!function e(t,n,r){function o(i,l){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!l&&s)return s(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";function r(e){var t,n,r,o,a,i,l=e.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a="="===e[l-2]?2:"="===e[l-1]?1:0,i=new u(3*l/4-a),r=a>0?l-4:l;var c=0;for(t=0,n=0;t<r;t+=4,n+=3)o=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],i[c++]=o>>16&255,i[c++]=o>>8&255,i[c++]=255&o;return 2===a?(o=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,i[c++]=255&o):1===a&&(o=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,i[c++]=o>>8&255,i[c++]=255&o),i}function o(e){return l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}function a(e,t,n){for(var r,a=[],i=t;i<n;i+=3)r=(e[i]<<16)+(e[i+1]<<8)+e[i+2],a.push(o(r));return a.join("")}function i(e){for(var t,n=e.length,r=n%3,o="",i=[],s=0,u=n-r;s<u;s+=16383)i.push(a(e,s,s+16383>u?u:s+16383));return 1===r?(t=e[n-1],o+=l[t>>2],o+=l[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=l[t>>10],o+=l[t>>4&63],o+=l[t<<2&63],o+="="),i.push(o),i.join("")}n.toByteArray=r,n.fromByteArray=i;var l=[],s=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array;!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)l[t]=e[t],s[e.charCodeAt(t)]=t;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}()},{}],2:[function(e,t,n){(function(t){"use strict";function r(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return i(this,e,t,n)}function i(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?c(e,t,n):p(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number')}function s(e,t,n,r){return l(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function u(e,t){if(l(t),e=o(e,t<0?0:0|h(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(t,n);e=o(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function f(e,t){var n=0|h(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=f(e,t),e}function p(e,t){if(a.isBuffer(t)){var n=0|h(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||W(t.length)?o(e,0):f(e,t);if("Buffer"===t.type&&K(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),a.alloc(+e)}function g(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return Y(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return O(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return j(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function x(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){function a(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}var i=1,l=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,l/=2,s/=2,n/=2}var u;if(o){var c=-1;for(u=n;u<l;u++)if(a(e,u)===a(t,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===s)return c*i}else-1!==c&&(u-=u-c),c=-1}else for(n+s>l&&(n=l-s),u=n;u>=0;u--){for(var f=!0,d=0;d<s;d++)if(a(e,u+d)!==a(t,d)){f=!1;break}if(f)return u}return-1}function w(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var i=0;i<r;++i){var l=parseInt(t.substr(2*i,2),16);if(isNaN(l))return i;e[n+i]=l}return i}function _(e,t,n,r){return Z(Y(t,e.length-n),e,n,r)}function k(e,t,n,r){return Z(H(t),e,n,r)}function z(e,t,n,r){return k(e,t,n,r)}function M(e,t,n,r){return Z(G(t),e,n,r)}function A(e,t,n,r){return Z(X(t,e.length-n),e,n,r)}function j(e,t,n){return 0===t&&n===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var a=e[o],i=null,l=a>239?4:a>223?3:a>191?2:1;if(o+l<=n){var s,u,c,f;switch(l){case 1:a<128&&(i=a);break;case 2:s=e[o+1],128==(192&s)&&(f=(31&a)<<6|63&s)>127&&(i=f);break;case 3:s=e[o+1],u=e[o+2],128==(192&s)&&128==(192&u)&&(f=(15&a)<<12|(63&s)<<6|63&u)>2047&&(f<55296||f>57343)&&(i=f);break;case 4:s=e[o+1],u=e[o+2],c=e[o+3],128==(192&s)&&128==(192&u)&&128==(192&c)&&(f=(15&a)<<18|(63&s)<<12|(63&u)<<6|63&c)>65535&&f<1114112&&(i=f)}}null===i?(i=65533,l=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=l}return S(r)}function S(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=$));return n}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function N(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function F(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",a=t;a<n;++a)o+=U(e[a]);return o}function T(e,t,n){for(var r=e.slice(t,n),o="",a=0;a<r.length;a+=2)o+=String.fromCharCode(r[a]+256*r[a+1]);return o}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function q(e,t,n,r,o,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function B(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function D(e,t,n,r,o,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(e,t,n,r,o){return o||D(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,o){return o||D(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,n,r,52,8),n+8}function L(e){if(e=V(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function V(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var n,r=e.length,o=null,a=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function X(e,t){for(var n,r,o,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,o=n%256,a.push(o),a.push(r);return a}function G(e){return J.toByteArray(L(e))}function Z(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function W(e){return e!==e}var J=e("base64-js"),Q=e("ieee754"),K=e("isarray");n.Buffer=a,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=r(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return i(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return s(null,e,t,n)},a.allocUnsafe=function(e){return u(null,e)},a.allocUnsafeSlow=function(e){return u(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!K(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):m.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,o){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,l=n-t,s=Math.min(i,l),u=this.slice(r,o),c=e.slice(t,n),f=0;f<s;++f)if(u[f]!==c[f]){i=u[f],l=c[f];break}return i<l?-1:l<i?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return x(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return x(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return k(this,e,t,n);case"latin1":case"binary":return z(this,e,t,n);case"base64":return M(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=a.prototype;else{var o=t-e;r=new a(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},a.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return r},a.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},a.prototype.readUInt8=function(e,t){return t||C(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||C(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||C(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=t,o=1,a=this[e+--r];r>0&&(o*=256);)a+=this[e+--r]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||C(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||C(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||C(e,4,this.length),Q.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||C(e,4,this.length),Q.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||C(e,8,this.length),Q.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||C(e,8,this.length),Q.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){q(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){q(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):B(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var a=0,i=1,l=0;for(this[t]=255&e;++a<n&&(i*=256);)e<0&&0===l&&0!==this[t+a-1]&&(l=1),this[t+a]=(e/i>>0)-l&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var a=n-1,i=1,l=0;for(this[t+a]=255&e;--a>=0&&(i*=256);)e<0&&0===l&&0!==this[t+a+1]&&(l=1),this[t+a]=(e/i>>0)-l&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):B(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return R(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var i;if("number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var l=a.isBuffer(e)?e:Y(new a(e,r).toString()),s=l.length;for(i=0;i<n-t;++i)this[i+t]=l[i%s]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:6,isarray:7}],3:[function(e,t,n){!function(){function e(e){return e&&(e.ownerDocument||e.document||e).documentElement}function n(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function r(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function o(e){return null===e?NaN:+e}function a(e){return!isNaN(e)}function i(e){return{left:function(t,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)<0?r=a+1:o=a}return r},right:function(t,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)>0?o=a:r=a+1}return r}}}function l(e){return e.length}function s(e){for(var t=1;e*t%1;)t*=10;return t}function u(e,t){for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}function c(){this._=Object.create(null)}function f(e){return(e+="")===bi||e[0]===wi?wi+e:e}function d(e){return(e+="")[0]===wi?e.slice(1):e}function p(e){return f(e)in this._}function h(e){return(e=f(e))in this._&&delete this._[e]}function v(){var e=[];for(var t in this._)e.push(d(t));return e}function g(){var e=0;for(var t in this._)++e;return e}function m(){for(var e in this._)return!1;return!0}function y(){this._=Object.create(null)}function x(e){return e}function b(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function w(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0,r=_i.length;n<r;++n){var o=_i[n]+t;if(o in e)return o}}function _(){}function k(){}function z(e){function t(){for(var t,r=n,o=-1,a=r.length;++o<a;)(t=r[o].on)&&t.apply(this,arguments);return e}var n=[],r=new c;return t.on=function(t,o){var a,i=r.get(t);return arguments.length<2?i&&i.on:(i&&(i.on=null,n=n.slice(0,a=n.indexOf(i)).concat(n.slice(a+1)),r.remove(t)),o&&n.push(r.set(t,{on:o})),e)},t}function M(){ui.event.preventDefault()}function A(){for(var e,t=ui.event;e=t.sourceEvent;)t=e;return t}function j(e){for(var t=new k,n=0,r=arguments.length;++n<r;)t[arguments[n]]=z(t);return t.of=function(n,r){return function(o){try{var a=o.sourceEvent=ui.event;o.target=e,ui.event=o,t[o.type].apply(n,r)}finally{ui.event=a}}},t}function E(e){return zi(e,Ei),e}function S(e){return"function"==typeof e?e:function(){return Mi(e,this)}}function O(e){return"function"==typeof e?e:function(){return Ai(e,this)}}function N(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function o(){this.setAttribute(e,t)}function a(){this.setAttributeNS(e.space,e.local,t)}function i(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function l(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=ui.ns.qualify(e),null==t?e.local?r:n:"function"==typeof t?e.local?l:i:e.local?a:o}function F(e){return e.trim().replace(/\s+/g," ")}function T(e){return new RegExp("(?:^|\\s+)"+ui.requote(e)+"(?:\\s+|$)","g")}function C(e){return(e+"").trim().split(/^|\s+/)}function q(e,t){function n(){for(var n=-1;++n<o;)e[n](this,t)}function r(){for(var n=-1,r=t.apply(this,arguments);++n<o;)e[n](this,r)}e=C(e).map(P);var o=e.length;return"function"==typeof t?r:n}function P(e){var t=T(e);return function(n,r){if(o=n.classList)return r?o.add(e):o.remove(e);var o=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(o)||n.setAttribute("class",F(o+" "+e))):n.setAttribute("class",F(o.replace(t," ")))}}function B(e,t,n){function r(){this.style.removeProperty(e)}function o(){this.style.setProperty(e,t,n)}function a(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return null==t?r:"function"==typeof t?a:o}function D(e,t){function n(){delete this[e]}function r(){this[e]=t}function o(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"==typeof t?o:r}function R(e){function t(){var t=this.ownerDocument,n=this.namespaceURI;return n&&n!==t.documentElement.namespaceURI?t.createElementNS(n,e):t.createElement(e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=ui.ns.qualify(e)).local?n:t}function I(){var e=this.parentNode;e&&e.removeChild(this)}function L(e){return{__data__:e}}function V(e){return function(){return ji(this,e)}}function U(e){return arguments.length||(e=r),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function Y(e,t){for(var n=0,r=e.length;n<r;n++)for(var o,a=e[n],i=0,l=a.length;i<l;i++)(o=a[i])&&t(o,i,n);return e}function H(e){return zi(e,Oi),e}function X(e){var t,n;return function(r,o,a){var i,l=e[a].update,s=l.length;for(a!=n&&(n=a,t=0),o>=t&&(t=o+1);!(i=l[t])&&++t<s;);return i}}function G(e,t,n){function r(){var t=this[i];t&&(this.removeEventListener(e,t,t.$),delete this[i])}function o(){var o=s(t,fi(arguments));r.call(this),this.addEventListener(e,this[i]=o,o.$=n),o._=t}function a(){var t,n=new RegExp("^__on([^.]+)"+ui.requote(e)+"$");for(var r in this)if(t=r.match(n)){var o=this[r];this.removeEventListener(t[1],o,o.$),delete this[r]}}var i="__on"+e,l=e.indexOf("."),s=Z;l>0&&(e=e.slice(0,l));var u=Ni.get(e);return u&&(e=u,s=W),l?t?o:r:t?_:a}function Z(e,t){return function(n){var r=ui.event;ui.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{ui.event=r}}}function W(e,t){var n=Z(e,t);return function(e){var t=this,r=e.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||n.call(t,e)}}function J(t){var r=".dragsuppress-"+ ++Ti,o="click"+r,a=ui.select(n(t)).on("touchmove"+r,M).on("dragstart"+r,M).on("selectstart"+r,M);if(null==Fi&&(Fi=!("onselectstart"in t)&&w(t.style,"userSelect")),Fi){var i=e(t).style,l=i[Fi];i[Fi]="none"}return function(e){if(a.on(r,null),Fi&&(i[Fi]=l),e){var t=function(){a.on(o,null)};a.on(o,function(){M(),t()},!0),setTimeout(t,0)}}}function Q(e,t){t.changedTouches&&(t=t.changedTouches[0]);var r=e.ownerSVGElement||e;if(r.createSVGPoint){var o=r.createSVGPoint();if(Ci<0){var a=n(e);if(a.scrollX||a.scrollY){r=ui.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var i=r[0][0].getScreenCTM();Ci=!(i.f||i.e),r.remove()}}return Ci?(o.x=t.pageX,o.y=t.pageY):(o.x=t.clientX,o.y=t.clientY),o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}var l=e.getBoundingClientRect();return[t.clientX-l.left-e.clientLeft,t.clientY-l.top-e.clientTop]}function K(){return ui.event.changedTouches[0].identifier}function $(e){return e>0?1:e<0?-1:0}function ee(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function te(e){return e>1?0:e<-1?Bi:Math.acos(e)}function ne(e){return e>1?Ii:e<-1?-Ii:Math.asin(e)}function re(e){return((e=Math.exp(e))-1/e)/2}function oe(e){return((e=Math.exp(e))+1/e)/2}function ae(e){return((e=Math.exp(2*e))-1)/(e+1)}function ie(e){return(e=Math.sin(e/2))*e}function le(){}function se(e,t,n){return this instanceof se?(this.h=+e,this.s=+t,void(this.l=+n)):arguments.length<2?e instanceof se?new se(e.h,e.s,e.l):_e(""+e,ke,se):new se(e,t,n)}function ue(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?a+(i-a)*e/60:e<180?i:e<240?a+(i-a)*(240-e)/60:a}function o(e){return Math.round(255*r(e))}var a,i;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i,new ye(o(e+120),o(e),o(e-120))}function ce(e,t,n){return this instanceof ce?(this.h=+e,this.c=+t,void(this.l=+n)):arguments.length<2?e instanceof ce?new ce(e.h,e.c,e.l):e instanceof de?he(e.l,e.a,e.b):he((e=ze((e=ui.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new ce(e,t,n)}function fe(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new de(n,Math.cos(e*=Li)*t,Math.sin(e)*t)}function de(e,t,n){return this instanceof de?(this.l=+e,this.a=+t,void(this.b=+n)):arguments.length<2?e instanceof de?new de(e.l,e.a,e.b):e instanceof ce?fe(e.h,e.c,e.l):ze((e=ye(e)).r,e.g,e.b):new de(e,t,n)}function pe(e,t,n){var r=(e+16)/116,o=r+t/500,a=r-n/200;return o=ve(o)*Ji,r=ve(r)*Qi,a=ve(a)*Ki,new ye(me(3.2404542*o-1.5371385*r-.4985314*a),me(-.969266*o+1.8760108*r+.041556*a),me(.0556434*o-.2040259*r+1.0572252*a))}function he(e,t,n){return e>0?new ce(Math.atan2(n,t)*Vi,Math.sqrt(t*t+n*n),e):new ce(NaN,NaN,e)}function ve(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ge(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function me(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function ye(e,t,n){return this instanceof ye?(this.r=~~e,this.g=~~t,void(this.b=~~n)):arguments.length<2?e instanceof ye?new ye(e.r,e.g,e.b):_e(""+e,ye,ue):new ye(e,t,n)}function xe(e){return new ye(e>>16,e>>8&255,255&e)}function be(e){return xe(e)+""}function we(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function _e(e,t,n){var r,o,a,i=0,l=0,s=0;if(r=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()))switch(o=r[2].split(","),r[1]){case"hsl":return n(parseFloat(o[0]),parseFloat(o[1])/100,parseFloat(o[2])/100);case"rgb":return t(Ae(o[0]),Ae(o[1]),Ae(o[2]))}return(a=tl.get(e))?t(a.r,a.g,a.b):(null==e||"#"!==e.charAt(0)||isNaN(a=parseInt(e.slice(1),16))||(4===e.length?(i=(3840&a)>>4,i|=i>>4,l=240&a,l|=l>>4,s=15&a,s|=s<<4):7===e.length&&(i=(16711680&a)>>16,l=(65280&a)>>8,s=255&a)),t(i,l,s))}function ke(e,t,n){var r,o,a=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),l=i-a,s=(i+a)/2;return l?(o=s<.5?l/(i+a):l/(2-i-a),r=e==i?(t-n)/l+(t<n?6:0):t==i?(n-e)/l+2:(e-t)/l+4,r*=60):(r=NaN,o=s>0&&s<1?0:r),new se(r,o,s)}function ze(e,t,n){e=Me(e),t=Me(t),n=Me(n);var r=ge((.4124564*e+.3575761*t+.1804375*n)/Ji),o=ge((.2126729*e+.7151522*t+.072175*n)/Qi);return de(116*o-16,500*(r-o),200*(o-ge((.0193339*e+.119192*t+.9503041*n)/Ki)))}function Me(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ae(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function je(e){return"function"==typeof e?e:function(){return e}}function Ee(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),Se(t,n,e,r)}}function Se(e,t,n,r){function o(){var e,t=s.status;if(!t&&Ne(s)||t>=200&&t<300||304===t){try{e=n.call(a,s)}catch(e){return void i.error.call(a,e)}i.load.call(a,e)}else i.error.call(a,s)}var a={},i=ui.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,u=null
;return!this.XDomainRequest||"withCredentials"in s||!/^(http(s)?:)?\/\//.test(e)||(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=o:s.onreadystatechange=function(){s.readyState>3&&o()},s.onprogress=function(e){var t=ui.event;ui.event=e;try{i.progress.call(a,s)}finally{ui.event=t}},a.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?l[e]:(null==t?delete l[e]:l[e]=t+"",a)},a.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",a):t},a.responseType=function(e){return arguments.length?(u=e,a):u},a.response=function(e){return n=e,a},["get","post"].forEach(function(e){a[e]=function(){return a.send.apply(a,[e].concat(fi(arguments)))}}),a.send=function(n,r,o){if(2===arguments.length&&"function"==typeof r&&(o=r,r=null),s.open(n,e,!0),null==t||"accept"in l||(l.accept=t+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=t&&s.overrideMimeType&&s.overrideMimeType(t),null!=u&&(s.responseType=u),null!=o&&a.on("error",o).on("load",function(e){o(null,e)}),i.beforesend.call(a,s),s.send(null==r?null:r),a},a.abort=function(){return s.abort(),a},ui.rebind(a,i,"on"),null==r?a:a.get(Oe(r))}function Oe(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function Ne(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Fe(e,t,n){var r=arguments.length;r<2&&(t=0),r<3&&(n=Date.now());var o=n+t,a={c:e,t:o,n:null};return rl?rl.n=a:nl=a,rl=a,ol||(al=clearTimeout(al),ol=1,il(Te)),a}function Te(){var e=Ce(),t=qe()-e;t>24?(isFinite(t)&&(clearTimeout(al),al=setTimeout(Te,t)),ol=0):(ol=1,il(Te))}function Ce(){for(var e=Date.now(),t=nl;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function qe(){for(var e,t=nl,n=1/0;t;)t.c?(t.t<n&&(n=t.t),t=(e=t).n):t=e?e.n=t.n:nl=t.n;return rl=e,n}function Pe(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function Be(e,t){var n=Math.pow(10,3*xi(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function De(e){var t=e.decimal,n=e.thousands,r=e.grouping,o=e.currency,a=r&&n?function(e,t){for(var o=e.length,a=[],i=0,l=r[0],s=0;o>0&&l>0&&(s+l+1>t&&(l=Math.max(1,t-s)),a.push(e.substring(o-=l,o+l)),!((s+=l+1)>t));)l=r[i=(i+1)%r.length];return a.reverse().join(n)}:x;return function(e){var n=sl.exec(e),r=n[1]||" ",i=n[2]||">",l=n[3]||"-",s=n[4]||"",u=n[5],c=+n[6],f=n[7],d=n[8],p=n[9],h=1,v="",g="",m=!1,y=!0;switch(d&&(d=+d.substring(1)),(u||"0"===r&&"="===i)&&(u=r="0",i="="),p){case"n":f=!0,p="g";break;case"%":h=100,g="%",p="f";break;case"p":h=100,g="%",p="r";break;case"b":case"o":case"x":case"X":"#"===s&&(v="0"+p.toLowerCase());case"c":y=!1;case"d":m=!0,d=0;break;case"s":h=-1,p="r"}"$"===s&&(v=o[0],g=o[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):"e"!=p&&"f"!=p||(d=Math.max(0,Math.min(20,d)))),p=ul.get(p)||Re;var x=u&&f;return function(e){var n=g;if(m&&e%1)return"";var o=e<0||0===e&&1/e<0?(e=-e,"-"):"-"===l?"":l;if(h<0){var s=ui.formatPrefix(e,d);e=s.scale(e),n=s.symbol+g}else e*=h;e=p(e,d);var b,w,_=e.lastIndexOf(".");if(_<0){var k=y?e.lastIndexOf("e"):-1;k<0?(b=e,w=""):(b=e.substring(0,k),w=e.substring(k))}else b=e.substring(0,_),w=t+e.substring(_+1);!u&&f&&(b=a(b,1/0));var z=v.length+b.length+w.length+(x?0:o.length),M=z<c?new Array(z=c-z+1).join(r):"";return x&&(b=a(M+b,M.length?c-w.length:1/0)),o+=v,e=b+w,("<"===i?o+e+M:">"===i?M+o+e:"^"===i?M.substring(0,z>>=1)+o+e+M.substring(z):o+(x?e:M+e))+n}}}function Re(e){return e+""}function Ie(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Le(e,t,n){function r(t){var n=e(t),r=a(n,1);return t-n<r-t?n:r}function o(n){return t(n=e(new fl(n-1)),1),n}function a(e,n){return t(e=new fl(+e),n),e}function i(e,r,a){var i=o(e),l=[];if(a>1)for(;i<r;)n(i)%a||l.push(new Date(+i)),t(i,1);else for(;i<r;)l.push(new Date(+i)),t(i,1);return l}function l(e,t,n){try{fl=Ie;var r=new Ie;return r._=e,i(r,t,n)}finally{fl=Date}}e.floor=e,e.round=r,e.ceil=o,e.offset=a,e.range=i;var s=e.utc=Ve(e);return s.floor=s,s.round=Ve(r),s.ceil=Ve(o),s.offset=Ve(a),s.range=l,e}function Ve(e){return function(t,n){try{fl=Ie;var r=new Ie;return r._=t,e(r,n)._}finally{fl=Date}}}function Ue(e){function t(e){function t(t){for(var n,o,a,i=[],l=-1,s=0;++l<r;)37===e.charCodeAt(l)&&(i.push(e.slice(s,l)),null!=(o=pl[n=e.charAt(++l)])&&(n=e.charAt(++l)),(a=E[n])&&(n=a(t,null==o?"e"===n?" ":"0":o)),i.push(n),s=l+1);return i.push(e.slice(s,l)),i.join("")}var r=e.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(n(r,e,t,0)!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var o=null!=r.Z&&fl!==Ie,a=new(o?Ie:fl);return"j"in r?a.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),a.setFullYear(r.y,0,1),a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(a.getDay()+5)%7:r.w+7*r.U-(a.getDay()+6)%7)):a.setFullYear(r.y,r.m,r.d),a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),o?a._:a},t.toString=function(){return e},t}function n(e,t,n,r){for(var o,a,i,l=0,s=t.length,u=n.length;l<s;){if(r>=u)return-1;if(37===(o=t.charCodeAt(l++))){if(i=t.charAt(l++),!(a=S[i in pl?t.charAt(l++):i])||(r=a(e,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}function r(e,t,n){_.lastIndex=0;var r=_.exec(t.slice(n));return r?(e.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function o(e,t,n){b.lastIndex=0;var r=b.exec(t.slice(n));return r?(e.w=w.get(r[0].toLowerCase()),n+r[0].length):-1}function a(e,t,n){A.lastIndex=0;var r=A.exec(t.slice(n));return r?(e.m=j.get(r[0].toLowerCase()),n+r[0].length):-1}function i(e,t,n){z.lastIndex=0;var r=z.exec(t.slice(n));return r?(e.m=M.get(r[0].toLowerCase()),n+r[0].length):-1}function l(e,t,r){return n(e,E.c.toString(),t,r)}function s(e,t,r){return n(e,E.x.toString(),t,r)}function u(e,t,r){return n(e,E.X.toString(),t,r)}function c(e,t,n){var r=x.get(t.slice(n,n+=2).toLowerCase());return null==r?-1:(e.p=r,n)}var f=e.dateTime,d=e.date,p=e.time,h=e.periods,v=e.days,g=e.shortDays,m=e.months,y=e.shortMonths;t.utc=function(e){function n(e){try{fl=Ie;var t=new fl;return t._=e,r(t)}finally{fl=Date}}var r=t(e);return n.parse=function(e){try{fl=Ie;var t=r.parse(e);return t&&t._}finally{fl=Date}},n.toString=r.toString,n},t.multi=t.utc.multi=ut;var x=ui.map(),b=He(v),w=Xe(v),_=He(g),k=Xe(g),z=He(m),M=Xe(m),A=He(y),j=Xe(y);h.forEach(function(e,t){x.set(e.toLowerCase(),t)});var E={a:function(e){return g[e.getDay()]},A:function(e){return v[e.getDay()]},b:function(e){return y[e.getMonth()]},B:function(e){return m[e.getMonth()]},c:t(f),d:function(e,t){return Ye(e.getDate(),t,2)},e:function(e,t){return Ye(e.getDate(),t,2)},H:function(e,t){return Ye(e.getHours(),t,2)},I:function(e,t){return Ye(e.getHours()%12||12,t,2)},j:function(e,t){return Ye(1+cl.dayOfYear(e),t,3)},L:function(e,t){return Ye(e.getMilliseconds(),t,3)},m:function(e,t){return Ye(e.getMonth()+1,t,2)},M:function(e,t){return Ye(e.getMinutes(),t,2)},p:function(e){return h[+(e.getHours()>=12)]},S:function(e,t){return Ye(e.getSeconds(),t,2)},U:function(e,t){return Ye(cl.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Ye(cl.mondayOfYear(e),t,2)},x:t(d),X:t(p),y:function(e,t){return Ye(e.getFullYear()%100,t,2)},Y:function(e,t){return Ye(e.getFullYear()%1e4,t,4)},Z:lt,"%":function(){return"%"}},S={a:r,A:o,b:a,B:i,c:l,d:tt,e:tt,H:rt,I:rt,j:nt,L:it,m:et,M:ot,p:c,S:at,U:Ze,w:Ge,W:We,x:s,X:u,y:Qe,Y:Je,Z:Ke,"%":st};return t}function Ye(e,t,n){var r=e<0?"-":"",o=(r?-e:e)+"",a=o.length;return r+(a<n?new Array(n-a+1).join(t)+o:o)}function He(e){return new RegExp("^(?:"+e.map(ui.requote).join("|")+")","i")}function Xe(e){for(var t=new c,n=-1,r=e.length;++n<r;)t.set(e[n].toLowerCase(),n);return t}function Ge(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ze(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n));return r?(e.U=+r[0],n+r[0].length):-1}function We(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n));return r?(e.W=+r[0],n+r[0].length):-1}function Je(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Qe(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.y=$e(+r[0]),n+r[0].length):-1}function Ke(e,t,n){return/^[+-]\d{4}$/.test(t=t.slice(n,n+5))?(e.Z=-t,n+5):-1}function $e(e){return e+(e>68?1900:2e3)}function et(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function tt(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function nt(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+3));return r?(e.j=+r[0],n+r[0].length):-1}function rt(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ot(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function at(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function it(e,t,n){hl.lastIndex=0;var r=hl.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function lt(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=xi(t)/60|0,o=xi(t)%60;return n+Ye(r,"0",2)+Ye(o,"0",2)}function st(e,t,n){vl.lastIndex=0;var r=vl.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function ut(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,r=e[n];!r[1](t);)r=e[++n];return r[0](t)}}function ct(){}function ft(e,t,n){var r=n.s=e+t,o=r-e,a=r-o;n.t=e-a+(t-o)}function dt(e,t){e&&xl.hasOwnProperty(e.type)&&xl[e.type](e,t)}function pt(e,t,n){var r,o=-1,a=e.length-n;for(t.lineStart();++o<a;)r=e[o],t.point(r[0],r[1],r[2]);t.lineEnd()}function ht(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)pt(e[n],t,1);t.polygonEnd()}function vt(){function e(e,t){e*=Li,t=t*Li/2+Bi/4;var n=e-r,i=n>=0?1:-1,l=i*n,s=Math.cos(t),u=Math.sin(t),c=a*u,f=o*s+c*Math.cos(l),d=c*i*Math.sin(l);wl.add(Math.atan2(d,f)),r=e,o=s,a=u}var t,n,r,o,a;_l.point=function(i,l){_l.point=e,r=(t=i)*Li,o=Math.cos(l=(n=l)*Li/2+Bi/4),a=Math.sin(l)},_l.lineEnd=function(){e(t,n)}}function gt(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function mt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function yt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function xt(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function bt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function wt(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function _t(e){return[Math.atan2(e[1],e[0]),ne(e[2])]}function kt(e,t){return xi(e[0]-t[0])<qi&&xi(e[1]-t[1])<qi}function zt(e,t){e*=Li;var n=Math.cos(t*=Li);Mt(n*Math.cos(e),n*Math.sin(e),Math.sin(t))}function Mt(e,t,n){++kl,Ml+=(e-Ml)/kl,Al+=(t-Al)/kl,jl+=(n-jl)/kl}function At(){function e(e,o){e*=Li;var a=Math.cos(o*=Li),i=a*Math.cos(e),l=a*Math.sin(e),s=Math.sin(o),u=Math.atan2(Math.sqrt((u=n*s-r*l)*u+(u=r*i-t*s)*u+(u=t*l-n*i)*u),t*i+n*l+r*s);zl+=u,El+=u*(t+(t=i)),Sl+=u*(n+(n=l)),Ol+=u*(r+(r=s)),Mt(t,n,r)}var t,n,r;Cl.point=function(o,a){o*=Li;var i=Math.cos(a*=Li);t=i*Math.cos(o),n=i*Math.sin(o),r=Math.sin(a),Cl.point=e,Mt(t,n,r)}}function jt(){Cl.point=zt}function Et(){function e(e,t){e*=Li;var n=Math.cos(t*=Li),i=n*Math.cos(e),l=n*Math.sin(e),s=Math.sin(t),u=o*s-a*l,c=a*i-r*s,f=r*l-o*i,d=Math.sqrt(u*u+c*c+f*f),p=r*i+o*l+a*s,h=d&&-te(p)/d,v=Math.atan2(d,p);Nl+=h*u,Fl+=h*c,Tl+=h*f,zl+=v,El+=v*(r+(r=i)),Sl+=v*(o+(o=l)),Ol+=v*(a+(a=s)),Mt(r,o,a)}var t,n,r,o,a;Cl.point=function(i,l){t=i,n=l,Cl.point=e,i*=Li;var s=Math.cos(l*=Li);r=s*Math.cos(i),o=s*Math.sin(i),a=Math.sin(l),Mt(r,o,a)},Cl.lineEnd=function(){e(t,n),Cl.lineEnd=jt,Cl.point=zt}}function St(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function Ot(){return!0}function Nt(e,t,n,r,o){var a=[],i=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n=e[0],r=e[t];if(kt(n,r)){o.lineStart();for(var l=0;l<t;++l)o.point((n=e[l])[0],n[1]);return void o.lineEnd()}var s=new Tt(n,e,null,!0),u=new Tt(n,null,s,!1);s.o=u,a.push(s),i.push(u),s=new Tt(r,e,null,!1),u=new Tt(r,null,s,!0),s.o=u,a.push(s),i.push(u)}}),i.sort(t),Ft(a),Ft(i),a.length){for(var l=0,s=n,u=i.length;l<u;++l)i[l].e=s=!s;for(var c,f,d=a[0];;){for(var p=d,h=!0;p.v;)if((p=p.n)===d)return;c=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(var l=0,u=c.length;l<u;++l)o.point((f=c[l])[0],f[1]);else r(p.x,p.n.x,1,o);p=p.n}else{if(h){c=p.p.z;for(var l=c.length-1;l>=0;--l)o.point((f=c[l])[0],f[1])}else r(p.x,p.p.x,-1,o);p=p.p}p=p.o,c=p.z,h=!h}while(!p.v);o.lineEnd()}}}function Ft(e){if(t=e.length){for(var t,n,r=0,o=e[0];++r<t;)o.n=n=e[r],n.p=o,o=n;o.n=n=e[0],n.p=o}}function Tt(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Ct(e,t,n,r){return function(o,a){function i(t,n){var r=o(t,n);e(t=r[0],n=r[1])&&a.point(t,n)}function l(e,t){var n=o(e,t);g.point(n[0],n[1])}function s(){y.point=l,g.lineStart()}function u(){y.point=i,g.lineEnd()}function c(e,t){v.push([e,t]);var n=o(e,t);b.point(n[0],n[1])}function f(){b.lineStart(),v=[]}function d(){c(v[0][0],v[0][1]),b.lineEnd();var e,t=b.clean(),n=x.buffer(),r=n.length;if(v.pop(),h.push(v),v=null,r)if(1&t){e=n[0];var o,r=e.length-1,i=-1;if(r>0){for(w||(a.polygonStart(),w=!0),a.lineStart();++i<r;)a.point((o=e[i])[0],o[1]);a.lineEnd()}}else r>1&&2&t&&n.push(n.pop().concat(n.shift())),p.push(n.filter(qt))}var p,h,v,g=t(a),m=o.invert(r[0],r[1]),y={point:i,lineStart:s,lineEnd:u,polygonStart:function(){y.point=c,y.lineStart=f,y.lineEnd=d,p=[],h=[]},polygonEnd:function(){y.point=i,y.lineStart=s,y.lineEnd=u,p=ui.merge(p);var e=Lt(m,h);p.length?(w||(a.polygonStart(),w=!0),Nt(p,Bt,e,n,a)):e&&(w||(a.polygonStart(),w=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),w&&(a.polygonEnd(),w=!1),p=h=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}},x=Pt(),b=t(x),w=!1;return y}}function qt(e){return e.length>1}function Pt(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:_,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Bt(e,t){return((e=e.x)[0]<0?e[1]-Ii-qi:Ii-e[1])-((t=t.x)[0]<0?t[1]-Ii-qi:Ii-t[1])}function Dt(e){var t,n=NaN,r=NaN,o=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,i){var l=a>0?Bi:-Bi,s=xi(a-n);xi(s-Bi)<qi?(e.point(n,r=(r+i)/2>0?Ii:-Ii),e.point(o,r),e.lineEnd(),e.lineStart(),e.point(l,r),e.point(a,r),t=0):o!==l&&s>=Bi&&(xi(n-o)<qi&&(n-=o*qi),xi(a-l)<qi&&(a-=l*qi),r=Rt(n,r,a,i),e.point(o,r),e.lineEnd(),e.lineStart(),e.point(l,r),t=0),e.point(n=a,r=i),o=l},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}function Rt(e,t,n,r){var o,a,i=Math.sin(e-n);return xi(i)>qi?Math.atan((Math.sin(t)*(a=Math.cos(r))*Math.sin(n)-Math.sin(r)*(o=Math.cos(t))*Math.sin(e))/(o*a*i)):(t+r)/2}function It(e,t,n,r){var o;if(null==e)o=n*Ii,r.point(-Bi,o),r.point(0,o),r.point(Bi,o),r.point(Bi,0),r.point(Bi,-o),r.point(0,-o),r.point(-Bi,-o),r.point(-Bi,0),r.point(-Bi,o);else if(xi(e[0]-t[0])>qi){var a=e[0]<t[0]?Bi:-Bi;o=n*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}function Lt(e,t){var n=e[0],r=e[1],o=[Math.sin(n),-Math.cos(n),0],a=0,i=0;wl.reset();for(var l=0,s=t.length;l<s;++l){var u=t[l],c=u.length;if(c)for(var f=u[0],d=f[0],p=f[1]/2+Bi/4,h=Math.sin(p),v=Math.cos(p),g=1;;){g===c&&(g=0),e=u[g];var m=e[0],y=e[1]/2+Bi/4,x=Math.sin(y),b=Math.cos(y),w=m-d,_=w>=0?1:-1,k=_*w,z=k>Bi,M=h*x;if(wl.add(Math.atan2(M*_*Math.sin(k),v*b+M*Math.cos(k))),a+=z?w+_*Di:w,z^d>=n^m>=n){var A=yt(gt(f),gt(e));wt(A);var j=yt(o,A);wt(j);var E=(z^w>=0?-1:1)*ne(j[2]);(r>E||r===E&&(A[0]||A[1]))&&(i+=z^w>=0?1:-1)}if(!g++)break;d=m,h=x,v=b,f=e}}return(a<-qi||a<qi&&wl<0)^1&i}function Vt(e){function t(e,t){return Math.cos(e)*Math.cos(t)>a}function n(e){var n,a,s,u,c;return{lineStart:function(){u=s=!1,c=1},point:function(f,d){var p,h=[f,d],v=t(f,d),g=i?v?0:o(f,d):v?o(f+(f<0?Bi:-Bi),d):0;if(!n&&(u=s=v)&&e.lineStart(),v!==s&&(p=r(n,h),(kt(n,p)||kt(h,p))&&(h[0]+=qi,h[1]+=qi,v=t(h[0],h[1]))),v!==s)c=0,v?(e.lineStart(),p=r(h,n),e.point(p[0],p[1])):(p=r(n,h),e.point(p[0],p[1]),e.lineEnd()),n=p;else if(l&&n&&i^v){var m;g&a||!(m=r(h,n,!0))||(c=0,i?(e.lineStart(),e.point(m[0][0],m[0][1]),e.point(m[1][0],m[1][1]),e.lineEnd()):(e.point(m[1][0],m[1][1]),e.lineEnd(),e.lineStart(),e.point(m[0][0],m[0][1])))}!v||n&&kt(n,h)||e.point(h[0],h[1]),n=h,s=v,a=g},lineEnd:function(){s&&e.lineEnd(),n=null},clean:function(){return c|(u&&s)<<1}}}function r(e,t,n){var r=gt(e),o=gt(t),i=[1,0,0],l=yt(r,o),s=mt(l,l),u=l[0],c=s-u*u;if(!c)return!n&&e;var f=a*s/c,d=-a*u/c,p=yt(i,l),h=bt(i,f);xt(h,bt(l,d));var v=p,g=mt(h,v),m=mt(v,v),y=g*g-m*(mt(h,h)-1);if(!(y<0)){var x=Math.sqrt(y),b=bt(v,(-g-x)/m);if(xt(b,h),b=_t(b),!n)return b;var w,_=e[0],k=t[0],z=e[1],M=t[1];k<_&&(w=_,_=k,k=w);var A=k-_,j=xi(A-Bi)<qi,E=j||A<qi;if(!j&&M<z&&(w=z,z=M,M=w),E?j?z+M>0^b[1]<(xi(b[0]-_)<qi?z:M):z<=b[1]&&b[1]<=M:A>Bi^(_<=b[0]&&b[0]<=k)){var S=bt(v,(-g+x)/m);return xt(S,h),[b,_t(S)]}}}function o(t,n){var r=i?e:Bi-e,o=0;return t<-r?o|=1:t>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}var a=Math.cos(e),i=a>0,l=xi(a)>qi;return Ct(t,n,gn(e,6*Li),i?[0,-e]:[-Bi,e-Bi])}function Ut(e,t,n,r){return function(o){var a,i=o.a,l=o.b,s=i.x,u=i.y,c=l.x,f=l.y,d=0,p=1,h=c-s,v=f-u;if(a=e-s,h||!(a>0)){if(a/=h,h<0){if(a<d)return;a<p&&(p=a)}else if(h>0){if(a>p)return;a>d&&(d=a)}if(a=n-s,h||!(a<0)){if(a/=h,h<0){if(a>p)return;a>d&&(d=a)}else if(h>0){if(a<d)return;a<p&&(p=a)}if(a=t-u,v||!(a>0)){if(a/=v,v<0){if(a<d)return;a<p&&(p=a)}else if(v>0){if(a>p)return;a>d&&(d=a)}if(a=r-u,v||!(a<0)){if(a/=v,v<0){if(a>p)return;a>d&&(d=a)}else if(v>0){if(a<d)return;a<p&&(p=a)}return d>0&&(o.a={x:s+d*h,y:u+d*v}),p<1&&(o.b={x:s+p*h,y:u+p*v}),o}}}}}}function Yt(e,t,n,r){function o(r,o){return xi(r[0]-e)<qi?o>0?0:3:xi(r[0]-n)<qi?o>0?2:1:xi(r[1]-t)<qi?o>0?1:0:o>0?3:2}function a(e,t){return i(e.x,t.x)}function i(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(l){function s(e){for(var t=0,n=g.length,r=e[1],o=0;o<n;++o)for(var a,i=1,l=g[o],s=l.length,u=l[0];i<s;++i)a=l[i],u[1]<=r?a[1]>r&&ee(u,a,e)>0&&++t:a[1]<=r&&ee(u,a,e)<0&&--t,u=a;return 0!==t}function u(a,l,s,u){var c=0,f=0;if(null==a||(c=o(a,s))!==(f=o(l,s))||i(a,l)<0^s>0)do{u.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==f);else u.point(l[0],l[1])}function c(o,a){return e<=o&&o<=n&&t<=a&&a<=r}function f(e,t){c(e,t)&&l.point(e,t)}function d(){S.point=h,g&&g.push(m=[]),z=!0,k=!1,w=_=NaN}function p(){v&&(h(y,x),b&&k&&j.rejoin(),v.push(j.buffer())),S.point=f,k&&l.lineEnd()}function h(e,t){e=Math.max(-Pl,Math.min(Pl,e)),t=Math.max(-Pl,Math.min(Pl,t));var n=c(e,t);if(g&&m.push([e,t]),z)y=e,x=t,b=n,z=!1,n&&(l.lineStart(),l.point(e,t));else if(n&&k)l.point(e,t);else{var r={a:{x:w,y:_},b:{x:e,y:t}};E(r)?(k||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),M=!1):n&&(l.lineStart(),l.point(e,t),M=!1)}w=e,_=t,k=n}var v,g,m,y,x,b,w,_,k,z,M,A=l,j=Pt(),E=Ut(e,t,n,r),S={point:f,lineStart:d,lineEnd:p,polygonStart:function(){l=j,v=[],g=[],M=!0},polygonEnd:function(){l=A,v=ui.merge(v);var t=s([e,r]),n=M&&t,o=v.length;(n||o)&&(l.polygonStart(),n&&(l.lineStart(),u(null,null,1,l),l.lineEnd()),o&&Nt(v,a,t,u,l),l.polygonEnd()),v=g=m=null}};return S}}function Ht(e){var t=0,n=Bi/3,r=sn(e),o=r(t,n);return o.parallels=function(e){return arguments.length?r(t=e[0]*Bi/180,n=e[1]*Bi/180):[t/Bi*180,n/Bi*180]},o}function Xt(e,t){function n(e,t){var n=Math.sqrt(a-2*o*Math.sin(t))/o;return[n*Math.sin(e*=o),i-n*Math.cos(e)]}var r=Math.sin(e),o=(r+Math.sin(t))/2,a=1+r*(2*o-r),i=Math.sqrt(a)/o;return n.invert=function(e,t){var n=i-t;return[Math.atan2(e,n)/o,ne((a-(e*e+n*n)*o*o)/(2*o))]},n}function Gt(){function e(e,t){Dl+=o*e-r*t,r=e,o=t}var t,n,r,o;Ul.point=function(a,i){Ul.point=e,t=r=a,n=o=i},Ul.lineEnd=function(){e(t,n)}}function Zt(e,t){e<Rl&&(Rl=e),e>Ll&&(Ll=e),t<Il&&(Il=t),t>Vl&&(Vl=t)}function Wt(){function e(e,t){i.push("M",e,",",t,a)}function t(e,t){i.push("M",e,",",t),l.point=n}function n(e,t){i.push("L",e,",",t)}function r(){l.point=e}function o(){i.push("Z")}var a=Jt(4.5),i=[],l={point:e,lineStart:function(){l.point=t},lineEnd:r,polygonStart:function(){l.lineEnd=o},polygonEnd:function(){l.lineEnd=r,l.point=e},pointRadius:function(e){return a=Jt(e),l},result:function(){if(i.length){var e=i.join("");return i=[],e}}};return l}function Jt(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Qt(e,t){Ml+=e,Al+=t,++jl}function Kt(){function e(e,r){var o=e-t,a=r-n,i=Math.sqrt(o*o+a*a);El+=i*(t+e)/2,Sl+=i*(n+r)/2,Ol+=i,Qt(t=e,n=r)}var t,n;Hl.point=function(r,o){Hl.point=e,Qt(t=r,n=o)}}function $t(){Hl.point=Qt}function en(){function e(e,t){var n=e-r,a=t-o,i=Math.sqrt(n*n+a*a);El+=i*(r+e)/2,Sl+=i*(o+t)/2,Ol+=i,i=o*e-r*t,Nl+=i*(r+e),Fl+=i*(o+t),Tl+=3*i,Qt(r=e,o=t)}var t,n,r,o;Hl.point=function(a,i){Hl.point=e,Qt(t=r=a,n=o=i)},Hl.lineEnd=function(){e(t,n)}}function tn(e){function t(t,n){e.moveTo(t+i,n),e.arc(t,n,i,0,Di)}function n(t,n){e.moveTo(t,n),l.point=r}function r(t,n){e.lineTo(t,n)}function o(){l.point=t}function a(){e.closePath()}var i=4.5,l={point:t,lineStart:function(){l.point=n},lineEnd:o,polygonStart:function(){l.lineEnd=a},polygonEnd:function(){l.lineEnd=o,l.point=t},pointRadius:function(e){return i=e,l},result:_};return l}function nn(e){function t(e){return(l?r:n)(e)}function n(t){return an(t,function(n,r){n=e(n,r),t.point(n[0],n[1])})}function r(t){function n(n,r){n=e(n,r),t.point(n[0],n[1])}function r(){x=NaN,z.point=a,t.lineStart()}function a(n,r){var a=gt([n,r]),i=e(n,r);o(x,b,y,w,_,k,x=i[0],b=i[1],y=n,w=a[0],_=a[1],k=a[2],l,t),t.point(x,b)}function i(){z.point=n,t.lineEnd()}function s(){r(),z.point=u,z.lineEnd=c}function u(e,t){a(f=e,d=t),p=x,h=b,v=w,g=_,m=k,z.point=a}function c(){o(x,b,y,w,_,k,p,h,f,v,g,m,l,t),z.lineEnd=i,i()}var f,d,p,h,v,g,m,y,x,b,w,_,k,z={point:n,lineStart:r,lineEnd:i,polygonStart:function(){t.polygonStart(),z.lineStart=s},polygonEnd:function(){t.polygonEnd(),z.lineStart=r}};return z}function o(t,n,r,l,s,u,c,f,d,p,h,v,g,m){var y=c-t,x=f-n,b=y*y+x*x;if(b>4*a&&g--){var w=l+p,_=s+h,k=u+v,z=Math.sqrt(w*w+_*_+k*k),M=Math.asin(k/=z),A=xi(xi(k)-1)<qi||xi(r-d)<qi?(r+d)/2:Math.atan2(_,w),j=e(A,M),E=j[0],S=j[1],O=E-t,N=S-n,F=x*O-y*N;(F*F/b>a||xi((y*O+x*N)/b-.5)>.3||l*p+s*h+u*v<i)&&(o(t,n,r,l,s,u,E,S,A,w/=z,_/=z,k,g,m),m.point(E,S),o(E,S,A,w,_,k,c,f,d,p,h,v,g,m))}}var a=.5,i=Math.cos(30*Li),l=16;return t.precision=function(e){return arguments.length?(l=(a=e*e)>0&&16,t):Math.sqrt(a)},t}function rn(e){var t=nn(function(t,n){return e([t*Vi,n*Vi])});return function(e){return un(t(e))}}function on(e){this.stream=e}function an(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function ln(e){return sn(function(){return e})()}function sn(e){function t(e){return e=l(e[0]*Li,e[1]*Li),[e[0]*d+s,u-e[1]*d]}function n(e){return(e=l.invert((e[0]-s)/d,(u-e[1])/d))&&[e[0]*Vi,e[1]*Vi]}function r(){l=St(i=dn(m,y,b),a);var e=a(v,g);return s=p-e[0]*d,u=h+e[1]*d,o()}function o(){return c&&(c.valid=!1,c=null),t}var a,i,l,s,u,c,f=nn(function(e,t){return e=a(e,t),[e[0]*d+s,u-e[1]*d]}),d=150,p=480,h=250,v=0,g=0,m=0,y=0,b=0,w=ql,_=x,k=null,z=null;return t.stream=function(e){return c&&(c.valid=!1),c=un(w(i,f(_(e)))),c.valid=!0,c},t.clipAngle=function(e){return arguments.length?(w=null==e?(k=e,ql):Vt((k=+e)*Li),o()):k},t.clipExtent=function(e){return arguments.length?(z=e,_=e?Yt(e[0][0],e[0][1],e[1][0],e[1][1]):x,o()):z},t.scale=function(e){return arguments.length?(d=+e,r()):d},t.translate=function(e){return arguments.length?(p=+e[0],h=+e[1],r()):[p,h]},t.center=function(e){return arguments.length?(v=e[0]%360*Li,g=e[1]%360*Li,r()):[v*Vi,g*Vi]},t.rotate=function(e){return arguments.length?(m=e[0]%360*Li,y=e[1]%360*Li,b=e.length>2?e[2]%360*Li:0,r()):[m*Vi,y*Vi,b*Vi]},ui.rebind(t,f,"precision"),function(){return a=e.apply(this,arguments),t.invert=a.invert&&n,r()}}function un(e){return an(e,function(t,n){e.point(t*Li,n*Li)})}function cn(e,t){return[e,t]}function fn(e,t){return[e>Bi?e-Di:e<-Bi?e+Di:e,t]}function dn(e,t,n){return e?t||n?St(hn(e),vn(t,n)):hn(e):t||n?vn(t,n):fn}function pn(e){return function(t,n){return t+=e,[t>Bi?t-Di:t<-Bi?t+Di:t,n]}}function hn(e){var t=pn(e);return t.invert=pn(-e),t}function vn(e,t){function n(e,t){var n=Math.cos(t),l=Math.cos(e)*n,s=Math.sin(e)*n,u=Math.sin(t),c=u*r+l*o;return[Math.atan2(s*a-c*i,l*r-u*o),ne(c*a+s*i)]}var r=Math.cos(e),o=Math.sin(e),a=Math.cos(t),i=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),l=Math.cos(e)*n,s=Math.sin(e)*n,u=Math.sin(t),c=u*a-s*i;return[Math.atan2(s*a+u*i,l*r+c*o),ne(c*r-l*o)]},n}function gn(e,t){var n=Math.cos(e),r=Math.sin(e);return function(o,a,i,l){var s=i*t;null!=o?(o=mn(n,o),a=mn(n,a),(i>0?o<a:o>a)&&(o+=i*Di)):(o=e+i*Di,a=e-.5*s);for(var u,c=o;i>0?c>a:c<a;c-=s)l.point((u=_t([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function mn(e,t){var n=gt(t);n[0]-=e,wt(n);var r=te(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-qi)%(2*Math.PI)}function yn(e,t,n){var r=ui.range(e,t-qi,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function xn(e,t,n){var r=ui.range(e,t-qi,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function bn(e){return e.source}function wn(e){return e.target}function _n(e,t,n,r){var o=Math.cos(t),a=Math.sin(t),i=Math.cos(r),l=Math.sin(r),s=o*Math.cos(e),u=o*Math.sin(e),c=i*Math.cos(n),f=i*Math.sin(n),d=2*Math.asin(Math.sqrt(ie(r-t)+o*i*ie(n-e))),p=1/Math.sin(d),h=d?function(e){var t=Math.sin(e*=d)*p,n=Math.sin(d-e)*p,r=n*s+t*c,o=n*u+t*f,i=n*a+t*l;return[Math.atan2(o,r)*Vi,Math.atan2(i,Math.sqrt(r*r+o*o))*Vi]}:function(){return[e*Vi,t*Vi]};return h.distance=d,h}function kn(){function e(e,o){var a=Math.sin(o*=Li),i=Math.cos(o),l=xi((e*=Li)-t),s=Math.cos(l);Xl+=Math.atan2(Math.sqrt((l=i*Math.sin(l))*l+(l=r*a-n*i*s)*l),n*a+r*i*s),t=e,n=a,r=i}var t,n,r;Gl.point=function(o,a){t=o*Li,n=Math.sin(a*=Li),r=Math.cos(a),Gl.point=e},Gl.lineEnd=function(){Gl.point=Gl.lineEnd=_}}function zn(e,t){function n(t,n){var r=Math.cos(t),o=Math.cos(n),a=e(r*o);return[a*o*Math.sin(t),a*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),o=t(r),a=Math.sin(o),i=Math.cos(o);return[Math.atan2(e*a,r*i),Math.asin(r&&n*a/r)]},n}function Mn(e,t){function n(e,t){i>0?t<-Ii+qi&&(t=-Ii+qi):t>Ii-qi&&(t=Ii-qi);var n=i/Math.pow(o(t),a);return[n*Math.sin(a*e),i-n*Math.cos(a*e)]}var r=Math.cos(e),o=function(e){return Math.tan(Bi/4+e/2)},a=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(o(t)/o(e)),i=r*Math.pow(o(e),a)/a;return a?(n.invert=function(e,t){var n=i-t,r=$(a)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/a,2*Math.atan(Math.pow(i/r,1/a))-Ii]},n):jn}function An(e,t){function n(e,t){var n=a-t;return[n*Math.sin(o*e),a-n*Math.cos(o*e)]}var r=Math.cos(e),o=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),a=r/o+e;return xi(o)<qi?cn:(n.invert=function(e,t){var n=a-t;return[Math.atan2(e,n)/o,a-$(o)*Math.sqrt(e*e+n*n)]},n)}function jn(e,t){return[e,Math.log(Math.tan(Bi/4+t/2))]}function En(e){var t,n=ln(e),r=n.scale,o=n.translate,a=n.clipExtent;return n.scale=function(){var e=r.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.translate=function(){var e=o.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.clipExtent=function(e){var i=a.apply(n,arguments);if(i===n){if(t=null==e){var l=Bi*r(),s=o();a([[s[0]-l,s[1]-l],[s[0]+l,s[1]+l]])}}else t&&(i=null);return i},n.clipExtent(null)}function Sn(e,t){return[Math.log(Math.tan(Bi/4+t/2)),-e]}function On(e){return e[0]}function Nn(e){return e[1]}function Fn(e){for(var t=e.length,n=[0,1],r=2,o=2;o<t;o++){for(;r>1&&ee(e[n[r-2]],e[n[r-1]],e[o])<=0;)--r;n[r++]=o}return n.slice(0,r)}function Tn(e,t){return e[0]-t[0]||e[1]-t[1]}function Cn(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function qn(e,t,n,r){var o=e[0],a=n[0],i=t[0]-o,l=r[0]-a,s=e[1],u=n[1],c=t[1]-s,f=r[1]-u,d=(l*(s-u)-f*(o-a))/(f*i-l*c);return[o+d*i,s+d*c]}function Pn(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function Bn(){or(this),this.edge=this.site=this.circle=null}function Dn(e){var t=as.pop()||new Bn;return t.site=e,t}function Rn(e){Wn(e),ns.remove(e),as.push(e),or(e)}function In(e){var t=e.circle,n=t.x,r=t.cy,o={x:n,y:r},a=e.P,i=e.N,l=[e];Rn(e);for(var s=a;s.circle&&xi(n-s.circle.x)<qi&&xi(r-s.circle.cy)<qi;)a=s.P,l.unshift(s),Rn(s),s=a;l.unshift(s),Wn(s);for(var u=i;u.circle&&xi(n-u.circle.x)<qi&&xi(r-u.circle.cy)<qi;)i=u.N,l.push(u),Rn(u),u=i;l.push(u),Wn(u);var c,f=l.length;for(c=1;c<f;++c)u=l[c],s=l[c-1],tr(u.edge,s.site,u.site,o);s=l[0],u=l[f-1],u.edge=$n(s.site,u.site,null,o),Zn(s),Zn(u)}function Ln(e){for(var t,n,r,o,a=e.x,i=e.y,l=ns._;l;)if((r=Vn(l,i)-a)>qi)l=l.L;else{if(!((o=a-Un(l,i))>qi)){r>-qi?(t=l.P,n=l):o>-qi?(t=l,n=l.N):t=n=l;break}if(!l.R){t=l;break}l=l.R}var s=Dn(e);if(ns.insert(t,s),t||n){if(t===n)return Wn(t),n=Dn(t.site),ns.insert(s,n),s.edge=n.edge=$n(t.site,s.site),Zn(t),void Zn(n);if(!n)return void(s.edge=$n(t.site,s.site));Wn(t),Wn(n);var u=t.site,c=u.x,f=u.y,d=e.x-c,p=e.y-f,h=n.site,v=h.x-c,g=h.y-f,m=2*(d*g-p*v),y=d*d+p*p,x=v*v+g*g,b={x:(g*y-p*x)/m+c,y:(d*x-v*y)/m+f};tr(n.edge,u,h,b),s.edge=$n(u,e,null,b),n.edge=$n(e,h,null,b),Zn(t),Zn(n)}}function Vn(e,t){var n=e.site,r=n.x,o=n.y,a=o-t;if(!a)return r;var i=e.P;if(!i)return-1/0;n=i.site;var l=n.x,s=n.y,u=s-t;if(!u)return l;var c=l-r,f=1/a-1/u,d=c/u;return f?(-d+Math.sqrt(d*d-2*f*(c*c/(-2*u)-s+u/2+o-a/2)))/f+r:(r+l)/2}function Un(e,t){var n=e.N;if(n)return Vn(n,t);var r=e.site;return r.y===t?r.x:1/0}function Yn(e){this.site=e,this.edges=[]}function Hn(e){for(var t,n,r,o,a,i,l,s,u,c,f=e[0][0],d=e[1][0],p=e[0][1],h=e[1][1],v=ts,g=v.length;g--;)if((a=v[g])&&a.prepare())for(l=a.edges,s=l.length,i=0;i<s;)c=l[i].end(),r=c.x,o=c.y,u=l[++i%s].start(),t=u.x,n=u.y,(xi(r-t)>qi||xi(o-n)>qi)&&(l.splice(i,0,new nr(er(a.site,c,xi(r-f)<qi&&h-o>qi?{x:f,y:xi(t-f)<qi?n:h}:xi(o-h)<qi&&d-r>qi?{x:xi(n-h)<qi?t:d,y:h}:xi(r-d)<qi&&o-p>qi?{x:d,y:xi(t-d)<qi?n:p}:xi(o-p)<qi&&r-f>qi?{x:xi(n-p)<qi?t:f,y:p}:null),a.site,null)),++s)}function Xn(e,t){return t.angle-e.angle}function Gn(){or(this),this.x=this.y=this.arc=this.site=this.cy=null}function Zn(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,o=e.site,a=n.site;if(r!==a){var i=o.x,l=o.y,s=r.x-i,u=r.y-l,c=a.x-i,f=a.y-l,d=2*(s*f-u*c);if(!(d>=-Pi)){var p=s*s+u*u,h=c*c+f*f,v=(f*p-u*h)/d,g=(s*h-c*p)/d,f=g+l,m=is.pop()||new Gn;m.arc=e,m.site=o,m.x=v+i,m.y=f+Math.sqrt(v*v+g*g),m.cy=f,e.circle=m;for(var y=null,x=os._;x;)if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(!x.L){y=x.P;break}x=x.L}else{if(!x.R){y=x;break}x=x.R}os.insert(y,m),y||(rs=m)}}}}function Wn(e){var t=e.circle;t&&(t.P||(rs=t.N),os.remove(t),is.push(t),or(t),e.circle=null)}function Jn(e){for(var t,n=es,r=Ut(e[0][0],e[0][1],e[1][0],e[1][1]),o=n.length;o--;)t=n[o],(!Qn(t,e)||!r(t)||xi(t.a.x-t.b.x)<qi&&xi(t.a.y-t.b.y)<qi)&&(t.a=t.b=null,n.splice(o,1))}function Qn(e,t){var n=e.b;if(n)return!0;var r,o,a=e.a,i=t[0][0],l=t[1][0],s=t[0][1],u=t[1][1],c=e.l,f=e.r,d=c.x,p=c.y,h=f.x,v=f.y,g=(d+h)/2,m=(p+v)/2;if(v===p){if(g<i||g>=l)return;if(d>h){if(a){if(a.y>=u)return}else a={x:g,y:s};n={x:g,y:u}}else{if(a){if(a.y<s)return}else a={x:g,y:u};n={x:g,y:s}}}else if(r=(d-h)/(v-p),o=m-r*g,r<-1||r>1)if(d>h){if(a){if(a.y>=u)return}else a={x:(s-o)/r,y:s};n={x:(u-o)/r,y:u}}else{if(a){if(a.y<s)return}else a={x:(u-o)/r,y:u};n={x:(s-o)/r,y:s}}else if(p<v){if(a){if(a.x>=l)return}else a={x:i,y:r*i+o};n={x:l,y:r*l+o}}else{if(a){if(a.x<i)return}else a={x:l,y:r*l+o};n={x:i,y:r*i+o}}return e.a=a,e.b=n,!0}function Kn(e,t){this.l=e,this.r=t,this.a=this.b=null}function $n(e,t,n,r){var o=new Kn(e,t);return es.push(o),n&&tr(o,e,t,n),r&&tr(o,t,e,r),ts[e.i].edges.push(new nr(o,e,t)),ts[t.i].edges.push(new nr(o,t,e)),o}function er(e,t,n){var r=new Kn(e,null);return r.a=t,r.b=n,es.push(r),r}function tr(e,t,n,r){e.a||e.b?e.l===n?e.b=r:e.a=r:(e.a=r,e.l=t,e.r=n)}
function nr(e,t,n){var r=e.a,o=e.b;this.edge=e,this.site=t,this.angle=n?Math.atan2(n.y-t.y,n.x-t.x):e.l===t?Math.atan2(o.x-r.x,r.y-o.y):Math.atan2(r.x-o.x,o.y-r.y)}function rr(){this._=null}function or(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function ar(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function ir(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function lr(e){for(;e.L;)e=e.L;return e}function sr(e,t){var n,r,o,a=e.sort(ur).pop();for(es=[],ts=new Array(e.length),ns=new rr,os=new rr;;)if(o=rs,a&&(!o||a.y<o.y||a.y===o.y&&a.x<o.x))a.x===n&&a.y===r||(ts[a.i]=new Yn(a),Ln(a),n=a.x,r=a.y),a=e.pop();else{if(!o)break;In(o.arc)}t&&(Jn(t),Hn(t));var i={cells:ts,edges:es};return ns=os=es=ts=null,i}function ur(e,t){return t.y-e.y||t.x-e.x}function cr(e,t,n){return(e.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-e.y)}function fr(e){return e.x}function dr(e){return e.y}function pr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function hr(e,t,n,r,o,a){if(!e(t,n,r,o,a)){var i=.5*(n+o),l=.5*(r+a),s=t.nodes;s[0]&&hr(e,s[0],n,r,i,l),s[1]&&hr(e,s[1],i,r,o,l),s[2]&&hr(e,s[2],n,l,i,a),s[3]&&hr(e,s[3],i,l,o,a)}}function vr(e,t,n,r,o,a,i){var l,s=1/0;return function e(u,c,f,d,p){if(!(c>a||f>i||d<r||p<o)){if(h=u.point){var h,v=t-u.x,g=n-u.y,m=v*v+g*g;if(m<s){var y=Math.sqrt(s=m);r=t-y,o=n-y,a=t+y,i=n+y,l=h}}for(var x=u.nodes,b=.5*(c+d),w=.5*(f+p),_=t>=b,k=n>=w,z=k<<1|_,M=z+4;z<M;++z)if(u=x[3&z])switch(3&z){case 0:e(u,c,f,b,w);break;case 1:e(u,b,f,d,w);break;case 2:e(u,c,w,b,p);break;case 3:e(u,b,w,d,p)}}}(e,r,o,a,i),l}function gr(e,t){e=ui.rgb(e),t=ui.rgb(t);var n=e.r,r=e.g,o=e.b,a=t.r-n,i=t.g-r,l=t.b-o;return function(e){return"#"+we(Math.round(n+a*e))+we(Math.round(r+i*e))+we(Math.round(o+l*e))}}function mr(e,t){var n,r={},o={};for(n in e)n in t?r[n]=br(e[n],t[n]):o[n]=e[n];for(n in t)n in e||(o[n]=t[n]);return function(e){for(n in r)o[n]=r[n](e);return o}}function yr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function xr(e,t){var n,r,o,a=ss.lastIndex=us.lastIndex=0,i=-1,l=[],s=[];for(e+="",t+="";(n=ss.exec(e))&&(r=us.exec(t));)(o=r.index)>a&&(o=t.slice(a,o),l[i]?l[i]+=o:l[++i]=o),(n=n[0])===(r=r[0])?l[i]?l[i]+=r:l[++i]=r:(l[++i]=null,s.push({i:i,x:yr(n,r)})),a=us.lastIndex;return a<t.length&&(o=t.slice(a),l[i]?l[i]+=o:l[++i]=o),l.length<2?s[0]?(t=s[0].x,function(e){return t(e)+""}):function(){return t}:(t=s.length,function(e){for(var n,r=0;r<t;++r)l[(n=s[r]).i]=n.x(e);return l.join("")})}function br(e,t){for(var n,r=ui.interpolators.length;--r>=0&&!(n=ui.interpolators[r](e,t)););return n}function wr(e,t){var n,r=[],o=[],a=e.length,i=t.length,l=Math.min(e.length,t.length);for(n=0;n<l;++n)r.push(br(e[n],t[n]));for(;n<a;++n)o[n]=e[n];for(;n<i;++n)o[n]=t[n];return function(e){for(n=0;n<l;++n)o[n]=r[n](e);return o}}function _r(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function kr(e){return function(t){return 1-e(1-t)}}function zr(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Mr(e){return e*e}function Ar(e){return e*e*e}function jr(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function Er(e){return function(t){return Math.pow(t,e)}}function Sr(e){return 1-Math.cos(e*Ii)}function Or(e){return Math.pow(2,10*(e-1))}function Nr(e){return 1-Math.sqrt(1-e*e)}function Fr(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/Di*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,-10*r)*Math.sin((r-n)*Di/t)}}function Tr(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function Cr(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function qr(e,t){e=ui.hcl(e),t=ui.hcl(t);var n=e.h,r=e.c,o=e.l,a=t.h-n,i=t.c-r,l=t.l-o;return isNaN(i)&&(i=0,r=isNaN(r)?t.c:r),isNaN(a)?(a=0,n=isNaN(n)?t.h:n):a>180?a-=360:a<-180&&(a+=360),function(e){return fe(n+a*e,r+i*e,o+l*e)+""}}function Pr(e,t){e=ui.hsl(e),t=ui.hsl(t);var n=e.h,r=e.s,o=e.l,a=t.h-n,i=t.s-r,l=t.l-o;return isNaN(i)&&(i=0,r=isNaN(r)?t.s:r),isNaN(a)?(a=0,n=isNaN(n)?t.h:n):a>180?a-=360:a<-180&&(a+=360),function(e){return ue(n+a*e,r+i*e,o+l*e)+""}}function Br(e,t){e=ui.lab(e),t=ui.lab(t);var n=e.l,r=e.a,o=e.b,a=t.l-n,i=t.a-r,l=t.b-o;return function(e){return pe(n+a*e,r+i*e,o+l*e)+""}}function Dr(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function Rr(e){var t=[e.a,e.b],n=[e.c,e.d],r=Lr(t),o=Ir(t,n),a=Lr(Vr(n,t,-o))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,o*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*Vi,this.translate=[e.e,e.f],this.scale=[r,a],this.skew=a?Math.atan2(o,a)*Vi:0}function Ir(e,t){return e[0]*t[0]+e[1]*t[1]}function Lr(e){var t=Math.sqrt(Ir(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Vr(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Ur(e){return e.length?e.pop()+",":""}function Yr(e,t,n,r){if(e[0]!==t[0]||e[1]!==t[1]){var o=n.push("translate(",null,",",null,")");r.push({i:o-4,x:yr(e[0],t[0])},{i:o-2,x:yr(e[1],t[1])})}else(t[0]||t[1])&&n.push("translate("+t+")")}function Hr(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(Ur(n)+"rotate(",null,")")-2,x:yr(e,t)})):t&&n.push(Ur(n)+"rotate("+t+")")}function Xr(e,t,n,r){e!==t?r.push({i:n.push(Ur(n)+"skewX(",null,")")-2,x:yr(e,t)}):t&&n.push(Ur(n)+"skewX("+t+")")}function Gr(e,t,n,r){if(e[0]!==t[0]||e[1]!==t[1]){var o=n.push(Ur(n)+"scale(",null,",",null,")");r.push({i:o-4,x:yr(e[0],t[0])},{i:o-2,x:yr(e[1],t[1])})}else 1===t[0]&&1===t[1]||n.push(Ur(n)+"scale("+t+")")}function Zr(e,t){var n=[],r=[];return e=ui.transform(e),t=ui.transform(t),Yr(e.translate,t.translate,n,r),Hr(e.rotate,t.rotate,n,r),Xr(e.skew,t.skew,n,r),Gr(e.scale,t.scale,n,r),e=t=null,function(e){for(var t,o=-1,a=r.length;++o<a;)n[(t=r[o]).i]=t.x(e);return n.join("")}}function Wr(e,t){return t=(t-=e=+e)||1/t,function(n){return(n-e)/t}}function Jr(e,t){return t=(t-=e=+e)||1/t,function(n){return Math.max(0,Math.min(1,(n-e)/t))}}function Qr(e){for(var t=e.source,n=e.target,r=$r(t,n),o=[t];t!==r;)t=t.parent,o.push(t);for(var a=o.length;n!==r;)o.splice(a,0,n),n=n.parent;return o}function Kr(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function $r(e,t){if(e===t)return e;for(var n=Kr(e),r=Kr(t),o=n.pop(),a=r.pop(),i=null;o===a;)i=o,o=n.pop(),a=r.pop();return i}function eo(e){e.fixed|=2}function to(e){e.fixed&=-7}function no(e){e.fixed|=4,e.px=e.x,e.py=e.y}function ro(e){e.fixed&=-5}function oo(e,t,n){var r=0,o=0;if(e.charge=0,!e.leaf)for(var a,i=e.nodes,l=i.length,s=-1;++s<l;)null!=(a=i[s])&&(oo(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,o+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var u=t*n[e.point.index];e.charge+=e.pointCharge=u,r+=u*e.point.x,o+=u*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}function ao(e,t){return ui.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=fo,e}function io(e,t){for(var n=[e];null!=(e=n.pop());)if(t(e),(o=e.children)&&(r=o.length))for(var r,o;--r>=0;)n.push(o[r])}function lo(e,t){for(var n=[e],r=[];null!=(e=n.pop());)if(r.push(e),(a=e.children)&&(o=a.length))for(var o,a,i=-1;++i<o;)n.push(a[i]);for(;null!=(e=r.pop());)t(e)}function so(e){return e.children}function uo(e){return e.value}function co(e,t){return t.value-e.value}function fo(e){return ui.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function po(e){return e.x}function ho(e){return e.y}function vo(e,t,n){e.y0=t,e.y=n}function go(e){return ui.range(e.length)}function mo(e){for(var t=-1,n=e[0].length,r=[];++t<n;)r[t]=0;return r}function yo(e){for(var t,n=1,r=0,o=e[0][1],a=e.length;n<a;++n)(t=e[n][1])>o&&(r=n,o=t);return r}function xo(e){return e.reduce(bo,0)}function bo(e,t){return e+t[1]}function wo(e,t){return _o(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function _o(e,t){for(var n=-1,r=+e[0],o=(e[1]-r)/t,a=[];++n<=t;)a[n]=o*n+r;return a}function ko(e){return[ui.min(e),ui.max(e)]}function zo(e,t){return e.value-t.value}function Mo(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function Ao(e,t){e._pack_next=t,t._pack_prev=e}function jo(e,t){var n=t.x-e.x,r=t.y-e.y,o=e.r+t.r;return.999*o*o>n*n+r*r}function Eo(e){function t(e){c=Math.min(e.x-e.r,c),f=Math.max(e.x+e.r,f),d=Math.min(e.y-e.r,d),p=Math.max(e.y+e.r,p)}if((n=e.children)&&(u=n.length)){var n,r,o,a,i,l,s,u,c=1/0,f=-1/0,d=1/0,p=-1/0;if(n.forEach(So),r=n[0],r.x=-r.r,r.y=0,t(r),u>1&&(o=n[1],o.x=o.r,o.y=0,t(o),u>2))for(a=n[2],Fo(r,o,a),t(a),Mo(r,a),r._pack_prev=a,Mo(a,o),o=r._pack_next,i=3;i<u;i++){Fo(r,o,a=n[i]);var h=0,v=1,g=1;for(l=o._pack_next;l!==o;l=l._pack_next,v++)if(jo(l,a)){h=1;break}if(1==h)for(s=r._pack_prev;s!==l._pack_prev&&!jo(s,a);s=s._pack_prev,g++);h?(v<g||v==g&&o.r<r.r?Ao(r,o=l):Ao(r=s,o),i--):(Mo(r,a),o=a,t(a))}var m=(c+f)/2,y=(d+p)/2,x=0;for(i=0;i<u;i++)a=n[i],a.x-=m,a.y-=y,x=Math.max(x,a.r+Math.sqrt(a.x*a.x+a.y*a.y));e.r=x,n.forEach(Oo)}}function So(e){e._pack_next=e._pack_prev=e}function Oo(e){delete e._pack_next,delete e._pack_prev}function No(e,t,n,r){var o=e.children;if(e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r,o)for(var a=-1,i=o.length;++a<i;)No(o[a],t,n,r)}function Fo(e,t,n){var r=e.r+n.r,o=t.x-e.x,a=t.y-e.y;if(r&&(o||a)){var i=t.r+n.r,l=o*o+a*a;i*=i,r*=r;var s=.5+(r-i)/(2*l),u=Math.sqrt(Math.max(0,2*i*(r+l)-(r-=l)*r-i*i))/(2*l);n.x=e.x+s*o+u*a,n.y=e.y+s*a-u*o}else n.x=e.x+r,n.y=e.y}function To(e,t){return e.parent==t.parent?1:2}function Co(e){var t=e.children;return t.length?t[0]:e.t}function qo(e){var t,n=e.children;return(t=n.length)?n[t-1]:e.t}function Po(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Bo(e){for(var t,n=0,r=0,o=e.children,a=o.length;--a>=0;)t=o[a],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}function Do(e,t,n){return e.a.parent===t.parent?e.a:n}function Ro(e){return 1+ui.max(e,function(e){return e.y})}function Io(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Lo(e){var t=e.children;return t&&t.length?Lo(t[0]):e}function Vo(e){var t,n=e.children;return n&&(t=n.length)?Vo(n[t-1]):e}function Uo(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Yo(e,t){var n=e.x+t[3],r=e.y+t[0],o=e.dx-t[1]-t[3],a=e.dy-t[0]-t[2];return o<0&&(n+=o/2,o=0),a<0&&(r+=a/2,a=0),{x:n,y:r,dx:o,dy:a}}function Ho(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Xo(e){return e.rangeExtent?e.rangeExtent():Ho(e.range())}function Go(e,t,n,r){var o=n(e[0],e[1]),a=r(t[0],t[1]);return function(e){return a(o(e))}}function Zo(e,t){var n,r=0,o=e.length-1,a=e[r],i=e[o];return i<a&&(n=r,r=o,o=n,n=a,a=i,i=n),e[r]=t.floor(a),e[o]=t.ceil(i),e}function Wo(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:bs}function Jo(e,t,n,r){var o=[],a=[],i=0,l=Math.min(e.length,t.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<=l;)o.push(n(e[i-1],e[i])),a.push(r(t[i-1],t[i]));return function(t){var n=ui.bisect(e,t,1,l)-1;return a[n](o[n](t))}}function Qo(e,t,n,r){function o(){var o=Math.min(e.length,t.length)>2?Jo:Go,s=r?Jr:Wr;return i=o(e,t,s,n),l=o(t,e,s,br),a}function a(e){return i(e)}var i,l;return a.invert=function(e){return l(e)},a.domain=function(t){return arguments.length?(e=t.map(Number),o()):e},a.range=function(e){return arguments.length?(t=e,o()):t},a.rangeRound=function(e){return a.range(e).interpolate(Dr)},a.clamp=function(e){return arguments.length?(r=e,o()):r},a.interpolate=function(e){return arguments.length?(n=e,o()):n},a.ticks=function(t){return ta(e,t)},a.tickFormat=function(t,n){return na(e,t,n)},a.nice=function(t){return $o(e,t),o()},a.copy=function(){return Qo(e,t,n,r)},o()}function Ko(e,t){return ui.rebind(e,t,"range","rangeRound","interpolate","clamp")}function $o(e,t){return Zo(e,Wo(ea(e,t)[2])),Zo(e,Wo(ea(e,t)[2])),e}function ea(e,t){null==t&&(t=10);var n=Ho(e),r=n[1]-n[0],o=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),a=t/r*o;return a<=.15?o*=10:a<=.35?o*=5:a<=.75&&(o*=2),n[0]=Math.ceil(n[0]/o)*o,n[1]=Math.floor(n[1]/o)*o+.5*o,n[2]=o,n}function ta(e,t){return ui.range.apply(ui,ea(e,t))}function na(e,t,n){var r=ea(e,t);if(n){var o=sl.exec(n);if(o.shift(),"s"===o[8]){var a=ui.formatPrefix(Math.max(xi(r[0]),xi(r[1])));return o[7]||(o[7]="."+ra(a.scale(r[2]))),o[8]="f",n=ui.format(o.join("")),function(e){return n(a.scale(e))+a.symbol}}o[7]||(o[7]="."+oa(o[8],r)),n=o.join("")}else n=",."+ra(r[2])+"f";return ui.format(n)}function ra(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function oa(e,t){var n=ra(t[2]);return e in ws?Math.abs(n-ra(Math.max(xi(t[0]),xi(t[1]))))+ +("e"!==e):n-2*("%"===e)}function aa(e,t,n,r){function o(e){return(n?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function a(e){return n?Math.pow(t,e):-Math.pow(t,-e)}function i(t){return e(o(t))}return i.invert=function(t){return a(e.invert(t))},i.domain=function(t){return arguments.length?(n=t[0]>=0,e.domain((r=t.map(Number)).map(o)),i):r},i.base=function(n){return arguments.length?(t=+n,e.domain(r.map(o)),i):t},i.nice=function(){var t=Zo(r.map(o),n?Math:ks);return e.domain(t),r=t.map(a),i},i.ticks=function(){var e=Ho(r),i=[],l=e[0],s=e[1],u=Math.floor(o(l)),c=Math.ceil(o(s)),f=t%1?2:t;if(isFinite(c-u)){if(n){for(;u<c;u++)for(var d=1;d<f;d++)i.push(a(u)*d);i.push(a(u))}else for(i.push(a(u));u++<c;)for(var d=f-1;d>0;d--)i.push(a(u)*d);for(u=0;i[u]<l;u++);for(c=i.length;i[c-1]>s;c--);i=i.slice(u,c)}return i},i.tickFormat=function(e,n){if(!arguments.length)return _s;arguments.length<2?n=_s:"function"!=typeof n&&(n=ui.format(n));var r=Math.max(1,t*e/i.ticks().length);return function(e){var i=e/a(Math.round(o(e)));return i*t<t-.5&&(i*=t),i<=r?n(e):""}},i.copy=function(){return aa(e.copy(),t,n,r)},Ko(i,e)}function ia(e,t,n){function r(t){return e(o(t))}var o=la(t),a=la(1/t);return r.invert=function(t){return a(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(o)),r):n},r.ticks=function(e){return ta(n,e)},r.tickFormat=function(e,t){return na(n,e,t)},r.nice=function(e){return r.domain($o(n,e))},r.exponent=function(i){return arguments.length?(o=la(t=i),a=la(1/t),e.domain(n.map(o)),r):t},r.copy=function(){return ia(e.copy(),t,n)},Ko(r,e)}function la(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function sa(e,t){function n(n){return a[((o.get(n)||("range"===t.t?o.set(n,e.push(n)):NaN))-1)%a.length]}function r(t,n){return ui.range(e.length).map(function(e){return t+n*e})}var o,a,i;return n.domain=function(r){if(!arguments.length)return e;e=[],o=new c;for(var a,i=-1,l=r.length;++i<l;)o.has(a=r[i])||o.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(a=e,i=0,t={t:"range",a:arguments},n):a},n.rangePoints=function(o,l){arguments.length<2&&(l=0);var s=o[0],u=o[1],c=e.length<2?(s=(s+u)/2,0):(u-s)/(e.length-1+l);return a=r(s+c*l/2,c),i=0,t={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(o,l){arguments.length<2&&(l=0);var s=o[0],u=o[1],c=e.length<2?(s=u=Math.round((s+u)/2),0):(u-s)/(e.length-1+l)|0;return a=r(s+Math.round(c*l/2+(u-s-(e.length-1+l)*c)/2),c),i=0,t={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(o,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=o[1]<o[0],c=o[u-0],f=o[1-u],d=(f-c)/(e.length-l+2*s);return a=r(c+d*s,d),u&&a.reverse(),i=d*(1-l),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(o,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=o[1]<o[0],c=o[u-0],f=o[1-u],d=Math.floor((f-c)/(e.length-l+2*s));return a=r(c+Math.round((f-c-(e.length-l)*d)/2),d),u&&a.reverse(),i=Math.round(d*(1-l)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return i},n.rangeExtent=function(){return Ho(t.a[0])},n.copy=function(){return sa(e,t)},n.domain(e)}function ua(e,t){function n(){var n=0,r=t.length;for(l=[];++n<r;)l[n-1]=ui.quantile(e,n/r);return i}function i(e){if(!isNaN(e=+e))return t[ui.bisect(l,e)]}var l;return i.domain=function(t){return arguments.length?(e=t.map(o).filter(a).sort(r),n()):e},i.range=function(e){return arguments.length?(t=e,n()):t},i.quantiles=function(){return l},i.invertExtent=function(n){return n=t.indexOf(n),n<0?[NaN,NaN]:[n>0?l[n-1]:e[0],n<l.length?l[n]:e[e.length-1]]},i.copy=function(){return ua(e,t)},n()}function ca(e,t,n){function r(t){return n[Math.max(0,Math.min(i,Math.floor(a*(t-e))))]}function o(){return a=n.length/(t-e),i=n.length-1,r}var a,i;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],o()):[e,t]},r.range=function(e){return arguments.length?(n=e,o()):n},r.invertExtent=function(t){return t=n.indexOf(t),t=t<0?NaN:t/a+e,[t,t+1/a]},r.copy=function(){return ca(e,t,n)},o()}function fa(e,t){function n(n){if(n<=n)return t[ui.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return fa(e,t)},n}function da(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return ta(e,t)},t.tickFormat=function(t,n){return na(e,t,n)},t.copy=function(){return da(e)},t}function pa(){return 0}function ha(e){return e.innerRadius}function va(e){return e.outerRadius}function ga(e){return e.startAngle}function ma(e){return e.endAngle}function ya(e){return e&&e.padAngle}function xa(e,t,n,r){return(e-n)*t-(t-r)*e>0?0:1}function ba(e,t,n,r,o){var a=e[0]-t[0],i=e[1]-t[1],l=(o?r:-r)/Math.sqrt(a*a+i*i),s=l*i,u=-l*a,c=e[0]+s,f=e[1]+u,d=t[0]+s,p=t[1]+u,h=(c+d)/2,v=(f+p)/2,g=d-c,m=p-f,y=g*g+m*m,x=n-r,b=c*p-d*f,w=(m<0?-1:1)*Math.sqrt(Math.max(0,x*x*y-b*b)),_=(b*m-g*w)/y,k=(-b*g-m*w)/y,z=(b*m+g*w)/y,M=(-b*g+m*w)/y,A=_-h,j=k-v,E=z-h,S=M-v;return A*A+j*j>E*E+S*S&&(_=z,k=M),[[_-s,k-u],[_*n/x,k*n/x]]}function wa(e){function t(t){function i(){u.push("M",a(e(c),l))}for(var s,u=[],c=[],f=-1,d=t.length,p=je(n),h=je(r);++f<d;)o.call(this,s=t[f],f)?c.push([+p.call(this,s,f),+h.call(this,s,f)]):c.length&&(i(),c=[]);return c.length&&i(),u.length?u.join(""):null}var n=On,r=Nn,o=Ot,a=_a,i=a.key,l=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(i="function"==typeof e?a=e:(a=Ss.get(e)||_a).key,t):i},t.tension=function(e){return arguments.length?(l=e,t):l},t}function _a(e){return e.length>1?e.join("L"):e+"Z"}function ka(e){return e.join("L")+"Z"}function za(e){for(var t=0,n=e.length,r=e[0],o=[r[0],",",r[1]];++t<n;)o.push("H",(r[0]+(r=e[t])[0])/2,"V",r[1]);return n>1&&o.push("H",r[0]),o.join("")}function Ma(e){for(var t=0,n=e.length,r=e[0],o=[r[0],",",r[1]];++t<n;)o.push("V",(r=e[t])[1],"H",r[0]);return o.join("")}function Aa(e){for(var t=0,n=e.length,r=e[0],o=[r[0],",",r[1]];++t<n;)o.push("H",(r=e[t])[0],"V",r[1]);return o.join("")}function ja(e,t){return e.length<4?_a(e):e[1]+Oa(e.slice(1,-1),Na(e,t))}function Ea(e,t){return e.length<3?ka(e):e[0]+Oa((e.push(e[0]),e),Na([e[e.length-2]].concat(e,[e[1]]),t))}function Sa(e,t){return e.length<3?_a(e):e[0]+Oa(e,Na(e,t))}function Oa(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return _a(e);var n=e.length!=t.length,r="",o=e[0],a=e[1],i=t[0],l=i,s=1;if(n&&(r+="Q"+(a[0]-2*i[0]/3)+","+(a[1]-2*i[1]/3)+","+a[0]+","+a[1],o=e[1],s=2),t.length>1){l=t[1],a=e[s],s++,r+="C"+(o[0]+i[0])+","+(o[1]+i[1])+","+(a[0]-l[0])+","+(a[1]-l[1])+","+a[0]+","+a[1];for(var u=2;u<t.length;u++,s++)a=e[s],l=t[u],r+="S"+(a[0]-l[0])+","+(a[1]-l[1])+","+a[0]+","+a[1]}if(n){var c=e[s];r+="Q"+(a[0]+2*l[0]/3)+","+(a[1]+2*l[1]/3)+","+c[0]+","+c[1]}return r}function Na(e,t){for(var n,r=[],o=(1-t)/2,a=e[0],i=e[1],l=1,s=e.length;++l<s;)n=a,a=i,i=e[l],r.push([o*(i[0]-n[0]),o*(i[1]-n[1])]);return r}function Fa(e){if(e.length<3)return _a(e);var t=1,n=e.length,r=e[0],o=r[0],a=r[1],i=[o,o,o,(r=e[1])[0]],l=[a,a,a,r[1]],s=[o,",",a,"L",Pa(Fs,i),",",Pa(Fs,l)];for(e.push(e[n-1]);++t<=n;)r=e[t],i.shift(),i.push(r[0]),l.shift(),l.push(r[1]),Ba(s,i,l);return e.pop(),s.push("L",r),s.join("")}function Ta(e){if(e.length<4)return _a(e);for(var t,n=[],r=-1,o=e.length,a=[0],i=[0];++r<3;)t=e[r],a.push(t[0]),i.push(t[1]);for(n.push(Pa(Fs,a)+","+Pa(Fs,i)),--r;++r<o;)t=e[r],a.shift(),a.push(t[0]),i.shift(),i.push(t[1]),Ba(n,a,i);return n.join("")}function Ca(e){for(var t,n,r=-1,o=e.length,a=o+4,i=[],l=[];++r<4;)n=e[r%o],i.push(n[0]),l.push(n[1]);for(t=[Pa(Fs,i),",",Pa(Fs,l)],--r;++r<a;)n=e[r%o],i.shift(),i.push(n[0]),l.shift(),l.push(n[1]),Ba(t,i,l);return t.join("")}function qa(e,t){var n=e.length-1;if(n)for(var r,o,a=e[0][0],i=e[0][1],l=e[n][0]-a,s=e[n][1]-i,u=-1;++u<=n;)r=e[u],o=u/n,r[0]=t*r[0]+(1-t)*(a+o*l),r[1]=t*r[1]+(1-t)*(i+o*s);return Fa(e)}function Pa(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ba(e,t,n){e.push("C",Pa(Os,t),",",Pa(Os,n),",",Pa(Ns,t),",",Pa(Ns,n),",",Pa(Fs,t),",",Pa(Fs,n))}function Da(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Ra(e){for(var t=0,n=e.length-1,r=[],o=e[0],a=e[1],i=r[0]=Da(o,a);++t<n;)r[t]=(i+(i=Da(o=a,a=e[t+1])))/2;return r[t]=i,r}function Ia(e){for(var t,n,r,o,a=[],i=Ra(e),l=-1,s=e.length-1;++l<s;)t=Da(e[l],e[l+1]),xi(t)<qi?i[l]=i[l+1]=0:(n=i[l]/t,r=i[l+1]/t,(o=n*n+r*r)>9&&(o=3*t/Math.sqrt(o),i[l]=o*n,i[l+1]=o*r));for(l=-1;++l<=s;)o=(e[Math.min(s,l+1)][0]-e[Math.max(0,l-1)][0])/(6*(1+i[l]*i[l])),a.push([o||0,i[l]*o||0]);return a}function La(e){return e.length<3?_a(e):e[0]+Oa(e,Ia(e))}function Va(e){for(var t,n,r,o=-1,a=e.length;++o<a;)t=e[o],n=t[0],r=t[1]-Ii,t[0]=n*Math.cos(r),t[1]=n*Math.sin(r);return e}function Ua(e){function t(t){function s(){v.push("M",l(e(m),f),c,u(e(g.reverse()),f),"Z")}for(var d,p,h,v=[],g=[],m=[],y=-1,x=t.length,b=je(n),w=je(o),_=n===r?function(){return p}:je(r),k=o===a?function(){return h}:je(a);++y<x;)i.call(this,d=t[y],y)?(g.push([p=+b.call(this,d,y),h=+w.call(this,d,y)]),m.push([+_.call(this,d,y),+k.call(this,d,y)])):g.length&&(s(),g=[],m=[]);return g.length&&s(),v.length?v.join(""):null}var n=On,r=On,o=0,a=Nn,i=Ot,l=_a,s=l.key,u=l,c="L",f=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(o=a=e,t):a},t.y0=function(e){return arguments.length?(o=e,t):o},t.y1=function(e){return arguments.length?(a=e,t):a},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(s="function"==typeof e?l=e:(l=Ss.get(e)||_a).key,u=l.reverse||l,c=l.closed?"M":"L",t):s},t.tension=function(e){return arguments.length?(f=e,t):f},t}function Ya(e){return e.radius}function Ha(e){return[e.x,e.y]}function Xa(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]-Ii;return[n*Math.cos(r),n*Math.sin(r)]}}function Ga(){return 64}function Za(){return"circle"}function Wa(e){var t=Math.sqrt(e/Bi);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Ja(e){return function(){var t,n,r;(t=this[e])&&(r=t[n=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[n]:delete this[e],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Qa(e,t,n){return zi(e,Rs),e.namespace=t,e.id=n,e}function Ka(e,t,n,r){var o=e.id,a=e.namespace;return Y(e,"function"==typeof n?function(e,i,l){e[a][o].tween.set(t,r(n.call(e,e.__data__,i,l)))}:(n=r(n),function(e){e[a][o].tween.set(t,n)}))}function $a(e){return null==e&&(e=""),function(){this.textContent=e}}function ei(e){return null==e?"__transition__":"__transition_"+e+"__"}function ti(e,t,n,r,o){function a(e){var t=v.delay;if(u.t=t+s,t<=e)return i(e-t);u.c=i}function i(n){var o=h.active,a=h[o];a&&(a.timer.c=null,a.timer.t=NaN,--h.count,delete h[o],a.event&&a.event.interrupt.call(e,e.__data__,a.index));for(var i in h)if(+i<r){var c=h[i];c.timer.c=null,c.timer.t=NaN,--h.count,delete h[i]}u.c=l,Fe(function(){return u.c&&l(n||1)&&(u.c=null,u.t=NaN),1},0,s),h.active=r,v.event&&v.event.start.call(e,e.__data__,t),p=[],v.tween.forEach(function(n,r){(r=r.call(e,e.__data__,t))&&p.push(r)}),d=v.ease,f=v.duration}function l(o){for(var a=o/f,i=d(a),l=p.length;l>0;)p[--l].call(e,i);if(a>=1)return v.event&&v.event.end.call(e,e.__data__,t),--h.count?delete h[r]:delete e[n],1}var s,u,f,d,p,h=e[n]||(e[n]={active:0,count:0}),v=h[r];v||(s=o.time,u=Fe(a,0,s),v=h[r]={tween:new c,time:s,timer:u,delay:o.delay,duration:o.duration,ease:o.ease,index:t},o=null,++h.count)}function ni(e,t,n){e.attr("transform",function(e){var r=t(e);return"translate("+(isFinite(r)?r:n(e))+",0)"})}function ri(e,t,n){e.attr("transform",function(e){var r=t(e);return"translate(0,"+(isFinite(r)?r:n(e))+")"})}function oi(e){return e.toISOString()}function ai(e,t,n){function r(t){return e(t)}function o(e,n){var r=e[1]-e[0],o=r/n,a=ui.bisect(Zs,o);return a==Zs.length?[t.year,ea(e.map(function(e){return e/31536e6}),n)[2]]:a?t[o/Zs[a-1]<Zs[a]/o?a-1:a]:[Qs,ea(e,n)[2]]}return r.invert=function(t){return ii(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(ii)},r.nice=function(e,t){function n(n){return!isNaN(n)&&!e.range(n,ii(+n+1),t).length}var a=r.domain(),i=Ho(a),l=null==e?o(i,10):"number"==typeof e&&o(i,e);return l&&(e=l[0],t=l[1]),r.domain(Zo(a,t>1?{floor:function(t){for(;n(t=e.floor(t));)t=ii(t-1);return t},ceil:function(t){for(;n(t=e.ceil(t));)t=ii(+t+1);return t}}:e))},r.ticks=function(e,t){var n=Ho(r.domain()),a=null==e?o(n,10):"number"==typeof e?o(n,e):!e.range&&[{range:e},t];return a&&(e=a[0],t=a[1]),e.range(n[0],ii(+n[1]+1),t<1?1:t)},r.tickFormat=function(){return n},r.copy=function(){return ai(e.copy(),t,n)},Ko(r,e)}function ii(e){return new Date(e)}function li(e){return JSON.parse(e.responseText)}function si(e){var t=di.createRange();return t.selectNode(di.body),t.createContextualFragment(e.responseText)}var ui={version:"3.5.15"},ci=[].slice,fi=function(e){return ci.call(e)},di=this.document;if(di)try{fi(di.documentElement.childNodes)[0].nodeType}catch(e){fi=function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}}if(Date.now||(Date.now=function(){return+new Date}),di)try{di.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var pi=this.Element.prototype,hi=pi.setAttribute,vi=pi.setAttributeNS,gi=this.CSSStyleDeclaration.prototype,mi=gi.setProperty;pi.setAttribute=function(e,t){hi.call(this,e,t+"")},pi.setAttributeNS=function(e,t,n){vi.call(this,e,t,n+"")},gi.setProperty=function(e,t,n){mi.call(this,e,t+"",n)}}ui.ascending=r,ui.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},ui.min=function(e,t){var n,r,o=-1,a=e.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=e[o])&&r>=r){n=r;break}for(;++o<a;)null!=(r=e[o])&&n>r&&(n=r)}else{for(;++o<a;)if(null!=(r=t.call(e,e[o],o))&&r>=r){n=r;break}for(;++o<a;)null!=(r=t.call(e,e[o],o))&&n>r&&(n=r)}return n},ui.max=function(e,t){var n,r,o=-1,a=e.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=e[o])&&r>=r){n=r;break}for(;++o<a;)null!=(r=e[o])&&r>n&&(n=r)}else{for(;++o<a;)if(null!=(r=t.call(e,e[o],o))&&r>=r){n=r;break}for(;++o<a;)null!=(r=t.call(e,e[o],o))&&r>n&&(n=r)}return n},ui.extent=function(e,t){var n,r,o,a=-1,i=e.length;if(1===arguments.length){for(;++a<i;)if(null!=(r=e[a])&&r>=r){n=o=r;break}for(;++a<i;)null!=(r=e[a])&&(n>r&&(n=r),o<r&&(o=r))}else{for(;++a<i;)if(null!=(r=t.call(e,e[a],a))&&r>=r){n=o=r;break}for(;++a<i;)null!=(r=t.call(e,e[a],a))&&(n>r&&(n=r),o<r&&(o=r))}return[n,o]},ui.sum=function(e,t){var n,r=0,o=e.length,i=-1;if(1===arguments.length)for(;++i<o;)a(n=+e[i])&&(r+=n);else for(;++i<o;)a(n=+t.call(e,e[i],i))&&(r+=n);return r},ui.mean=function(e,t){var n,r=0,i=e.length,l=-1,s=i;if(1===arguments.length)for(;++l<i;)a(n=o(e[l]))?r+=n:--s;else for(;++l<i;)a(n=o(t.call(e,e[l],l)))?r+=n:--s;if(s)return r/s},ui.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),o=+e[r-1],a=n-r;return a?o+a*(e[r]-o):o},ui.median=function(e,t){var n,i=[],l=e.length,s=-1;if(1===arguments.length)for(;++s<l;)a(n=o(e[s]))&&i.push(n);else for(;++s<l;)a(n=o(t.call(e,e[s],s)))&&i.push(n);if(i.length)return ui.quantile(i.sort(r),.5)},ui.variance=function(e,t){var n,r,i=e.length,l=0,s=0,u=-1,c=0;if(1===arguments.length)for(;++u<i;)a(n=o(e[u]))&&(r=n-l,l+=r/++c,s+=r*(n-l));else for(;++u<i;)a(n=o(t.call(e,e[u],u)))&&(r=n-l,l+=r/++c,s+=r*(n-l));if(c>1)return s/(c-1)},ui.deviation=function(){var e=ui.variance.apply(this,arguments);return e?Math.sqrt(e):e};var yi=i(r);ui.bisectLeft=yi.left,ui.bisect=ui.bisectRight=yi.right,ui.bisector=function(e){return i(1===e.length?function(t,n){return r(e(t),n)}:e)},ui.shuffle=function(e,t,n){(a=arguments.length)<3&&(n=e.length,a<2&&(t=0));for(var r,o,a=n-t;a;)o=Math.random()*a--|0,r=e[a+t],e[a+t]=e[o+t],e[o+t]=r;return e},ui.permute=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},ui.pairs=function(e){for(var t=0,n=e.length-1,r=e[0],o=new Array(n<0?0:n);t<n;)o[t]=[r,r=e[++t]];return o},ui.transpose=function(e){if(!(o=e.length))return[];for(var t=-1,n=ui.min(e,l),r=new Array(n);++t<n;)for(var o,a=-1,i=r[t]=new Array(o);++a<o;)i[a]=e[a][t];return r},ui.zip=function(){return ui.transpose(arguments)},ui.keys=function(e){var t=[];for(var n in e)t.push(n);return t},ui.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},ui.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},ui.merge=function(e){for(var t,n,r,o=e.length,a=-1,i=0;++a<o;)i+=e[a].length;for(n=new Array(i);--o>=0;)for(r=e[o],t=r.length;--t>=0;)n[--i]=r[t];return n};var xi=Math.abs;ui.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n==1/0)throw new Error("infinite range");var r,o=[],a=s(xi(n)),i=-1;if(e*=a,t*=a,n*=a,n<0)for(;(r=e+n*++i)>t;)o.push(r/a);else for(;(r=e+n*++i)<t;)o.push(r/a);return o},ui.map=function(e,t){var n=new c;if(e instanceof c)e.forEach(function(e,t){n.set(e,t)});else if(Array.isArray(e)){var r,o=-1,a=e.length;if(1===arguments.length)for(;++o<a;)n.set(o,e[o]);else for(;++o<a;)n.set(t.call(e,r=e[o],o),r)}else for(var i in e)n.set(i,e[i]);return n};var bi="__proto__",wi="\0";u(c,{has:p,get:function(e){return this._[f(e)]},set:function(e,t){return this._[f(e)]=t},remove:h,keys:v,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:d(t),value:this._[t]});return e},size:g,empty:m,forEach:function(e){for(var t in this._)e.call(this,d(t),this._[t])}}),ui.nest=function(){function e(t,i,l){if(l>=a.length)return r?r.call(o,i):n?i.sort(n):i;for(var s,u,f,d,p=-1,h=i.length,v=a[l++],g=new c;++p<h;)(d=g.get(s=v(u=i[p])))?d.push(u):g.set(s,[u]);return t?(u=t(),f=function(n,r){u.set(n,e(t,r,l))}):(u={},f=function(n,r){u[n]=e(t,r,l)}),g.forEach(f),u}function t(e,n){if(n>=a.length)return e;var r=[],o=i[n++];return e.forEach(function(e,o){r.push({key:e,values:t(o,n)})}),o?r.sort(function(e,t){return o(e.key,t.key)}):r}var n,r,o={},a=[],i=[];return o.map=function(t,n){return e(n,t,0)},o.entries=function(n){return t(e(ui.map,n,0),0)},o.key=function(e){return a.push(e),o},o.sortKeys=function(e){return i[a.length-1]=e,o},o.sortValues=function(e){return n=e,o},o.rollup=function(e){return r=e,o},o},ui.set=function(e){var t=new y;if(e)for(var n=0,r=e.length;n<r;++n)t.add(e[n]);return t},u(y,{has:p,add:function(e){return this._[f(e+="")]=!0,e},remove:h,values:v,size:g,empty:m,forEach:function(e){for(var t in this._)e.call(this,d(t))}}),ui.behavior={},ui.rebind=function(e,t){for(var n,r=1,o=arguments.length;++r<o;)e[n=arguments[r]]=b(e,t,t[n]);return e};var _i=["webkit","ms","moz","Moz","o","O"];ui.dispatch=function(){for(var e=new k,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=z(e);return e},k.prototype.on=function(e,t){var n=e.indexOf("."),r="";if(n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},
ui.event=null,ui.requote=function(e){return e.replace(ki,"\\$&")};var ki=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,zi={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},Mi=function(e,t){return t.querySelector(e)},Ai=function(e,t){return t.querySelectorAll(e)},ji=function(e,t){var n=e.matches||e[w(e,"matchesSelector")];return(ji=function(e,t){return n.call(e,t)})(e,t)};"function"==typeof Sizzle&&(Mi=function(e,t){return Sizzle(e,t)[0]||null},Ai=Sizzle,ji=Sizzle.matchesSelector),ui.selection=function(){return ui.select(di.documentElement)};var Ei=ui.selection.prototype=[];Ei.select=function(e){var t,n,r,o,a=[];e=S(e);for(var i=-1,l=this.length;++i<l;){a.push(t=[]),t.parentNode=(r=this[i]).parentNode;for(var s=-1,u=r.length;++s<u;)(o=r[s])?(t.push(n=e.call(o,o.__data__,s,i)),n&&"__data__"in o&&(n.__data__=o.__data__)):t.push(null)}return E(a)},Ei.selectAll=function(e){var t,n,r=[];e=O(e);for(var o=-1,a=this.length;++o<a;)for(var i=this[o],l=-1,s=i.length;++l<s;)(n=i[l])&&(r.push(t=fi(e.call(n,n.__data__,l,o))),t.parentNode=n);return E(r)};var Si={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ui.ns={prefix:Si,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&"xmlns"!==(n=e.slice(0,t))&&(e=e.slice(t+1)),Si.hasOwnProperty(n)?{space:Si[n],local:e}:e}},Ei.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node();return e=ui.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(N(t,e[t]));return this}return this.each(N(e,t))},Ei.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),r=(e=C(e)).length,o=-1;if(t=n.classList){for(;++o<r;)if(!t.contains(e[o]))return!1}else for(t=n.getAttribute("class");++o<r;)if(!T(e[o]).test(t))return!1;return!0}for(t in e)this.each(q(t,e[t]));return this}return this.each(q(e,t))},Ei.style=function(e,t,r){var o=arguments.length;if(o<3){if("string"!=typeof e){o<2&&(t="");for(r in e)this.each(B(r,e[r],t));return this}if(o<2){var a=this.node();return n(a).getComputedStyle(a,null).getPropertyValue(e)}r=""}return this.each(B(e,t,r))},Ei.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(D(t,e[t]));return this}return this.each(D(e,t))},Ei.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Ei.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Ei.append=function(e){return e=R(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Ei.insert=function(e,t){return e=R(e),t=S(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Ei.remove=function(){return this.each(I)},Ei.data=function(e,t){function n(e,n){var r,o,a,i=e.length,f=n.length,d=Math.min(i,f),p=new Array(f),h=new Array(f),v=new Array(i);if(t){var g,m=new c,y=new Array(i);for(r=-1;++r<i;)(o=e[r])&&(m.has(g=t.call(o,o.__data__,r))?v[r]=o:m.set(g,o),y[r]=g);for(r=-1;++r<f;)(o=m.get(g=t.call(n,a=n[r],r)))?!0!==o&&(p[r]=o,o.__data__=a):h[r]=L(a),m.set(g,!0);for(r=-1;++r<i;)r in y&&!0!==m.get(y[r])&&(v[r]=e[r])}else{for(r=-1;++r<d;)o=e[r],a=n[r],o?(o.__data__=a,p[r]=o):h[r]=L(a);for(;r<f;++r)h[r]=L(n[r]);for(;r<i;++r)v[r]=e[r]}h.update=p,h.parentNode=p.parentNode=v.parentNode=e.parentNode,l.push(h),s.push(p),u.push(v)}var r,o,a=-1,i=this.length;if(!arguments.length){for(e=new Array(i=(r=this[0]).length);++a<i;)(o=r[a])&&(e[a]=o.__data__);return e}var l=H([]),s=E([]),u=E([]);if("function"==typeof e)for(;++a<i;)n(r=this[a],e.call(r,r.parentNode.__data__,a));else for(;++a<i;)n(r=this[a],e);return s.enter=function(){return l},s.exit=function(){return u},s},Ei.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Ei.filter=function(e){var t,n,r,o=[];"function"!=typeof e&&(e=V(e));for(var a=0,i=this.length;a<i;a++){o.push(t=[]),t.parentNode=(n=this[a]).parentNode;for(var l=0,s=n.length;l<s;l++)(r=n[l])&&e.call(r,r.__data__,l,a)&&t.push(r)}return E(o)},Ei.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,r=this[e],o=r.length-1,a=r[o];--o>=0;)(n=r[o])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},Ei.sort=function(e){e=U.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},Ei.each=function(e){return Y(this,function(t,n,r){e.call(t,t.__data__,n,r)})},Ei.call=function(e){var t=fi(arguments);return e.apply(t[0]=this,t),this},Ei.empty=function(){return!this.node()},Ei.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,o=n.length;r<o;r++){var a=n[r];if(a)return a}return null},Ei.size=function(){var e=0;return Y(this,function(){++e}),e};var Oi=[];ui.selection.enter=H,ui.selection.enter.prototype=Oi,Oi.append=Ei.append,Oi.empty=Ei.empty,Oi.node=Ei.node,Oi.call=Ei.call,Oi.size=Ei.size,Oi.select=function(e){for(var t,n,r,o,a,i=[],l=-1,s=this.length;++l<s;){r=(o=this[l]).update,i.push(t=[]),t.parentNode=o.parentNode;for(var u=-1,c=o.length;++u<c;)(a=o[u])?(t.push(r[u]=n=e.call(o.parentNode,a.__data__,u,l)),n.__data__=a.__data__):t.push(null)}return E(i)},Oi.insert=function(e,t){return arguments.length<2&&(t=X(this)),Ei.insert.call(this,e,t)},ui.select=function(t){var n;return"string"==typeof t?(n=[Mi(t,di)],n.parentNode=di.documentElement):(n=[t],n.parentNode=e(t)),E([n])},ui.selectAll=function(e){var t;return"string"==typeof e?(t=fi(Ai(e,di)),t.parentNode=di.documentElement):(t=fi(e),t.parentNode=null),E([t])},Ei.on=function(e,t,n){var r=arguments.length;if(r<3){if("string"!=typeof e){r<2&&(t=!1);for(n in e)this.each(G(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(G(e,t,n))};var Ni=ui.map({mouseenter:"mouseover",mouseleave:"mouseout"});di&&Ni.forEach(function(e){"on"+e in di&&Ni.remove(e)});var Fi,Ti=0;ui.mouse=function(e){return Q(e,A())};var Ci=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ui.touch=function(e,t,n){if(arguments.length<3&&(n=t,t=A().changedTouches),t)for(var r,o=0,a=t.length;o<a;++o)if((r=t[o]).identifier===n)return Q(e,r)},ui.behavior.drag=function(){function e(){this.on("mousedown.drag",a).on("touchstart.drag",i)}function t(e,t,n,a,i){return function(){function l(){var e,n,r=t(d,v);r&&(e=r[0]-x[0],n=r[1]-x[1],h|=e|n,x=r,p({type:"drag",x:r[0]+u[0],y:r[1]+u[1],dx:e,dy:n}))}function s(){t(d,v)&&(m.on(a+g,null).on(i+g,null),y(h),p({type:"dragend"}))}var u,c=this,f=ui.event.target.correspondingElement||ui.event.target,d=c.parentNode,p=r.of(c,arguments),h=0,v=e(),g=".drag"+(null==v?"":"-"+v),m=ui.select(n(f)).on(a+g,l).on(i+g,s),y=J(f),x=t(d,v);o?(u=o.apply(c,arguments),u=[u.x-x[0],u.y-x[1]]):u=[0,0],p({type:"dragstart"})}}var r=j(e,"drag","dragstart","dragend"),o=null,a=t(_,ui.mouse,n,"mousemove","mouseup"),i=t(K,ui.touch,x,"touchmove","touchend");return e.origin=function(t){return arguments.length?(o=t,e):o},ui.rebind(e,r,"on")},ui.touches=function(e,t){return arguments.length<2&&(t=A().touches),t?fi(t).map(function(t){var n=Q(e,t);return n.identifier=t.identifier,n}):[]};var qi=1e-6,Pi=qi*qi,Bi=Math.PI,Di=2*Bi,Ri=Di-qi,Ii=Bi/2,Li=Bi/180,Vi=180/Bi,Ui=Math.SQRT2;ui.interpolateZoom=function(e,t){var n,r,o=e[0],a=e[1],i=e[2],l=t[0],s=t[1],u=t[2],c=l-o,f=s-a,d=c*c+f*f;if(d<Pi)r=Math.log(u/i)/Ui,n=function(e){return[o+e*c,a+e*f,i*Math.exp(Ui*e*r)]};else{var p=Math.sqrt(d),h=(u*u-i*i+4*d)/(2*i*2*p),v=(u*u-i*i-4*d)/(2*u*2*p),g=Math.log(Math.sqrt(h*h+1)-h),m=Math.log(Math.sqrt(v*v+1)-v);r=(m-g)/Ui,n=function(e){var t=e*r,n=oe(g),l=i/(2*p)*(n*ae(Ui*t+g)-re(g));return[o+l*c,a+l*f,i*n/oe(Ui*t+g)]}}return n.duration=1e3*r,n},ui.behavior.zoom=function(){function e(e){e.on(N,f).on(Hi+".zoom",p).on("dblclick.zoom",h).on(C,d)}function t(e){return[(e[0]-z.x)/z.k,(e[1]-z.y)/z.k]}function r(e){return[e[0]*z.k+z.x,e[1]*z.k+z.y]}function o(e){z.k=Math.max(E[0],Math.min(E[1],e))}function a(e,t){t=r(t),z.x+=e[0]-t[0],z.y+=e[1]-t[1]}function i(t,n,r,i){t.__chart__={x:z.x,y:z.y,k:z.k},o(Math.pow(2,i)),a(g=n,r),t=ui.select(t),S>0&&(t=t.transition().duration(S)),t.call(e.event)}function l(){w&&w.domain(b.range().map(function(e){return(e-z.x)/z.k}).map(b.invert)),k&&k.domain(_.range().map(function(e){return(e-z.y)/z.k}).map(_.invert))}function s(e){O++||e({type:"zoomstart"})}function u(e){l(),e({type:"zoom",scale:z.k,translate:[z.x,z.y]})}function c(e){--O||(e({type:"zoomend"}),g=null)}function f(){function e(){l=1,a(ui.mouse(o),d),u(i)}function r(){f.on(F,null).on(T,null),p(l),c(i)}var o=this,i=q.of(o,arguments),l=0,f=ui.select(n(o)).on(F,e).on(T,r),d=t(ui.mouse(o)),p=J(o);Ds.call(o),s(i)}function d(){function e(){var e=ui.touches(h);return p=z.k,e.forEach(function(e){e.identifier in g&&(g[e.identifier]=t(e))}),e}function n(){var t=ui.event.target;ui.select(t).on(b,r).on(w,l),_.push(t);for(var n=ui.event.changedTouches,o=0,a=n.length;o<a;++o)g[n[o].identifier]=null;var s=e(),u=Date.now();if(1===s.length){if(u-x<500){var c=s[0];i(h,c,g[c.identifier],Math.floor(Math.log(z.k)/Math.LN2)+1),M()}x=u}else if(s.length>1){var c=s[0],f=s[1],d=c[0]-f[0],p=c[1]-f[1];m=d*d+p*p}}function r(){var e,t,n,r,i=ui.touches(h);Ds.call(h);for(var l=0,s=i.length;l<s;++l,r=null)if(n=i[l],r=g[n.identifier]){if(t)break;e=n,t=r}if(r){var c=(c=n[0]-e[0])*c+(c=n[1]-e[1])*c,f=m&&Math.sqrt(c/m);e=[(e[0]+n[0])/2,(e[1]+n[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],o(f*p)}x=null,a(e,t),u(v)}function l(){if(ui.event.touches.length){for(var t=ui.event.changedTouches,n=0,r=t.length;n<r;++n)delete g[t[n].identifier];for(var o in g)return void e()}ui.selectAll(_).on(y,null),k.on(N,f).on(C,d),A(),c(v)}var p,h=this,v=q.of(h,arguments),g={},m=0,y=".zoom-"+ui.event.changedTouches[0].identifier,b="touchmove"+y,w="touchend"+y,_=[],k=ui.select(h),A=J(h);n(),s(v),k.on(N,null).on(C,n)}function p(){var e=q.of(this,arguments);y?clearTimeout(y):(Ds.call(this),v=t(g=m||ui.mouse(this)),s(e)),y=setTimeout(function(){y=null,c(e)},50),M(),o(Math.pow(2,.002*Yi())*z.k),a(g,v),u(e)}function h(){var e=ui.mouse(this),n=Math.log(z.k)/Math.LN2;i(this,e,t(e),ui.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var v,g,m,y,x,b,w,_,k,z={x:0,y:0,k:1},A=[960,500],E=Xi,S=250,O=0,N="mousedown.zoom",F="mousemove.zoom",T="mouseup.zoom",C="touchstart.zoom",q=j(e,"zoomstart","zoom","zoomend");return Hi||(Hi="onwheel"in di?(Yi=function(){return-ui.event.deltaY*(ui.event.deltaMode?120:1)},"wheel"):"onmousewheel"in di?(Yi=function(){return ui.event.wheelDelta},"mousewheel"):(Yi=function(){return-ui.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=q.of(this,arguments),t=z;Ps?ui.select(this).transition().each("start.zoom",function(){z=this.__chart__||{x:0,y:0,k:1},s(e)}).tween("zoom:zoom",function(){var n=A[0],r=A[1],o=g?g[0]:n/2,a=g?g[1]:r/2,i=ui.interpolateZoom([(o-z.x)/z.k,(a-z.y)/z.k,n/z.k],[(o-t.x)/t.k,(a-t.y)/t.k,n/t.k]);return function(t){var r=i(t),l=n/r[2];this.__chart__=z={x:o-r[0]*l,y:a-r[1]*l,k:l},u(e)}}).each("interrupt.zoom",function(){c(e)}).each("end.zoom",function(){c(e)}):(this.__chart__=z,s(e),u(e),c(e))})},e.translate=function(t){return arguments.length?(z={x:+t[0],y:+t[1],k:z.k},l(),e):[z.x,z.y]},e.scale=function(t){return arguments.length?(z={x:z.x,y:z.y,k:null},o(+t),l(),e):z.k},e.scaleExtent=function(t){return arguments.length?(E=null==t?Xi:[+t[0],+t[1]],e):E},e.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],e):m},e.size=function(t){return arguments.length?(A=t&&[+t[0],+t[1]],e):A},e.duration=function(t){return arguments.length?(S=+t,e):S},e.x=function(t){return arguments.length?(w=t,b=t.copy(),z={x:0,y:0,k:1},e):w},e.y=function(t){return arguments.length?(k=t,_=t.copy(),z={x:0,y:0,k:1},e):k},ui.rebind(e,q,"on")};var Yi,Hi,Xi=[0,1/0];ui.color=le,le.prototype.toString=function(){return this.rgb()+""},ui.hsl=se;var Gi=se.prototype=new le;Gi.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new se(this.h,this.s,this.l/e)},Gi.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new se(this.h,this.s,e*this.l)},Gi.rgb=function(){return ue(this.h,this.s,this.l)},ui.hcl=ce;var Zi=ce.prototype=new le;Zi.brighter=function(e){return new ce(this.h,this.c,Math.min(100,this.l+Wi*(arguments.length?e:1)))},Zi.darker=function(e){return new ce(this.h,this.c,Math.max(0,this.l-Wi*(arguments.length?e:1)))},Zi.rgb=function(){return fe(this.h,this.c,this.l).rgb()},ui.lab=de;var Wi=18,Ji=.95047,Qi=1,Ki=1.08883,$i=de.prototype=new le;$i.brighter=function(e){return new de(Math.min(100,this.l+Wi*(arguments.length?e:1)),this.a,this.b)},$i.darker=function(e){return new de(Math.max(0,this.l-Wi*(arguments.length?e:1)),this.a,this.b)},$i.rgb=function(){return pe(this.l,this.a,this.b)},ui.rgb=ye;var el=ye.prototype=new le;el.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,o=30;return t||n||r?(t&&t<o&&(t=o),n&&n<o&&(n=o),r&&r<o&&(r=o),new ye(Math.min(255,t/e),Math.min(255,n/e),Math.min(255,r/e))):new ye(o,o,o)},el.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new ye(e*this.r,e*this.g,e*this.b)},el.hsl=function(){return ke(this.r,this.g,this.b)},el.toString=function(){return"#"+we(this.r)+we(this.g)+we(this.b)};var tl=ui.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});tl.forEach(function(e,t){tl.set(e,xe(t))}),ui.functor=je,ui.xhr=Ee(x),ui.dsv=function(e,t){function n(e,n,a){arguments.length<3&&(a=n,n=null);var i=Se(e,t,null==n?r:o(n),a);return i.row=function(e){return arguments.length?i.response(null==(n=e)?r:o(e)):n},i}function r(e){return n.parse(e.responseText)}function o(e){return function(t){return n.parse(t.responseText,e)}}function a(t){return t.map(i).join(e)}function i(e){return l.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var l=new RegExp('["'+e+"\n]"),s=e.charCodeAt(0);return n.parse=function(e,t){var r;return n.parseRows(e,function(e,n){if(r)return r(e,n-1);var o=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,n){return t(o(e),n)}:o})},n.parseRows=function(e,t){function n(){if(c>=u)return i;if(o)return o=!1,a;var t=c;if(34===e.charCodeAt(t)){for(var n=t;n++<u;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}c=n+2;var r=e.charCodeAt(n+1);return 13===r?(o=!0,10===e.charCodeAt(n+2)&&++c):10===r&&(o=!0),e.slice(t+1,n).replace(/""/g,'"')}for(;c<u;){var r=e.charCodeAt(c++),l=1;if(10===r)o=!0;else if(13===r)o=!0,10===e.charCodeAt(c)&&(++c,++l);else if(r!==s)continue;return e.slice(t,c-l)}return e.slice(t)}for(var r,o,a={},i={},l=[],u=e.length,c=0,f=0;(r=n())!==i;){for(var d=[];r!==a&&r!==i;)d.push(r),r=n();t&&null==(d=t(d,f++))||l.push(d)}return l},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var r=new y,o=[];return t.forEach(function(e){for(var t in e)r.has(t)||o.push(r.add(t))}),[o.map(i).join(e)].concat(t.map(function(t){return o.map(function(e){return i(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(a).join("\n")},n},ui.csv=ui.dsv(",","text/csv"),ui.tsv=ui.dsv("\t","text/tab-separated-values");var nl,rl,ol,al,il=this[w(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};ui.timer=function(){Fe.apply(this,arguments)},ui.timer.flush=function(){Ce(),qe()},ui.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var ll=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Be);ui.formatPrefix=function(e,t){var n=0;return(e=+e)&&(e<0&&(e*=-1),t&&(e=ui.round(e,Pe(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),ll[8+n/3]};var sl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ul=ui.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=ui.round(e,Pe(e,t))).toFixed(Math.max(0,Math.min(20,Pe(e*(1+1e-15),t))))}}),cl=ui.time={},fl=Date;Ie.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){dl.setUTCDate.apply(this._,arguments)},setDay:function(){dl.setUTCDay.apply(this._,arguments)},setFullYear:function(){dl.setUTCFullYear.apply(this._,arguments)},setHours:function(){dl.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){dl.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){dl.setUTCMinutes.apply(this._,arguments)},setMonth:function(){dl.setUTCMonth.apply(this._,arguments)},setSeconds:function(){dl.setUTCSeconds.apply(this._,arguments)},setTime:function(){dl.setTime.apply(this._,arguments)}};var dl=Date.prototype;cl.year=Le(function(e){return e=cl.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),cl.years=cl.year.range,cl.years.utc=cl.year.utc.range,cl.day=Le(function(e){var t=new fl(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),cl.days=cl.day.range,cl.days.utc=cl.day.utc.range,cl.dayOfYear=function(e){var t=cl.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=cl[e]=Le(function(e){return(e=cl.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=cl.year(e).getDay();return Math.floor((cl.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});cl[e+"s"]=n.range,cl[e+"s"].utc=n.utc.range,cl[e+"OfYear"]=function(e){var n=cl.year(e).getDay();return Math.floor((cl.dayOfYear(e)+(n+t)%7)/7)}}),cl.week=cl.sunday,cl.weeks=cl.sunday.range,cl.weeks.utc=cl.sunday.utc.range,cl.weekOfYear=cl.sundayOfYear;var pl={"-":"",_:" ",0:"0"},hl=/^\s*\d+/,vl=/^%/;ui.locale=function(e){return{numberFormat:De(e),timeFormat:Ue(e)}};var gl=ui.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ui.format=gl.numberFormat,ui.geo={},ct.prototype={s:0,t:0,add:function(e){ft(e,this.t,ml),ft(ml.s,this.s,this),this.s?this.t+=ml.t:this.s=ml.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ml=new ct;ui.geo.stream=function(e,t){e&&yl.hasOwnProperty(e.type)?yl[e.type](e,t):dt(e,t)};var yl={Feature:function(e,t){dt(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,o=n.length;++r<o;)dt(n[r].geometry,t)}},xl={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){pt(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)pt(n[r],t,0)},Polygon:function(e,t){ht(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)ht(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,o=n.length;++r<o;)dt(n[r],t)}};ui.geo.area=function(e){return bl=0,ui.geo.stream(e,_l),bl};var bl,wl=new ct,_l={sphere:function(){bl+=4*Bi},point:_,lineStart:_,lineEnd:_,polygonStart:function(){wl.reset(),_l.lineStart=vt},polygonEnd:function(){var e=2*wl;bl+=e<0?4*Bi+e:e,_l.lineStart=_l.lineEnd=_l.point=_}};ui.geo.bounds=function(){function e(e,t){x.push(b=[c=e,d=e]),t<f&&(f=t),t>p&&(p=t)}function t(t,n){var r=gt([t*Li,n*Li]);if(m){var o=yt(m,r),a=[o[1],-o[0],0],i=yt(a,o);wt(i),i=_t(i);var s=t-h,u=s>0?1:-1,v=i[0]*Vi*u,g=xi(s)>180;if(g^(u*h<v&&v<u*t)){var y=i[1]*Vi;y>p&&(p=y)}else if(v=(v+360)%360-180,g^(u*h<v&&v<u*t)){var y=-i[1]*Vi;y<f&&(f=y)}else n<f&&(f=n),n>p&&(p=n);g?t<h?l(c,t)>l(c,d)&&(d=t):l(t,d)>l(c,d)&&(c=t):d>=c?(t<c&&(c=t),t>d&&(d=t)):t>h?l(c,t)>l(c,d)&&(d=t):l(t,d)>l(c,d)&&(c=t)}else e(t,n);m=r,h=t}function n(){w.point=t}function r(){b[0]=c,b[1]=d,w.point=e,m=null}function o(e,n){if(m){var r=e-h;y+=xi(r)>180?r+(r>0?360:-360):r}else v=e,g=n;_l.point(e,n),t(e,n)}function a(){_l.lineStart()}function i(){o(v,g),_l.lineEnd(),xi(y)>qi&&(c=-(d=180)),b[0]=c,b[1]=d,m=null}function l(e,t){return(t-=e)<0?t+360:t}function s(e,t){return e[0]-t[0]}function u(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c,f,d,p,h,v,g,m,y,x,b,w={point:e,lineStart:n,lineEnd:r,polygonStart:function(){w.point=o,w.lineStart=a,w.lineEnd=i,y=0,_l.polygonStart()},polygonEnd:function(){_l.polygonEnd(),w.point=e,w.lineStart=n,w.lineEnd=r,wl<0?(c=-(d=180),f=-(p=90)):y>qi?p=90:y<-qi&&(f=-90),b[0]=c,b[1]=d}};return function(e){p=d=-(c=f=1/0),x=[],ui.geo.stream(e,w);var t=x.length;if(t){x.sort(s);for(var n,r=1,o=x[0],a=[o];r<t;++r)n=x[r],u(n[0],o)||u(n[1],o)?(l(o[0],n[1])>l(o[0],o[1])&&(o[1]=n[1]),l(n[0],o[1])>l(o[0],o[1])&&(o[0]=n[0])):a.push(o=n);for(var i,n,h=-1/0,t=a.length-1,r=0,o=a[t];r<=t;o=n,++r)n=a[r],(i=l(o[1],n[0]))>h&&(h=i,c=n[0],d=o[1])}return x=b=null,c===1/0||f===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,f],[d,p]]}}(),ui.geo.centroid=function(e){kl=zl=Ml=Al=jl=El=Sl=Ol=Nl=Fl=Tl=0,ui.geo.stream(e,Cl);var t=Nl,n=Fl,r=Tl,o=t*t+n*n+r*r;return o<Pi&&(t=El,n=Sl,r=Ol,zl<qi&&(t=Ml,n=Al,r=jl),(o=t*t+n*n+r*r)<Pi)?[NaN,NaN]:[Math.atan2(n,t)*Vi,ne(r/Math.sqrt(o))*Vi]};var kl,zl,Ml,Al,jl,El,Sl,Ol,Nl,Fl,Tl,Cl={sphere:_,point:zt,lineStart:At,lineEnd:jt,polygonStart:function(){Cl.lineStart=Et},polygonEnd:function(){Cl.lineStart=At}},ql=Ct(Ot,Dt,It,[-Bi,-Bi/2]),Pl=1e9;ui.geo.clipExtent=function(){var e,t,n,r,o,a,i={stream:function(e){return o&&(o.valid=!1),o=a(e),o.valid=!0,o},extent:function(l){return arguments.length?(a=Yt(e=+l[0][0],t=+l[0][1],n=+l[1][0],r=+l[1][1]),o&&(o.valid=!1,o=null),i):[[e,t],[n,r]]}};return i.extent([[0,0],[960,500]])},(ui.geo.conicEqualArea=function(){return Ht(Xt)}).raw=Xt,ui.geo.albers=function(){return ui.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ui.geo.albersUsa=function(){function e(e){var a=e[0],i=e[1];return t=null,n(a,i),t||(r(a,i),t)||o(a,i),t}var t,n,r,o,a=ui.geo.albers(),i=ui.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=ui.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(e,n){t=[e,n]}};return e.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,o=(e[1]-n[1])/t;return(o>=.12&&o<.234&&r>=-.425&&r<-.214?i:o>=.166&&o<.234&&r>=-.214&&r<-.115?l:a).invert(e)},e.stream=function(e){var t=a.stream(e),n=i.stream(e),r=l.stream(e);return{point:function(e,o){t.point(e,o),n.point(e,o),r.point(e,o)},sphere:function(){t.sphere(),n.sphere(),r.sphere()},lineStart:function(){t.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},e.precision=function(t){return arguments.length?(a.precision(t),i.precision(t),l.precision(t),e):a.precision()},e.scale=function(t){return arguments.length?(a.scale(t),i.scale(.35*t),l.scale(t),e.translate(a.translate())):a.scale()},e.translate=function(t){if(!arguments.length)return a.translate();var u=a.scale(),c=+t[0],f=+t[1];return n=a.translate(t).clipExtent([[c-.455*u,f-.238*u],[c+.455*u,f+.238*u]]).stream(s).point,r=i.translate([c-.307*u,f+.201*u]).clipExtent([[c-.425*u+qi,f+.12*u+qi],[c-.214*u-qi,f+.234*u-qi]]).stream(s).point,o=l.translate([c-.205*u,f+.212*u]).clipExtent([[c-.214*u+qi,f+.166*u+qi],[c-.115*u-qi,f+.234*u-qi]]).stream(s).point,e},e.scale(1070)};var Bl,Dl,Rl,Il,Ll,Vl,Ul={point:_,lineStart:_,lineEnd:_,polygonStart:function(){Dl=0,Ul.lineStart=Gt},polygonEnd:function(){Ul.lineStart=Ul.lineEnd=Ul.point=_,Bl+=xi(Dl/2)}},Yl={point:Zt,lineStart:_,lineEnd:_,polygonStart:_,polygonEnd:_},Hl={point:Qt,lineStart:Kt,lineEnd:$t,polygonStart:function(){Hl.lineStart=en},polygonEnd:function(){Hl.point=Qt,Hl.lineStart=Kt,Hl.lineEnd=$t}};ui.geo.path=function(){function e(e){return e&&("function"==typeof l&&a.pointRadius(+l.apply(this,arguments)),i&&i.valid||(i=o(a)),ui.geo.stream(e,i)),a.result()}function t(){return i=null,e}var n,r,o,a,i,l=4.5;return e.area=function(e){return Bl=0,ui.geo.stream(e,o(Ul)),Bl},e.centroid=function(e){return Ml=Al=jl=El=Sl=Ol=Nl=Fl=Tl=0,ui.geo.stream(e,o(Hl)),Tl?[Nl/Tl,Fl/Tl]:Ol?[El/Ol,Sl/Ol]:jl?[Ml/jl,Al/jl]:[NaN,NaN]},e.bounds=function(e){return Ll=Vl=-(Rl=Il=1/0),ui.geo.stream(e,o(Yl)),[[Rl,Il],[Ll,Vl]]},e.projection=function(e){return arguments.length?(o=(n=e)?e.stream||rn(e):x,t()):n},e.context=function(e){return arguments.length?(a=null==(r=e)?new Wt:new tn(e),"function"!=typeof l&&a.pointRadius(l),t()):r},e.pointRadius=function(t){return arguments.length?(l="function"==typeof t?t:(a.pointRadius(+t),+t),e):l},e.projection(ui.geo.albersUsa()).context(null)},ui.geo.transform=function(e){return{stream:function(t){var n=new on(t);for(var r in e)n[r]=e[r];return n}}},on.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ui.geo.projection=ln,ui.geo.projectionMutator=sn,(ui.geo.equirectangular=function(){return ln(cn)}).raw=cn.invert=cn,ui.geo.rotation=function(e){function t(t){return t=e(t[0]*Li,t[1]*Li),t[0]*=Vi,t[1]*=Vi,t}return e=dn(e[0]%360*Li,e[1]*Li,e.length>2?e[2]*Li:0),t.invert=function(t){return t=e.invert(t[0]*Li,t[1]*Li),t[0]*=Vi,t[1]*=Vi,t},t},fn.invert=cn,ui.geo.circle=function(){function e(){var e="function"==typeof r?r.apply(this,arguments):r,t=dn(-e[0]*Li,-e[1]*Li,0).invert,o=[];return n(null,null,1,{point:function(e,n){o.push(e=t(e,n)),e[0]*=Vi,e[1]*=Vi}}),{type:"Polygon",coordinates:[o]}}var t,n,r=[0,0],o=6;return e.origin=function(t){return arguments.length?(r=t,e):r},e.angle=function(r){return arguments.length?(n=gn((t=+r)*Li,o*Li),e):t},e.precision=function(r){return arguments.length?(n=gn(t*Li,(o=+r)*Li),e):o},e.angle(90)},ui.geo.distance=function(e,t){var n,r=(t[0]-e[0])*Li,o=e[1]*Li,a=t[1]*Li,i=Math.sin(r),l=Math.cos(r),s=Math.sin(o),u=Math.cos(o),c=Math.sin(a),f=Math.cos(a);return Math.atan2(Math.sqrt((n=f*i)*n+(n=u*c-s*f*l)*n),s*c+u*f*l)},ui.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return ui.range(Math.ceil(a/g)*g,o,g).map(d).concat(ui.range(Math.ceil(u/m)*m,s,m).map(p)).concat(ui.range(Math.ceil(r/h)*h,n,h).filter(function(e){return xi(e%g)>qi}).map(c)).concat(ui.range(Math.ceil(l/v)*v,i,v).filter(function(e){return xi(e%m)>qi}).map(f))}var n,r,o,a,i,l,s,u,c,f,d,p,h=10,v=h,g=90,m=360,y=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[d(a).concat(p(s).slice(1),d(o).reverse().slice(1),p(u).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(a=+t[0][0],o=+t[1][0],u=+t[0][1],s=+t[1][1],a>o&&(t=a,a=o,o=t),u>s&&(t=u,u=s,s=t),e.precision(y)):[[a,u],[o,s]]},e.minorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],i=+t[1][1],r>n&&(t=r,r=n,n=t),l>i&&(t=l,l=i,i=t),e.precision(y)):[[r,l],[n,i]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(g=+t[0],m=+t[1],e):[g,m]},e.minorStep=function(t){return arguments.length?(h=+t[0],v=+t[1],e):[h,v]},e.precision=function(t){return arguments.length?(y=+t,c=yn(l,i,90),f=xn(r,n,y),d=yn(u,s,90),p=xn(a,o,y),e):y},e.majorExtent([[-180,-90+qi],[180,90-qi]]).minorExtent([[-180,-80-qi],[180,80+qi]])},ui.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),n||o.apply(this,arguments)]}}var t,n,r=bn,o=wn;return e.distance=function(){
return ui.geo.distance(t||r.apply(this,arguments),n||o.apply(this,arguments))},e.source=function(n){return arguments.length?(r=n,t="function"==typeof n?null:n,e):r},e.target=function(t){return arguments.length?(o=t,n="function"==typeof t?null:t,e):o},e.precision=function(){return arguments.length?e:0},e},ui.geo.interpolate=function(e,t){return _n(e[0]*Li,e[1]*Li,t[0]*Li,t[1]*Li)},ui.geo.length=function(e){return Xl=0,ui.geo.stream(e,Gl),Xl};var Xl,Gl={sphere:_,point:_,lineStart:kn,lineEnd:_,polygonStart:_,polygonEnd:_},Zl=zn(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(ui.geo.azimuthalEqualArea=function(){return ln(Zl)}).raw=Zl;var Wl=zn(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},x);(ui.geo.azimuthalEquidistant=function(){return ln(Wl)}).raw=Wl,(ui.geo.conicConformal=function(){return Ht(Mn)}).raw=Mn,(ui.geo.conicEquidistant=function(){return Ht(An)}).raw=An;var Jl=zn(function(e){return 1/e},Math.atan);(ui.geo.gnomonic=function(){return ln(Jl)}).raw=Jl,jn.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Ii]},(ui.geo.mercator=function(){return En(jn)}).raw=jn;var Ql=zn(function(){return 1},Math.asin);(ui.geo.orthographic=function(){return ln(Ql)}).raw=Ql;var Kl=zn(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(ui.geo.stereographic=function(){return ln(Kl)}).raw=Kl,Sn.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Ii]},(ui.geo.transverseMercator=function(){var e=En(Sn),t=e.center,n=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90])}).raw=Sn,ui.geom={},ui.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,o=je(n),a=je(r),i=e.length,l=[],s=[];for(t=0;t<i;t++)l.push([+o.call(this,e[t],t),+a.call(this,e[t],t),t]);for(l.sort(Tn),t=0;t<i;t++)s.push([l[t][0],-l[t][1]]);var u=Fn(l),c=Fn(s),f=c[0]===u[0],d=c[c.length-1]===u[u.length-1],p=[];for(t=u.length-1;t>=0;--t)p.push(e[l[u[t]][2]]);for(t=+f;t<c.length-d;++t)p.push(e[l[c[t]][2]]);return p}var n=On,r=Nn;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t)},ui.geom.polygon=function(e){return zi(e,$l),e};var $l=ui.geom.polygon.prototype=[];$l.area=function(){for(var e,t=-1,n=this.length,r=this[n-1],o=0;++t<n;)e=r,r=this[t],o+=e[1]*r[0]-e[0]*r[1];return.5*o},$l.centroid=function(e){var t,n,r=-1,o=this.length,a=0,i=0,l=this[o-1];for(arguments.length||(e=-1/(6*this.area()));++r<o;)t=l,l=this[r],n=t[0]*l[1]-l[0]*t[1],a+=(t[0]+l[0])*n,i+=(t[1]+l[1])*n;return[a*e,i*e]},$l.clip=function(e){for(var t,n,r,o,a,i,l=Pn(e),s=-1,u=this.length-Pn(this),c=this[u-1];++s<u;){for(t=e.slice(),e.length=0,o=this[s],a=t[(r=t.length-l)-1],n=-1;++n<r;)i=t[n],Cn(i,c,o)?(Cn(a,c,o)||e.push(qn(a,i,c,o)),e.push(i)):Cn(a,c,o)&&e.push(qn(a,i,c,o)),a=i;l&&e.push(e[0]),c=o}return e};var es,ts,ns,rs,os,as=[],is=[];Yn.prototype.prepare=function(){for(var e,t=this.edges,n=t.length;n--;)e=t[n].edge,e.b&&e.a||t.splice(n,1);return t.sort(Xn),t.length},nr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},rr.prototype={insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=lr(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(o=r.R,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(ar(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ir(this,r))):(o=r.L,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(ir(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ar(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,o=e.U,a=e.L,i=e.R;if(n=a?i?lr(i):a:i,o?o.L===e?o.L=n:o.R=n:this._=n,a&&i?(r=n.C,n.C=e.C,n.L=a,a.U=n,n!==i?(o=n.U,n.U=e.U,e=n.R,o.L=e,n.R=i,i.U=n):(n.U=o,o=n,e=n.R)):(r=e.C,e=n),e&&(e.U=o),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===o.L){if(t=o.R,t.C&&(t.C=!1,o.C=!0,ar(this,o),t=o.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ir(this,t),t=o.R),t.C=o.C,o.C=t.R.C=!1,ar(this,o),e=this._;break}}else if(t=o.L,t.C&&(t.C=!1,o.C=!0,ir(this,o),t=o.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,ar(this,t),t=o.L),t.C=o.C,o.C=t.L.C=!1,ir(this,o),e=this._;break}t.C=!0,e=o,o=o.U}while(!e.C);e&&(e.C=!1)}}},ui.geom.voronoi=function(e){function t(e){var t=new Array(e.length),r=l[0][0],o=l[0][1],a=l[1][0],i=l[1][1];return sr(n(e),l).cells.forEach(function(n,l){var s=n.edges,u=n.site;(t[l]=s.length?s.map(function(e){var t=e.start();return[t.x,t.y]}):u.x>=r&&u.x<=a&&u.y>=o&&u.y<=i?[[r,i],[a,i],[a,o],[r,o]]:[]).point=e[l]}),t}function n(e){return e.map(function(e,t){return{x:Math.round(a(e,t)/qi)*qi,y:Math.round(i(e,t)/qi)*qi,i:t}})}var r=On,o=Nn,a=r,i=o,l=ls;return e?t(e):(t.links=function(e){return sr(n(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return sr(n(e)).cells.forEach(function(n,r){for(var o,a=n.site,i=n.edges.sort(Xn),l=-1,s=i.length,u=i[s-1].edge,c=u.l===a?u.r:u.l;++l<s;)u,o=c,u=i[l].edge,c=u.l===a?u.r:u.l,r<o.i&&r<c.i&&cr(a,o,c)<0&&t.push([e[r],e[o.i],e[c.i]])}),t},t.x=function(e){return arguments.length?(a=je(r=e),t):r},t.y=function(e){return arguments.length?(i=je(o=e),t):o},t.clipExtent=function(e){return arguments.length?(l=null==e?ls:e,t):l===ls?null:l},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):l===ls?null:l&&l[1]},t)};var ls=[[-1e6,-1e6],[1e6,1e6]];ui.geom.delaunay=function(e){return ui.geom.voronoi().triangles(e)},ui.geom.quadtree=function(e,t,n,r,o){function a(e){function a(e,t,n,r,o,a,i,l){if(!isNaN(n)&&!isNaN(r))if(e.leaf){var s=e.x,c=e.y;if(null!=s)if(xi(s-n)+xi(c-r)<.01)u(e,t,n,r,o,a,i,l);else{var f=e.point;e.x=e.y=e.point=null,u(e,f,s,c,o,a,i,l),u(e,t,n,r,o,a,i,l)}else e.x=n,e.y=r,e.point=t}else u(e,t,n,r,o,a,i,l)}function u(e,t,n,r,o,i,l,s){var u=.5*(o+l),c=.5*(i+s),f=n>=u,d=r>=c,p=d<<1|f;e.leaf=!1,e=e.nodes[p]||(e.nodes[p]=pr()),f?o=u:l=u,d?i=c:s=c,a(e,t,n,r,o,i,l,s)}var c,f,d,p,h,v,g,m,y,x=je(l),b=je(s);if(null!=t)v=t,g=n,m=r,y=o;else if(m=y=-(v=g=1/0),f=[],d=[],h=e.length,i)for(p=0;p<h;++p)c=e[p],c.x<v&&(v=c.x),c.y<g&&(g=c.y),c.x>m&&(m=c.x),c.y>y&&(y=c.y),f.push(c.x),d.push(c.y);else for(p=0;p<h;++p){var w=+x(c=e[p],p),_=+b(c,p);w<v&&(v=w),_<g&&(g=_),w>m&&(m=w),_>y&&(y=_),f.push(w),d.push(_)}var k=m-v,z=y-g;k>z?y=g+k:m=v+z;var M=pr();if(M.add=function(e){a(M,e,+x(e,++p),+b(e,p),v,g,m,y)},M.visit=function(e){hr(e,M,v,g,m,y)},M.find=function(e){return vr(M,e[0],e[1],v,g,m,y)},p=-1,null==t){for(;++p<h;)a(M,e[p],f[p],d[p],v,g,m,y);--p}else e.forEach(M.add);return f=d=e=c=null,M}var i,l=On,s=Nn;return(i=arguments.length)?(l=fr,s=dr,3===i&&(o=n,r=t,n=t=0),a(e)):(a.x=function(e){return arguments.length?(l=e,a):l},a.y=function(e){return arguments.length?(s=e,a):s},a.extent=function(e){return arguments.length?(null==e?t=n=r=o=null:(t=+e[0][0],n=+e[0][1],r=+e[1][0],o=+e[1][1]),a):null==t?null:[[t,n],[r,o]]},a.size=function(e){return arguments.length?(null==e?t=n=r=o=null:(t=n=0,r=+e[0],o=+e[1]),a):null==t?null:[r-t,o-n]},a)},ui.interpolateRgb=gr,ui.interpolateObject=mr,ui.interpolateNumber=yr,ui.interpolateString=xr;var ss=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,us=new RegExp(ss.source,"g");ui.interpolate=br,ui.interpolators=[function(e,t){var n=typeof t;return("string"===n?tl.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?gr:xr:t instanceof le?gr:Array.isArray(t)?wr:"object"===n&&isNaN(t)?mr:yr)(e,t)}],ui.interpolateArray=wr;var cs=function(){return x},fs=ui.map({linear:cs,poly:Er,quad:function(){return Mr},cubic:function(){return Ar},sin:function(){return Sr},exp:function(){return Or},circle:function(){return Nr},elastic:Fr,back:Tr,bounce:function(){return Cr}}),ds=ui.map({in:x,out:kr,"in-out":zr,"out-in":function(e){return zr(kr(e))}});ui.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.slice(0,t):e,r=t>=0?e.slice(t+1):"in";return n=fs.get(n)||cs,r=ds.get(r)||x,_r(r(n.apply(null,ci.call(arguments,1))))},ui.interpolateHcl=qr,ui.interpolateHsl=Pr,ui.interpolateLab=Br,ui.interpolateRound=Dr,ui.transform=function(e){var t=di.createElementNS(ui.ns.prefix.svg,"g");return(ui.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new Rr(n?n.matrix:ps)})(e)},Rr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ps={a:1,b:0,c:0,d:1,e:0,f:0};ui.interpolateTransform=Zr,ui.layout={},ui.layout.bundle=function(){return function(e){for(var t=[],n=-1,r=e.length;++n<r;)t.push(Qr(e[n]));return t}},ui.layout.chord=function(){function e(){var e,u,f,d,p,h={},v=[],g=ui.range(a),m=[];for(n=[],r=[],e=0,d=-1;++d<a;){for(u=0,p=-1;++p<a;)u+=o[d][p];v.push(u),m.push(ui.range(a)),e+=u}for(i&&g.sort(function(e,t){return i(v[e],v[t])}),l&&m.forEach(function(e,t){e.sort(function(e,n){return l(o[t][e],o[t][n])})}),e=(Di-c*a)/e,u=0,d=-1;++d<a;){for(f=u,p=-1;++p<a;){var y=g[d],x=m[y][p],b=o[y][x],w=u,_=u+=b*e;h[y+"-"+x]={index:y,subindex:x,startAngle:w,endAngle:_,value:b}}r[y]={index:y,startAngle:f,endAngle:u,value:v[y]},u+=c}for(d=-1;++d<a;)for(p=d-1;++p<a;){var k=h[d+"-"+p],z=h[p+"-"+d];(k.value||z.value)&&n.push(k.value<z.value?{source:z,target:k}:{source:k,target:z})}s&&t()}function t(){n.sort(function(e,t){return s((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n,r,o,a,i,l,s,u={},c=0;return u.matrix=function(e){return arguments.length?(a=(o=e)&&o.length,n=r=null,u):o},u.padding=function(e){return arguments.length?(c=e,n=r=null,u):c},u.sortGroups=function(e){return arguments.length?(i=e,n=r=null,u):i},u.sortSubgroups=function(e){return arguments.length?(l=e,n=null,u):l},u.sortChords=function(e){return arguments.length?(s=e,n&&t(),u):s},u.chords=function(){return n||e(),n},u.groups=function(){return r||e(),r},u},ui.layout.force=function(){function e(e){return function(t,n,r,o){if(t.point!==e){var a=t.cx-e.x,i=t.cy-e.y,l=o-n,s=a*a+i*i;if(l*l/m<s){if(s<v){var u=t.charge/s;e.px-=a*u,e.py-=i*u}return!0}if(t.point&&s&&s<v){var u=t.pointCharge/s;e.px-=a*u,e.py-=i*u}}return!t.charge}}function t(e){e.px=ui.event.x,e.py=ui.event.y,s.resume()}var n,r,o,a,i,l,s={},u=ui.dispatch("start","tick","end"),c=[1,1],f=.9,d=hs,p=vs,h=-30,v=gs,g=.1,m=.64,y=[],b=[];return s.tick=function(){if((o*=.99)<.005)return n=null,u.end({type:"end",alpha:o=0}),!0;var t,r,s,d,p,v,m,x,w,_=y.length,k=b.length;for(r=0;r<k;++r)s=b[r],d=s.source,p=s.target,x=p.x-d.x,w=p.y-d.y,(v=x*x+w*w)&&(v=o*i[r]*((v=Math.sqrt(v))-a[r])/v,x*=v,w*=v,p.x-=x*(m=d.weight+p.weight?d.weight/(d.weight+p.weight):.5),p.y-=w*m,d.x+=x*(m=1-m),d.y+=w*m);if((m=o*g)&&(x=c[0]/2,w=c[1]/2,r=-1,m))for(;++r<_;)s=y[r],s.x+=(x-s.x)*m,s.y+=(w-s.y)*m;if(h)for(oo(t=ui.geom.quadtree(y),o,l),r=-1;++r<_;)(s=y[r]).fixed||t.visit(e(s));for(r=-1;++r<_;)s=y[r],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*f,s.y-=(s.py-(s.py=s.y))*f);u.tick({type:"tick",alpha:o})},s.nodes=function(e){return arguments.length?(y=e,s):y},s.links=function(e){return arguments.length?(b=e,s):b},s.size=function(e){return arguments.length?(c=e,s):c},s.linkDistance=function(e){return arguments.length?(d="function"==typeof e?e:+e,s):d},s.distance=s.linkDistance,s.linkStrength=function(e){return arguments.length?(p="function"==typeof e?e:+e,s):p},s.friction=function(e){return arguments.length?(f=+e,s):f},s.charge=function(e){return arguments.length?(h="function"==typeof e?e:+e,s):h},s.chargeDistance=function(e){return arguments.length?(v=e*e,s):Math.sqrt(v)},s.gravity=function(e){return arguments.length?(g=+e,s):g},s.theta=function(e){return arguments.length?(m=e*e,s):Math.sqrt(m)},s.alpha=function(e){return arguments.length?(e=+e,o?e>0?o=e:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:o=0})):e>0&&(u.start({type:"start",alpha:o=e}),n=Fe(s.tick)),s):o},s.start=function(){function e(e,r){if(!n){for(n=new Array(o),s=0;s<o;++s)n[s]=[];for(s=0;s<u;++s){var a=b[s];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var i,l=n[t],s=-1,c=l.length;++s<c;)if(!isNaN(i=l[s][e]))return i;return Math.random()*r}var t,n,r,o=y.length,u=b.length,f=c[0],v=c[1];for(t=0;t<o;++t)(r=y[t]).index=t,r.weight=0;for(t=0;t<u;++t)r=b[t],"number"==typeof r.source&&(r.source=y[r.source]),"number"==typeof r.target&&(r.target=y[r.target]),++r.source.weight,++r.target.weight;for(t=0;t<o;++t)r=y[t],isNaN(r.x)&&(r.x=e("x",f)),isNaN(r.y)&&(r.y=e("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof d)for(t=0;t<u;++t)a[t]=+d.call(this,b[t],t);else for(t=0;t<u;++t)a[t]=d;if(i=[],"function"==typeof p)for(t=0;t<u;++t)i[t]=+p.call(this,b[t],t);else for(t=0;t<u;++t)i[t]=p;if(l=[],"function"==typeof h)for(t=0;t<o;++t)l[t]=+h.call(this,y[t],t);else for(t=0;t<o;++t)l[t]=h;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(r||(r=ui.behavior.drag().origin(x).on("dragstart.force",eo).on("drag.force",t).on("dragend.force",to)),!arguments.length)return r;this.on("mouseover.force",no).on("mouseout.force",ro).call(r)},ui.rebind(s,u,"on")};var hs=20,vs=1,gs=1/0;ui.layout.hierarchy=function(){function e(o){var a,i=[o],l=[];for(o.depth=0;null!=(a=i.pop());)if(l.push(a),(u=n.call(e,a,a.depth))&&(s=u.length)){for(var s,u,c;--s>=0;)i.push(c=u[s]),c.parent=a,c.depth=a.depth+1;r&&(a.value=0),a.children=u}else r&&(a.value=+r.call(e,a,a.depth)||0),delete a.children;return lo(o,function(e){var n,o;t&&(n=e.children)&&n.sort(t),r&&(o=e.parent)&&(o.value+=e.value)}),l}var t=co,n=so,r=uo;return e.sort=function(n){return arguments.length?(t=n,e):t},e.children=function(t){return arguments.length?(n=t,e):n},e.value=function(t){return arguments.length?(r=t,e):r},e.revalue=function(t){return r&&(io(t,function(e){e.children&&(e.value=0)}),lo(t,function(t){var n;t.children||(t.value=+r.call(e,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},e},ui.layout.partition=function(){function e(t,n,r,o){var a=t.children;if(t.x=n,t.y=t.depth*o,t.dx=r,t.dy=o,a&&(i=a.length)){var i,l,s,u=-1;for(r=t.value?r/t.value:0;++u<i;)e(l=a[u],n,s=l.value*r,o),n+=s}}function t(e){var n=e.children,r=0;if(n&&(o=n.length))for(var o,a=-1;++a<o;)r=Math.max(r,t(n[a]));return 1+r}function n(n,a){var i=r.call(this,n,a);return e(i[0],0,o[0],o[1]/t(i[0])),i}var r=ui.layout.hierarchy(),o=[1,1];return n.size=function(e){return arguments.length?(o=e,n):o},ao(n,r)},ui.layout.pie=function(){function e(i){var l,s=i.length,u=i.map(function(n,r){return+t.call(e,n,r)}),c=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof o?o.apply(this,arguments):o)-c,d=Math.min(Math.abs(f)/s,+("function"==typeof a?a.apply(this,arguments):a)),p=d*(f<0?-1:1),h=ui.sum(u),v=h?(f-s*p)/h:0,g=ui.range(s),m=[];return null!=n&&g.sort(n===ms?function(e,t){return u[t]-u[e]}:function(e,t){return n(i[e],i[t])}),g.forEach(function(e){m[e]={data:i[e],value:l=u[e],startAngle:c,endAngle:c+=l*v+p,padAngle:d}}),m}var t=Number,n=ms,r=0,o=Di,a=0;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(o=t,e):o},e.padAngle=function(t){return arguments.length?(a=t,e):a},e};var ms={};ui.layout.stack=function(){function e(l,s){if(!(d=l.length))return l;var u=l.map(function(n,r){return t.call(e,n,r)}),c=u.map(function(t){return t.map(function(t,n){return[a.call(e,t,n),i.call(e,t,n)]})}),f=n.call(e,c,s);u=ui.permute(u,f),c=ui.permute(c,f);var d,p,h,v,g=r.call(e,c,s),m=u[0].length;for(h=0;h<m;++h)for(o.call(e,u[0][h],v=g[h],c[0][h][1]),p=1;p<d;++p)o.call(e,u[p][h],v+=c[p-1][h][1],c[p][h][1]);return l}var t=x,n=go,r=mo,o=vo,a=po,i=ho;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"==typeof t?t:ys.get(t)||go,e):n},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:xs.get(t)||mo,e):r},e.x=function(t){return arguments.length?(a=t,e):a},e.y=function(t){return arguments.length?(i=t,e):i},e.out=function(t){return arguments.length?(o=t,e):o},e};var ys=ui.map({"inside-out":function(e){var t,n,r=e.length,o=e.map(yo),a=e.map(xo),i=ui.range(r).sort(function(e,t){return o[e]-o[t]}),l=0,s=0,u=[],c=[];for(t=0;t<r;++t)n=i[t],l<s?(l+=a[n],u.push(n)):(s+=a[n],c.push(n));return c.reverse().concat(u)},reverse:function(e){return ui.range(e.length).reverse()},default:go}),xs=ui.map({silhouette:function(e){var t,n,r,o=e.length,a=e[0].length,i=[],l=0,s=[];for(n=0;n<a;++n){for(t=0,r=0;t<o;t++)r+=e[t][n][1];r>l&&(l=r),i.push(r)}for(n=0;n<a;++n)s[n]=(l-i[n])/2;return s},wiggle:function(e){var t,n,r,o,a,i,l,s,u,c=e.length,f=e[0],d=f.length,p=[];for(p[0]=s=u=0,n=1;n<d;++n){for(t=0,o=0;t<c;++t)o+=e[t][n][1];for(t=0,a=0,l=f[n][0]-f[n-1][0];t<c;++t){for(r=0,i=(e[t][n][1]-e[t][n-1][1])/(2*l);r<t;++r)i+=(e[r][n][1]-e[r][n-1][1])/l;a+=i*e[t][n][1]}p[n]=s-=o?a/o*l:0,s<u&&(u=s)}for(n=0;n<d;++n)p[n]-=u;return p},expand:function(e){var t,n,r,o=e.length,a=e[0].length,i=1/o,l=[];for(n=0;n<a;++n){for(t=0,r=0;t<o;t++)r+=e[t][n][1];if(r)for(t=0;t<o;t++)e[t][n][1]/=r;else for(t=0;t<o;t++)e[t][n][1]=i}for(n=0;n<a;++n)l[n]=0;return l},zero:mo});ui.layout.histogram=function(){function e(e,a){for(var i,l,s=[],u=e.map(n,this),c=r.call(this,u,a),f=o.call(this,c,u,a),a=-1,d=u.length,p=f.length-1,h=t?1:1/d;++a<p;)i=s[a]=[],i.dx=f[a+1]-(i.x=f[a]),i.y=0;if(p>0)for(a=-1;++a<d;)(l=u[a])>=c[0]&&l<=c[1]&&(i=s[ui.bisect(f,l,1,p)-1],i.y+=h,i.push(e[a]));return s}var t=!0,n=Number,r=ko,o=wo;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=je(t),e):r},e.bins=function(t){return arguments.length?(o="number"==typeof t?function(e){return _o(e,t)}:je(t),e):o},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},ui.layout.pack=function(){function e(e,a){var i=n.call(this,e,a),l=i[0],s=o[0],u=o[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(l.x=l.y=0,lo(l,function(e){e.r=+c(e.value)}),lo(l,Eo),r){var f=r*(t?1:Math.max(2*l.r/s,2*l.r/u))/2;lo(l,function(e){e.r+=f}),lo(l,Eo),lo(l,function(e){e.r-=f})}return No(l,s/2,u/2,t?1:1/Math.max(2*l.r/s,2*l.r/u)),i}var t,n=ui.layout.hierarchy().sort(zo),r=0,o=[1,1];return e.size=function(t){return arguments.length?(o=t,e):o},e.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,e):t},e.padding=function(t){return arguments.length?(r=+t,e):r},ao(e,n)},ui.layout.tree=function(){function e(e,o){var c=i.call(this,e,o),f=c[0],d=t(f);if(lo(d,n),d.parent.m=-d.z,io(d,r),u)io(f,a);else{var p=f,h=f,v=f;io(f,function(e){e.x<p.x&&(p=e),e.x>h.x&&(h=e),e.depth>v.depth&&(v=e)});var g=l(p,h)/2-p.x,m=s[0]/(h.x+l(h,p)/2+g),y=s[1]/(v.depth||1);io(f,function(e){e.x=(e.x+g)*m,e.y=e.depth*y})}return c}function t(e){for(var t,n={A:null,children:[e]},r=[n];null!=(t=r.pop());)for(var o,a=t.children,i=0,l=a.length;i<l;++i)r.push((a[i]=o={_:a[i],parent:t,children:(o=a[i].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=o);return n.children[0]}function n(e){var t=e.children,n=e.parent.children,r=e.i?n[e.i-1]:null;if(t.length){Bo(e);var a=(t[0].z+t[t.length-1].z)/2;r?(e.z=r.z+l(e._,r._),e.m=e.z-a):e.z=a}else r&&(e.z=r.z+l(e._,r._));e.parent.A=o(e,r,e.parent.A||n[0])}function r(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function o(e,t,n){if(t){for(var r,o=e,a=e,i=t,s=o.parent.children[0],u=o.m,c=a.m,f=i.m,d=s.m;i=qo(i),o=Co(o),i&&o;)s=Co(s),a=qo(a),a.a=e,r=i.z+f-o.z-u+l(i._,o._),r>0&&(Po(Do(i,e,n),e,r),u+=r,c+=r),f+=i.m,u+=o.m,d+=s.m,c+=a.m;i&&!qo(a)&&(a.t=i,a.m+=f-c),o&&!Co(s)&&(s.t=o,s.m+=u-d,n=e)}return n}function a(e){e.x*=s[0],e.y=e.depth*s[1]}var i=ui.layout.hierarchy().sort(null).value(null),l=To,s=[1,1],u=null;return e.separation=function(t){return arguments.length?(l=t,e):l},e.size=function(t){return arguments.length?(u=null==(s=t)?a:null,e):u?null:s},e.nodeSize=function(t){return arguments.length?(u=null==(s=t)?null:a,e):u?s:null},ao(e,i)},ui.layout.cluster=function(){function e(e,a){var i,l=t.call(this,e,a),s=l[0],u=0;lo(s,function(e){var t=e.children;t&&t.length?(e.x=Io(t),e.y=Ro(t)):(e.x=i?u+=n(e,i):0,e.y=0,i=e)});var c=Lo(s),f=Vo(s),d=c.x-n(c,f)/2,p=f.x+n(f,c)/2;return lo(s,o?function(e){e.x=(e.x-s.x)*r[0],e.y=(s.y-e.y)*r[1]}:function(e){e.x=(e.x-d)/(p-d)*r[0],e.y=(1-(s.y?e.y/s.y:1))*r[1]}),l}var t=ui.layout.hierarchy().sort(null).value(null),n=To,r=[1,1],o=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(o=null==(r=t),e):o?null:r},e.nodeSize=function(t){return arguments.length?(o=null!=(r=t),e):o?r:null},ao(e,t)},ui.layout.treemap=function(){function e(e,t){for(var n,r,o=-1,a=e.length;++o<a;)r=(n=e[o]).value*(t<0?0:t),n.area=isNaN(r)||r<=0?0:r}function t(n){var a=n.children;if(a&&a.length){var i,l,s,u=f(n),c=[],d=a.slice(),h=1/0,v="slice"===p?u.dx:"dice"===p?u.dy:"slice-dice"===p?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(e(d,u.dx*u.dy/n.value),c.area=0;(s=d.length)>0;)c.push(i=d[s-1]),c.area+=i.area,"squarify"!==p||(l=r(c,v))<=h?(d.pop(),h=l):(c.area-=c.pop().area,o(c,v,u,!1),v=Math.min(u.dx,u.dy),c.length=c.area=0,h=1/0);c.length&&(o(c,v,u,!0),c.length=c.area=0),a.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var a,i=f(t),l=r.slice(),s=[];for(e(l,i.dx*i.dy/t.value),s.area=0;a=l.pop();)s.push(a),s.area+=a.area,null!=a.z&&(o(s,a.z?i.dx:i.dy,i,!l.length),s.length=s.area=0);r.forEach(n)}}function r(e,t){for(var n,r=e.area,o=0,a=1/0,i=-1,l=e.length;++i<l;)(n=e[i].area)&&(n<a&&(a=n),n>o&&(o=n));return r*=r,t*=t,r?Math.max(t*o*h/r,r/(t*a*h)):1/0}function o(e,t,n,r){var o,a=-1,i=e.length,l=n.x,u=n.y,c=t?s(e.area/t):0;if(t==n.dx){for((r||c>n.dy)&&(c=n.dy);++a<i;)o=e[a],o.x=l,o.y=u,o.dy=c,l+=o.dx=Math.min(n.x+n.dx-l,c?s(o.area/c):0);o.z=!0,o.dx+=n.x+n.dx-l,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++a<i;)o=e[a],o.x=l,o.y=u,o.dx=c,u+=o.dy=Math.min(n.y+n.dy-u,c?s(o.area/c):0);o.z=!1,o.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function a(r){var o=i||l(r),a=o[0];return a.x=a.y=0,a.value?(a.dx=u[0],a.dy=u[1]):a.dx=a.dy=0,i&&l.revalue(a),e([a],a.dx*a.dy/a.value),(i?n:t)(a),d&&(i=o),o}var i,l=ui.layout.hierarchy(),s=Math.round,u=[1,1],c=null,f=Uo,d=!1,p="squarify",h=.5*(1+Math.sqrt(5));return a.size=function(e){return arguments.length?(u=e,a):u},a.padding=function(e){function t(t){var n=e.call(a,t,t.depth);return null==n?Uo(t):Yo(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Yo(t,e)}if(!arguments.length)return c;var r;return f=null==(c=e)?Uo:"function"==(r=typeof e)?t:"number"===r?(e=[e,e,e,e],n):n,a},a.round=function(e){return arguments.length?(s=e?Math.round:Number,a):s!=Number},a.sticky=function(e){return arguments.length?(d=e,i=null,a):d},a.ratio=function(e){return arguments.length?(h=e,a):h},a.mode=function(e){return arguments.length?(p=e+"",a):p},ao(a,l)},ui.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,o;do{n=2*Math.random()-1,r=2*Math.random()-1,o=n*n+r*r}while(!o||o>1);return e+t*n*Math.sqrt(-2*Math.log(o)/o)}},logNormal:function(){var e=ui.random.normal.apply(ui,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=ui.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t}}},ui.scale={};var bs={floor:x,ceil:x};ui.scale.linear=function(){return Qo([0,1],[0,1],br,!1)};var ws={s:1,g:1,p:1,r:1,e:1};ui.scale.log=function(){return aa(ui.scale.linear().domain([0,1]),10,!0,[1,10])};var _s=ui.format(".0e"),ks={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};ui.scale.pow=function(){return ia(ui.scale.linear(),1,[0,1])},ui.scale.sqrt=function(){return ui.scale.pow().exponent(.5)},ui.scale.ordinal=function(){return sa([],{t:"range",a:[[]]})},ui.scale.category10=function(){return ui.scale.ordinal().range(zs)},ui.scale.category20=function(){return ui.scale.ordinal().range(Ms)},ui.scale.category20b=function(){return ui.scale.ordinal().range(As)},ui.scale.category20c=function(){return ui.scale.ordinal().range(js)};var zs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(be),Ms=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(be),As=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(be),js=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(be);ui.scale.quantile=function(){return ua([],[])},ui.scale.quantize=function(){return ca(0,1,[0,1])},ui.scale.threshold=function(){return fa([.5],[0,1])},ui.scale.identity=function(){return da([0,1])},ui.svg={},ui.svg.arc=function(){function e(){var e=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+r.apply(this,arguments)),c=i.apply(this,arguments)-Ii,f=l.apply(this,arguments)-Ii,d=Math.abs(f-c),p=c>f?0:1;if(u<e&&(h=u,u=e,e=h),d>=Ri)return t(u,p)+(e?t(e,1-p):"")+"Z";var h,v,g,m,y,x,b,w,_,k,z,M,A=0,j=0,E=[];if((m=(+s.apply(this,arguments)||0)/2)&&(g=a===Es?Math.sqrt(e*e+u*u):+a.apply(this,arguments),p||(j*=-1),u&&(j=ne(g/u*Math.sin(m))),e&&(A=ne(g/e*Math.sin(m)))),u){y=u*Math.cos(c+j),x=u*Math.sin(c+j),b=u*Math.cos(f-j),w=u*Math.sin(f-j);var S=Math.abs(f-c-2*j)<=Bi?0:1;if(j&&xa(y,x,b,w)===p^S){var O=(c+f)/2;y=u*Math.cos(O),x=u*Math.sin(O),b=w=null}}else y=x=0;if(e){_=e*Math.cos(f-A),k=e*Math.sin(f-A),z=e*Math.cos(c+A),M=e*Math.sin(c+A);var N=Math.abs(c-f+2*A)<=Bi?0:1;if(A&&xa(_,k,z,M)===1-p^N){var F=(c+f)/2;_=e*Math.cos(F),k=e*Math.sin(F),z=M=null}}else _=k=0;if(d>qi&&(h=Math.min(Math.abs(u-e)/2,+o.apply(this,arguments)))>.001){v=e<u^p?0:1;var T=h,C=h;if(d<Bi){var q=null==z?[_,k]:null==b?[y,x]:qn([y,x],[z,M],[b,w],[_,k]),P=y-q[0],B=x-q[1],D=b-q[0],R=w-q[1],I=1/Math.sin(Math.acos((P*D+B*R)/(Math.sqrt(P*P+B*B)*Math.sqrt(D*D+R*R)))/2),L=Math.sqrt(q[0]*q[0]+q[1]*q[1]);C=Math.min(h,(e-L)/(I-1)),T=Math.min(h,(u-L)/(I+1))}if(null!=b){var V=ba(null==z?[_,k]:[z,M],[y,x],u,T,p),U=ba([b,w],[_,k],u,T,p);h===T?E.push("M",V[0],"A",T,",",T," 0 0,",v," ",V[1],"A",u,",",u," 0 ",1-p^xa(V[1][0],V[1][1],U[1][0],U[1][1]),",",p," ",U[1],"A",T,",",T," 0 0,",v," ",U[0]):E.push("M",V[0],"A",T,",",T," 0 1,",v," ",U[0])}else E.push("M",y,",",x);if(null!=z){var Y=ba([y,x],[z,M],e,-C,p),H=ba([_,k],null==b?[y,x]:[b,w],e,-C,p);h===C?E.push("L",H[0],"A",C,",",C," 0 0,",v," ",H[1],"A",e,",",e," 0 ",p^xa(H[1][0],H[1][1],Y[1][0],Y[1][1]),",",1-p," ",Y[1],"A",C,",",C," 0 0,",v," ",Y[0]):E.push("L",H[0],"A",C,",",C," 0 0,",v," ",Y[0])}else E.push("L",_,",",k)}else E.push("M",y,",",x),null!=b&&E.push("A",u,",",u," 0 ",S,",",p," ",b,",",w),E.push("L",_,",",k),null!=z&&E.push("A",e,",",e," 0 ",N,",",1-p," ",z,",",M);return E.push("Z"),E.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var n=ha,r=va,o=pa,a=Es,i=ga,l=ma,s=ya;return e.innerRadius=function(t){return arguments.length?(n=je(t),e):n},e.outerRadius=function(t){return arguments.length?(r=je(t),e):r},e.cornerRadius=function(t){return arguments.length?(o=je(t),e):o},e.padRadius=function(t){return arguments.length?(a=t==Es?Es:je(t),e):a},e.startAngle=function(t){return arguments.length?(i=je(t),e):i},e.endAngle=function(t){return arguments.length?(l=je(t),e):l},e.padAngle=function(t){return arguments.length?(s=je(t),e):s},e.centroid=function(){var e=(+n.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+i.apply(this,arguments)+ +l.apply(this,arguments))/2-Ii;return[Math.cos(t)*e,Math.sin(t)*e]},e};var Es="auto";ui.svg.line=function(){return wa(x)};var Ss=ui.map({linear:_a,"linear-closed":ka,step:za,"step-before":Ma,"step-after":Aa,basis:Fa,"basis-open":Ta,"basis-closed":Ca,bundle:qa,cardinal:Sa,"cardinal-open":ja,"cardinal-closed":Ea,monotone:La});Ss.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Os=[0,2/3,1/3,0],Ns=[0,1/3,2/3,0],Fs=[0,1/6,2/3,1/6];ui.svg.line.radial=function(){var e=wa(Va);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Ma.reverse=Aa,Aa.reverse=Ma,ui.svg.area=function(){return Ua(x)},ui.svg.area.radial=function(){var e=Ua(Va);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},ui.svg.chord=function(){function e(e,l){var s=t(this,a,e,l),u=t(this,i,e,l);return"M"+s.p0+r(s.r,s.p1,s.a1-s.a0)+(n(s,u)?o(s.r,s.p1,s.r,s.p0):o(s.r,s.p1,u.r,u.p0)+r(u.r,u.p1,u.a1-u.a0)+o(u.r,u.p1,s.r,s.p0))+"Z"}function t(e,t,n,r){var o=t.call(e,n,r),a=l.call(e,o,r),i=s.call(e,o,r)-Ii,c=u.call(e,o,r)-Ii;return{r:a,a0:i,a1:c,p0:[a*Math.cos(i),a*Math.sin(i)],p1:[a*Math.cos(c),a*Math.sin(c)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Bi)+",1 "+t}function o(e,t,n,r){return"Q 0,0 "+r}var a=bn,i=wn,l=Ya,s=ga,u=ma;return e.radius=function(t){return arguments.length?(l=je(t),e):l},e.source=function(t){return arguments.length?(a=je(t),e):a},e.target=function(t){return arguments.length?(i=je(t),e):i},e.startAngle=function(t){return arguments.length?(s=je(t),e):s},e.endAngle=function(t){return arguments.length?(u=je(t),e):u},e},ui.svg.diagonal=function(){function e(e,o){var a=t.call(this,e,o),i=n.call(this,e,o),l=(a.y+i.y)/2,s=[a,{x:a.x,y:l},{x:i.x,y:l},i];return s=s.map(r),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var t=bn,n=wn,r=Ha;return e.source=function(n){return arguments.length?(t=je(n),e):t},e.target=function(t){return arguments.length?(n=je(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},ui.svg.diagonal.radial=function(){var e=ui.svg.diagonal(),t=Ha,n=e.projection;return e.projection=function(e){return arguments.length?n(Xa(t=e)):t},e},ui.svg.symbol=function(){function e(e,r){return(Ts.get(t.call(this,e,r))||Wa)(n.call(this,e,r))}var t=Za,n=Ga;return e.type=function(n){return arguments.length?(t=je(n),e):t},e.size=function(t){return arguments.length?(n=je(t),e):n},e};var Ts=ui.map({circle:Wa,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*qs)),n=t*qs;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Cs),n=t*Cs/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Cs),n=t*Cs/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});ui.svg.symbolTypes=Ts.keys();var Cs=Math.sqrt(3),qs=Math.tan(30*Li);Ei.transition=function(e){for(var t,n,r=Ps||++Is,o=ei(e),a=[],i=Bs||{time:Date.now(),ease:jr,delay:0,duration:250},l=-1,s=this.length;++l<s;){a.push(t=[]);for(var u=this[l],c=-1,f=u.length;++c<f;)(n=u[c])&&ti(n,c,o,r,i),t.push(n)}return Qa(a,o,r)},Ei.interrupt=function(e){return this.each(null==e?Ds:Ja(ei(e)))};var Ps,Bs,Ds=Ja(ei()),Rs=[],Is=0;Rs.call=Ei.call,Rs.empty=Ei.empty,Rs.node=Ei.node,Rs.size=Ei.size,ui.transition=function(e,t){return e&&e.transition?Ps?e.transition(t):e:ui.selection().transition(e)},ui.transition.prototype=Rs,Rs.select=function(e){var t,n,r,o=this.id,a=this.namespace,i=[];e=S(e);for(var l=-1,s=this.length;++l<s;){i.push(t=[]);for(var u=this[l],c=-1,f=u.length;++c<f;)(r=u[c])&&(n=e.call(r,r.__data__,c,l))?("__data__"in r&&(n.__data__=r.__data__),ti(n,c,a,o,r[a][o]),t.push(n)):t.push(null)}return Qa(i,a,o)},Rs.selectAll=function(e){var t,n,r,o,a,i=this.id,l=this.namespace,s=[]
;e=O(e);for(var u=-1,c=this.length;++u<c;)for(var f=this[u],d=-1,p=f.length;++d<p;)if(r=f[d]){a=r[l][i],n=e.call(r,r.__data__,d,u),s.push(t=[]);for(var h=-1,v=n.length;++h<v;)(o=n[h])&&ti(o,h,l,i,a),t.push(o)}return Qa(s,l,i)},Rs.filter=function(e){var t,n,r,o=[];"function"!=typeof e&&(e=V(e));for(var a=0,i=this.length;a<i;a++){o.push(t=[]);for(var n=this[a],l=0,s=n.length;l<s;l++)(r=n[l])&&e.call(r,r.__data__,l,a)&&t.push(r)}return Qa(o,this.namespace,this.id)},Rs.tween=function(e,t){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(e):Y(this,null==t?function(t){t[r][n].tween.remove(e)}:function(o){o[r][n].tween.set(e,t)})},Rs.attr=function(e,t){function n(){this.removeAttribute(l)}function r(){this.removeAttributeNS(l.space,l.local)}function o(e){return null==e?n:(e+="",function(){var t,n=this.getAttribute(l);return n!==e&&(t=i(n,e),function(e){this.setAttribute(l,t(e))})})}function a(e){return null==e?r:(e+="",function(){var t,n=this.getAttributeNS(l.space,l.local);return n!==e&&(t=i(n,e),function(e){this.setAttributeNS(l.space,l.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var i="transform"==e?Zr:br,l=ui.ns.qualify(e);return Ka(this,"attr."+e,t,l.local?a:o)},Rs.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(o));return r&&function(e){this.setAttribute(o,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(o.space,o.local));return r&&function(e){this.setAttributeNS(o.space,o.local,r(e))}}var o=ui.ns.qualify(e);return this.tween("attr."+e,o.local?r:n)},Rs.style=function(e,t,r){function o(){this.style.removeProperty(e)}function a(t){return null==t?o:(t+="",function(){var o,a=n(this).getComputedStyle(this,null).getPropertyValue(e);return a!==t&&(o=br(a,t),function(t){this.style.setProperty(e,o(t),r)})})}var i=arguments.length;if(i<3){if("string"!=typeof e){i<2&&(t="");for(r in e)this.style(r,e[r],t);return this}r=""}return Ka(this,"style."+e,t,a)},Rs.styleTween=function(e,t,r){function o(o,a){var i=t.call(this,o,a,n(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(t){this.style.setProperty(e,i(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+e,o)},Rs.text=function(e){return Ka(this,"text",e,$a)},Rs.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Rs.ease=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].ease:("function"!=typeof e&&(e=ui.ease.apply(ui,arguments)),Y(this,function(r){r[n][t].ease=e}))},Rs.delay=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].delay:Y(this,"function"==typeof e?function(r,o,a){r[n][t].delay=+e.call(r,r.__data__,o,a)}:(e=+e,function(r){r[n][t].delay=e}))},Rs.duration=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].duration:Y(this,"function"==typeof e?function(r,o,a){r[n][t].duration=Math.max(1,e.call(r,r.__data__,o,a))}:(e=Math.max(1,e),function(r){r[n][t].duration=e}))},Rs.each=function(e,t){var n=this.id,r=this.namespace;if(arguments.length<2){var o=Bs,a=Ps;try{Ps=n,Y(this,function(t,o,a){Bs=t[r][n],e.call(t,t.__data__,o,a)})}finally{Bs=o,Ps=a}}else Y(this,function(o){var a=o[r][n];(a.event||(a.event=ui.dispatch("start","end","interrupt"))).on(e,t)});return this},Rs.transition=function(){for(var e,t,n,r,o=this.id,a=++Is,i=this.namespace,l=[],s=0,u=this.length;s<u;s++){l.push(e=[]);for(var t=this[s],c=0,f=t.length;c<f;c++)(n=t[c])&&(r=n[i][o],ti(n,c,i,a,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),e.push(n)}return Qa(l,i,a)},ui.svg.axis=function(){function e(e){e.each(function(){var e,u=ui.select(this),c=this.__chart__||n,f=this.__chart__=n.copy(),d=null==s?f.ticks?f.ticks.apply(f,l):f.domain():s,p=null==t?f.tickFormat?f.tickFormat.apply(f,l):x:t,h=u.selectAll(".tick").data(d,f),v=h.enter().insert("g",".domain").attr("class","tick").style("opacity",qi),g=ui.transition(h.exit()).style("opacity",qi).remove(),m=ui.transition(h.order()).style("opacity",1),y=Math.max(o,0)+i,b=Xo(f),w=u.selectAll(".domain").data([0]),_=(w.enter().append("path").attr("class","domain"),ui.transition(w));v.append("line"),v.append("text");var k,z,M,A,j=v.select("line"),E=m.select("line"),S=h.select("text").text(p),O=v.select("text"),N=m.select("text"),F="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(e=ni,k="x",M="y",z="x2",A="y2",S.attr("dy",F<0?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+b[0]+","+F*a+"V0H"+b[1]+"V"+F*a)):(e=ri,k="y",M="x",z="y2",A="x2",S.attr("dy",".32em").style("text-anchor",F<0?"end":"start"),_.attr("d","M"+F*a+","+b[0]+"H0V"+b[1]+"H"+F*a)),j.attr(A,F*o),O.attr(M,F*y),E.attr(z,0).attr(A,F*o),N.attr(k,0).attr(M,F*y),f.rangeBand){var T=f,C=T.rangeBand()/2;c=f=function(e){return T(e)+C}}else c.rangeBand?c=f:g.call(e,f,c);v.call(e,c,f),m.call(e,f,f)})}var t,n=ui.scale.linear(),r=Ls,o=6,a=6,i=3,l=[10],s=null;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(r=t in Vs?t+"":Ls,e):r},e.ticks=function(){return arguments.length?(l=fi(arguments),e):l},e.tickValues=function(t){return arguments.length?(s=t,e):s},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t){var n=arguments.length;return n?(o=+t,a=+arguments[n-1],e):o},e.innerTickSize=function(t){return arguments.length?(o=+t,e):o},e.outerTickSize=function(t){return arguments.length?(a=+t,e):a},e.tickPadding=function(t){return arguments.length?(i=+t,e):i},e.tickSubdivide=function(){return arguments.length&&e},e};var Ls="bottom",Vs={top:1,right:1,bottom:1,left:1};ui.svg.brush=function(){function e(n){n.each(function(){var n=ui.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),i=n.selectAll(".background").data([0]);i.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=n.selectAll(".resize").data(v,x);l.exit().remove(),l.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Us[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",e.empty()?"none":null);var s,f=ui.transition(n),d=ui.transition(i);u&&(s=Xo(u),d.attr("x",s[0]).attr("width",s[1]-s[0]),r(f)),c&&(s=Xo(c),d.attr("y",s[0]).attr("height",s[1]-s[0]),o(f)),t(f)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+f[+/e$/.test(e)]+","+d[+/^s/.test(e)]+")"})}function r(e){e.select(".extent").attr("x",f[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1]-f[0])}function o(e){e.select(".extent").attr("y",d[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function a(){function a(){32==ui.event.keyCode&&(S||(x=null,N[0]-=f[1],N[1]-=d[1],S=2),M())}function v(){32==ui.event.keyCode&&2==S&&(N[0]+=f[1],N[1]+=d[1],S=0,M())}function g(){var e=ui.mouse(w),n=!1;b&&(e[0]+=b[0],e[1]+=b[1]),S||(ui.event.altKey?(x||(x=[(f[0]+f[1])/2,(d[0]+d[1])/2]),N[0]=f[+(e[0]<x[0])],N[1]=d[+(e[1]<x[1])]):x=null),j&&m(e,u,0)&&(r(z),n=!0),E&&m(e,c,1)&&(o(z),n=!0),n&&(t(z),k({type:"brush",mode:S?"move":"resize"}))}function m(e,t,n){var r,o,a=Xo(t),s=a[0],u=a[1],c=N[n],v=n?d:f,g=v[1]-v[0];if(S&&(s-=c,u-=g+c),r=(n?h:p)?Math.max(s,Math.min(u,e[n])):e[n],S?o=(r+=c)+g:(x&&(c=Math.max(s,Math.min(u,2*x[n]-r))),c<r?(o=r,r=c):o=c),v[0]!=r||v[1]!=o)return n?l=null:i=null,v[0]=r,v[1]=o,!0}function y(){g(),z.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),ui.select("body").style("cursor",null),F.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),O(),k({type:"brushend"})}var x,b,w=this,_=ui.select(ui.event.target),k=s.of(w,arguments),z=ui.select(w),A=_.datum(),j=!/^(n|s)$/.test(A)&&u,E=!/^(e|w)$/.test(A)&&c,S=_.classed("extent"),O=J(w),N=ui.mouse(w),F=ui.select(n(w)).on("keydown.brush",a).on("keyup.brush",v);if(ui.event.changedTouches?F.on("touchmove.brush",g).on("touchend.brush",y):F.on("mousemove.brush",g).on("mouseup.brush",y),z.interrupt().selectAll("*").interrupt(),S)N[0]=f[0]-N[0],N[1]=d[0]-N[1];else if(A){var T=+/w$/.test(A),C=+/^n/.test(A);b=[f[1-T]-N[0],d[1-C]-N[1]],N[0]=f[T],N[1]=d[C]}else ui.event.altKey&&(x=N.slice());z.style("pointer-events","none").selectAll(".resize").style("display",null),ui.select("body").style("cursor",_.style("cursor")),k({type:"brushstart"}),g()}var i,l,s=j(e,"brushstart","brush","brushend"),u=null,c=null,f=[0,0],d=[0,0],p=!0,h=!0,v=Ys[0];return e.event=function(e){e.each(function(){var e=s.of(this,arguments),t={x:f,y:d,i:i,j:l},n=this.__chart__||t;this.__chart__=t,Ps?ui.select(this).transition().each("start.brush",function(){i=n.i,l=n.j,f=n.x,d=n.y,e({type:"brushstart"})}).tween("brush:brush",function(){var n=wr(f,t.x),r=wr(d,t.y);return i=l=null,function(o){f=t.x=n(o),d=t.y=r(o),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,l=t.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(u=t,v=Ys[!u<<1|!c],e):u},e.y=function(t){return arguments.length?(c=t,v=Ys[!u<<1|!c],e):c},e.clamp=function(t){return arguments.length?(u&&c?(p=!!t[0],h=!!t[1]):u?p=!!t:c&&(h=!!t),e):u&&c?[p,h]:u?p:c?h:null},e.extent=function(t){var n,r,o,a,s;return arguments.length?(u&&(n=t[0],r=t[1],c&&(n=n[0],r=r[0]),i=[n,r],u.invert&&(n=u(n),r=u(r)),r<n&&(s=n,n=r,r=s),n==f[0]&&r==f[1]||(f=[n,r])),c&&(o=t[0],a=t[1],u&&(o=o[1],a=a[1]),l=[o,a],c.invert&&(o=c(o),a=c(a)),a<o&&(s=o,o=a,a=s),o==d[0]&&a==d[1]||(d=[o,a])),e):(u&&(i?(n=i[0],r=i[1]):(n=f[0],r=f[1],u.invert&&(n=u.invert(n),r=u.invert(r)),r<n&&(s=n,n=r,r=s))),c&&(l?(o=l[0],a=l[1]):(o=d[0],a=d[1],c.invert&&(o=c.invert(o),a=c.invert(a)),a<o&&(s=o,o=a,a=s))),u&&c?[[n,o],[r,a]]:u?[n,r]:c&&[o,a])},e.clear=function(){return e.empty()||(f=[0,0],d=[0,0],i=l=null),e},e.empty=function(){return!!u&&f[0]==f[1]||!!c&&d[0]==d[1]},ui.rebind(e,s,"on")};var Us={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ys=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Hs=cl.format=gl.timeFormat,Xs=Hs.utc,Gs=Xs("%Y-%m-%dT%H:%M:%S.%LZ");Hs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?oi:Gs,oi.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},oi.toString=Gs.toString,cl.second=Le(function(e){return new fl(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),cl.seconds=cl.second.range,cl.seconds.utc=cl.second.utc.range,cl.minute=Le(function(e){return new fl(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),cl.minutes=cl.minute.range,cl.minutes.utc=cl.minute.utc.range,cl.hour=Le(function(e){var t=e.getTimezoneOffset()/60;return new fl(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),cl.hours=cl.hour.range,cl.hours.utc=cl.hour.utc.range,cl.month=Le(function(e){return e=cl.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),cl.months=cl.month.range,cl.months.utc=cl.month.utc.range;var Zs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ws=[[cl.second,1],[cl.second,5],[cl.second,15],[cl.second,30],[cl.minute,1],[cl.minute,5],[cl.minute,15],[cl.minute,30],[cl.hour,1],[cl.hour,3],[cl.hour,6],[cl.hour,12],[cl.day,1],[cl.day,2],[cl.week,1],[cl.month,1],[cl.month,3],[cl.year,1]],Js=Hs.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Ot]]),Qs={range:function(e,t,n){return ui.range(Math.ceil(e/n)*n,+t,n).map(ii)},floor:x,ceil:x};Ws.year=cl.year,cl.scale=function(){return ai(ui.scale.linear(),Ws,Js)};var Ks=Ws.map(function(e){return[e[0].utc,e[1]]}),$s=Xs.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Ot]]);Ks.year=cl.year.utc,cl.scale.utc=function(){return ai(ui.scale.linear(),Ks,$s)},ui.text=Ee(function(e){return e.responseText}),ui.json=function(e,t){return Se(e,"application/json",li,t)},ui.html=function(e,t){return Se(e,"text/html",si,t)},ui.xml=Ee(function(e){return e.responseXML}),"function"==typeof define&&define.amd?(this.d3=ui,define(ui)):"object"==typeof t&&t.exports?t.exports=ui:this.d3=ui}()},{}],4:[function(e,t,n){t.exports=e("./lib/heap")},{"./lib/heap":5}],5:[function(e,t,n){(function(){var e,r,o,a,i,l,s,u,c,f,d,p,h,v,g;o=Math.floor,f=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},c=function(e,t,n,a,i){var l;if(null==n&&(n=0),null==i&&(i=r),n<0)throw new Error("lo must be non-negative");for(null==a&&(a=e.length);n<a;)l=o((n+a)/2),i(t,e[l])<0?a=l:n=l+1;return[].splice.apply(e,[n,n-n].concat(t)),t},l=function(e,t,n){return null==n&&(n=r),e.push(t),v(e,0,e.length-1,n)},i=function(e,t){var n,o;return null==t&&(t=r),n=e.pop(),e.length?(o=e[0],e[0]=n,g(e,0,t)):o=n,o},u=function(e,t,n){var o;return null==n&&(n=r),o=e[0],e[0]=t,g(e,0,n),o},s=function(e,t,n){var o;return null==n&&(n=r),e.length&&n(e[0],t)<0&&(o=[e[0],t],t=o[0],e[0]=o[1],g(e,0,n)),t},a=function(e,t){var n,a,i,l,s,u;for(null==t&&(t=r),l=function(){u=[];for(var t=0,n=o(e.length/2);0<=n?t<n:t>n;0<=n?t++:t--)u.push(t);return u}.apply(this).reverse(),s=[],a=0,i=l.length;a<i;a++)n=l[a],s.push(g(e,n,t));return s},h=function(e,t,n){var o;if(null==n&&(n=r),-1!==(o=e.indexOf(t)))return v(e,0,o,n),g(e,o,n)},d=function(e,t,n){var o,i,l,u,c;if(null==n&&(n=r),i=e.slice(0,t),!i.length)return i;for(a(i,n),c=e.slice(t),l=0,u=c.length;l<u;l++)o=c[l],s(i,o,n);return i.sort(n).reverse()},p=function(e,t,n){var o,l,s,u,d,p,h,v,g;if(null==n&&(n=r),10*t<=e.length){if(s=e.slice(0,t).sort(n),!s.length)return s;for(l=s[s.length-1],h=e.slice(t),u=0,p=h.length;u<p;u++)o=h[u],n(o,l)<0&&(c(s,o,0,null,n),s.pop(),l=s[s.length-1]);return s}for(a(e,n),g=[],d=0,v=f(t,e.length);0<=v?d<v:d>v;0<=v?++d:--d)g.push(i(e,n));return g},v=function(e,t,n,o){var a,i,l;for(null==o&&(o=r),a=e[n];n>t&&(l=n-1>>1,i=e[l],o(a,i)<0);)e[n]=i,n=l;return e[n]=a},g=function(e,t,n){var o,a,i,l,s;for(null==n&&(n=r),a=e.length,s=t,i=e[t],o=2*t+1;o<a;)l=o+1,l<a&&!(n(e[o],e[l])<0)&&(o=l),e[t]=e[o],t=o,o=2*t+1;return e[t]=i,v(e,s,t,n)},e=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=l,e.pop=i,e.replace=u,e.pushpop=s,e.heapify=a,e.updateItem=h,e.nlargest=d,e.nsmallest=p,e.prototype.push=function(e){return l(this.nodes,e,this.cmp)},e.prototype.pop=function(){return i(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return s(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return a(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return h(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),function(e,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?t.exports=r():e.Heap=r()}(this,function(){return e})}).call(this)},{}],6:[function(e,t,n){n.read=function(e,t,n,r,o){var a,i,l=8*o-r-1,s=(1<<l)-1,u=s>>1,c=-7,f=n?o-1:0,d=n?-1:1,p=e[t+f];for(f+=d,a=p&(1<<-c)-1,p>>=-c,c+=l;c>0;a=256*a+e[t+f],f+=d,c-=8);for(i=a&(1<<-c)-1,a>>=-c,c+=r;c>0;i=256*i+e[t+f],f+=d,c-=8);if(0===a)a=1-u;else{if(a===s)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),a-=u}return(p?-1:1)*i*Math.pow(2,a-r)},n.write=function(e,t,n,r,o,a){var i,l,s,u=8*a-o-1,c=(1<<u)-1,f=c>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-i))<1&&(i--,s*=2),t+=i+f>=1?d/s:d*Math.pow(2,1-f),t*s>=2&&(i++,s/=2),i+f>=c?(l=0,i=c):i+f>=1?(l=(t*s-1)*Math.pow(2,o),i+=f):(l=t*Math.pow(2,f-1)*Math.pow(2,o),i=0));o>=8;e[n+p]=255&l,p+=h,l/=256,o-=8);for(i=i<<o|l,u+=o;u>0;e[n+p]=255&i,p+=h,i/=256,u-=8);e[n+p-h]|=128*v}},{}],7:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],8:[function(require,module,exports){(function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,r,o,a;for(void 0===t&&(t=15),o=.5,n=new Date;;){for(o*=2,a=o;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;if((r=new Date)-n>t)break}for(a=o;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;return r=new Date,1e3*(3*o-1)/(r-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;t<n;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+t(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),r=e/Math.pow(10,n),o=r.toPrecision(numeric.precision);return 10===parseFloat(o)&&(n++,r=1,o=r.toPrecision(numeric.precision)),parseFloat(o).toString()+"e"+n.toString()}return"Infinity"}function n(e){var o;if(void 0===e)return r.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return r.push('"'+e+'"'),!1;if("boolean"==typeof e)return r.push(e.toString()),!1;if("number"==typeof e){var a=t(e),i=e.toPrecision(numeric.precision),l=parseFloat(e.toString()).toString(),s=[a,i,l,parseFloat(i).toString(),parseFloat(l).toString()];for(o=1;o<s.length;o++)s[o].length<a.length&&(a=s[o]);return r.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(null===e)return r.push("null"),!1;if("function"==typeof e){r.push(e.toString());var u=!1;for(o in e)e.hasOwnProperty(o)&&(u?r.push(",\n"):r.push("\n{"),u=!0,r.push(o),r.push(": \n"),n(e[o]));return u&&r.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return r.push("...Large Array..."),!0;var u=!1;for(r.push("["),o=0;o<e.length;o++)o>0&&(r.push(","),u&&r.push("\n ")),u=n(e[o]);return r.push("]"),!0}r.push("{");var u=!1;for(o in e)e.hasOwnProperty(o)&&(u&&r.push(",\n"),u=!0,r.push(o),r.push(": \n"),n(e[o]));return r.push("}"),!0}var r=[];return n(e),r.join("")},numeric.parseDate=function(e){function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseFloat=function(e){function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseCSV=function(e){var t,n,r=e.split("\n"),o=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,i=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(n=0;n<r.length;n++){var s,u=(r[n]+",").match(a);if(u.length>0){for(o[l]=[],t=0;t<u.length;t++)s=function(e){return e.substr(0,e.length-1)}(u[t]),i.test(s)?o[l][t]=parseFloat(s):o[l][t]=s;l++}}return o},numeric.toCSV=function(e){var t,n,r,o,a,i=numeric.dim(e);for(r=i[0],i[1],a=[],t=0;t<r;t++){for(o=[],n=0;n<r;n++)o[n]=e[t][n].toString();a[t]=o.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var r,o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],a=-1,i=0;e.length;for(r=t;r<n;r++)i=255&(a^e[r]),a=a>>>8^o[i];return-1^a}var n,r,o,a,i,l,s,u,c,f,d=e[0].length,p=e[0][0].length,h=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(f=t(h,12,29),h[29]=f>>24&255,h[30]=f>>16&255,h[31]=f>>8&255,h[32]=255&f,n=1,r=0,s=0;s<d;s++){for(s<d-1?h.push(0):h.push(1),i=3*p+1+(0===s)&255,l=3*p+1+(0===s)>>8&255,h.push(i),h.push(l),h.push(255&~i),h.push(255&~l),0===s&&h.push(0),u=0;u<p;u++)for(o=0;o<3;o++)i=e[o][s][u],i=i>255?255:i<0?0:Math.round(i),n=(n+i)%65521,r=(r+n)%65521,h.push(i);h.push(0)}return c=(r<<16)+n,h.push(c>>24&255),h.push(c>>16&255),h.push(c>>8&255),h.push(255&c),a=h.length-41,h[33]=a>>24&255,h[34]=a>>16&255,h[35]=a>>8&255,h[36]=255&a,f=t(h,37),h.push(f>>24&255),h.push(f>>16&255),h.push(f>>8&255),h.push(255&f),h.push(0),h.push(0),h.push(0),h.push(0),h.push(73),h.push(69),h.push(78),h.push(68),h.push(174),h.push(66),h.push(96),h.push(130),"data:image/png;base64,"+function(e){var t,n,r,o,a,i,l,s,u=e.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="";for(t=0;t<u;t+=3)n=e[t],r=e[t+1],o=e[t+2],a=n>>2,i=((3&n)<<4)+(r>>4),l=((15&r)<<2)+(o>>6),s=63&o,t+1>=u?l=s=64:t+2>=u&&(s=64),f+=c.charAt(a)+c.charAt(i)+c.charAt(l)+c.charAt(s);return f}(h)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,n;return"object"==typeof e?(t=e[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var r,o;if(!(t instanceof Array&&n instanceof Array))return!1;if((o=t.length)!==n.length)return!1;for(r=0;r<o;r++)if(t[r]!==n[r]){if("object"!=typeof t[r])return!1;if(!e(t[r],n[r]))return!1}return!0},numeric.rep=function(e,t,n){void 0===n&&(n=0);var r,o=e[n],a=Array(o);if(n===e.length-1){for(r=o-2;r>=0;r-=2)a[r+1]=t,a[r]=t;return-1===r&&(a[0]=t),a}for(r=o-1;r>=0;r--)a[r]=numeric.rep(e,t,n+1);return a},numeric.dotMMsmall=function(e,t){var n,r,o,a,i,l,s,u,c,f,d;for(a=e.length,i=t.length,l=t[0].length,s=Array(a),n=a-1;n>=0;n--){for(u=Array(l),c=e[n],o=l-1;o>=0;o--){for(f=c[i-1]*t[i-1][o],r=i-2;r>=1;r-=2)d=r-1,f+=c[r]*t[r][o]+c[d]*t[d][o];0===r&&(f+=c[0]*t[0][o]),u[o]=f}s[n]=u}return s},numeric._getCol=function(e,t,n){var r,o=e.length;for(r=o-1;r>0;--r)n[r]=e[r][t],--r,n[r]=e[r][t];0===r&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,r,o,a=numeric._getCol,i=t.length,l=Array(i),s=e.length,u=t[0].length,c=new Array(s),f=numeric.dotVV;for(--i,--s,r=s;-1!==r;--r)c[r]=Array(u);for(--u,r=u;-1!==r;--r)for(a(t,r,l),o=s;-1!==o;--o)0,n=e[o],c[o][r]=f(n,l);return c},numeric.dotMV=function(e,t){var n,r=e.length,o=(t.length,Array(r)),a=numeric.dotVV;for(n=r-1;n>=0;n--)o[n]=a(e[n],t);return o},numeric.dotVM=function(e,t){var n,r,o,a,i,l,s;for(o=e.length,a=t[0].length,i=Array(a),r=a-1;r>=0;r--){for(l=e[o-1]*t[o-1][r],n=o-2;n>=1;n-=2)s=n-1,l+=e[n]*t[n][r]+e[s]*t[s][r];0===n&&(l+=e[0]*t[0][r]),i[r]=l}return i},numeric.dotVV=function(e,t){var n,r,o=e.length,a=e[o-1]*t[o-1];for(n=o-2;n>=1;n-=2)r=n-1,a+=e[n]*t[n]+e[r]*t[r];return 0===n&&(a+=e[0]*t[0]),a},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,r,o,a=e.length,i=Array(a);for(t=a-1;t>=0;t--){for(o=Array(a),n=t+2,r=a-1;r>=n;r-=2)o[r]=0,o[r-1]=0;for(r>t&&(o[r]=0),o[t]=e[t],r=t-1;r>=1;r-=2)o[r]=0,o[r-1]=0;0===r&&(o[0]=0),i[t]=o}return i},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),r=Array(n);for(t=n-1;t>=1;--t)r[t]=e[t][t],--t,r[t]=e[t][t];return 0===t&&(r[0]=e[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){void 0===n&&(n="");var r,o,a=[],i=/\[i\]$/,l="",s=!1;for(r=0;r<e.length;r++)i.test(e[r])?(o=e[r].substring(0,e[r].length-3),l=o):o=e[r],"ret"===o&&(s=!0),a.push(o);return a[e.length]="_s",a[e.length+1]="_k",a[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+l+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(s?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric.pointwise2=function(e,t,n){void 0===n&&(n="");var r,o,a=[],i=/\[i\]$/,l="",s=!1;for(r=0;r<e.length;r++)i.test(e[r])?(o=e[r].substring(0,e[r].length-3),l=o):o=e[r],"ret"===o&&(s=!0),a.push(o);return a[e.length]="var _n = "+l+".length;\nvar i"+(s?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric._biforeach=function e(t,n,r,o,a){if(o===r.length-1)return void a(t,n);var i,l=r[o];for(i=l-1;i>=0;i--)e("object"==typeof t?t[i]:t,"object"==typeof n?n[i]:n,r,o+1,a)},numeric._biforeach2=function e(t,n,r,o,a){if(o===r.length-1)return a(t,n);var i,l=r[o],s=Array(l);for(i=l-1;i>=0;--i)s[i]=e("object"==typeof t?t[i]:t,"object"==typeof n?n[i]:n,r,o+1,a);return s},numeric._foreach=function e(t,n,r,o){if(r===n.length-1)return void o(t);var a,i=n[r];for(a=i-1;a>=0;a--)e(t[a],n,r+1,o)},numeric._foreach2=function e(t,n,r,o){if(r===n.length-1)return o(t);var a,i=n[r],l=Array(i);for(a=i-1;a>=0;a--)l[a]=e(t[a],n,r+1,o);return l},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,o="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(o="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),o),
numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),o),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),o),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),o),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),o),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(o="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(o="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",o),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",o),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,r,o,a,i,l,e,s=numeric.dim(e),u=Math.abs,c=s[0],f=s[1],d=numeric.clone(e),p=numeric.identity(c);for(i=0;i<f;++i){var h=-1,v=-1;for(a=i;a!==c;++a)(l=u(d[a][i]))>v&&(h=a,v=l);for(n=d[h],d[h]=d[i],d[i]=n,o=p[h],p[h]=p[i],p[i]=o,e=n[i],l=i;l!==f;++l)n[l]/=e;for(l=f-1;-1!==l;--l)o[l]/=e;for(a=c-1;-1!==a;--a)if(a!==i){for(t=d[a],r=p[a],e=t[i],l=i+1;l!==f;++l)t[l]-=n[l]*e;for(l=f-1;l>0;--l)r[l]-=o[l]*e,--l,r[l]-=o[l]*e;0===l&&(r[0]-=o[0]*e)}}return p},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,r,o,a,i,l,s,u,c=t[0],f=1,d=numeric.clone(e);for(r=0;r<c-1;r++){for(o=r,n=r+1;n<c;n++)Math.abs(d[n][r])>Math.abs(d[o][r])&&(o=n);for(o!==r&&(s=d[o],d[o]=d[r],d[r]=s,f*=-1),a=d[r],n=r+1;n<c;n++){for(i=d[n],l=i[r]/a[r],o=r+1;o<c-1;o+=2)u=o+1,i[o]-=a[o]*l,i[u]-=a[u]*l;o!==c&&(i[o]-=a[o]*l)}if(0===a[r])return 0;f*=a[r]}return f*d[r][r]},numeric.transpose=function(e){var t,n,r,o,a,i=e.length,l=e[0].length,s=Array(l);for(n=0;n<l;n++)s[n]=Array(i);for(t=i-1;t>=1;t-=2){for(o=e[t],r=e[t-1],n=l-1;n>=1;--n)a=s[n],a[t]=o[n],a[t-1]=r[n],--n,a=s[n],a[t]=o[n],a[t-1]=r[n];0===n&&(a=s[0],a[t]=o[0],a[t-1]=r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)s[n][0]=r[n],--n,s[n][0]=r[n];0===n&&(s[0][0]=r[0])}return s},numeric.negtranspose=function(e){var t,n,r,o,a,i=e.length,l=e[0].length,s=Array(l);for(n=0;n<l;n++)s[n]=Array(i);for(t=i-1;t>=1;t-=2){for(o=e[t],r=e[t-1],n=l-1;n>=1;--n)a=s[n],a[t]=-o[n],a[t-1]=-r[n],--n,a=s[n],a[t]=-o[n],a[t-1]=-r[n];0===n&&(a=s[0],a[t]=-o[0],a[t-1]=-r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)s[n][0]=-r[n],--n,s[n][0]=-r[n];0===n&&(s[0][0]=-r[0])}return s},numeric._random=function e(t,n){var r,o,a=t[n],i=Array(a);if(n===t.length-1){for(o=Math.random,r=a-1;r>=1;r-=2)i[r]=o(),i[r-1]=o();return 0===r&&(i[0]=o()),i}for(r=a-1;r>=0;r--)i[r]=e(t,n+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if(void 0===n&&(n=Math.max(Math.round(t-e)+1,1)),n<2)return 1===n?[e]:[];var r,o=Array(n);for(n--,r=n;r>=0;r--)o[r]=(r*t+(n-r)*e)/n;return o},numeric.getBlock=function(e,t,n){function r(e,a){var i,l=t[a],s=n[a]-l,u=Array(s);if(a===o.length-1){for(i=s;i>=0;i--)u[i]=e[i+l];return u}for(i=s;i>=0;i--)u[i]=r(e[i+l],a+1);return u}var o=numeric.dim(e);return r(e,0)},numeric.setBlock=function(e,t,n,r){function o(e,r,i){var l,s=t[i],u=n[i]-s;if(i===a.length-1)for(l=u;l>=0;l--)e[l+s]=r[l];for(l=u;l>=0;l--)o(e[l+s],r[l],i+1)}var a=numeric.dim(e);return o(e,r,0),e},numeric.getRange=function(e,t,n){var r,o,a,i,l=t.length,s=n.length,u=Array(l);for(r=l-1;-1!==r;--r)for(u[r]=Array(s),a=u[r],i=e[t[r]],o=s-1;-1!==o;--o)a[o]=i[n[o]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,r,o,a,i,l=t[0],s=t[1];for(n=0,r=0,o=0;o<l;++o)n+=e[o][0].length;for(a=0;a<s;++a)r+=e[0][a][0].length;var u=Array(n);for(o=0;o<n;++o)u[o]=Array(r);var c,f,d,p,h,v=0;for(o=0;o<l;++o){for(c=r,a=s-1;-1!==a;--a)for(i=e[o][a],c-=i[0].length,d=i.length-1;-1!==d;--d)for(h=i[d],f=u[v+d],p=h.length-1;-1!==p;--p)f[c+p]=h[p];v+=e[o][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),r=numeric.dim(t);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var o,a,i,l,s=n[0],u=r[0],c=Array(s);for(a=s-1;a>=0;a--){for(o=Array(u),l=e[a],i=u-1;i>=3;--i)o[i]=l*t[i],--i,o[i]=l*t[i],--i,o[i]=l*t[i],--i,o[i]=l*t[i];for(;i>=0;)o[i]=l*t[i],--i;c[a]=o}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,r,o){numeric.indexOf;if("string"!=typeof o){var a;o="";for(a in numeric)numeric.hasOwnProperty(a)&&(e.indexOf(a)>=0||t.indexOf(a)>=0||n.indexOf(a)>=0||r.indexOf(a)>=0)&&a.length>1&&(o+="var "+a+" = numeric."+a+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+o+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,n,r,o,a,i,l,s,u,c,f,t,n,r,d,p,h,v,g,m,y,x=e.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),_=numeric.clone(e.x),k=numeric.clone(e.y);for(t=0;t<x;t++){for(h=_[t][t],v=k[t][t],d=h*h+v*v,r=t,n=t+1;n<x;n++)h=_[n][t],v=k[n][t],(p=h*h+v*v)>d&&(r=n,d=p);for(r!==t&&(y=_[t],_[t]=_[r],_[r]=y,y=k[t],k[t]=k[r],k[r]=y,y=b[t],b[t]=b[r],b[r]=y,y=w[t],w[t]=w[r],w[r]=y),o=_[t],a=k[t],s=b[t],u=w[t],h=o[t],v=a[t],n=t+1;n<x;n++)g=o[n],m=a[n],o[n]=(g*h+m*v)/d,a[n]=(m*h-g*v)/d;for(n=0;n<x;n++)g=s[n],m=u[n],s[n]=(g*h+m*v)/d,u[n]=(m*h-g*v)/d;for(n=t+1;n<x;n++){for(i=_[n],l=k[n],c=b[n],f=w[n],h=i[t],v=l[t],r=t+1;r<x;r++)g=o[r],m=a[r],i[r]-=g*h-m*v,l[r]-=m*h+g*v;for(r=0;r<x;r++)g=s[r],m=u[r],c[r]-=g*h-m*v,f[r]-=m*h+g*v}}for(t=x-1;t>0;t--)for(s=b[t],u=w[t],n=t-1;n>=0;n--)for(c=b[n],f=w[n],h=_[n][t],v=k[n][t],r=x-1;r>=0;r--)g=s[r],m=u[r],c[r]-=h*g-v*m,f[r]-=h*m+v*g;return new numeric.T(b,w)},numeric.T.prototype.get=function(e){var t,n=this.x,r=this.y,o=0,a=e.length;if(r){for(;o<a;)t=e[o],n=n[t],r=r[t],o++;return new numeric.T(n,r)}for(;o<a;)t=e[o],n=n[t],o++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,r=this.x,o=this.y,a=0,i=e.length,l=t.x,s=t.y;if(0===i)return s?this.y=s:o&&(this.y=void 0),this.x=r,this;if(s){for(o||(o=numeric.rep(numeric.dim(r),0),this.y=o);a<i-1;)n=e[a],r=r[n],o=o[n],a++;return n=e[a],r[n]=l,o[n]=s,this}if(o){for(;a<i-1;)n=e[a],r=r[n],o=o[n],a++;return n=e[a],r[n]=l,l instanceof Array?o[n]=numeric.rep(numeric.dim(l),0):o[n]=0,this}for(;a<i-1;)n=e[a],r=r[n],a++;return n=e[a],r[n]=l,this},numeric.T.prototype.getRows=function(e,t){var n,r,o=t-e+1,a=Array(o),i=this.x,l=this.y;for(n=e;n<=t;n++)a[n-e]=i[n];if(l){for(r=Array(o),n=e;n<=t;n++)r[n-e]=l[n];return new numeric.T(a,r)}return new numeric.T(a)},numeric.T.prototype.setRows=function(e,t,n){var r,o=this.x,a=this.y,i=n.x,l=n.y;for(r=e;r<=t;r++)o[r]=i[r-e];if(l)for(a||(a=numeric.rep(numeric.dim(o),0),this.y=a),r=e;r<=t;r++)a[r]=l[r-e];else if(a)for(r=e;r<=t;r++)a[r]=numeric.rep([i[r-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,r=this.y,o=t.x,a=t.y;return n[e]=o,a?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[e]=a):r&&(r=numeric.rep([o.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,r=this.y,o=numeric.getBlock;return r?new numeric.T(o(n,e,t),o(r,e,t)):new numeric.T(o(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,o=this.y,a=numeric.setBlock,i=n.x,l=n.y;if(l)return o||(this.y=numeric.rep(numeric.dim(this),0),o=this.y),a(r,e,t,i),a(o,e,t,l),this;a(r,e,t,i),o&&a(o,e,t,numeric.rep(numeric.dim(i),0))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var r=t.x,o=t.y,a=numeric.rep;return o?new n(a(e,r),a(e,o)):new n(a(e,r))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,r=numeric.diag;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=e[0]>=0?1:-1,r=n*numeric.norm2(e);t[0]+=r;var o=numeric.norm2(t);if(0===o)throw new Error("eig: internal error");return numeric.div(t,o)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,o,a,i,l,s,u,c,f,d=t[0],p=numeric.clone(e),h=numeric.identity(d);for(r=0;r<d-2;r++){for(a=Array(d-r-1),n=r+1;n<d;n++)a[n-r-1]=p[n][r];if(numeric.norm2(a)>0){for(i=numeric.house(a),l=numeric.getBlock(p,[r+1,r],[d-1,d-1]),s=numeric.tensor(i,numeric.dot(i,l)),n=r+1;n<d;n++)for(u=p[n],c=s[n-r-1],o=r;o<d;o++)u[o]-=2*c[o-r];for(l=numeric.getBlock(p,[0,r+1],[d-1,d-1]),s=numeric.tensor(numeric.dot(l,i),i),n=0;n<d;n++)for(u=p[n],c=s[n],o=r+1;o<d;o++)u[o]-=2*c[o-r-1];for(l=Array(d-r-1),n=r+1;n<d;n++)l[n-r-1]=h[n];for(s=numeric.tensor(i,numeric.dot(i,l)),n=r+1;n<d;n++)for(f=h[n],c=s[n-r-1],o=0;o<d;o++)f[o]-=2*c[o]}}return{H:p,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);var n,r,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b=(numeric.clone(e),numeric.dim(e)),w=b[0],_=numeric.identity(w);if(w<3)return{Q:_,B:[[0,w-1]]};var k=numeric.epsilon;for(x=0;x<t;x++){for(m=0;m<w-1;m++)if(Math.abs(e[m+1][m])<k*(Math.abs(e[m][m])+Math.abs(e[m+1][m+1]))){var z=numeric.QRFrancis(numeric.getBlock(e,[0,0],[m,m]),t),M=numeric.QRFrancis(numeric.getBlock(e,[m+1,m+1],[w-1,w-1]),t);for(p=Array(m+1),g=0;g<=m;g++)p[g]=_[g];for(h=numeric.dot(z.Q,p),g=0;g<=m;g++)_[g]=h[g];for(p=Array(w-m-1),g=m+1;g<w;g++)p[g-m-1]=_[g];for(h=numeric.dot(M.Q,p),g=m+1;g<w;g++)_[g]=h[g-m-1];return{Q:_,B:z.B.concat(numeric.add(M.B,m+1))}}if(o=e[w-2][w-2],a=e[w-2][w-1],i=e[w-1][w-2],l=e[w-1][w-1],u=o+l,s=o*l-a*i,c=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*s){var A,j;A=.5*(u+Math.sqrt(u*u-4*s)),j=.5*(u-Math.sqrt(u*u-4*s)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,A+j)),numeric.diag(numeric.rep([3],A*j)))}else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],s)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),p=[e[0],e[1],e[2]],h=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(d=e[g],v=h[g],y=0;y<w;y++)d[y]-=2*v[y];for(p=numeric.getBlock(e,[0,0],[w-1,2]),h=numeric.tensor(numeric.dot(p,r),r),g=0;g<w;g++)for(d=e[g],v=h[g],y=0;y<3;y++)d[y]-=2*v[y];for(p=[_[0],_[1],_[2]],h=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(f=_[g],v=h[g],y=0;y<w;y++)f[y]-=2*v[y];var E;for(m=0;m<w-2;m++){for(y=m;y<=m+1;y++)if(Math.abs(e[y+1][y])<k*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var z=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),M=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[w-1,w-1]),t);for(p=Array(y+1),g=0;g<=y;g++)p[g]=_[g];for(h=numeric.dot(z.Q,p),g=0;g<=y;g++)_[g]=h[g];for(p=Array(w-y-1),g=y+1;g<w;g++)p[g-y-1]=_[g];for(h=numeric.dot(M.Q,p),g=y+1;g<w;g++)_[g]=h[g-y-1];return{Q:_,B:z.B.concat(numeric.add(M.B,y+1))}}for(E=Math.min(w-1,m+3),n=Array(E-m),g=m+1;g<=E;g++)n[g-m-1]=e[g][m];for(r=numeric.house(n),p=numeric.getBlock(e,[m+1,m],[E,w-1]),h=numeric.tensor(r,numeric.dot(r,p)),g=m+1;g<=E;g++)for(d=e[g],v=h[g-m-1],y=m;y<w;y++)d[y]-=2*v[y-m];for(p=numeric.getBlock(e,[0,m+1],[w-1,E]),h=numeric.tensor(numeric.dot(p,r),r),g=0;g<w;g++)for(d=e[g],v=h[g],y=m+1;y<=E;y++)d[y]-=2*v[y-m-1];for(p=Array(E-m),g=m+1;g<=E;g++)p[g-m-1]=_[g];for(h=numeric.tensor(r,numeric.dot(r,p)),g=m+1;g<=E;g++)for(f=_[g],v=h[g-m-1],y=0;y<w;y++)f[y]-=2*v[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,r,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x=numeric.toUpperHessenberg(e),b=numeric.QRFrancis(x.H,t),w=numeric.T,_=e.length,k=b.B,z=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),M=new w(numeric.dot(b.Q,x.Q)),A=k.length,j=Math.sqrt;for(r=0;r<A;r++)if((n=k[r][0])===k[r][1]);else{if(a=n+1,i=z[n][n],l=z[n][a],s=z[a][n],u=z[a][a],0===l&&0===s)continue;c=-i-u,f=i*u-l*s,d=c*c-4*f,d>=0?(p=c<0?-.5*(c-j(d)):-.5*(c+j(d)),m=(i-p)*(i-p)+l*l,y=s*s+(u-p)*(u-p),m>y?(m=j(m),v=(i-p)/m,g=l/m):(y=j(y),v=s/y,g=(u-p)/y),o=new w([[g,-v],[v,g]]),M.setRows(n,a,o.dot(M.getRows(n,a)))):(p=-.5*c,h=.5*j(-d),m=(i-p)*(i-p)+l*l,y=s*s+(u-p)*(u-p),m>y?(m=j(m+h*h),v=(i-p)/m,g=l/m,p=0,h/=m):(y=j(y+h*h),v=s/y,g=(u-p)/y,p=h/y,h=0),o=new w([[g,-v],[v,g]],[[p,h],[h,-p]]),M.setRows(n,a,o.dot(M.getRows(n,a))))}var E=M.dot(e).dot(M.transjugate()),_=e.length,S=numeric.T.identity(_);for(a=0;a<_;a++)if(a>0)for(r=a-1;r>=0;r--){var O=E.get([r,r]),N=E.get([a,a]);numeric.neq(O.x,N.x)||numeric.neq(O.y,N.y)?(p=E.getRow(r).getBlock([r],[a-1]),h=S.getRow(a).getBlock([r],[a-1]),S.set([a,r],E.get([r,a]).neg().sub(p.dot(h)).div(O.sub(N)))):S.setRow(a,S.getRow(r))}for(a=0;a<_;a++)p=S.getRow(a),S.setRow(a,p.div(p.norm2()));return S=S.transpose(),S=M.transjugate().dot(S),{lambda:E.getDiag(),E:S}},numeric.ccsSparse=function(e){var t,n,r,o,a=e.length,i=[];for(r=a-1;-1!==r;--r){n=e[r];for(o in n){for(o=parseInt(o);o>=i.length;)i[i.length]=0;0!==n[o]&&i[o]++}}var t=i.length,l=Array(t+1);for(l[0]=0,r=0;r<t;++r)l[r+1]=l[r]+i[r];var s=Array(l[t]),u=Array(l[t]);for(r=a-1;-1!==r;--r){n=e[r];for(o in n)0!==n[o]&&(i[o]--,s[l[o]+i[o]]=r,u[l[o]+i[o]]=n[o])}return[l,s,u]},numeric.ccsFull=function(e){var t,n,r,o,a=e[0],i=e[1],l=e[2],s=numeric.ccsDim(e),u=s[0],c=s[1],f=numeric.rep([u,c],0);for(t=0;t<c;t++)for(r=a[t],o=a[t+1],n=r;n<o;++n)f[i[n]][t]=l[n];return f},numeric.ccsTSolve=function(e,t,n,r,o){function a(e){var t;if(0===n[e]){for(n[e]=1,t=i[e];t<i[e+1];++t)a(l[t]);o[f]=e,++f}}var i=e[0],l=e[1],s=e[2],u=i.length-1,c=Math.max,f=0;void 0===r&&(n=numeric.rep([u],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===o&&(o=[]);var d,p,h,v,g,m,y;for(d=r.length-1;-1!==d;--d)a(r[d]);for(o.length=f,d=o.length-1;-1!==d;--d)n[o[d]]=0;for(d=r.length-1;-1!==d;--d)p=r[d],n[p]=t[p];for(d=o.length-1;-1!==d;--d){for(p=o[d],h=i[p],v=c(i[p+1],h),g=h;g!==v;++g)if(l[g]===p){n[p]/=s[g];break}for(y=n[p],g=h;g!==v;++g)(m=l[g])!==p&&(n[m]-=y*s[g])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,r,o,a){var i,l,s,u=0,c=o.length,f=this.k,d=this.k1,p=this.j;if(0===r[e])for(r[e]=1,p[0]=e,f[0]=l=t[e],d[0]=s=t[e+1];;)if(l>=s){if(o[c]=p[u],0===u)return;++c,--u,l=f[u],s=d[u]}else i=a[n[l]],0===r[i]?(r[i]=1,f[u]=l,++u,p[u]=i,l=t[i],d[u]=s=t[i+1]):++l},numeric.ccsLPSolve=function(e,t,n,r,o,a,i){var l,s,u,c,f,d,p,h,v,g=e[0],m=e[1],y=e[2],x=(g.length,t[0]),b=t[1],w=t[2];for(s=x[o],u=x[o+1],r.length=0,l=s;l<u;++l)i.dfs(a[b[l]],g,m,n,r,a);for(l=r.length-1;-1!==l;--l)n[r[l]]=0;for(l=s;l!==u;++l)c=a[b[l]],n[c]=w[l];for(l=r.length-1;-1!==l;--l){for(c=r[l],f=g[c],d=g[c+1],p=f;p<d;++p)if(a[m[p]]===c){n[c]/=y[p];break}for(v=n[c],p=f;p<d;++p)(h=a[m[p]])!==c&&(n[h]-=v*y[p])}return n},numeric.ccsLUP1=function(e,t){var n,r,o,a,i,l,s,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],f=[numeric.rep([u+1],0),[],[]],d=c[0],p=c[1],h=c[2],v=f[0],g=f[1],m=f[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,k,z),a=-1,i=-1,r=x.length-1;-1!==r;--r)(o=x[r])<=n||(l=w(y[o]))>a&&(i=o,a=l);for(w(y[n])<t*a&&(r=_[n],a=_[i],_[n]=a,k[a]=n,_[i]=r,k[r]=i,a=y[n],y[n]=y[i],y[i]=a),a=d[n],i=v[n],s=y[n],p[a]=_[n],h[a]=1,++a,r=x.length-1;-1!==r;--r)o=x[r],l=y[o],x[r]=0,y[o]=0,o<=n?(g[i]=o,m[i]=l,++i):(p[a]=_[o],h[a]=l/s,++a);d[n+1]=a,v[n+1]=i}for(r=p.length-1;-1!==r;--r)p[r]=k[p[r]];return{L:c,U:f,P:_,Pinv:k}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,r,o,a,i){var l,s,u,c=0,f=o.length,d=this.k,p=this.k1,h=this.j;if(0===r[e])for(r[e]=1,h[0]=e,d[0]=s=t[a[e]],p[0]=u=t[a[e]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=u){if(o[f]=a[h[c]],0===c)return;++f,--c,s=d[c],u=p[c]}else l=n[s],0===r[l]?(r[l]=1,d[c]=s,++c,h[c]=l,l=a[l],s=t[l],p[c]=u=t[l+1]):++s}},numeric.ccsLPSolve0=function(e,t,n,r,o,a,i,l){var s,u,c,f,d,p,h,v,g,m=e[0],y=e[1],x=e[2],b=(m.length,t[0]),w=t[1],_=t[2];for(u=b[o],c=b[o+1],r.length=0,s=u;s<c;++s)l.dfs(w[s],m,y,n,r,a,i);for(s=r.length-1;-1!==s;--s)f=r[s],n[i[f]]=0;for(s=u;s!==c;++s)f=w[s],n[f]=_[s];for(s=r.length-1;-1!==s;--s){for(f=r[s],v=i[f],d=m[f],p=m[f+1],h=d;h<p;++h)if(y[h]===v){n[v]/=x[h];break}for(g=n[v],h=d;h<p;++h)n[y[h]]-=g*x[h];n[v]=g}},numeric.ccsLUP0=function(e,t){var n,r,o,a,i,l,s,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],f=[numeric.rep([u+1],0),[],[]],d=c[0],p=c[1],h=c[2],v=f[0],g=f[1],m=f[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS0(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,k,_,z),a=-1,i=-1,r=x.length-1;-1!==r;--r)(o=x[r])<=n||(l=w(y[_[o]]))>a&&(i=o,a=l);for(w(y[_[n]])<t*a&&(r=_[n],a=_[i],_[n]=a,k[a]=n,_[i]=r,k[r]=i),a=d[n],i=v[n],s=y[_[n]],p[a]=_[n],h[a]=1,++a,r=x.length-1;-1!==r;--r)o=x[r],l=y[_[o]],x[r]=0,y[_[o]]=0,o<=n?(g[i]=o,m[i]=l,++i):(p[a]=_[o],h[a]=l/s,++a);d[n+1]=a,v[n+1]=i}for(r=p.length-1;-1!==r;--r)p[r]=k[p[r]];return{L:c,U:f,P:_,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var r=numeric.ccsDim(e),o=r[0],a=r[1];void 0===t?t=numeric.linspace(0,o-1):"number"==typeof t&&(t=[t]),void 0===n?n=numeric.linspace(0,a-1):"number"==typeof n&&(n=[n]);var i,l,s,u,c,f=t.length,d=n.length,p=numeric.rep([a],0),h=[],v=[],g=[p,h,v],m=e[0],y=e[1],x=e[2],b=numeric.rep([o],0),w=0,_=numeric.rep([o],0);for(l=0;l<d;++l){u=n[l];var k=m[u],z=m[u+1];for(i=k;i<z;++i)s=y[i],_[s]=1,b[s]=x[i];for(i=0;i<f;++i)c=t[i],_[c]&&(h[w]=i,v[w]=b[t[i]],++w);for(i=k;i<z;++i)s=y[i],_[s]=0;p[l+1]=w}return g},numeric.ccsDot=function(e,t){var n,r,o,a,i,l,s,u,c,f,d,p=e[0],h=e[1],v=e[2],g=t[0],m=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),w=x[0],_=(x[1],b[1]),k=numeric.rep([w],0),z=numeric.rep([w],0),M=Array(w),A=numeric.rep([_],0),j=[],E=[],S=[A,j,E];for(o=0;o!==_;++o){for(a=g[o],i=g[o+1],c=0,r=a;r<i;++r)for(f=m[r],d=y[r],l=p[f],s=p[f+1],n=l;n<s;++n)u=h[n],0===z[u]&&(M[c]=u,z[u]=1,c+=1),k[u]=k[u]+v[n]*d;for(a=A[o],i=a+c,A[o+1]=i,r=c-1;-1!==r;--r)d=a+r,n=M[r],j[d]=n,E[d]=k[n],z[n]=0,k[n]=0;A[o+1]=A[o]+c}return S},numeric.ccsLUPSolve=function(e,t){var n=e.L,r=e.U,o=(e.P,t[0]),a=!1;"object"!=typeof o&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],o=t[0],a=!0);var i,l,s,u,c,f,d=t[1],p=t[2],h=n[0].length-1,v=o.length-1,g=numeric.rep([h],0),m=Array(h),y=numeric.rep([h],0),x=Array(h),b=numeric.rep([v+1],0),w=[],_=[],k=numeric.ccsTSolve,z=0;for(i=0;i<v;++i){for(c=0,s=o[i],u=o[i+1],l=s;l<u;++l)f=e.Pinv[d[l]],x[c]=f,y[f]=p[l],++c;for(x.length=c,k(n,y,g,x,m),l=x.length-1;-1!==l;--l)y[x[l]]=0;if(k(r,g,y,m,x),a)return y;for(l=m.length-1;-1!==l;--l)g[m[l]]=0;for(l=x.length-1;-1!==l;--l)f=x[l],w[z]=f,_[z]=y[f],y[f]=0,++z;b[i+1]=z}return[b,w,_]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],r=e[1],o=e[2],a=numeric.sup(r)+1,i=n.length,l=numeric.rep([a],0),s=Array(i),u=Array(i),c=numeric.rep([a],0);for(t=0;t<i;++t)c[r[t]]++;for(t=0;t<a;++t)l[t+1]=l[t]+c[t];var f,d,p=l.slice(0);for(t=0;t<i;++t)d=r[t],f=p[d],s[f]=n[t],u[f]=o[t],p[d]=p[d]+1;return[l,s,u]},numeric.ccsGather=function(e){var t,n,r,o,a,i=e[0],l=e[1],s=e[2],u=i.length-1,c=l.length,f=Array(c),d=Array(c),p=Array(c);for(a=0,t=0;t<u;++t)for(r=i[t],o=i[t+1],n=r;n!==o;++n)d[a]=t,f[a]=l[n],p[a]=s[n],++a;return[f,d,p]},numeric.sdim=function e(t,n,r){if(void 0===n&&(n=[]),"object"!=typeof t)return n;void 0===r&&(r=0),r in n||(n[r]=0),t.length>n[r]&&(n[r]=t.length);var o;for(o in t)t.hasOwnProperty(o)&&e(t[o],n,r+1);return n},numeric.sclone=function e(t,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(t).length);var o,a=Array(t.length);if(n===r-1){for(o in t)t.hasOwnProperty(o)&&(a[o]=t[o]);return a}for(o in t)t.hasOwnProperty(o)&&(a[o]=e(t[o],n+1,r));return a},numeric.sdiag=function(e){var t,n,r=e.length,o=Array(r);for(t=r-1;t>=1;t-=2)n=t-1,o[t]=[],o[t][t]=e[t],o[n]=[],o[n][n]=e[n];return 0===t&&(o[0]=[],o[0][0]=e[t]),o},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,n,r,o=[];e.length;for(t in e)if(e.hasOwnProperty(t)){r=e[t];for(n in r)r.hasOwnProperty(n)&&("object"!=typeof o[n]&&(o[n]=[]),o[n][t]=r[n])}return o},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,r,o,a,i,l,s,u=e.length,c=(t.length,numeric.stranspose(t)),f=c.length,d=Array(u);for(o=u-1;o>=0;o--){for(s=[],n=e[o],i=f-1;i>=0;i--){l=0,r=c[i];for(a in n)n.hasOwnProperty(a)&&a in r&&(l+=n[a]*r[a]);l&&(s[i]=l)}d[o]=s}return d},numeric.sdotMV=function(e,t){var n,r,o,a,i=e.length,l=Array(i);for(r=i-1;r>=0;r--){n=e[r],a=0;for(o in n)n.hasOwnProperty(o)&&t[o]&&(a+=n[o]*t[o]);a&&(l[r]=a)}return l},numeric.sdotVM=function(e,t){var n,r,o,a,i=[];for(n in e)if(e.hasOwnProperty(n)){o=t[n],a=e[n];for(r in o)o.hasOwnProperty(r)&&(i[r]||(i[r]=0),i[r]+=a*o[r])}return i},numeric.sdotVV=function(e,t){var n,r=0;for(n in e)e[n]&&t[n]&&(r+=e[n]*t[n]);return r},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,r=numeric.sdim(t).length;switch(1e3*n+r){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(e){var t,n,r,o,a=e[0].length,i=e.length,l=[];for(n=a-1;n>=0;--n)if(e[i-1][n]){for(o=l,r=0;r<i-2;r++)t=e[r][n],o[t]||(o[t]=[]),o=o[t];o[e[r][n]]=e[r+1][n]}return l},numeric.sgather=function e(t,n,r){void 0===n&&(n=[]),void 0===r&&(r=[]);var o,a,i;o=r.length;for(a in t)if(t.hasOwnProperty(a))if(r[o]=parseInt(a),"number"==typeof(i=t[a])){if(i){if(0===n.length)for(a=o+1;a>=0;--a)n[a]=[];for(a=o;a>=0;--a)n[a].push(r[a]);n[o+1].push(i)}}else e(i,n,r);return r.length>o&&r.pop(),n},numeric.cLU=function(e){var t,n,r,o,a,i,l=e[0],s=e[1],u=e[2],c=l.length,f=0;for(t=0;t<c;t++)l[t]>f&&(f=l[t]);f++;var d,p,h,v=Array(f),g=Array(f),m=numeric.rep([f],1/0),y=numeric.rep([f],-1/0);for(r=0;r<c;r++)t=l[r],n=s[r],n<m[t]&&(m[t]=n),n>y[t]&&(y[t]=n);for(t=0;t<f-1;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=f-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);var x=0,b=0;for(t=0;t<f;t++)g[t]=numeric.rep([y[t]-m[t]+1],0),v[t]=numeric.rep([t-m[t]],0),x+=t-m[t]+1,b+=y[t]-t+1;for(r=0;r<c;r++)t=l[r],g[t][s[r]-m[t]]=u[r];for(t=0;t<f-1;t++)for(o=t-m[t],d=g[t],n=t+1;m[n]<=t&&n<f;n++)if(a=t-m[n],i=y[t]-t,p=g[n],h=p[a]/d[o]){for(r=1;r<=i;r++)p[r+a]-=h*d[r+o];v[n][t-m[n]]=h}var c,w,_,d=[],p=[],k=[],z=[],M=[],A=[];for(c=0,w=0,t=0;t<f;t++){for(o=m[t],a=y[t],_=g[t],n=t;n<=a;n++)_[n-o]&&(d[c]=t,p[c]=n,k[c]=_[n-o],c++);for(_=v[t],n=o;n<t;n++)_[n-o]&&(z[w]=t,M[w]=n,A[w]=_[n-o],w++);z[w]=t,M[w]=t,A[w]=1,w++}return{U:[d,p,k],L:[z,M,A]}},numeric.cLUsolve=function(e,t){var n,r,o=e.L,a=e.U,i=numeric.clone(t),l=o[0],s=o[1],u=o[2],c=a[0],f=a[1],d=a[2],p=c.length,h=(l.length,i.length);for(r=0,n=0;n<h;n++){for(;s[r]<n;)i[n]-=u[r]*i[s[r]],r++;r++}for(r=p-1,n=h-1;n>=0;n--){for(;f[r]>n;)i[n]-=d[r]*i[f[r]],r--;i[n]/=d[r],r--}return i},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,r,o,a=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(e,t){return!0}}for(o=0,n=1;n<e[0]-1;n++)for(r=1;r<e[1]-1;r++)t(n,r)&&(a[n][r]=o,o++);return a},numeric.cdelsq=function(e){var t,n,r,o,a,i=[[-1,0],[0,-1],[0,1],[1,0]],l=numeric.dim(e),s=l[0],u=l[1],c=[],f=[],d=[];for(t=1;t<s-1;t++)for(n=1;n<u-1;n++)if(!(e[t][n]<0)){for(r=0;r<4;r++)o=t+i[r][0],a=n+i[r][1],e[o][a]<0||(c.push(e[t][n]),f.push(e[o][a]),d.push(-1));c.push(e[t][n]),f.push(e[t][n]),d.push(4)}return[c,f,d]},numeric.cdotMV=function(e,t){var n,r,o,a=e[0],i=e[1],l=e[2],s=a.length;for(o=0,r=0;r<s;r++)a[r]>o&&(o=a[r]);for(o++,n=numeric.rep([o],0),r=0;r<s;r++)n[a[r]]+=l[r]*t[i[r]];return n},numeric.Spline=function(e,t,n,r,o){this.x=e,this.yl=t,this.yr=n,this.kl=r,this.kr=o},numeric.Spline.prototype._at=function(e,t){var e,n,r,o,a=this.x,i=this.yl,l=this.yr,s=this.kl,u=this.kr,c=numeric.add,f=numeric.sub,d=numeric.mul;n=f(d(s[t],a[t+1]-a[t]),f(l[t+1],i[t])),r=c(d(u[t+1],a[t]-a[t+1]),f(l[t+1],i[t])),o=(e-a[t])/(a[t+1]-a[t]);var p=o*(1-o);return c(c(c(d(1-o,i[t]),d(o,l[t+1])),d(n,p*(1-o))),d(r,p*o))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,r,o=this.x,a=o.length,i=Math.floor;for(t=0,n=a-1;n-t>1;)r=i((t+n)/2),o[r]<=e?t=r:n=r;return this._at(e,t)}var l,a=e.length,s=Array(a);for(l=a-1;-1!==l;--l)s[l]=this.at(e[l]);return s},numeric.Spline.prototype.diff=function(){
var e,t,n,r=this.x,o=this.yl,a=this.yr,i=this.kl,l=this.kr,s=o.length,u=i,c=l,f=Array(s),d=Array(s),p=numeric.add,h=numeric.mul,v=numeric.div,g=numeric.sub;for(e=s-1;-1!==e;--e)t=r[e+1]-r[e],n=g(a[e+1],o[e]),f[e]=v(p(h(n,6),h(i[e],-4*t),h(l[e+1],-2*t)),t*t),d[e+1]=v(p(h(n,-6),h(i[e],2*t),h(l[e+1],4*t)),t*t);return new numeric.Spline(r,u,c,f,d)},numeric.Spline.prototype.roots=function(){var e=[],t=this.x,n=this.yl,r=this.yr,o=this.kl,a=this.kr;"number"==typeof n[0]&&(n=[n],r=[r],o=[o],a=[a]);var i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S=n.length,O=t.length-1,e=Array(S),N=Math.sqrt;for(i=0;i!==S;++i){for(u=n[i],c=r[i],f=o[i],d=a[i],p=[],l=0;l!==O;l++){for(l>0&&c[l]*u[l]<0&&p.push(t[l]),w=t[l+1]-t[l],t[l],g=u[l],m=c[l+1],h=f[l]/w,v=d[l+1]/w,b=function(e){return e*e}(h-v+3*(g-m))+12*v*g,y=v+3*g+2*h-3*m,x=3*(v+h+2*(g-m)),b<=0?(k=y/x,_=k>t[l]&&k<t[l+1]?[t[l],k,t[l+1]]:[t[l],t[l+1]]):(k=(y-N(b))/x,z=(y+N(b))/x,_=[t[l]],k>t[l]&&k<t[l+1]&&_.push(k),z>t[l]&&z<t[l+1]&&_.push(z),_.push(t[l+1])),A=_[0],k=this._at(A,l),s=0;s<_.length-1;s++)if(j=_[s+1],z=this._at(j,l),0!==k)if(0===z||k*z>0)A=j,k=z;else{for(var F=0;;){if((E=(k*j-z*A)/(k-z))<=A||E>=j)break;if((M=this._at(E,l))*z>0)j=E,z=M,-1===F&&(k*=.5),F=-1;else{if(!(M*k>0))break;A=E,k=M,1===F&&(z*=.5),F=1}}p.push(E),A=_[s+1],k=this._at(A,l)}else p.push(A),A=j,k=z;0===z&&p.push(j)}e[i]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(e,t,n,r){var o,a=e.length,i=[],l=[],s=[],u=numeric.sub,c=numeric.mul,f=numeric.add;for(o=a-2;o>=0;o--)l[o]=e[o+1]-e[o],s[o]=u(t[o+1],t[o]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var d=[[],[],[]];switch(typeof n){case"undefined":i[0]=c(3/(l[0]*l[0]),s[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/l[0],1/l[0]);break;case"string":i[0]=f(c(3/(l[a-2]*l[a-2]),s[a-2]),c(3/(l[0]*l[0]),s[0])),d[0].push(0,0,0),d[1].push(a-2,0,1),d[2].push(1/l[a-2],2/l[a-2]+2/l[0],1/l[0]);break;default:i[0]=n,d[0].push(0),d[1].push(0),d[2].push(1)}for(o=1;o<a-1;o++)i[o]=f(c(3/(l[o-1]*l[o-1]),s[o-1]),c(3/(l[o]*l[o]),s[o])),d[0].push(o,o,o),d[1].push(o-1,o,o+1),d[2].push(1/l[o-1],2/l[o-1]+2/l[o],1/l[o]);switch(typeof r){case"undefined":i[a-1]=c(3/(l[a-2]*l[a-2]),s[a-2]),d[0].push(a-1,a-1),d[1].push(a-2,a-1),d[2].push(1/l[a-2],2/l[a-2]);break;case"string":d[1][d[1].length-1]=0;break;default:i[a-1]=r,d[0].push(a-1),d[1].push(a-1),d[2].push(1)}i="number"!=typeof i[0]?numeric.transpose(i):[i];var p=Array(i.length);if("string"==typeof n)for(o=p.length-1;-1!==o;--o)p[o]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),i[o]),p[o][a-1]=p[o][0];else for(o=p.length-1;-1!==o;--o)p[o]=numeric.cLUsolve(numeric.cLU(d),i[o]);return p="number"==typeof t[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,t,t,p,p)},numeric.fftpow2=function e(t,n){var r=t.length;if(1!==r){var o,a,i=Math.cos,l=Math.sin,s=Array(r/2),u=Array(r/2),c=Array(r/2),f=Array(r/2);for(a=r/2,o=r-1;-1!==o;--o)--a,c[a]=t[o],f[a]=n[o],--o,s[a]=t[o],u[a]=n[o];e(s,u),e(c,f),a=r/2;var d,p,h,v=-6.283185307179586/r;for(o=r-1;-1!==o;--o)--a,-1===a&&(a=r/2-1),d=v*o,p=i(d),h=l(d),t[o]=s[a]+p*c[a]-h*f[a],n[o]=u[a]+p*f[a]+h*c[a]}},numeric._ifftpow2=function e(t,n){var r=t.length;if(1!==r){var o,a,i=Math.cos,l=Math.sin,s=Array(r/2),u=Array(r/2),c=Array(r/2),f=Array(r/2);for(a=r/2,o=r-1;-1!==o;--o)--a,c[a]=t[o],f[a]=n[o],--o,s[a]=t[o],u[a]=n[o];e(s,u),e(c,f),a=r/2;var d,p,h,v=6.283185307179586/r;for(o=r-1;-1!==o;--o)--a,-1===a&&(a=r/2-1),d=v*o,p=i(d),h=l(d),t[o]=s[a]+p*c[a]-h*f[a],n[o]=u[a]+p*f[a]+h*c[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,r){numeric.fftpow2(e,t),numeric.fftpow2(n,r);var o,a,i,l,s,u=e.length;for(o=u-1;-1!==o;--o)a=e[o],l=t[o],i=n[o],s=r[o],e[o]=a*i-l*s,t[o]=a*s+l*i;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,n=this.x,r=this.y,o=n.length,a=Math.log,i=a(2),l=Math.ceil(a(2*o-1)/i),s=Math.pow(2,l),u=numeric.rep([s],0),c=numeric.rep([s],0),f=Math.cos,d=Math.sin,p=-3.141592653589793/o,h=numeric.rep([s],0),v=numeric.rep([s],0);Math.floor(o/2);for(e=0;e<o;e++)h[e]=n[e];if(void 0!==r)for(e=0;e<o;e++)v[e]=r[e];for(u[0]=1,e=1;e<=s/2;e++)t=p*e*e,u[e]=f(t),c[e]=d(t),u[s-e]=f(t),c[s-e]=d(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),g=g.mul(m),g.x.length=o,g.y.length=o,g},numeric.T.prototype.ifft=function(){var e,t,n=this.x,r=this.y,o=n.length,a=Math.log,i=a(2),l=Math.ceil(a(2*o-1)/i),s=Math.pow(2,l),u=numeric.rep([s],0),c=numeric.rep([s],0),f=Math.cos,d=Math.sin,p=3.141592653589793/o,h=numeric.rep([s],0),v=numeric.rep([s],0);Math.floor(o/2);for(e=0;e<o;e++)h[e]=n[e];if(void 0!==r)for(e=0;e<o;e++)v[e]=r[e];for(u[0]=1,e=1;e<=s/2;e++)t=p*e*e,u[e]=f(t),c[e]=d(t),u[s-e]=f(t),c[s-e]=d(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),g=g.mul(m),g.x.length=o,g.y.length=o,g.div(o)},numeric.gradient=function(e,t){var n=t.length,r=e(t);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var o,a,i,l,s,u,c,f,d,p=Math.max,h=numeric.clone(t),v=Array(n),p=(numeric.div,numeric.sub,Math.max),g=Math.abs,m=Math.min,y=0;for(o=0;o<n;o++)for(var x=p(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(h[o]=t[o]+x,a=e(h),h[o]=t[o]-x,i=e(h),h[o]=t[o],isNaN(a)||isNaN(i))x/=16;else{if(v[o]=(a-i)/(2*x),l=t[o]-x,s=t[o],u=t[o]+x,c=(a-r)/x,f=(r-i)/x,d=p(g(v[o]),g(r),g(a),g(i),g(l),g(s),g(u),1e-8),!(m(p(g(c-v[o]),g(f-v[o]),g(c-f))/d,x/d)>.001))break;x/=16}}return v},numeric.uncmin=function(e,t,n,r,o,a,i){var l=numeric.gradient;void 0===i&&(i={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(t){return l(e,t)}),void 0===o&&(o=1e3),t=numeric.clone(t);var s,u,c=t.length,f=e(t);if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,p=numeric.norm2;n=d(n,numeric.epsilon);var h,v,g,m,y,x,b,w,_,k,z=i.Hinv||numeric.identity(c),M=numeric.dot,A=(numeric.inv,numeric.sub),j=numeric.add,E=numeric.tensor,S=numeric.div,O=numeric.mul,N=numeric.all,F=numeric.isFinite,T=numeric.neg,C=0,q="";for(v=r(t);C<o;){if("function"==typeof a&&a(C,t,f,v,z)){q="Callback returned true";break}if(!N(F(v))){q="Gradient has Infinity or NaN";break}if(h=T(M(z,v)),!N(F(h))){q="Search direction has Infinity or NaN";break}if((k=p(h))<n){q="Newton step smaller than tol";break}for(_=1,u=M(v,h),y=t;C<o&&!(_*k<n)&&(m=O(h,_),y=j(t,m),(s=e(y))-f>=.1*_*u||isNaN(s));)_*=.5,++C;if(_*k<n){q="Line search step size smaller than tol";break}if(C===o){q="maxit reached during line search";break}g=r(y),x=A(g,v),w=M(x,m),b=M(z,x),z=A(j(z,O((w+M(x,b))/(w*w),E(m,m))),S(j(E(b,m),E(m,b)),w)),t=y,f=s,v=g,++C}return{solution:t,f:f,gradient:v,invHessian:z,iterations:C,message:q}},numeric.Dopri=function(e,t,n,r,o,a,i){this.x=e,this.y=t,this.f=n,this.ymid=r,this.iterations=o,this.events=i,this.message=a},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var r,o,a,i,l,s,e,u,c,f,d,p=this,h=p.x,v=p.y,g=p.f,m=p.ymid,y=(h.length,Math.floor,numeric.add),x=numeric.mul,b=numeric.sub;return r=h[t],o=h[t+1],i=v[t],l=v[t+1],u=o-r,a=r+.5*u,s=m[t],c=b(g[t],x(i,1/(r-a)+2/(r-o))),f=b(g[t+1],x(l,1/(o-a)+2/(o-r))),d=[n(e-o)*(e-a)/n(r-o)/(r-a),n(e-r)*n(e-o)/n(r-a)/n(o-a),n(e-r)*(e-a)/n(o-r)/(o-a),(e-r)*n(e-o)*(e-a)/n(r-o)/(r-a),(e-o)*n(e-r)*(e-a)/n(r-o)/(o-a)],y(y(y(y(x(i,d[0]),x(s,d[1])),x(l,d[2])),x(c,d[3])),x(f,d[4]))},numeric.Dopri.prototype.at=function(e){var t,n,r,o=Math.floor;if("number"!=typeof e){var a=e.length,i=Array(a);for(t=a-1;-1!==t;--t)i[t]=this.at(e[t]);return i}var l=this.x;for(t=0,n=l.length-1;n-t>1;)r=o(.5*(t+n)),l[r]<=e?t=r:n=r;return this._at(e,t)},numeric.dopri=function(e,t,n,r,o,a,i){void 0===o&&(o=1e-6),void 0===a&&(a=1e3);var l,s,u,c,f,d,p,h,v,g,m,y,x,b=[e],w=[n],_=[r(e,n)],k=[],z=[.075,.225],M=[44/45,-56/15,32/9],A=[19372/6561,-25360/2187,64448/6561,-212/729],j=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],E=[35/384,0,500/1113,125/192,-2187/6784,11/84],S=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],O=[.2,.3,.8,8/9,1,1],N=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],F=0,T=(t-e)/10,C=0,q=numeric.add,P=numeric.mul,B=(Math.max,Math.min),D=Math.abs,R=numeric.norminf,I=Math.pow,L=numeric.any,V=numeric.lt,U=numeric.and,Y=(numeric.sub,new numeric.Dopri(b,w,_,k,-1,""));for("function"==typeof i&&(m=i(e,n));e<t&&C<a;)if(++C,e+T>t&&(T=t-e),l=r(e+O[0]*T,q(n,P(.2*T,_[F]))),s=r(e+O[1]*T,q(q(n,P(z[0]*T,_[F])),P(z[1]*T,l))),u=r(e+O[2]*T,q(q(q(n,P(M[0]*T,_[F])),P(M[1]*T,l)),P(M[2]*T,s))),c=r(e+O[3]*T,q(q(q(q(n,P(A[0]*T,_[F])),P(A[1]*T,l)),P(A[2]*T,s)),P(A[3]*T,u))),f=r(e+O[4]*T,q(q(q(q(q(n,P(j[0]*T,_[F])),P(j[1]*T,l)),P(j[2]*T,s)),P(j[3]*T,u)),P(j[4]*T,c))),v=q(q(q(q(q(n,P(_[F],T*E[0])),P(s,T*E[2])),P(u,T*E[3])),P(c,T*E[4])),P(f,T*E[5])),d=r(e+T,v),p=q(q(q(q(q(P(_[F],T*N[0]),P(s,T*N[2])),P(u,T*N[3])),P(c,T*N[4])),P(f,T*N[5])),P(d,T*N[6])),(g="number"==typeof p?D(p):R(p))>o){if(T=.2*T*I(o/g,.25),e+T===e){Y.msg="Step size became too small";break}}else{if(k[F]=q(q(q(q(q(q(n,P(_[F],T*S[0])),P(s,T*S[2])),P(u,T*S[3])),P(c,T*S[4])),P(f,T*S[5])),P(d,T*S[6])),++F,b[F]=e+T,w[F]=v,_[F]=d,"function"==typeof i){var H,X,G=e,Z=e+.5*T;if(y=i(Z,k[F-1]),x=U(V(m,0),V(0,y)),L(x)||(G=Z,Z=e+T,m=y,y=i(Z,v),x=U(V(m,0),V(0,y))),L(x)){for(var W,J,Q=0,K=1,$=1;;){if("number"==typeof m)X=($*y*G-K*m*Z)/($*y-K*m);else for(X=Z,h=m.length-1;-1!==h;--h)m[h]<0&&y[h]>0&&(X=B(X,($*y[h]*G-K*m[h]*Z)/($*y[h]-K*m[h])));if(X<=G||X>=Z)break;H=Y._at(X,F-1),J=i(X,H),W=U(V(m,0),V(0,J)),L(W)?(Z=X,y=J,x=W,$=1,-1===Q?K*=.5:K=1,Q=-1):(G=X,m=J,K=1,1===Q?$*=.5:$=1,Q=1)}return v=Y._at(.5*(e+X),F-1),Y.f[F]=r(X,H),Y.x[F]=X,Y.y[F]=H,Y.ymid[F-1]=v,Y.events=x,Y.iterations=C,Y}}e+=T,n=v,m=y,T=B(.8*T*I(o/g,.25),4*T)}return Y.iterations=C,Y},numeric.LU=function(e,t){t=t||!1;var n,r,o,a,i,l,s,u,c,f=Math.abs,d=e.length,p=d-1,h=new Array(d);for(t||(e=numeric.clone(e)),o=0;o<d;++o){for(s=o,l=e[o],c=f(l[o]),r=o+1;r<d;++r)a=f(e[r][o]),c<a&&(c=a,s=r);for(h[o]=s,s!=o&&(e[o]=e[s],e[s]=l,l=e[o]),i=l[o],n=o+1;n<d;++n)e[n][o]/=i;for(n=o+1;n<d;++n){for(u=e[n],r=o+1;r<p;++r)u[r]-=u[o]*l[r],++r,u[r]-=u[o]*l[r];r===p&&(u[r]-=u[o]*l[r])}}return{LU:e,P:h}},numeric.LUsolve=function(e,t){var n,r,o,a,i,l=e.LU,s=l.length,u=numeric.clone(t),c=e.P;for(n=s-1;-1!==n;--n)u[n]=t[n];for(n=0;n<s;++n)for(o=c[n],c[n]!==n&&(i=u[n],u[n]=u[o],u[o]=i),a=l[n],r=0;r<n;++r)u[n]-=u[r]*a[r];for(n=s-1;n>=0;--n){for(a=l[n],r=n+1;r<s;++r)u[n]-=u[r]*a[r];u[n]/=a[n]}return u},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,r,o,a,i,l,s,u=numeric.dim(e),c=u[0],f=u[1],d=numeric.identity(c),p=Array(c),h=Math.abs,v=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(r=0,a=e[t],i=d[t],n=1;n<f;++n)h(a[r])<h(a[n])&&(r=n);for(p[t]=r,v(i,a[r]),v(a,a[r]),n=0;n<c;++n)if(n!==t){for(l=e[n],s=l[r],o=f-1;-1!==o;--o)l[o]-=a[o]*s;for(l=d[n],o=c-1;-1!==o;--o)l[o]-=i[o]*s}}return{I:d,A:e,P:p}},numeric.__solveLP=function(e,t,n,r,o,a,i){var l,s,u,c,f=numeric.sum,d=(numeric.log,numeric.mul),p=numeric.sub,h=numeric.dot,v=numeric.div,g=numeric.add,m=e.length,y=n.length,x=!1,b=1,w=(numeric.transpose(t),numeric.svd,numeric.transpose),_=(numeric.leq,Math.sqrt),k=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),M=numeric.all,A=numeric.gt,j=Array(m),E=Array(y),S=(numeric.rep([y],1),numeric.solve),O=p(n,h(t,a)),N=h(e,e);for(u=0;u<o;++u){var F,T;for(F=y-1;-1!==F;--F)E[F]=v(t[F],O[F]);var C=w(E);for(F=m-1;-1!==F;--F)j[F]=f(C[F]);b=.25*k(N/h(e,j));var q=100*_(N/h(j,j));for((!isFinite(b)||b>q)&&(b=q),c=g(e,d(b,j)),s=h(C,E),F=m-1;-1!==F;--F)s[F][F]+=1;T=S(s,v(c,b),!0);var P=v(O,h(t,T)),B=1;for(F=y-1;-1!==F;--F)P[F]<0&&(B=z(B,-.999*P[F]));if(l=p(a,d(T,B)),O=p(n,h(t,l)),!M(A(O,0)))return{solution:a,message:"",iterations:u};if(a=l,b<r)return{solution:l,message:"",iterations:u};if(i){var D=h(e,c),R=h(t,c);for(x=!0,F=y-1;-1!==F;--F)if(D*R[F]<0){x=!1;break}}else x=!(a[m-1]>=0);if(x)return{solution:l,message:"Unbounded",iterations:u}}return{solution:a,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,n,r,o){var a,i=e.length,l=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([i],0).concat([1])),f=numeric.rep([l,1],-1),d=numeric.blockMatrix([[t,f]]),p=n,a=numeric.rep([i],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(c,d,p,r,o,a,!1),v=numeric.clone(h.solution);if(v.length=i,numeric.inf(s(n,u(t,v)))<0)return{solution:NaN,message:"Infeasible",iterations:h.iterations};var g=numeric.__solveLP(e,t,n,r,o-h.iterations,v,!0);return g.iterations+=h.iterations,g},numeric.solveLP=function(e,t,n,r,o,a,i){if(void 0===i&&(i=1e3),void 0===a&&(a=numeric.epsilon),void 0===r)return numeric._solveLP(e,t,n,a,i);var l,s=r.length,u=r[0].length,c=t.length,f=numeric.echelonize(r),d=numeric.rep([u],0),p=f.P,h=[];for(l=p.length-1;-1!==l;--l)d[p[l]]=1;for(l=u-1;-1!==l;--l)0===d[l]&&h.push(l);var v=numeric.getRange,g=numeric.linspace(0,s-1),m=numeric.linspace(0,c-1),y=v(r,g,h),x=v(t,m,p),b=v(t,m,h),w=numeric.dot,_=numeric.sub,k=w(x,f.I),z=_(b,w(k,y)),M=_(n,w(k,o)),A=Array(p.length),j=Array(h.length);for(l=p.length-1;-1!==l;--l)A[l]=e[p[l]];for(l=h.length-1;-1!==l;--l)j[l]=e[h[l]];var E=_(j,w(A,w(f.I,y))),S=numeric._solveLP(E,z,M,a,i),O=S.solution;if(O!==O)return S;var N=w(f.I,_(o,w(y,O))),F=Array(e.length);for(l=p.length-1;-1!==l;--l)F[p[l]]=N[l];for(l=h.length-1;-1!==l;--l)F[h[l]]=O[l];return{solution:F,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(e){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+e[n]+"\nCurrent state: "+l[i]+"\n")}e instanceof String&&e.split("\n");var n,r,o,a,i=0,l=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,u=0,c={},f=[],d=0,p={},h=0,v=[],g=[],m=[];for(n=0;n<s;++n){o=e[n];var y=o.match(/\S*/g),x=[];for(r=0;r<y.length;++r)""!==y[r]&&x.push(y[r]);if(0!==x.length){for(r=0;r<l.length&&o.substr(0,l[r].length)!==l[r];++r);if(r<l.length){if(i=r,1===r&&(a=x[1]),6===r)return{name:a,c:v,A:numeric.transpose(g),b:m,rows:c,vars:p}}else switch(i){case 0:case 1:t("Unexpected line");case 2:switch(x[0]){case"N":0===u?u=x[1]:t("Two or more N rows");break;case"L":c[x[1]]=d,f[d]=1,m[d]=0,++d;break;case"G":c[x[1]]=d,f[d]=-1,m[d]=0,++d;break;case"E":c[x[1]]=d,f[d]=0,m[d]=0,++d;break;default:t("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=h,v[h]=0,g[h]=numeric.rep([d],0),++h);var b=p[x[0]];for(r=1;r<x.length;r+=2)if(x[r]!==u){var w=c[x[r]];g[b][w]=(f[w]<0?-1:1)*parseFloat(x[r+1])}else v[b]=parseFloat(x[r+1]);break;case 4:for(r=1;r<x.length;r+=2)m[c[x[r]]]=(f[c[x[r]]]<0?-1:1)*parseFloat(x[r+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,o,a,i){function l(e){var t,r,o=this,a=e.length,i=0,l=o.i=o.j=o.m=0;for(o.S=[],o.c=[],a||(e=[a++]);i<n;)o.S[i]=i++;for(i=0;i<n;i++)t=o.S[i],l=c(l+t+e[i%a]),r=o.S[l],o.S[i]=r,o.S[l]=t;o.g=function(e){var t=o.S,r=c(o.i+1),a=t[r],i=c(o.j+a),l=t[i];t[r]=l,t[i]=a;for(var s=t[c(a+l)];--e;)r=c(r+1),a=t[r],i=c(i+a),l=t[i],t[r]=l,t[i]=a,s=s*n+t[c(a+l)];return o.i=r,o.j=i,s},o.g(n)}function s(e,t,n,r,o){if(n=[],o=typeof e,t&&"object"==o)for(r in e)if(r.indexOf("S")<5)try{n.push(s(e[r],t-1))}catch(e){}return n.length?n:e+("string"!=o?"\0":"")}function u(e,t,n,r){for(e+="",n=0,r=0;r<e.length;r++)t[c(r)]=c((n^=19*t[c(r)])+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function c(e){return e&n-1}t.seedrandom=function(r,c){var f,d=[];return r=u(s(c?[r,e]:arguments.length?r:[(new Date).getTime(),e,window],3),d),f=new l(d),u(f.S,e),t.random=function(){for(var e=f.g(6),t=i,r=0;e<o;)e=(e+r)*n,t*=n,r=f.g(1);for(;e>=a;)e/=2,t/=2,r>>>=1;return(e+r)/t},r},i=t.pow(n,6),o=t.pow(2,o),a=2*o,u(t.random(),e)}([],numeric.seedrandom,256,0,52),function(e){function t(e){if("object"!=typeof e)return e;var n,r=[],o=e.length;for(n=0;n<o;n++)r[n+1]=t(e[n]);return r}function n(e){if("object"!=typeof e)return e;var t,r=[],o=e.length;for(t=1;t<o;t++)r[t-1]=n(e[t]);return r}function r(e,t,n){var r,o,a,i,l;for(a=1;a<=n;a+=1){for(e[a][a]=1/e[a][a],l=-e[a][a],r=1;r<a;r+=1)e[r][a]=l*e[r][a];if(i=a+1,n<i)break;for(o=i;o<=n;o+=1)for(l=e[a][o],e[a][o]=0,r=1;r<=a;r+=1)e[r][o]=e[r][o]+l*e[r][a]}}function o(e,t,n,r){var o,a,i,l;for(a=1;a<=n;a+=1){for(l=0,o=1;o<a;o+=1)l+=e[o][a]*r[o];r[a]=(r[a]-l)/e[a][a]}for(i=1;i<=n;i+=1)for(a=n+1-i,r[a]=r[a]/e[a][a],l=-r[a],o=1;o<a;o+=1)r[o]=r[o]+l*e[o][a]}function a(e,t,n,r){var o,a,i,l,s,u;for(a=1;a<=n;a+=1){if(r[1]=a,u=0,(i=a-1)<1){if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}else{for(l=1;l<=i;l+=1){for(s=e[l][a],o=1;o<l;o+=1)s-=e[o][a]*e[o][l];s/=e[l][l],e[l][a]=s,u+=s*s}if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}r[1]=0}}function i(e,t,n,i,l,s,u,c,f,d,p,h,v,g,m,y){function x(){return m[O+v]=m[O+v+1],m[O+v+1]=0,h[v]=0,v-=1,g[2]=g[2]+1,0}var b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X;F=Math.min(i,d),_=2*i+F*(F+5)/2+2*d+1,U=1e-60;do{U+=U,Y=1+.1*U,H=1+.2*U}while(Y<=1||H<=1);for(b=1;b<=i;b+=1)m[b]=t[b];for(b=i+1;b<=_;b+=1)m[b]=0;for(b=1;b<=d;b+=1)h[b]=0;if(z=[],0===y[1]){if(a(e,n,i,z),0!==z[1])return void(y[1]=2);o(e,n,i,t),r(e,n,i)}else{for(w=1;w<=i;w+=1)for(l[w]=0,b=1;b<=w;b+=1)l[w]=l[w]+e[b][w]*t[b];for(w=1;w<=i;w+=1)for(t[w]=0,b=w;b<=i;b+=1)t[w]=t[w]+e[w][b]*l[b]}for(s[1]=0,w=1;w<=i;w+=1)for(l[w]=t[w],s[1]=s[1]+m[w]*l[w],m[w]=0,b=w+1;b<=i;b+=1)e[b][w]=0;for(s[1]=-s[1]/2,y[1]=0,A=i,j=A+i,O=j+F,E=O+F+1,S=E+F*(F+1)/2,T=S+d,b=1;b<=d;b+=1){for(q=0,w=1;w<=i;w+=1)q+=u[w][b]*u[w][b];m[T+b]=Math.sqrt(q)}for(v=0,g[1]=0,g[2]=0,X=0;;){if(999===(X=function(){for(g[1]=g[1]+1,_=S,b=1;b<=d;b+=1){for(_+=1,q=-c[b],w=1;w<=i;w+=1)q+=u[w][b]*l[w];if(Math.abs(q)<U&&(q=0),b>p)m[_]=q;else if(m[_]=-Math.abs(q),q>0){for(w=1;w<=i;w+=1)u[w][b]=-u[w][b];c[b]=-c[b]}}for(b=1;b<=v;b+=1)m[S+h[b]]=0;for(N=0,C=0,b=1;b<=d;b+=1)m[S+b]<C*m[T+b]&&(N=b,C=m[S+b]/m[T+b]);return 0===N?999:0}()))return;for(;;){if(0===(X=function(){for(b=1;b<=i;b+=1){for(q=0,w=1;w<=i;w+=1)q+=e[w][b]*u[w][N];m[b]=q}for(k=A,b=1;b<=i;b+=1)m[k+b]=0;for(w=v+1;w<=i;w+=1)for(b=1;b<=i;b+=1)m[k+b]=m[k+b]+e[b][w]*m[w];for(L=!0,b=v;b>=1;b-=1){for(q=m[b],_=E+b*(b+3)/2,k=_-b,w=b+1;w<=v;w+=1)q-=m[_]*m[j+w],_+=w;if(q/=m[k],m[j+b]=q,h[b]<p)break;if(q<0)break;L=!1,M=b}if(!L)for(P=m[O+M]/m[j+M],b=1;b<=v&&!(h[b]<p)&&!(m[j+b]<0);b+=1)(C=m[O+b]/m[j+b])<P&&(P=C,M=b);for(q=0,b=A+1;b<=A+i;b+=1)q+=m[b]*m[b];if(Math.abs(q)<=U){if(L)return y[1]=1,999;for(b=1;b<=v;b+=1)m[O+b]=m[O+b]-P*m[j+b];return m[O+v+1]=m[O+v+1]+P,700}for(q=0,b=1;b<=i;b+=1)q+=m[A+b]*u[b][N];for(B=-m[S+N]/q,V=!0,L||P<B&&(B=P,V=!1),b=1;b<=i;b+=1)l[b]=l[b]+B*m[A+b],Math.abs(l[b])<U&&(l[b]=0);for(s[1]=s[1]+B*q*(B/2+m[O+v+1]),b=1;b<=v;b+=1)m[O+b]=m[O+b]-B*m[j+b];if(m[O+v+1]=m[O+v+1]+B,!V){for(q=-c[N],w=1;w<=i;w+=1)q+=l[w]*u[w][N];if(N>p)m[S+N]=q;else if(m[S+N]=-Math.abs(q),q>0){for(w=1;w<=i;w+=1)u[w][N]=-u[w][N];c[N]=-c[N]}return 700}for(v+=1,h[v]=N,_=E+(v-1)*v/2+1,b=1;b<=v-1;b+=1)m[_]=m[b],_+=1;if(v===i)m[_]=m[i];else{for(b=i;b>=v+1&&0!==m[b]&&(D=Math.max(Math.abs(m[b-1]),Math.abs(m[b])),R=Math.min(Math.abs(m[b-1]),Math.abs(m[b])),C=m[b-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[b-1]/C,R=m[b]/C,1!==D);b-=1)if(0===D)for(m[b-1]=R*C,w=1;w<=i;w+=1)C=e[w][b-1],e[w][b-1]=e[w][b],e[w][b]=C;else for(m[b-1]=C,I=R/(1+D),w=1;w<=i;w+=1)C=D*e[w][b-1]+R*e[w][b],e[w][b]=I*(e[w][b-1]+C)-e[w][b],e[w][b-1]=C;m[_]=m[v]}return 0}()))break;if(999===X)return;if(700===X)if(M===v)x();else{for(;;)if(function(){if(_=E+M*(M+1)/2+1,k=_+M,0===m[k])return 798;if(D=Math.max(Math.abs(m[k-1]),Math.abs(m[k])),R=Math.min(Math.abs(m[k-1]),Math.abs(m[k])),C=m[k-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[k-1]/C,R=m[k]/C,1===D)return 798;if(0===D){for(b=M+1;b<=v;b+=1)C=m[k-1],m[k-1]=m[k],m[k]=C,k+=b;for(b=1;b<=i;b+=1)C=e[b][M],e[b][M]=e[b][M+1],e[b][M+1]=C}else{for(I=R/(1+D),b=M+1;b<=v;b+=1)C=D*m[k-1]+R*m[k],m[k]=I*(m[k-1]+C)-m[k],m[k-1]=C,k+=b;for(b=1;b<=i;b+=1)C=D*e[b][M]+R*e[b][M+1],e[b][M+1]=I*(e[b][M]+C)-e[b][M+1],e[b][M]=C}}(),797!==(X=function(){for(k=_-M,b=1;b<=M;b+=1)m[k]=m[_],_+=1,k+=1;return m[O+M]=m[O+M+1],h[M]=h[M+1],M+=1,M<v?797:0}()))break;x()}}}}function l(e,r,o,a,l,s){e=t(e),r=t(r),o=t(o);var u,c,f,d,p,h,v=[],g=[],m=[],y=[],x=[];if(l=l||0,s=s?t(s):[void 0,0],a=a?t(a):[],c=e.length-1,f=o[1].length-1,!a)for(u=1;u<=f;u+=1)a[u]=0;for(u=1;u<=f;u+=1)g[u]=0;for(d=0,p=Math.min(c,f),u=1;u<=c;u+=1)m[u]=0;for(v[1]=0,u=1;u<=2*c+p*(p+5)/2+2*f+1;u+=1)y[u]=0;for(u=1;u<=2;u+=1)x[u]=0;return i(e,r,c,c,m,v,o,a,c,f,l,g,d,x,y,s),h="",1===s[1]&&(h="constraints are inconsistent, no solution!"),2===s[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(v),unconstrained_solution:n(r),iterations:n(x),iact:n(g),message:h}}e.solveQP=l}(numeric),numeric.svd=function(e){function t(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var n,r=numeric.epsilon,o=1e-64/r,a=0,i=0,l=0,s=0,u=0,c=numeric.clone(e),f=c.length,d=c[0].length;if(f<d)throw"Need more rows than columns";var p=new Array(d),h=new Array(d);for(i=0;i<d;i++)p[i]=h[i]=0;var v=numeric.rep([d,d],0),g=0,m=0,y=0,x=0,b=0,w=0,_=0;for(i=0;i<d;i++){for(p[i]=m,_=0,u=i+1,l=i;l<f;l++)_+=c[l][i]*c[l][i];if(_<=o)m=0;else for(g=c[i][i],m=Math.sqrt(_),g>=0&&(m=-m),y=g*m-_,c[i][i]=g-m,l=u;l<d;l++){for(_=0,s=i;s<f;s++)_+=c[s][i]*c[s][l];for(g=_/y,s=i;s<f;s++)c[s][l]+=g*c[s][i]}for(h[i]=m,_=0,l=u;l<d;l++)_+=c[i][l]*c[i][l];if(_<=o)m=0;else{for(g=c[i][i+1],m=Math.sqrt(_),g>=0&&(m=-m),y=g*m-_,c[i][i+1]=g-m,l=u;l<d;l++)p[l]=c[i][l]/y;for(l=u;l<f;l++){for(_=0,s=u;s<d;s++)_+=c[l][s]*c[i][s];for(s=u;s<d;s++)c[l][s]+=_*p[s]}}b=Math.abs(h[i])+Math.abs(p[i]),b>x&&(x=b)}for(i=d-1;-1!=i;i+=-1){if(0!=m){for(y=m*c[i][i+1],l=u;l<d;l++)v[l][i]=c[i][l]/y;for(l=u;l<d;l++){for(_=0,s=u;s<d;s++)_+=c[i][s]*v[s][l];for(s=u;s<d;s++)v[s][l]+=_*v[s][i]}}for(l=u;l<d;l++)v[i][l]=0,v[l][i]=0;v[i][i]=1,m=p[i],u=i}for(i=d-1;-1!=i;i+=-1){for(u=i+1,m=h[i],l=u;l<d;l++)c[i][l]=0;if(0!=m){for(y=c[i][i]*m,l=u;l<d;l++){for(_=0,s=u;s<f;s++)_+=c[s][i]*c[s][l];for(g=_/y,s=i;s<f;s++)c[s][l]+=g*c[s][i]}for(l=i;l<f;l++)c[l][i]=c[l][i]/m}else for(l=i;l<f;l++)c[l][i]=0;c[i][i]+=1}for(r*=x,s=d-1;-1!=s;s+=-1)for(var k=0;k<50;k++){var z=!1;for(u=s;-1!=u;u+=-1){if(Math.abs(p[u])<=r){z=!0;break}if(Math.abs(h[u-1])<=r)break}if(!z){a=0,_=1;var M=u-1;for(i=u;i<s+1&&(g=_*p[i],p[i]=a*p[i],!(Math.abs(g)<=r));i++)for(m=h[i],y=t(g,m),h[i]=y,a=m/y,_=-g/y,l=0;l<f;l++)b=c[l][M],w=c[l][i],c[l][M]=b*a+w*_,c[l][i]=-b*_+w*a}if(w=h[s],u==s){if(w<0)for(h[s]=-w,l=0;l<d;l++)v[l][s]=-v[l][s];break}if(k>=49)throw"Error: no convergence.";for(x=h[u],b=h[s-1],m=p[s-1],y=p[s],g=((b-w)*(b+w)+(m-y)*(m+y))/(2*y*b),m=t(g,1),g=g<0?((x-w)*(x+w)+y*(b/(g-m)-y))/x:((x-w)*(x+w)+y*(b/(g+m)-y))/x,a=1,_=1,i=u+1;i<s+1;i++){for(m=p[i],b=h[i],y=_*m,m*=a,w=t(g,y),p[i-1]=w,a=g/w,_=y/w,g=x*a+m*_,m=-x*_+m*a,y=b*_,b*=a,l=0;l<d;l++)x=v[l][i-1],w=v[l][i],v[l][i-1]=x*a+w*_,v[l][i]=-x*_+w*a;for(w=t(g,y),h[i-1]=w,a=g/w,_=y/w,g=a*m+_*b,x=-_*m+a*b,l=0;l<f;l++)b=c[l][i-1],w=c[l][i],c[l][i-1]=b*a+w*_,c[l][i]=-b*_+w*a}p[u]=0,p[s]=g,h[s]=x}for(i=0;i<h.length;i++)h[i]<r&&(h[i]=0);for(i=0;i<d;i++)for(l=i-1;l>=0;l--)if(h[l]<h[i]){for(a=h[l],h[l]=h[i],h[i]=a,s=0;s<c.length;s++)n=c[s][i],c[s][i]=c[s][l],c[s][l]=n;for(s=0;s<v.length;s++)n=v[s][i],v[s][i]=v[s][l],v[s][l]=n;i=l}return{U:c,S:h,V:v}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){!function(){"use strict";function e(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function n(e,t,n){var r=t.x,o=t.y,a=n.x-r,i=n.y-o;if(0!==a||0!==i){var l=((e.x-r)*a+(e.y-o)*i)/(a*a+i*i);l>1?(r=n.x,o=n.y):l>0&&(r+=a*l,o+=i*l)}return a=e.x-r,i=e.y-o,a*a+i*i}function r(t,n){for(var r,o=t[0],a=[o],i=1,l=t.length;i<l;i++)r=t[i],e(r,o)>n&&(a.push(r),o=r);return o!==r&&a.push(r),a}function o(e,t){var r,o,a,i,l=e.length,s="undefined"!=typeof Uint8Array?Uint8Array:Array,u=new s(l),c=0,f=l-1,d=[],p=[];for(u[c]=u[f]=1;f;){for(o=0,r=c+1;r<f;r++)(a=n(e[r],e[c],e[f]))>o&&(i=r,o=a);o>t&&(u[i]=1,d.push(c,i,i,f)),f=d.pop(),c=d.pop()}for(r=0;r<l;r++)u[r]&&p.push(e[r]);return p}function a(e,t,n){var a=void 0!==t?t*t:1;return e=n?e:r(e,a),e=o(e,a)}"function"==typeof define&&define.amd?define(function(){return a}):void 0!==t?t.exports=a:"undefined"!=typeof self?self.simplify=a:window.simplify=a}()},{}],10:[function(e,t,n){"use strict";function r(e,t,n,r){this.points=e,this.ids=t,this.dimension=r,this.length=n}function o(e){var t,n,o;if(Array.isArray(e)){if(0===(t=e.length))return new r(null,null,0,0);n=e[0].length,o=i(f.mallocDouble(t*(n+1)),[t,n+1]),s(e,o.hi(t,n))}else{t=e.shape[0],n=e.shape[1];var a=e.dtype;a="int8"===a||"int16"===a||"int32"===a?"int32":"uint8"===a||"uint8_clamped"===a||"buffer"===a||"uint16"===a||"uint32"===a?"uint32":"float32"===a?"float32":"float64",o=i(f.malloc(t*(n+1)),[t,n+1]),u.assign(o.hi(t,n),e)}for(var h=0;h<t;++h)o.set(h,n,h);for(var v=c.malloc([t,n],e.dtype),g=f.mallocInt32(t),m=0,y=v.data,x=o.data,b=(p.log2(p.nextPow2(t)),l.compile(o.order,!0,o.dtype)),w=[o];m<t;){var _=w.shift(),k=_,z=0|k.shape[0];if(z>1){var M,A=p.log2(m+1)%n,j=d.root(z);M=b(k,j,function(e,t){return e.get(A)-t.get(A)});for(var E=v.index(m,0),S=M.offset,h=0;h<n;++h)y[E++]=x[S++];g[m]=x[S],m+=1,w.push(k.hi(j)),z>2&&w.push(k.lo(j+1))}else{for(var S=k.offset,E=v.index(m,0),h=0;h<n;++h)y[E+h]=x[S++];g[m]=x[S],m+=1}}return f.free(o.data),new r(v,g,t,n)}function a(e){var t=e.p,n=e.i;if(t){for(var o=t.length,a=f.mallocFloat64(o),l=0;l<o;++l)a[l]=t[l];for(var s=n.length,u=f.mallocInt32(s),l=0;l<s;++l)u[l]=n[l];var c=o/s|0;return new r(i(a,[s,c]),u,s,c)}return new r(null,null,0,e.d)}t.exports=o,t.exports.deserialize=a;var i=e("ndarray"),l=e("ndarray-select"),s=e("ndarray-pack"),u=e("ndarray-ops"),c=e("ndarray-scratch"),f=e("typedarray-pool"),d=e("inorder-tree-layout"),p=e("bit-twiddle"),h=e("./lib/heap.js"),v=r.prototype;v.serialize=function(){return this.length>0?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},v.range=function(e,t,n){var r=this.length;if(!(r<1)){for(var o=this.dimension,a=0;a<o;++a)if(t[a]<e[a])return;var i,l=this.points,u=this.ids,d=c.malloc([r,2,o]),h=f.mallocInt32(r),v=d.data,g=l.data,m=1,y=0;for(h[0]=0,s(e,d.pick(0,0)),s(t,d.pick(0,1));y<m;){for(var x=h[y],b=p.log2(x+1)%o,w=d.index(y,0,0),_=d.index(y,1,0),k=l.index(x,0),z=!0,a=0;a<o;++a){var M=g[k+a];if(M<v[w+a]||v[_+a]<M){z=!1;break}}if(z&&void 0!==(i=n(u[x])))break;var A=g[k+b],j=v[_+b],E=v[w+b];if(E<=A){var S=2*x+1;if(S<r){h[m]=S;for(var O=d.index(m,0,0),a=0;a<o;++a)v[O+a]=v[w+a];for(var N=d.index(m,1,0),a=0;a<o;++a)v[N+a]=v[_+a];v[N+b]=Math.min(j,A),m+=1}}if(A<=j){var F=2*(x+1);if(F<r){h[m]=F;for(var O=d.index(m,0,0),a=0;a<o;++a)v[O+a]=v[w+a];for(var N=d.index(m,1,0),a=0;a<o;++a)v[N+a]=v[_+a];v[O+b]=Math.max(E,A),m+=1}}y+=1}return c.free(d),f.free(h),i}},v.rnn=function(e,t,n){if(!(t<0)){var r=this.length;if(!(r<1)){var o,a=this.dimension,i=this.points,l=this.ids,s=c.malloc([r,a]),u=f.mallocInt32(r),d=s.data,h=i.data,v=1,g=0,m=t*t;u[0]=0;for(var y=0;y<a;++y)s.set(0,y,0);for(;g<v;){for(var x=u[g],b=i.index(x,0),w=0,y=0;y<a;++y)w+=Math.pow(e[y]-h[b+y],2);if(w<=m&&void 0!==(o=n(l[x])))break;for(var _=p.log2(x+1)%a,k=0,z=s.index(g,0),y=0;y<a;++y)y!==_&&(k+=d[z+y]);var M=e[_],A=h[b+_],j=d[z+_],E=j,S=j;M<A?S=Math.max(j,Math.pow(A-M,2)):E=Math.max(j,Math.pow(A-M,2));var O=E+k,N=S+k;if(O<=m){var F=2*x+1;if(F<r){u[v]=F;for(var T=s.index(v,0),y=0;y<a;++y)d[T+y]=d[z+y];d[T+_]=E,v+=1}}if(N<=m){var C=2*(x+1);if(C<r){u[v]=C;for(var T=s.index(v,0),y=0;y<a;++y)d[T+y]=d[z+y];d[T+_]=S,v+=1}}g+=1}return c.free(s),f.free(u),o}}},v.nn=function(e,t){var n=this.length;if(n<1)return-1;if("number"==typeof t){if(t<0)return-1}else t=1/0;var r=this.dimension,o=this.points,a=o.data,i=f.mallocFloat64(r),l=new h(n,r+1),s=l.index,u=l.data;s[0]=0;for(var c=0;c<=r;++c)u[c]=0;l.count+=1;for(var d=-1,v=t;l.count>0&&!(u[0]>=v);){for(var g=s[0],m=o.index(g,0),y=0,c=0;c<r;++c)y+=Math.pow(e[c]-a[m+c],2);y<v&&(v=y,d=g);for(var x=p.log2(g+1)%r,b=0,c=0;c<r;++c){var w=u[c+1];c!==x&&(b+=w),i[c]=w}var _=e[x],k=a[m+x],z=i[x],M=z,A=z;_<k?A=Math.max(z,Math.pow(k-_,2)):M=Math.max(z,Math.pow(k-_,2));var j=M+b,E=A+b;if(l.pop(),j<v){var S=2*g+1;if(S<n){var O=l.count;s[O]=S;var N=O*(r+1);u[N]=j;for(var c=1;c<=r;++c)u[N+c]=i[c-1];u[N+x+1]=M,l.push()}}if(E<v){var F=2*(g+1);if(F<n){var O=l.count;s[O]=F;var N=O*(r+1);u[N]=E;for(var c=1;c<=r;++c)u[N+c]=i[c-1];u[N+x+1]=A,l.push()}}}return f.freeFloat64(i),l.dispose(),d<0?-1:this.ids[d]},v.knn=function(e,t,n){if("number"==typeof n){if(n<0)return[]}else n=1/0;var r=this.length;if(r<1)return[];if("number"==typeof t){if(t<=0)return[];t=0|Math.min(t,r)}else t=r;var o=this.ids,a=this.dimension,i=this.points,l=i.data,s=f.mallocFloat64(a),u=new h(t,1),c=u.index,d=u.data,v=new h(r,a+1),g=v.index,m=v.data;g[0]=0;for(var y=0;y<=a;++y)m[y]=0;v.count+=1;for(var x=n;v.count>0&&!(m[0]>=x);){for(var b=g[0],w=i.index(b,0),_=0,y=0;y<a;++y)_+=Math.pow(e[y]-l[w+y],2);if(_<x){u.count>=t&&u.pop();var k=u.count;c[k]=b,d[k]=-_,u.push(),u.count>=t&&(x=-d[0])}for(var z=p.log2(b+1)%a,M=0,y=0;y<a;++y){var A=m[y+1];y!==z&&(M+=A),s[y]=A}var j=e[z],E=l[w+z],S=s[z],O=S,N=S;j<E?N=Math.max(S,Math.pow(E-j,2)):O=Math.max(S,Math.pow(E-j,2));var F=O+M,T=N+M;if(v.pop(),F<x){var C=2*b+1;if(C<r){var q=v.count;g[q]=C;var P=q*(a+1);m[P]=F;for(var y=1;y<=a;++y)m[P+y]=s[y-1];m[P+z+1]=O,v.push()}}if(T<x){var B=2*(b+1);if(B<r){var q=v.count;g[q]=B;var P=q*(a+1);m[P]=T;for(var y=1;y<=a;++y)m[P+y]=s[y-1];m[P+z+1]=N,v.push()}}}f.freeFloat64(s),v.dispose();for(var D=new Array(u.count),o=this.ids,y=u.count-1;y>=0;--y)D[y]=o[c[0]],u.pop();return u.dispose(),D},v.dispose=function(){f.free(this.points.data),f.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0}},{"./lib/heap.js":11,"bit-twiddle":12,"inorder-tree-layout":13,ndarray:28,"ndarray-ops":15,"ndarray-pack":20,"ndarray-scratch":26,"ndarray-select":27,"typedarray-pool":32}],11:[function(e,t,n){"use strict";function r(e){return 1&e?e-1>>1:(e>>1)-1}function o(e,t){this.count=0,this.dataSize=t,this.index=a.mallocInt32(e),this.data=a.mallocFloat64(e*t)}t.exports=o;var a=e("typedarray-pool"),i=o.prototype;i.heapSwap=function(e,t){var n=this.data,r=this.index,o=this.dataSize,a=r[e];r[e]=r[t],r[t]=a;for(var i=o*e,l=o*t,s=0;s<o;++s){var u=n[i];n[i]=n[l],n[l]=u,i+=1,l+=1}},i.heapUp=function(e){for(var t=this.dataSize,n=(this.index,this.data),o=n[t*e];e>0;){var a=r(e);if(a>=0){if(o<n[t*a]){this.heapSwap(e,a),e=a;continue}}break}},i.heapDown=function(e){for(var t=this.dataSize,n=(this.index,this.data),r=this.count,o=n[t*e];;){var a=o,i=2*e+1,l=2*(e+1),s=e;if(i<r){var u=n[t*i];u<a&&(s=i,a=u)}if(l<r){n[t*l]<a&&(s=l)}if(s===e)break;this.heapSwap(e,s),e=s}},i.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},i.push=function(){this.heapUp(this.count),this.count+=1},i.dispose=function(){a.freeInt32(this.index),a.freeFloat64(this.data)}},{"typedarray-pool":32}],12:[function(e,t,n){"use strict";"use restrict";function r(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}n.INT_BITS=32,n.INT_MAX=2147483647,n.INT_MIN=-1<<31,n.sign=function(e){return(e>0)-(e<0)},n.abs=function(e){var t=e>>31;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(e<t)},n.max=function(e,t){return e^(e^t)&-(e<t)},n.isPow2=function(e){return!(e&e-1||!e)},n.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,(t|=n)|e>>1},n.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},n.popCount=function(e){return e-=e>>>1&1431655765,
16843009*((e=(858993459&e)+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},n.countTrailingZeros=r,n.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var o=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,o=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--o;e[t]=r<<o&255}}(o),n.reverse=function(e){return o[255&e]<<24|o[e>>>8&255]<<16|o[e>>>16&255]<<8|o[e>>>24&255]},n.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},n.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),(e=65535&(e|e>>>16))<<16>>16},n.interleave3=function(e,t,n){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),e|n<<2},n.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),(e=1023&(e|e>>>16))<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},{}],13:[function(e,t,n){"use strict";function r(e){var t=(v.nextPow2(e+1)>>>1)-1,n=e-t;return v.nextPow2(n)-1>=t?t:(t>>>1)+n}function o(e){return 0}function a(e){return e-1}function i(e,t){if(e<=0)return 0;var n=r(e);return t>n?i(e-n-1,t-n-1):t===n?v.log2(e):i(n,t)}function l(e,t){return Math.max(t-1,0)}function s(e,t){return Math.min(t+1,e-1)}function u(e,t){if(e<=0)return-1;var n=r(e);if(t>n){var o=u(e-n-1,t-n-1);return o<0?n:o+n+1}if(t===n)return-1;var o=u(n,t);return o<0?n:o}function c(e,t){if(e<=0)return 0;var n=r(e);return t>n?c(e-n-1,t-n-1)+n+1:t===n?r(t):c(n,t)}function f(e,t){if(e<=0)return 0;var n=r(e);return t>n?f(e-n-1,t-n-1)+n+1:t===n?r(e-n-1)+n+1:f(n,t)}function d(e,t){return 0===i(e,t)}function p(e,t){e|=0,t|=0;for(var n=0;e>1;){var o=r(e);if(t>o)n+=o+1,e-=o+1,t-=o+1;else{if(t===o)break;e=o}}return n}function h(e,t){e|=0,t|=0;for(var n=0;e>1;){var o=r(e);if(t>o)n+=o+1,e-=o+1,t-=o+1;else{if(t===o){n+=e-1;break}e=o}}return n}var v=e("bit-twiddle");n.root=r,n.begin=o,n.end=a,n.height=i,n.prev=l,n.next=s,n.parent=u,n.left=c,n.right=f,n.leaf=d,n.lo=p,n.hi=h},{"bit-twiddle":14}],14:[function(e,t,n){arguments[4][12][0].apply(n,arguments)},{dup:12}],15:[function(e,t,n){"use strict";function r(e){if(!e)return l;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function o(e){return i({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function a(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(o(e))}var i=e("cwise-compiler"),l={body:"",args:[],thisVars:[],localVars:[]},s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var t=s[e];n[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),n[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var t=u[e];n[e]=a({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),n[e+"eq"]=a({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in c){var t=c[e];n[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),n[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<f.length;++e){var t=f[e];n[t]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),n[t+"eq"]=a({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var d=["max","min","atan2","pow"];!function(){for(var e=0;e<d.length;++e){var t=d[e];n[t]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),n[t+"s"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),n[t+"eq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),n[t+"seq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var p=["atan2","pow"];!function(){for(var e=0;e<p.length;++e){var t=p[e];n[t+"op"]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),n[t+"ops"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),n[t+"opeq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),n[t+"opseq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),n.any=i({args:["array"],pre:l,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),n.all=i({args:["array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),n.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),n.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),n.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),n.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),n.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),n.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),n.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.random=a({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),n.assign=a({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),n.assigns=a({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),n.equals=i({args:["array","array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":16}],16:[function(e,t,n){"use strict";function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function o(e){var t=new r;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var o=0;o<n.length;++o){var i=n[o];if("array"===i||"object"==typeof i&&i.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(i.blockIndices?i.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===i)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===i){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===i){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof i||!i.offset)throw new Error("cwise: Unknown argument type "+n[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:i.array,offset:i.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,a(t)}var a=e("./lib/thunk.js");t.exports=o},{"./lib/thunk.js":18}],17:[function(e,t,n){"use strict";function r(e,t,n){var r,o,a=e.length,i=t.arrayArgs.length,l=t.indexArgs.length>0,s=[],u=[],c=0,f=0;for(r=0;r<a;++r)u.push(["i",r,"=0"].join(""));for(o=0;o<i;++o)for(r=0;r<a;++r)f=c,c=e[r],0===r?u.push(["d",o,"s",r,"=t",o,"p",c].join("")):u.push(["d",o,"s",r,"=(t",o,"p",c,"-s",f,"*t",o,"p",f,")"].join(""));for(s.push("var "+u.join(",")),r=a-1;r>=0;--r)c=e[r],s.push(["for(i",r,"=0;i",r,"<s",c,";++i",r,"){"].join(""));for(s.push(n),r=0;r<a;++r){for(f=c,c=e[r],o=0;o<i;++o)s.push(["p",o,"+=d",o,"s",r].join(""));l&&(r>0&&s.push(["index[",f,"]-=s",f].join("")),s.push(["++index[",c,"]"].join(""))),s.push("}")}return s.join("\n")}function o(e,t,n,o){for(var a=t.length,i=n.arrayArgs.length,l=n.blockSize,s=n.indexArgs.length>0,u=[],c=0;c<i;++c)u.push(["var offset",c,"=p",c].join(""));for(var c=e;c<a;++c)u.push(["for(var j"+c+"=SS[",t[c],"]|0;j",c,">0;){"].join("")),u.push(["if(j",c,"<",l,"){"].join("")),u.push(["s",t[c],"=j",c].join("")),u.push(["j",c,"=0"].join("")),u.push(["}else{s",t[c],"=",l].join("")),u.push(["j",c,"-=",l,"}"].join("")),s&&u.push(["index[",t[c],"]=j",c].join(""));for(var c=0;c<i;++c){for(var f=["offset"+c],d=e;d<a;++d)f.push(["j",d,"*t",c,"p",t[d]].join(""));u.push(["p",c,"=(",f.join("+"),")"].join(""))}u.push(r(t,n,o));for(var c=e;c<a;++c)u.push("}");return u.join("\n")}function a(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function i(e,t,n){for(var r=e.body,o=[],a=[],i=0;i<e.args.length;++i){var l=e.args[i];if(!(l.count<=0)){var s=new RegExp(l.name,"g"),u="",c=t.arrayArgs.indexOf(i);switch(t.argTypes[i]){case"offset":var f=t.offsetArgIndex.indexOf(i);c=t.offsetArgs[f].array,u="+q"+f;case"array":u="p"+c+u;var d="l"+i,p="a"+c;if(0===t.arrayBlockIndices[c])1===l.count?"generic"===n[c]?l.lvalue?(o.push(["var ",d,"=",p,".get(",u,")"].join("")),r=r.replace(s,d),a.push([p,".set(",u,",",d,")"].join(""))):r=r.replace(s,[p,".get(",u,")"].join("")):r=r.replace(s,[p,"[",u,"]"].join("")):"generic"===n[c]?(o.push(["var ",d,"=",p,".get(",u,")"].join("")),r=r.replace(s,d),l.lvalue&&a.push([p,".set(",u,",",d,")"].join(""))):(o.push(["var ",d,"=",p,"[",u,"]"].join("")),r=r.replace(s,d),l.lvalue&&a.push([p,"[",u,"]=",d].join("")));else{for(var h=[l.name],v=[u],g=0;g<Math.abs(t.arrayBlockIndices[c]);g++)h.push("\\s*\\[([^\\]]+)\\]"),v.push("$"+(g+1)+"*t"+c+"b"+g);if(s=new RegExp(h.join(""),"g"),u=v.join("+"),"generic"===n[c])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(s,[p,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(s,"Y"+t.scalarArgs.indexOf(i));break;case"index":r=r.replace(s,"index");break;case"shape":r=r.replace(s,"shape")}}}return[o.join("\n"),r,a.join("\n")].join("\n").trim()}function l(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var o=e[r],a=o.match(/\d+/);a=a?a[0]:"",0===o.charAt(0)?t[r]="u"+o.charAt(1)+a:t[r]=o.charAt(0)+a,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function s(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),c=new Array(e.arrayArgs.length),f=0;f<e.arrayArgs.length;++f)c[f]=t[2*f],s[f]=t[2*f+1];for(var d=[],p=[],h=[],v=[],g=[],f=0;f<e.arrayArgs.length;++f){e.arrayBlockIndices[f]<0?(h.push(0),v.push(n),d.push(n),p.push(n+e.arrayBlockIndices[f])):(h.push(e.arrayBlockIndices[f]),v.push(e.arrayBlockIndices[f]+n),d.push(0),p.push(e.arrayBlockIndices[f]));for(var m=[],y=0;y<s[f].length;y++)h[f]<=s[f][y]&&s[f][y]<v[f]&&m.push(s[f][y]-h[f]);g.push(m)}for(var x=["SS"],b=["'use strict'"],w=[],y=0;y<n;++y)w.push(["s",y,"=SS[",y,"]"].join(""));for(var f=0;f<e.arrayArgs.length;++f){x.push("a"+f),x.push("t"+f),x.push("p"+f);for(var y=0;y<n;++y)w.push(["t",f,"p",y,"=t",f,"[",h[f]+y,"]"].join(""));for(var y=0;y<Math.abs(e.arrayBlockIndices[f]);++y)w.push(["t",f,"b",y,"=t",f,"[",d[f]+y,"]"].join(""))}for(var f=0;f<e.scalarArgs.length;++f)x.push("Y"+f);if(e.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var _=new Array(n),f=0;f<n;++f)_[f]="0";w.push(["index=[",_.join(","),"]"].join(""))}for(var f=0;f<e.offsetArgs.length;++f){for(var k=e.offsetArgs[f],z=[],y=0;y<k.offset.length;++y)0!==k.offset[y]&&(1===k.offset[y]?z.push(["t",k.array,"p",y].join("")):z.push([k.offset[y],"*t",k.array,"p",y].join("")));0===z.length?w.push("q"+f+"=0"):w.push(["q",f,"=",z.join("+")].join(""))}var M=u([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));w=w.concat(M),b.push("var "+w.join(","));for(var f=0;f<e.arrayArgs.length;++f)b.push("p"+f+"|=0");e.pre.body.length>3&&b.push(i(e.pre,e,c));var A=i(e.body,e,c),j=a(g);j<n?b.push(o(j,g[0],e,A)):b.push(r(g[0],e,A)),e.post.body.length>3&&b.push(i(e.post,e,c)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+b.join("\n")+"\n----------");var E=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",j,l(c)].join("");return new Function(["function ",E,"(",x.join(","),"){",b.join("\n"),"} return ",E].join(""))()}var u=e("uniq");t.exports=s},{uniq:19}],18:[function(e,t,n){"use strict";function r(e){var t=["'use strict'","var CACHED={}"],n=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var a=[],i=[],l=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],s=[],u=[],c=0;c<e.arrayArgs.length;++c){var f=e.arrayArgs[c];n.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),a.push("t"+f),a.push("r"+f),i.push("t"+f),i.push("r"+f+".join()"),l.push("array"+f+".data"),l.push("array"+f+".stride"),l.push("array"+f+".offset|0"),c>0&&(s.push("array"+e.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[c]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[c])+"]"))}e.arrayArgs.length>1&&(t.push("if (!("+s.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var c=0;c<e.scalarArgs.length;++c)l.push("scalar"+e.scalarArgs[c]);return n.push(["type=[",i.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",l.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(o.bind(void 0,e))}var o=e("./compile.js");t.exports=r},{"./compile.js":17}],19:[function(e,t,n){"use strict";function r(e,t){for(var n=1,r=e.length,o=e[0],a=e[0],i=1;i<r;++i)if(a=o,o=e[i],t(o,a)){if(i===n){n++;continue}e[n++]=o}return e.length=n,e}function o(e){for(var t=1,n=e.length,r=e[0],o=e[0],a=1;a<n;++a,o=r)if(o=r,(r=e[a])!==o){if(a===t){t++;continue}e[t++]=r}return e.length=t,e}function a(e,t,n){return 0===e.length?e:t?(n||e.sort(t),r(e,t)):(n||e.sort(),o(e))}t.exports=a},{}],20:[function(e,t,n){"use strict";var r=e("ndarray"),o=e("./doConvert.js");t.exports=function(e,t){for(var n=[],a=e,i=1;a instanceof Array;)n.push(a.length),i*=a.length,a=a[0];return 0===n.length?r():(t||(t=r(new Float64Array(i),n)),o(t,e),t)}},{"./doConvert.js":21,ndarray:28}],21:[function(e,t,n){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":22}],22:[function(e,t,n){arguments[4][16][0].apply(n,arguments)},{"./lib/thunk.js":24,dup:16}],23:[function(e,t,n){arguments[4][17][0].apply(n,arguments)},{dup:17,uniq:25}],24:[function(e,t,n){arguments[4][18][0].apply(n,arguments)},{"./compile.js":23,dup:18}],25:[function(e,t,n){arguments[4][19][0].apply(n,arguments)},{dup:19}],26:[function(e,t,n){"use strict";function r(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=f.malloc(e.size,t),r=u(n,e.shape);return c.assign(r,e),r}function o(e,t){t||(t="double");for(var n=1,r=new Array(e.length),o=e.length-1;o>=0;--o)r[o]=n,n*=e[o];return u(f.malloc(n,t),e,r,0)}function a(e){"generic"!==e.dtype&&"array"!==e.dtype&&f.free(e.data)}function i(e,t){t||(t="double");for(var n=1,r=new Array(e.length),o=e.length-1;o>=0;--o)r[o]=n,n*=e[o];for(var a=f.malloc(n,t),o=0;o<n;++o)a[o]=0;return u(a,e,r,0)}function l(e,t){t||(t="double");for(var n=1,r=new Array(e.length),o=e.length-1;o>=0;--o)r[o]=n,n*=e[o];for(var a=f.malloc(n,t),o=0;o<n;++o)a[o]=1;return u(a,e,r,0)}function s(e,t){var n,r;t||(t="double");var o=1,a=new Array(e.length);for(n=e.length-1;n>=0;--n)a[n]=o,o*=e[n];var i=f.malloc(o,t);for(n=0;n<o;++n)i[n]=0;var l=1/0,s=0;for(n=e.length-1;n>=0;n--)s+=a[n],l=Math.min(l,e[n]);for(n=0,r=0;n<l;n++,r+=s)i[r]=1;return u(i,e,a,0)}var u=e("ndarray"),c=e("ndarray-ops"),f=e("typedarray-pool");n.clone=r,n.malloc=o,n.free=a,n.zeros=i,n.ones=l,n.eye=s},{ndarray:28,"ndarray-ops":15,"typedarray-pool":32}],27:[function(e,t,n){"use strict";function r(e){return"s"+e}function o(e){return"t"+e}function a(e){return"u"+e}function i(e){return"v"+e}function l(e){return"i"+e}function s(e){return"p"+e}function u(e){return"x"+e}function c(e){var t=e.slice();return t.splice(e.indexOf(0),1),t.unshift(0),t}function f(e,t,n){function f(t,n){M.push(u(0),"=",y,"+",o(e[0]),"*(",t,");",u(1),"=",y,"+",o(e[0]),"*(",n,");");for(var i=d-1;i>0;--i)M.push("for(",l(e[i]),"=0;",l(e[i]),"<",r(e[i]),";",l(e[i]),"++){");p?M.push(b,"=",m,".get(",u(0),");",m,".set(",u(0),",",m,".get(",u(1),"));",m,".set(",u(1),",",b,");"):M.push(b,"=",m,"[",u(0),"];",m,"[",u(0),"]=",m,"[",u(1),"];",m,"[",u(1),"]=",b,";");for(var i=1;i<d;++i)M.push(u(0),"+=",a(e[i]),";",u(1),"+=",a(e[i]),"}")}e=c(e);var d=e.length,p="generic"===n,z="ndSelect"+n+e.join("_")+"_"+(t?"cmp":"lex"),M=[],A=[h,v];t&&A.push(g);for(var j=[m+"="+h+".data",y+"="+h+".offset|0",x+"=Math.random",b],E=0;E<2;++E)j.push(u(E)+"=0");for(var E=0;E<d;++E)j.push(r(E)+"="+h+".shape["+E+"]|0",o(E)+"="+h+".stride["+E+"]|0",l(E)+"=0");for(var E=1;E<d;++E)E>1?j.push(i(E)+"=("+o(E)+"-"+r(E-1)+"*"+o(E-1)+")|0",a(e[E])+"=("+o(e[E])+"-"+r(e[E-1])+"*"+o(e[E-1])+")|0"):j.push(i(E)+"="+o(E),a(e[E])+"="+o(e[E]));if(t)for(var E=0;E<2;++E)j.push(s(E)+"="+h+".pick(0)");j.push(k+"=0",w+"=0",_+"="+r(e[0])+"-1"),M.push("while(",w,"<",_,"){",k,"=(",x,"()*(",_,"-",w,"+1)+",w,")|0;"),f(k,_),M.push(k,"=",w,";","for(",l(0),"=",w,";",l(0),"<",_,";",l(0),"++){"),function(n,a,c){if(t)M.push(s(0),".offset=",y,"+",o(e[0]),"*(",a,");",s(1),".offset=",y,"+",o(e[0]),"*(",c,");",n,"=",g,"(",s(0),",",s(1),");");else{M.push(u(0),"=",y,"+",o(0),"*(",a,");",u(1),"=",y,"+",o(0),"*(",c,");"),d>1&&M.push("_cmp:");for(var f=d-1;f>0;--f)M.push("for(",l(f),"=0;",l(f),"<",r(f),";",l(f),"++){");p?M.push(n,"=",m,".get(",u(0),")-",m,".get(",u(1),");"):M.push(n,"=",m,"[",u(0),"]-",m,"[",u(1),"];"),d>1&&M.push("if(",n,")break _cmp;");for(var f=1;f<d;++f)M.push(u(0),"+=",i(f),";",u(1),"+=",i(f),"}")}}(b,l(0),_),M.push("if(",b,"<0){"),f(k,l(0)),M.push(k,"++;"),M.push("}}"),f(k,_),M.push("if(",k,"===",v,"){",w,"=",k,";","break;","}else if(",v,"<",k,"){",_,"=",k,"-1;","}else{",w,"=",k,"+1;","}","}"),t?M.push(s(0),".offset=",y,"+",w,"*",o(0),";","return ",s(0),";"):M.push("return ",h,".pick(",w,");");var S=["'use strict';function ",z,"(",A,"){","var ",j.join(),";",M.join(""),"};return ",z].join("");return new Function(S)()}function d(e,t,n){var r=e.join()+t+n,o=z[r];return o||(z[r]=f(e,t,n))}function p(e,t,n){if(t|=0,0===e.dimension||e.shape[0]<=t||t<0)return null;var r=!!n,o=d(e.order,r,e.dtype);return r?o(e,t,n):o(e,t)}t.exports=p,t.exports.compile=d;var h="a",v="K",g="C",m="d",y="o",x="R",b="T",w="L",_="H",k="X",z={}},{}],28:[function(e,t,n){function r(e,t){return e[0]-t[0]}function o(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var o=new Array(n.length);for(e=0;e<o.length;++e)o[e]=n[e][1];return o}function a(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var r="generic"===e;if(-1===t){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",i=new Function(a);return i()}if(0===t){var a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",i=new Function("TrivialArray",a);return i(f[e][0])}var a=["'use strict'"],l=s(t),u=l.map(function(e){return"i"+e}),c="this.offset+"+l.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),d=l.map(function(e){return"b"+e}).join(","),p=l.map(function(e){return"c"+e}).join(",");a.push("function "+n+"(a,"+d+","+p+",d){this.data=a","this.shape=["+d+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+l.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+n+"_order(){"),2===t?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),r?a.push("return this.data.set("+c+",v)}"):a.push("return this.data["+c+"]=v}"),a.push("proto.get=function "+n+"_get("+u.join(",")+"){"),r?a.push("return this.data.get("+c+")}"):a.push("return this.data["+c+"]}"),a.push("proto.index=function "+n+"_index(",u.join(),"){return "+c+"}"),a.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var h=l.map(function(e){return"a"+e+"=this.shape["+e+"]"}),v=l.map(function(e){return"c"+e+"=this.stride["+e+"]"});a.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+v.join(","));for(var g=0;g<t;++g)a.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");a.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+l.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+l.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;g<t;++g)a.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");a.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");for(var m=new Array(t),y=new Array(t),g=0;g<t;++g)m[g]="a[i"+g+"]",y[g]="b[i"+g+"]";a.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+m.join(",")+","+y.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var g=0;g<t;++g)a.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var i=new Function("CTOR_LIST","ORDER",a.join("\n"));return i(f[e],o)}function i(e){if(u(e))return"buffer";if(c)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8"
;case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function l(e,t,n,r){if(void 0===e){var o=f.array[0];return o([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var l=t.length;if(void 0===n){n=new Array(l);for(var s=l-1,u=1;s>=0;--s)n[s]=u,u*=t[s]}if(void 0===r){r=0;for(var s=0;s<l;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var c=i(e),d=f[c];d.length<=l+1;)d.push(a(c,d.length-1));var o=d[l+1];return o(e,t,n,r)}var s=e("iota-array"),u=e("is-buffer"),c="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=l},{"iota-array":29,"is-buffer":30}],29:[function(e,t,n){"use strict";function r(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}t.exports=r},{}],30:[function(e,t,n){t.exports=function(e){return!(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}},{}],31:[function(e,t,n){"use strict";function r(e,t,n){var o=0|e[n];if(o<=0)return[];var a,i=new Array(o);if(n===e.length-1)for(a=0;a<o;++a)i[a]=t;else for(a=0;a<o;++a)i[a]=r(e,t,n+1);return i}function o(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function a(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return o(0|e,t);break;case"object":if("number"==typeof e.length)return r(e,t,0)}return[]}t.exports=a},{}],32:[function(e,t,n){(function(t,r){"use strict";function o(e){if(e){var t=e.length||e.byteLength,n=y.log2(t);_[n].push(e)}}function a(e){o(e.buffer)}function i(e){var e=y.nextPow2(e),t=y.log2(e),n=_[t];return n.length>0?n.pop():new ArrayBuffer(e)}function l(e){return new Uint8Array(i(e),0,e)}function s(e){return new Uint16Array(i(2*e),0,e)}function u(e){return new Uint32Array(i(4*e),0,e)}function c(e){return new Int8Array(i(e),0,e)}function f(e){return new Int16Array(i(2*e),0,e)}function d(e){return new Int32Array(i(4*e),0,e)}function p(e){return new Float32Array(i(4*e),0,e)}function h(e){return new Float64Array(i(8*e),0,e)}function v(e){return b?new Uint8ClampedArray(i(e),0,e):l(e)}function g(e){return new DataView(i(e),0,e)}function m(e){e=y.nextPow2(e);var t=y.log2(e),n=k[t];return n.length>0?n.pop():new r(e)}var y=e("bit-twiddle"),x=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:x([32,0]),UINT16:x([32,0]),UINT32:x([32,0]),INT8:x([32,0]),INT16:x([32,0]),INT32:x([32,0]),FLOAT:x([32,0]),DOUBLE:x([32,0]),DATA:x([32,0]),UINT8C:x([32,0]),BUFFER:x([32,0])});var b="undefined"!=typeof Uint8ClampedArray,w=t.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=x([32,0])),w.BUFFER||(w.BUFFER=x([32,0]));var _=w.DATA,k=w.BUFFER;n.free=function(e){if(r.isBuffer(e))k[y.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|y.log2(t);_[n].push(e)}},n.freeUint8=n.freeUint16=n.freeUint32=n.freeInt8=n.freeInt16=n.freeInt32=n.freeFloat32=n.freeFloat=n.freeFloat64=n.freeDouble=n.freeUint8Clamped=n.freeDataView=a,n.freeArrayBuffer=o,n.freeBuffer=function(e){k[y.log2(e.length)].push(e)},n.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return i(e);switch(t){case"uint8":return l(e);case"uint16":return s(e);case"uint32":return u(e);case"int8":return c(e);case"int16":return f(e);case"int32":return d(e);case"float":case"float32":return p(e);case"double":case"float64":return h(e);case"uint8_clamped":return v(e);case"buffer":return m(e);case"data":case"dataview":return g(e);default:return null}return null},n.mallocArrayBuffer=i,n.mallocUint8=l,n.mallocUint16=s,n.mallocUint32=u,n.mallocInt8=c,n.mallocInt16=f,n.mallocInt32=d,n.mallocFloat32=n.mallocFloat=p,n.mallocFloat64=n.mallocDouble=h,n.mallocUint8Clamped=v,n.mallocDataView=g,n.mallocBuffer=m,n.clearCache=function(){for(var e=0;e<32;++e)w.UINT8[e].length=0,w.UINT16[e].length=0,w.UINT32[e].length=0,w.INT8[e].length=0,w.INT16[e].length=0,w.INT32[e].length=0,w.FLOAT[e].length=0,w.DOUBLE[e].length=0,w.UINT8C[e].length=0,_[e].length=0,k[e].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"bit-twiddle":12,buffer:2,dup:31}],33:[function(e,t,n){!function(e,r){"object"==typeof n&&void 0!==t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.topojson={})}(this,function(e){"use strict";function t(){}function n(e){if(!e)return t;var n,r,o=e.scale[0],a=e.scale[1],i=e.translate[0],l=e.translate[1];return function(e,t){t||(n=r=0),e[0]=(n+=e[0])*o+i,e[1]=(r+=e[1])*a+l}}function r(e){if(!e)return t;var n,r,o=e.scale[0],a=e.scale[1],i=e.translate[0],l=e.translate[1];return function(e,t){t||(n=r=0);var s=(e[0]-i)/o|0,u=(e[1]-l)/a|0;e[0]=s-n,e[1]=u-r,n=s,r=u}}function o(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n}function a(e,t){for(var n=0,r=e.length;n<r;){var o=n+r>>>1;e[o]<t?n=o+1:r=o}return n}function i(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return l(e,t)})}:l(e,t)}function l(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(e,t)};return null==t.id&&delete n.id,n}function s(e,t){function r(e,t){t.length&&t.pop();for(var n,r=f[e<0?~e:e],a=0,i=r.length;a<i;++a)t.push(n=r[a].slice()),c(n,a);e<0&&o(t,i)}function a(e){return e=e.slice(),c(e,0),e}function i(e){for(var t=[],n=0,o=e.length;n<o;++n)r(e[n],t);return t.length<2&&t.push(t[0].slice()),t}function l(e){for(var t=i(e);t.length<4;)t.push(t[0].slice());return t}function s(e){return e.map(l)}function u(e){var t=e.type;return"GeometryCollection"===t?{type:t,geometries:e.geometries.map(u)}:t in d?{type:t,coordinates:d[t](e)}:null}var c=n(e.transform),f=e.arcs,d={Point:function(e){return a(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(a)},LineString:function(e){return i(e.arcs)},MultiLineString:function(e){return e.arcs.map(i)},Polygon:function(e){return s(e.arcs)},MultiPolygon:function(e){return e.arcs.map(s)}};return u(t)}function u(e,t){function n(t){var n,r=e.arcs[t<0?~t:t],o=r[0];return e.transform?(n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]})):n=r[r.length-1],t<0?[n,o]:[o,n]}function r(e,t){for(var n in e){var r=e[n];delete t[r.start],delete r.start,delete r.end,r.forEach(function(e){o[e<0?~e:e]=1}),l.push(r)}}var o={},a={},i={},l=[],s=-1;return t.forEach(function(n,r){var o,a=e.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(o=t[++s],t[s]=n,t[r]=o)}),t.forEach(function(e){var t,r,o=n(e),l=o[0],s=o[1];if(t=i[l])if(delete i[t.end],t.push(e),t.end=s,r=a[s]){delete a[r.start];var u=r===t?t:t.concat(r);a[u.start=t.start]=i[u.end=r.end]=u}else a[t.start]=i[t.end]=t;else if(t=a[s])if(delete a[t.start],t.unshift(e),t.start=l,r=i[l]){delete i[r.end];var c=r===t?t:r.concat(t);a[c.start=r.start]=i[c.end=t.end]=c}else a[t.start]=i[t.end]=t;else t=[e],a[t.start=l]=i[t.end=s]=t}),r(i,a),r(a,i),t.forEach(function(e){o[e<0?~e:e]||l.push([e])}),l}function c(e){return s(e,f.apply(this,arguments))}function f(e,t,n){function r(e){var t=e<0?~e:e;(c[t]||(c[t]=[])).push({i:e,g:s})}function o(e){e.forEach(r)}function a(e){e.forEach(o)}function i(e){"GeometryCollection"===e.type?e.geometries.forEach(i):e.type in f&&(s=e,f[e.type](e.arcs))}var l=[];if(arguments.length>1){var s,c=[],f={LineString:o,MultiLineString:a,Polygon:a,MultiPolygon:function(e){e.forEach(a)}};i(t),c.forEach(arguments.length<3?function(e){l.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&l.push(e[0].i)})}else for(var d=0,p=e.arcs.length;d<p;++d)l.push(d);return{type:"MultiLineString",arcs:u(e,l)}}function d(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function p(e){for(var t,n=-1,r=e.length,o=e[r-1],a=0;++n<r;)t=o,o=e[n],a+=t[0]*o[1]-t[1]*o[0];return a/2}function h(e){return s(e,v.apply(this,arguments))}function v(e,t){function n(e){e.forEach(function(t){t.forEach(function(t){(o[t=t<0?~t:t]||(o[t]=[])).push(e)})}),a.push(e)}function r(t){return p(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var o={},a=[],i=[];return t.forEach(function(e){"Polygon"===e.type?n(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(n)}),a.forEach(function(e){if(!e._){var t=[],n=[e];for(e._=1,i.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){o[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),a.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:i.map(function(t){var n,a=[];if(t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){o[e<0?~e:e].length<2&&a.push(e)})})}),a=u(e,a),(n=a.length)>1)for(var i,l=r(t[0][0]),s=0;s<n;++s)if(l===r(a[s])){i=a[0],a[0]=a[s],a[s]=i;break}return a})}}function g(e){function t(e,t){e.forEach(function(e){e<0&&(e=~e);var n=o[e];n?n.push(t):o[e]=[t]})}function n(e,n){e.forEach(function(e){t(e,n)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in l&&l[e.type](e.arcs,t)}var o={},i=e.map(function(){return[]}),l={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(r);for(var s in o)for(var u=o[s],c=u.length,f=0;f<c;++f)for(var d=f+1;d<c;++d){var p,h=u[f],v=u[d];(p=i[h])[s=a(p,v)]!==v&&p.splice(s,0,v),(p=i[v])[s=a(p,h)]!==h&&p.splice(s,0,h)}return i}function m(e,t){return e[1][2]-t[1][2]}function y(){function e(e,t){for(;t>0;){var n=(t+1>>1)-1,o=r[n];if(m(e,o)>=0)break;r[o._=t]=o,r[e._=t=n]=e}}function t(e,t){for(;;){var n=t+1<<1,a=n-1,i=t,l=r[i];if(a<o&&m(r[a],l)<0&&(l=r[i=a]),n<o&&m(r[n],l)<0&&(l=r[i=n]),i===t)break;r[l._=t]=l,r[e._=t=i]=e}}var n={},r=[],o=0;return n.push=function(t){return e(r[t._=o]=t,o++),o},n.pop=function(){if(!(o<=0)){var e,n=r[0];return--o>0&&(e=r[o],t(r[e._=0]=e,0)),n}},n.remove=function(n){var a,i=n._;if(r[i]===n)return i!==--o&&(a=r[o],(m(a,n)<0?e:t)(r[a._=i]=a,i)),i},n}function x(e,t){function o(e){l.remove(e),e[1][2]=t(e),l.push(e)}var a=n(e.transform),i=r(e.transform),l=y();return t||(t=d),e.arcs.forEach(function(e){var n,r,s,u,c=[],f=0;for(r=0,s=e.length;r<s;++r)u=e[r],a(e[r]=[u[0],u[1],1/0],r);for(r=1,s=e.length-1;r<s;++r)n=e.slice(r-1,r+2),n[1][2]=t(n),c.push(n),l.push(n);for(r=0,s=c.length;r<s;++r)n=c[r],n.previous=c[r-1],n.next=c[r+1];for(;n=l.pop();){var d=n.previous,p=n.next;n[1][2]<f?n[1][2]=f:f=n[1][2],d&&(d.next=p,d[2]=n[2],o(d)),p&&(p.previous=d,p[0]=n[0],o(p))}e.forEach(i)}),e}e.version="1.6.24",e.mesh=c,e.meshArcs=f,e.merge=h,e.mergeArcs=v,e.feature=i,e.neighbors=g,e.presimplify=x})},{}],34:[function(e,t,n){var r;r=e("../color/sort.coffee"),t.exports=function(e,t,n,o,a,i,l){var s,u,c;for(o||(o="asc"),a instanceof Array||(a=[a]),n instanceof Array||(n=[n]),i&&void 0!==l&&"number"!=typeof l&&(l=i.id.nesting.indexOf(l)),c=0,s=0;s<n.length&&(u=n[s],e=i&&e.d3po&&e.d3po.sortKeys?e.d3po.sortKeys[u]:e[u],t=i&&t.d3po&&t.d3po.sortKeys?t.d3po.sortKeys[u]:t[u],0===(c=i&&a.indexOf(u)>=0?r(e,t):e<t?-1:1)&&s!==n.length-1);)s++;return"asc"===o?c:-c}},{"../color/sort.coffee":51}],35:[function(e,t,n){t.exports=function(e,t){var n;return e instanceof Array&&(n=void 0===t||null===t?t:t.constructor,e.indexOf(t)>=0||e.indexOf(n)>=0)}},{}],36:[function(e,t,n){var r,o;r=e("./comparator.coffee"),o=e("../core/fetch/sort.coffee"),t.exports=function(e,t,n,a,i,l){var s,u,c,f;if(!e||e.length<=1)return e||[];if(i)for(t||(t=i.order.value||i.size.value||i.id.value),n||(n=i.order.sort.value),a||(a=i.color.value||[]),c=0,f=e.length;c<f;c++)s=e[c],s.d3po||(s.d3po={}),u="d3po"in s&&"d3po"in s.d3po?s.d3po:s,s.d3po.sortKeys=o(i,u,t,a,l);return e.sort(function(e,o){return r(e,o,t,n,a,i,l)})}},{"../core/fetch/sort.coffee":67,"./comparator.coffee":34}],37:[function(e,t,n){t.exports=function(e,t){return void 0===t?e:!1===t?[]:t instanceof Array?t:(e instanceof Array||(e=[]),e.indexOf(t)>=0?e.splice(e.indexOf(t),1):e.push(t),e)}},{}],38:[function(e,t,n){var r;r=function(e){var t,n,o,a;if(a=r.tested,e in a)return a[e];for(n=0,o=!1;n<document.styleSheets.length;){if(t=document.styleSheets[n],t.href&&t.href.indexOf(e)>=0){o=!0;break}n++}return o},r.tested={},t.exports=r},{}],39:[function(e,t,n){t.exports=/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)},{}],40:[function(e,t,n){var r,o;r=e("./ie.js"),o=e("./touch.coffee"),t.exports=o?{click:"click",down:"touchstart",up:"touchend",over:r?"mouseenter":"mouseover",out:r?"mouseleave":"mouseout",move:"mousemove"}:{click:"click",down:"mousedown",up:"mouseup",over:r?"mouseenter":"mouseover",out:r?"mouseleave":"mouseout",move:"mousemove"}},{"./ie.js":39,"./touch.coffee":45}],41:[function(e,t,n){var r;r=function(){var e;return e="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",r=function(){return e},e},t.exports=r},{}],42:[function(e,t,n){t.exports="rtl"===d3.select("html").attr("dir")},{}],43:[function(e,t,n){t.exports={y:function(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},x:function(){return void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}}},{}],44:[function(e,t,n){var r;r=function(){var e,t,n,o,a;return e=document.createElement("p"),e.style.width="100%",e.style.height="200px",t=document.createElement("div"),t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t),o=e.offsetWidth,t.style.overflow="scroll",a=e.offsetWidth,o===a&&(a=t.clientWidth),document.body.removeChild(t),n=o-a,r=function(){return n},n},t.exports=r},{}],45:[function(e,t,n){t.exports=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},{}],46:[function(e,t,n){t.exports=function(e){var t;return t=d3.hsl(e),t.l>.45&&(t.s>.8&&(t.s=.8),t.l=.45),t.toString()}},{}],47:[function(e,t,n){t.exports=function(e,t){var n;return void 0===t&&(t=.5),n=d3.hsl(e),t=(1-n.l)*t,n.l+=t,n.s-=t,n.toString()}},{}],48:[function(e,t,n){t.exports=function(e,t,n,r){var o,a,i;return n||(n=1),r||(r=1),e=d3.rgb(e),t=d3.rgb(t),i=(n*e.r+r*t.r-n*r*t.r)/(n+r-n*r),a=(n*e.g+r*t.g-n*r*t.g)/(n+r-n*r),o=(n*e.b+r*t.b-n*r*t.b)/(n+r-n*r),d3.rgb(i,a,o).toString()}},{}],49:[function(e,t,n){var r;r=e("./scale.coffee"),t.exports=function(e,t){var n;return n=e||Math.floor(20*Math.random()),(t=t||r)(n)}},{"./scale.coffee":50}],50:[function(e,t,n){t.exports=d3.scale.ordinal().range(["#bf3251","#5c57d9","#d6c650","#406662","#872a41","#1c26b3","#d05555","#549e95","#993f7b","#dc8e7a","#ede788","#7485aa","#4d6fd0","#635b56","#7454a6","#a8c380","#8abdb6","#74c0e2","#bcd8af","#a1aafb","#a17cb0","#d1a1bc"])},{}],51:[function(e,t,n){t.exports=function(e,t){var n,r;return n=d3.hsl(e),r=d3.hsl(t),e=0===n.s?361:n.h,t=0===r.s?361:r.h,e===t?n.l-r.l:e-t}},{}],52:[function(e,t,n){t.exports=function(e){var t,n,r,o,a;return o=d3.rgb(e),r=o.r,n=o.g,t=o.b,a=(299*r+587*n+114*t)/1e3,a>=128?"#444444":"#f7f7f7"}},{}],53:[function(e,t,n){t.exports=function(e){var t,n,r;return e+="",e=e.replace(RegExp(" ","g"),""),0===e.indexOf("rgb")&&(e=e.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===e.indexOf("hsl")&&(e=e.split(",")[2].split(")")[0]),n=d3.rgb(e).toString(),t=["black","#000","#000000","0%","0,0,0"],r=t.indexOf(e)>=0,"#000000"!==n||r}},{}],54:[function(e,t,n){var r,o,a;r=e("../../client/ie.js"),a=e("./wiki.coffee"),o=function(e,t,n){n=n||"",r||"undefined"!=typeof InstallTrigger?console.log("[ d3po ] "+t):0===e.indexOf("group")?console[e]("%c[ d3po ]%c "+t,"font-weight: 800;color: #b35c1e;margin-left: 0px;","font-weight: 400;"+n):console[e]("%c"+t,n+"font-weight:200;")},o.comment=function(e){this("log",e,"color:#aaa;")},o.error=function(e,t){this("groupCollapsed","ERROR: "+e,"font-weight:800;color:#D74B03;"),this.stack(),this.wiki(t),this.groupEnd()},o.group=function(e){this("group",e,"color:#888;")},o.groupCollapsed=function(e){this("groupCollapsed",e,"color:#888;")},o.groupEnd=function(){r||console.groupEnd()},o.log=function(e){this("log",e,"color:#444444;")},o.stack=function(){var e,t,n,o,a,i,l;r||(e=new Error,e.stack&&(i=e.stack.split("\n"),i=i.filter(function(e){return 0!==e.indexOf("Error")&&e.indexOf("d3po.js:")<0&&e.indexOf("d3po.min.js:")<0}),i.length&&i[0].length&&(a=window.chrome?"at ":"@",l=i[0],l.indexOf(a)>=0&&(l=l.split(a)[1]),i=l.split(":"),3===i.length&&i.pop(),t=i.pop(),o=i.join(":").split("/"),o=o[o.length-1],n="line "+t+" of "+o+": "+l,this("log",n,"color:#D74B03;"))))},o.time=function(e){r||console.time(e)},o.timeEnd=function(e){r||console.timeEnd(e)},o.warning=function(e,t){this("groupCollapsed",e,"color:#888;"),this.stack(),this.wiki(t),this.groupEnd()},o.wiki=function(e){e&&(e in a&&(e=d3po.repo+"wiki/"+a[e]),this("log","documentation: "+e,"color:#aaa;"))},t.exports=o},{"../../client/ie.js":39,"./wiki.coffee":55}],55:[function(e,t,n){t.exports={active:"Visualizations#active",aggs:"Visualizations#aggs",alt:"Forms#alt",attrs:"Visualizations#attrs",axes:"Visualizations#axes",background:"Visualizations#background",color:"Visualizations#color",cols:"Visualizations#cols",config:"Visualizations#config",container:"Visualizations#container",coords:"Visualizations#coords",csv:"Visualizations#csv",data:"Visualizations#data",depth:"Visualizations#depth",descs:"Visualizations#descs",dev:"Visualizations#dev",draw:"Visualizations#draw",edges:"Visualizations#edges",error:"Visualizations#error",focus:"Visualizations#focus",font:"Visualizations#font",footer:"Visualizations#footer",format:"Visualizations#format",height:"Visualizations#height",history:"Visualizations#history",hover:"Forms#hover",icon:"Visualizations#icon",id:"Visualizations#id",keywords:"Forms#keywords",labels:"Visualizations#labels",legend:"Visualizations#legend",links:"Visualizations#links",margin:"Visualizations#margin",messages:"Visualizations#messages",method:"Methods",mouse:"Visualizations#mouse",nodes:"Visualizations#nodes",open:"Forms#open",order:"Visualizations#order",remove:"Forms#remove",search:"Forms#search",select:"Forms#select",selectAll:"Forms#selectAll",shape:"Visualizations#shape",size:"Visualizations#size",temp:"Visualizations#temp",text:"Visualizations#text",time:"Visualizations#time",timeline:"Visualizations#timeline",timing:"Visualizations#timing",title:"Visualizations#title",tooltip:"Visualizations#tooltip",total:"Visualizations#total",type:"Visualizations#type",ui:"Visualizations#ui",width:"Visualizations#width",x:"Visualizations#x",y:"Visualizations#y",zoom:"Visualizations#zoom"}},{}],56:[function(e,t,n){var r=e("../../util/buckets.coffee"),o=e("../fetch/value.coffee"),a=e("../console/print.coffee");t.exports=function(e){if(e.dev.value&&a.time("getting color data range"),e.color.domain.value)var t=e.color.domain.value;else{var t=[];e.data.pool.forEach(function(n){var r=parseFloat(o(e,n,e.color.value));"number"==typeof r&&!isNaN(r)&&t.indexOf(r)<0&&t.push(r)})}if(e.dev.value&&a.timeEnd("getting color data range"),t.length>1){if(e.dev.value&&a.time("calculating color scale"),t=d3.extent(t),t[0]<0&&t[1]>0){var n=e.color.range;3==n.length&&(t.push(t[1]),t[1]=0)}else if(t[1]>0&&t[0]>=0){var n=e.color.heatmap;t=r(t,n.length)}else{var n=e.color.range.slice(0);t[0]<0?n.pop():n.shift()}e.color.valueScale=d3.scale.sqrt().domain(t).range(n).interpolate(d3.interpolateRgb),e.dev.value&&a.timeEnd("calculating color scale")}else e.color.valueScale=null}},{"../../util/buckets.coffee":207,"../console/print.coffee":54,"../fetch/value.coffee":69}],57:[function(e,t,n){var r=e("../fetch/value.coffee"),o=e("../console/print.coffee"),a=e("../../object/validate.coffee");t.exports=function(e,t){e.dev.value&&o.time("filtering data");var n=d3.keys(e.data.keys||{});"attrs"in e&&(n=n.concat(d3.keys(e.attrs.keys||{}))),t=t.filter(function(t){return null!==r(e,t,e.id.value)});var i=e.types[e.type.value].requirements||[];e.data.filters.forEach(function(o){n.indexOf(e[o].value)>=0&&i.indexOf(o)>=0&&(t=t.filter(function(t){var n=r(e,t,e[o].value);return"y"===o&&e.y2.value&&null===n?n=r(e,t,e.y2.value):"x"===o&&e.x2.value&&null===n&&(n=r(e,t,e.x2.value)),"size"===o?"number"==typeof n:null!==n}))});var l=e.data.solo.length?"solo":"mute";return e.data[l].length?e.data[l].forEach(function(n){function i(t){var r=e[n][l].value,o=!1;return r.forEach(function(e){"function"==typeof e?o=e(t):e===t&&(o=!0)}),"solo"===l?o:!o}function s(t,o){if(!o&&e[n].nesting){var l=e[n].nesting;a(l)&&(l=d3.values(l));for(var s=0;s<l.length;s++){var u=t.filter(function(t){return i(r(e,t,l[s]))});u.length&&(t=u)}}else t=t.filter(function(t){return i(r(e,t,e[n].value))});return t}t=s(t),"id"===n&&("nodes"in e&&e.nodes.value&&(e.dev.value&&o.time("filtering nodes"),e.nodes.restricted=s(e.nodes.value),e.dev.value&&o.timeEnd("filtering nodes")),"edges"in e&&e.edges.value&&(e.dev.value&&o.time("filtering edges"),e.edges.restricted=e.edges.value.filter(function(t){return 2===s([t[e.edges.source],t[e.edges.target]]).length}),e.dev.value&&o.timeEnd("filtering edges")))}):"nodes"in e&&(e.nodes.restricted=void 0,e.edges.restricted=void 0),e.dev.value&&o.timeEnd("filtering data"),t}},{"../../object/validate.coffee":175,"../console/print.coffee":54,"../fetch/value.coffee":69}],58:[function(e,t,n){var r=e("./nest.js"),o=e("../fetch/value.coffee"),a=e("../console/print.coffee"),i=e("../../util/uniques.coffee");t.exports=function(e){var t;if(e.data.time={values:[]},e.time&&e.time.value){e.dev.value&&(t="analyzing time periods",a.time(t)),e.data.time.values=i(e.data.value,e.time.value,o,e),e.data.time.values.sort(function(e,t){return e-t});var n=[];e.data.time.values.forEach(function(t,r){if(0!==r){var o=e.data.time.values[r-1];n.push(t-o),r===e.data.time.values.length-1&&(e.data.time.total=t-e.data.time.values[0])}}),n=d3.min(n),e.data.time.step=n;var l=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],s=[1e3,60,60,24,30,12,1];e.data.time.periods=l;var u=function(t,n,r){return e.data.time.stepDivider||(arr=s.slice(0,r),arr.length?e.data.time.stepDivider=arr.reduce(function(e,t){return e*t}):e.data.time.stepDivider=1),Math.round(Math.floor(n-t)/e.data.time.stepDivider)},c=e.data.time.total;l.forEach(function(t,r){var o="Date"===t?28:s[r];if(!e.data.time.stepType&&(r===l.length-1||Math.round(n)<o)){e.data.time.stepType=t;var a=e.data.time.values[0],i=e.data.time.values[e.data.time.values.length-1];e.data.time.stepIntervals=u(a,i,r)}!e.data.time.totalType&&(r===l.length-1||Math.round(c)<o)&&(e.data.time.totalType=t),n/=o,c/=o}),e.data.time.values.forEach(function(t,n){if(0!==n){var r=e.data.time.values[0];e.data.time.dataSteps.push(u(r,t,l.indexOf(e.data.time.stepType)))}else e.data.time.dataSteps=[0]});var f=e.time.format.value,d=e.format.locale.value,p=[function(e){return e.getMilliseconds()},function(e){return e.getSeconds()},function(e){return e.getMinutes()},function(e){return e.getHours()},function(e){return 1!=e.getDate()},function(e){return e.getMonth()},function(e){return!0}];e.data.time.functions=p;var h=function(e,t,n){if(e===t)return n&&d.timeFormat[e+"Small"]?d.timeFormat[e+"Small"]:d.timeFormat[e];if(l.indexOf(e)>=4||l.indexOf(t)<=3)return d.timeFormat[t+"-"+e];var r;return r="Date"===t?d.timeFormat[t]:d.timeFormat[t+"-Date"],"Hours"===e?r+" "+d.timeFormat[e]:r+" "+d.timeFormat["Hours-"+e]};if(e.data.time.getFormat=h,f)"string"==typeof f?e.data.time.format=d3.locale(d.format).timeFormat(f):"function"==typeof f?e.data.time.format=f:f instanceof Array&&(e.data.time.format=d3.locale(d.format).timeFormat.multi(f)),e.data.time.multiFormat=e.data.time.format;else{for(var v=e.data.time.stepType,g=e.data.time.totalType,m=[],y=l.indexOf(v);y<=l.indexOf(g);y++){var x=y-1<l.indexOf(v)?l[y]:l[y-1],b=l[y]===x&&v!==g,w=h(x,l[y],b);m.push([w,p[y]])}e.data.time.format=d3.locale(d.format).timeFormat(h(v,g)),m.length>1?(m[m.length-1][1]=function(e){return!0},e.data.time.multiFormat=d3.locale(d.format).timeFormat.multi(m)):e.data.time.multiFormat=e.data.time.format}e.data.time.ticks=[];for(var _=d3.min(e.data.time.values),k=d3.max(e.data.time.values),z=0;z<=e.data.time.stepIntervals;z++){var M=new Date(_);M["set"+e.data.time.stepType](M["get"+e.data.time.stepType]()+z),M<=k&&e.data.time.ticks.push(M)}e.dev.value&&a.timeEnd(t)}if(e.dev.value&&(t="nesting data by time and depths",a.time(t)),e.data.nested={},0===e.data.time.values.length)e.data.nested.all={},e.id.nesting.forEach(function(t,n){var o=e.id.nesting.slice(0,n+1);e.data.nested.all[t]=r(e,e.data.value,o)});else{var A=e.data.value.reduce(function(t,n){var r=o(e,n,e.time.value).getTime();return r in t||(t[r]=[]),t[r].push(n),t},{});e.data.time.values.forEach(function(t){var n=t.getTime();e.data.nested[n]={},e.id.nesting.forEach(function(t,o){var a=e.id.nesting.slice(0,o+1);e.data.nested[n][t]=r(e,A[n],a)})})}e.dev.value&&a.timeEnd(t)}},{"../../util/uniques.coffee":213,"../console/print.coffee":54,"../fetch/value.coffee":69,"./nest.js":62}],59:[function(e,t,n){var r;r=e("../fetch/value.coffee"),t.exports=function(e,t,n){var o,a,i,l,s,u,c,f,d,p;if(a=d3.nest(),e.id.grouping.value)for(void 0===n&&(n=e.id.nesting),i=l=0,u=n.length;l<u;i=++l)f=n[i],i<e.depth.value&&function(t){a.key(function(n){return r(e,n.d3po,t)})}(f);for(d=[],s=0,c=t.length;s<c;s++)o=t[s],(p=e.size.value?r(e,o,e.size.value):1)&&"number"==typeof p&&p>0&&(delete o.d3po.r,delete o.d3po.x,delete o.d3po.y,d.push({d3po:o,id:o[e.id.value],value:p}));return a.entries(d)}},{"../fetch/value.coffee":69}],60:[function(e,t,n){var r,o,a=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../console/print.coffee"),o=e("../../object/validate.coffee"),t.exports=function(e,t){var n,i,l,s,u,c,f,d,p;if(f=t+" key analysis",e.dev.value&&r.time(f),e[t].keys={},n=function(r){var i,l,s,u,c,f,d;if(r instanceof Array){for(c=[],l=0,u=r.length;l<u;l++)i=r[l],c.push(n(i));return c}if(o(r)){f=[];for(s in r)d=r[s],0===s.indexOf("d3po")||a.call(e[t].keys,s)>=0||null===d?f.push(void 0):f.push(e[t].keys[s]=typeof d);return f}},o(e[t].value)){s=d3.keys(e[t].value).length===e.id.nesting.length,u=e[t].value;for(i in u)if(d=u[i],s&&e.id.nesting.indexOf(i)>=0&&o(d))for(l in d)p=d[l],n(p);else n(d)}else{c=e[t].value;for(i in c)d=c[i],n(d)}if(e.dev.value)return r.time(f)}},{"../../object/validate.coffee":175,"../console/print.coffee":54}],61:[function(e,t,n){var r,o;r=e("../console/print.coffee"),o=e("../../object/validate.coffee"),t.exports=function(e,t,n){var a,i,l;return a=e.dev.value,a&&r.time("loading "+t),l=e[t].url,e[t].filetype.value?i=e[t].filetype.value:(i=l.slice(l.length-5).split("."),i=i.length>1&&i[1],i?("txt"===i&&(i="text"),e[t].filetype.accepted.indexOf(i)<0&&(i="json")):i="json"),("dsv"===i?d3.dsv(e[t].delimiter.value,"text/plain"):d3[i])(l,function(s,u){var c,f;if(!s&&u){if("function"==typeof e[t].callback){if(f=e[t].callback(u))if(o(f)&&t in f)for(c in f)c in e&&(e[c].value=f[c]);else e[t].value=f}else e[t].value=u;["json"].indexOf(i)<0&&e[t].value.forEach(function(e){var t;t=[];for(c in e)isNaN(e[c])?"false"===e[c].toLowerCase()?t.push(e[c]=!1):"true"===e[c].toLowerCase()?t.push(e[c]=!0):"null"===e[c].toLowerCase()?t.push(e[c]=null):"undefined"===e[c].toLowerCase()?t.push(e[c]=void 0):t.push(void 0):t.push(e[c]=parseFloat(e[c]));return t}),e[t].changed=!0,e[t].loaded=!0}else e.error.internal='Could not load data from: "'+l+'"';return a&&r.timeEnd("loading "+t),n()})}},{"../../object/validate.coffee":175,"../console/print.coffee":54}],62:[function(e,t,n){var r=e("../fetch/value.coffee"),o=e("../../object/validate.coffee"),a=e("../../util/uniques.coffee"),i=function(e,t,n,o){void 0===o&&(o=!0);var i=d3.nest(),c=[],f="temp"in e?["active","temp","total"]:[];n.length?n.forEach(function(t,n){i.key(function(n){return r(e,n,t)})}):i.key(function(e){return!0}),o&&e.axes&&e.axes.discrete&&(!e.time||e[e.axes.discrete].value!==e.time.value)&&i.key(function(t){return r(e,t,e[e.axes.discrete].value)});var d=n.length&&e.id.nesting.indexOf(n[n.length-1])>=0,p=n.length&&d?n.length-1:0;d?e.id.nesting[p]:e.depth.value;i.rollup(function(t){if(1===t.length&&"d3po"in t[0])return c.push(t[0]),t[0];t=t.reduce(function(e,t){return t.values instanceof Array?e.concat(t.values):(e.push(t),e)},[]);var o={d3po:{data:{},depth:p}};if(d3.sum(t,function(e){return"d3po"in e&&e.d3po.merged?1:0})===t.length)for(var i=0;i<t.length;i++){var u=t[i];o.d3po.merged||(o.d3po.merged=[]),o.d3po.merged=o.d3po.merged.concat(u.d3po.merged),u.d3po.text&&(o.d3po.text=u.d3po.text)}for(var d=0;d<f.length;d++){var h=f[d],v=e.aggs&&e.aggs.value[g]?e.aggs.value[g]:"sum";"d3po"in t[0]&&h in t[0].d3po?o.d3po[h]=d3.sum(t,function(e){return e.d3po[h]}):o.d3po[h]="function"==typeof v?v(t):d3[v](t,function(t){var n="total"===h?1:0;return e[h].value&&"number"!=typeof(n=r(e,t,e[h].value))&&(n=n?1:0),n})}for(var g in e.data.keys){if(g in o.d3po.data)o[g]=o.d3po[g];else{var m=e.aggs&&e.aggs.value[g]?e.aggs.value[g]:"sum",y=typeof m,x=e.data.keys[g],b=e.id.nesting.indexOf(g)>=0,w="time"in e&&g===e.time.value;if(g in o.d3po.data)o[g]=o.d3po[g];else if("function"===y)o[g]=e.aggs.value[g](t);else if(w)o[g]=s(a(t,g));else if(e.axes&&e.axes.discrete&&e[e.axes.discrete].value===g)o[g]=a(t,g);else if("number"!==x||"string"!==y||b){var _=l(t,g),k=1===_.length?_[0][g]:a(_,g);if(1===_.length)o[g]=k;else if(k&&k.length)k instanceof Array||(k=[k]),b&&e.id.nesting.indexOf(g)>p?o[g]=_:o[g]=k;else if(b){var z=e.id.nesting.indexOf(g)-1;z>=p&&(!("endPoint"in o.d3po)||o.d3po.endPoint>p)&&(o.d3po.endPoint=p)}}else{var M=t.map(function(e){return e[g]});M=M.filter(function(e){return typeof e===x}),M.length&&(o[g]=d3[m](M))}}g in o&&o[g]instanceof Array&&1===o[g].length&&(o[g]=o[g][0])}for(var A=0;A<n.length;A++){var j=n[A];j in o||(o[j]=r(e,t[0],j))}return c.push(o),o});var h=function(t,r,o){if(t.children){"number"==e.data.keys[n[r]]&&(t.key=parseFloat(t.key)),o[n[r]]=t.key,delete t.key;for(var a in o)t[a]=o[a];r++,t.children.forEach(function(e){h(e,r,o)})}};return i=i.entries(t).map(u).map(function(e){return h(e,0,{}),e}),c},l=function(e,t){function n(e){e instanceof Array?e.forEach(n):o(e)&&t in e&&(e[t]instanceof Array?e[t].forEach(n):r.push(e))}var r=[];return n(e),r},s=function(e){function t(e){for(var r=0;r<e.length;r++){var o=e[r];o&&(o.constructor===Array?t(o):n.push(o))}}var n=[];return t(e),a(n)},u=function(e){return e.values&&e.values.length?(e.children=e.values.map(function(e){return u(e)}),delete e.values,e):e.values?e.values:e};t.exports=i},{"../../object/validate.coffee":175,"../../util/uniques.coffee":213,"../fetch/value.coffee":69}],63:[function(e,t,n){var r=e("../../array/sort.coffee"),o=e("./nest.js"),a=e("../fetch/value.coffee"),i=(e("../fetch/color.coffee"),e("../fetch/text.js"));t.exports=function(e,t,n){var l;if("number"==typeof(l=!1===e.size.threshold.value?0:"number"==typeof e.size.threshold.value?e.size.threshold.value:"function"==typeof e.size.threshold.value?e.size.threshold.value(e):"number"==typeof e.types[e.type.value].threshold?e.types[e.type.value].threshold:"function"==typeof e.types[e.type.value].threshold?e.types[e.type.value].threshold(e):.02)&&l>0){var s=[],u=0===e.depth.value?0:{},c=[],f=[],d=[],p={},h=d3.nest();n&&h.key(function(t){return a(e,t,n)}),h.rollup(function(t){var r=t.length;e.aggs.value[e.size.value]?"function"==typeof e.aggs.value[e.size.value]?r=e.aggs.value[e.size.value](t):"string"==typeof e.aggs.value[e.size.value]&&(r=d3[e.aggs.value[e.size.value]](t,function(t){return a(e,t,e.size.value)})):r=d3.sum(t,function(t){return a(e,t,e.size.value)});var o=n?a(e,t[0],n):"all";return p[o]=r,r}).entries(t),t.forEach(function(t){var r=a(e,t,e.id.value),o=a(e,t,e.size.value),i=n?a(e,t,n):"all"
;if(o/p[i]>=l&&s.indexOf(r)<0&&(s.push(r),e.depth.value)){var u=a(e,t,e.id.nesting[e.depth.value-1]);f.indexOf(u)<0&&f.push(u)}});var v=t.filter(function(t){var n=a(e,t,e.id.value),r=s.indexOf(n)>=0,o=e.depth.value?a(e,t,e.id.nesting[e.depth.value-1]):null;if(null!==o&&f.indexOf(o)<0&&d.indexOf(o)<0&&d.push(o),!r){var i=a(e,t,e.size.value);i>0&&(0===e.depth.value?i>u&&(u=i):(o in u||(u[o]=0),i>u[o]&&(u[o]=i)),c.push(t))}return r});if(c.length>1){c=r(c,e.size.value,"desc",[],e);var g=e.id.nesting.slice(0,e.depth.value);e.types[e.type.value].requirements.indexOf(e.axes.discrete)>=0&&g.push(e[e.axes.discrete].value);var m=o(e,c,g);m.forEach(function(t){var n=e.id.nesting[e.depth.value-1],r=a(e,t,n);if(children=n?c.filter(function(t){return a(e,t,n)===r}):c,children.length>1){e.id.nesting.forEach(function(n,r){if(e.depth.value==r){var o=t[n];t[n]="string"==typeof o?"d3po_other_"+o:"d3po_other"}else r>e.depth.value&&delete t[n]}),e.color.value&&"string"===e.color.type&&(0===e.depth.value?t[e.color.value]=e.color.missing:t[e.color.value]=a(e,r,e.color.value,n)),e.icon.value&&(t[e.icon.value]=a(e,r,e.icon.value,n)),r&&(t.d3po.depth=e.depth.value);var o;0===e.depth.value?(o=e.format.value(e.format.locale.value.ui.values,{key:"threshold",vars:e}),o+=" < "+e.format.value(u,{key:e.size.value,vars:e})):(o=i(e,t,e.depth.value-1),o=o.length?o[0].split(" < ")[0]:e.format.value(e.format.locale.value.ui.values,{key:"threshold",vars:e}),d.indexOf(r)<0&&(o+=" < "+e.format.value(u[r],{key:e.size.value,vars:e}))),d.indexOf(r)<0&&(o+=" ("+e.format.value(100*l,{key:"share",vars:e})+")"),t.d3po.threshold=u,t.d3po.merged=children,e.text.value&&(t[e.text.value]=o),t.d3po.text=o}})}else m=c;return v.concat(m)}return t}},{"../../array/sort.coffee":36,"../fetch/color.coffee":65,"../fetch/text.js":68,"../fetch/value.coffee":69,"./nest.js":62}],64:[function(e,t,n){var r;r=e("../../font/sizes.coffee"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b;if(b=t.values||e.data.time.ticks,g=t.style||{},l=t.limit||e.width.value,m={},c=e.data.time.periods,v=e.data.time.stepType,y=e.data.time.totalType,a=e.data.time.functions,i=e.data.time.getFormat,s=e.format.locale.value.format,e.time.format.value)m.format=e.data.time.format,m.values=b,m.sizes=r(b.map(function(e){return m.format(e)}),g);else for(u=c.indexOf(v);u<=c.indexOf(y);){if(x=b.filter(function(e){var t,n;if(u===c.indexOf(v))return!0;if(t=!0,n=u-1,u<0)return!0;for(;n>=c.indexOf(v)&&t;)t=!a[n](e),n--;return t}),c[u]===y)o=d3.locale(s).timeFormat(i(c[u],y));else{for(f=u,o=[];f<=c.indexOf(y);)d=f-1<c.indexOf(v)?f:f-1,d=c[d],h=c[f]===d&&v!==y,n=i(d,c[f],h),o.push([n,a[f]]),f++;o[o.length-1][1]=function(){return!0},o=d3.locale(s).timeFormat.multi(o)}if(p=r(x.map(function(e){return o(e)}),g),d3.sum(p,function(e){return e.width})<l||u===c.indexOf(y)){m.format=o,m.values=x,m.sizes=p;break}u++}return m}},{"../../font/sizes.coffee":104}],65:[function(e,t,n){var r,o,a,i,l,s,u;r=e("./value.coffee"),i=e("../../color/random.coffee"),s=e("../../color/validate.coffee"),u=e("../../object/validate.coffee"),l=e("../../util/uniques.coffee"),t.exports=function(e,t,n){var i,s,c,f,d;if(u(t)&&"d3po"in t&&"color"in t.d3po)return t.d3po.color;if(void 0===n&&(n=e.id.value),"number"==typeof n&&(n=e.id.nesting[n]),e.color.value){for(c=[],f=e.id.nesting.indexOf(n);f>=0;){if(s=e.id.nesting[f],d=l(t,e.color.value,r,e,s),1===d.length&&(d=d[0]),!(d instanceof Array)&&void 0!==d&&null!==d){i=o(e,t,d,n),c.indexOf(i)<0&&c.push(i);break}f--}return 1===c.length?c[0]:e.color.missing}return a(e,t,n)},o=function(e,t,n,r){return n?e.color.valueScale?e.color.valueScale(n):s(n)?n:a(e,n,r):e.color.value&&"function"==typeof e.color.valueScale?e.color.valueScale(0):a(e,t,r)},a=function(e,t,n){return u(t)&&(t=r(e,t,n)),t instanceof Array&&(t=t[0]),i(t,e.color.scale.value)}},{"../../color/random.coffee":49,"../../color/validate.coffee":53,"../../object/validate.coffee":175,"../../util/uniques.coffee":213,"./value.coffee":69}],66:[function(e,t,n){var r=e("../data/filter.js"),o=e("../data/nest.js"),a=e("../console/print.coffee"),i=e("../../string/format.js"),l=e("../../string/list.coffee");t.exports=function(e,t,n){if(!e.data.value)return[];void 0===n&&(n=e.depth.value);var s=e.id.nesting[n];if(!t||t instanceof Array||(t=[t]),!t&&"time"in e){t=[];var u=e.time.solo.value.length?"solo":"mute",c=e.time[u].value;if(c.length){t=[];for(var f=0;f<c.length;f++){var d=c[f];if("function"==typeof d)for(var p=0;p<e.data.time.values.length;p++){var h=e.data.time.values[p].getTime();d(h)&&t.push(h)}else if(d.constructor===Date)t.push(new Date(d).getTime());else{d+="",4===d.length&&parseInt(d)+""===d&&(d+="/01/01");var v=new Date(d);"Invalid Date"!==v&&t.push(v.getTime())}}"mute"===u&&(t=e.data.time.values.filter(function(e){return t.indexOf(e.getTime())<0}))}else t.push("all")}else t=["all"];if(t.indexOf("all")>=0&&e.data.time.values.length){t=e.data.time.values.slice(0);for(var g=0;g<t.length;g++)t[g]=t[g].getTime()}var m=[e.type.value,s,n].concat(e.data.filters).concat(t),y=e.data.solo.length?"solo":"mute",x=d3.keys(e.data.cache),b=e.types[e.type.value].filter||void 0;if(e.data[y].length)for(var w=0;w<e.data[y].length;w++){var _=e.data[y][w],k=e[_][y].value.slice(0);k.unshift(_),k.unshift(y),m=m.concat(k)}e.axes&&e.axes.discrete&&m.push(e.axes.discrete),m=m.join("_"),e.data.cacheID=m;for(var z=0;z<x.length;z++){if(x[z].split("_").slice(1).join("_")===m){m=(new Date).getTime()+"_"+m,e.data.cache[m]=e.data.cache[x[z]],delete e.data.cache[x[z]];break}}var M;if(e.data.cache[m])return e.dev.value&&a.comment("data already cached"),M=e.data.cache[m].data,"nodes"in e&&(e.nodes.restricted=e.data.cache[m].nodes,e.edges.restricted=e.data.cache[m].edges),"function"==typeof b&&(M=b(e,M)),M;var A=[];if(M=[],e.data.value&&e.data.value.length)for(var j=0;j<t.length;j++){var E=t[j];e.data.nested[E]?M=M.concat(e.data.nested[E][s]):A.push(E)}if(0===M.length&&A.length&&!e.error.internal){A.length>1&&(A=d3.extent(A)),A=A.map(function(t){return e.data.time.format(new Date(t))}),A=A.join(" - ");var S=e.format.locale.value.error.dataYear,O=e.format.locale.value.ui.and;A=l(A,O),e.error.internal=i(S,A),e.time.missing=!0}else{if(e.time&&(e.time.missing=!1),t.length>1){var N=!1;if(["x","y","x2","y2"].forEach(function(t){e[t].value===e.time.value&&"discrete"===e[t].scale.value&&(N=!0)}),!N){var F=e.id.nesting.slice(0,n+1);M=o(e,M,F)}}M=M?r(e,M):[],20===x.length&&(x.sort(),delete e.data.cache[x[0]]),m=(new Date).getTime()+"_"+m,e.data.cache[m]={data:M},"nodes"in e&&(e.data.cache[m].nodes=e.nodes.restricted,e.data.cache[m].edges=e.edges.restricted),"function"==typeof b&&(M=b(e,M)),e.dev.value&&a.comment("storing data in cache")}return M}},{"../../string/format.js":176,"../../string/list.coffee":177,"../console/print.coffee":54,"../data/filter.js":57,"../data/nest.js":62}],67:[function(e,t,n){var r,o,a;a=e("./value.coffee"),r=e("./color.coffee"),o=e("./text.js"),t.exports=function(e,t,n,i,l){var s,u,c,f,d,p;for(n instanceof Array||(n=[n]),i instanceof Array||(i=[i]),e&&(void 0===l?l=e.id.value:"number"!=typeof l&&(l=e.id.nesting.indexOf(l))),d={},u=0,f=n.length;u<f;u++)c=n[u],p=e?i.indexOf(c)>=0?r(e,t,l):c===e.text.value?o(e,t,l):3===d3.keys(t).length&&t.d3po&&t.key&&t.values?a(e,t.values.map(function(e){return e.d3po}),c,l):a(e,t,c,l):t[c],[e.data.keys[c],e.attrs.keys[c]].indexOf("number")>=0?(s=e.order.agg.value||e.aggs.value[c]||"sum",s.constructor===String&&(s=d3[s]),p instanceof Array||(p=[p]),p=s(p)):(p instanceof Array&&(p=p[0]),p="string"==typeof p?p.toLowerCase():p),d[c]=p;return d}},{"./color.coffee":65,"./text.js":68,"./value.coffee":69}],68:[function(e,t,n){var r=e("./value.coffee"),o=e("../../object/validate.coffee"),a=e("../../util/uniques.coffee");t.exports=function(e,t,n){"number"!=typeof n&&(n=e.depth.value);var i,l=e.id.nesting[n];e.text.nesting&&o(e.text.nesting)?i=e.text.nesting[l]?e.text.nesting[l]:e.text.value:(i=[],e.text.value&&n===e.depth.value&&i.push(e.text.value),i.push(l)),i instanceof Array||(i=[i]);var s=[];if(o(t)&&"d3po"in t&&t.d3po.text)s.push(t.d3po.text.toString()),s.push(e.format.value(t.d3po.text.toString(),{vars:e,data:t}));else{var u=o(t)?t:void 0;u&&t[e.id.value]instanceof Array?t=t[e.id.value]:t instanceof Array||(t=[t]),i.forEach(function(n){var o=a(t,n,r,e,l);o.length&&(o.length>1&&(o=o.filter(function(e){return e instanceof Array||"string"==typeof e&&e.indexOf(" < ")<0})),o=o.map(function(t){return t instanceof Array?(t=t.filter(function(e){return e}),t.map(function(t){return e.format.value(t.toString(),{vars:e,data:u,key:n})})):t?e.format.value(t.toString(),{vars:e,data:u,key:n}):void 0}),1===o.length&&(o=o[0]),s.push(o))})}return s}},{"../../object/validate.coffee":175,"../../util/uniques.coffee":213,"./value.coffee":69}],69:[function(e,t,n){var r,o,a,i,l,s,u,c,f,d;f=e("../../object/validate.coffee"),c=e("../../util/uniques.coffee"),u=function(e,t,n,i){var l,s,u,d;if(s=f(t),"function"==typeof n&&s)return n(t,e);if(s){if(n in t)return t[n];if(l=e.data.cacheID+"_"+i,r(t,l,e),n in t.d3po.data[l])return t.d3po.data[l][n];if(i in t)t=t[i];else{if(!(e.id.value in t))return null;if(t=t[e.id.value],i!==n&&(u=a(e,t,i,e.id.value)),null!==u&&void 0!==u||(u=o(e,t,i,e.id.value)),null===u||void 0===u)return null;if(i===n)return u;t=u}}return t instanceof Array&&!f(t[0])&&(t=c(t)),t instanceof Array&&f(t[0])&&(d=c(t,n),d.length)?d:(d=a(e,t,n,i))?d:d=o(e,t,n,i)},a=function(e,t,n,r){var o;return e.data.viz instanceof Array&&n in e.data.keys&&(o=c(s(e.data.viz,t,r),n)),o&&o.length?o:null},o=function(e,t,n,r){var o,a,i,l;if("attrs"in e&&e.attrs.value&&n in e.attrs.keys)if((o=f(e.attrs.value)&&r in e.attrs.value?e.attrs.value[r]:e.attrs.value)instanceof Array){if(i=c(s(o,t,r),n),i.length)return i}else if(t instanceof Array){if(o=[function(){var e,n,r;if(a in o){for(r=[],e=0,n=t.length;e<n;e++)a=t[e],r.push(o[a]);return r}}()],o.length&&(l=c(o,n),l.length))return l}else if(t in o)return o[t][n];return null},s=function(e,t,n){return t instanceof Array?e.filter(function(e){return t.indexOf(e[n])>=0}):e.filter(function(e){return e[n]===t})},r=function(e,t,n){return"d3po"in e||(e.d3po={}),"data"in e.d3po||(e.d3po.data={}),!(n.data.changed||n.attrs&&n.attrs.changed)&&t in e.d3po.data||(e.d3po.data[t]={}),e},d=function(e,t,n,r,o){var a,i,l,s,u,c,d;if(null===o)return o;c="time"in e&&e.time.value===r,o instanceof Array||(o=[o]);for(l=s=0,u=o.length;s<u;l=++s)d=o[l],c&&null!==d&&d.constructor!==Date&&(d+="",4===d.length&&parseInt(d)+""===d&&(d+="/01/01"),"Invalid Date"!==(i=new Date(d))&&(o[l]=i));return 1===o.length&&(o=o[0]),null===o||!f(t)||"string"!=typeof r||r in t||(a=e.data.cacheID+"_"+n,t.d3po.data[a][r]=o),o},l=function(e,t,n,r){var o,a,i,l,s;for(s=[],a=0,i=t.length;a<i;a++)o=t[a],f(o)?(l=u(e,o,n,r),s.push(d(e,o,r,n,l))):s.push(o);return"number"!=typeof s[0]&&(s=c(s)),1===s.length?s[0]:s},i=function(e,t,n,r){var o,a;return n?"number"==typeof n?n:(o=f(t),r||(r=e.id.value),o&&t.values instanceof Array?a=l(e,t.values,n,r):o&&t[n]instanceof Array?a=l(e,t[n],n,r):t instanceof Array?a=l(e,t,n,r):(a=u(e,t,n,r),a=d(e,t,r,n,a)),a):null},t.exports=i},{"../../object/validate.coffee":175,"../../util/uniques.coffee":213}],70:[function(e,t,n){t.exports=function(e){var t,n,r;return["div","svg"].indexOf(e)<0&&(e="div"),n={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},t="div"===e?{}:{position:"absolute"},r=d3.select("body").selectAll(e+".d3po_tester").data([0]),r.enter().append(e).attr("class","d3po_tester").style(n).attr(t),r}},{}],71:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," "],dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},error:{accepted:"{0} ist kein gltiger {1} fr {2}-Darstellungen. Benutzen Sie bitte: {3}.",connections:"Keine Verbindungen verfgbar fr {0}.",data:"Keine Daten verfgbar",dataYear:"Fr {0} sind keine Daten verfgbar.",lib:"{0}-Darstellungen erfordern das Laden der Bibliothek {1}.",libs:"{0}-Darstellungen erfordern das Laden folgender Bibliotheken: {1}.",method:"{0}-Darstellungen erfordern die Methode {1}.",methods:"Weitere Einstellungen fr folgende Methoden {1} sind bei {0}-Darstellungen erforderlich."},lowercase:["ein","ein","und","wie","bei","aber","durch","fr","von","wenn","in","in","in der Nhe","noch","von","auf","auf","oder","pro","das","die","zu","mit","ber","gegen","gegen."],method:{active:"aktive Segmente",color:"Farbe",depth:"Tiefe",dev:"ausfhrlich",focus:"Fokus",icon:"Symbol",id:"Kennung",height:"Hhe",labels:"Beschriftungen",legend:"Legende",margin:"Rand",messages:"Statusmeldungen",order:"Reihenfolge",search:"Suche",shape:"Form",size:"Gre",style:"Stil",temp:"temporre Segmente",text:"Text",time:"Zeit",timeline:"Zeitleiste",total:"Segmente gesamt",type:"Typ",width:"Breite",x:"x-Achse",y:"y-Achse",zoom:"Zoom",mode:"Modus",mute:"ausblenden",solo:"isolieren"},time:["Datum","Tag","Monat","Zeit","Jahr"],visualization:{bubbles:"Blasen",chart:"Diagramm",geo_map:"Karte",line:"Liniendiagramm",network:"Netzwerk",rings:"Ringe",scatter:"Punktdiagramm",stacked:"Gestapelte Flche",tree_map:"Baumdiagramm",bar:"Balkendiagramm",box:"Boxplot",paths:"Pfade",pie:"Kreisdiagramm",table:"Tabelle"},ui:{and:"und",back:"zurck",collapse:"Zum Ausblenden klicken",error:"Fehler",expand:"Zum Einblenden klicken",loading:"Lade...",more:"{0} weitere",moreInfo:"Fr zustzliche Informationen klicken",noResults:"Keine Ergebnisse fr {0} gefunden.",primary:"Primre Verbindungen",share:"teilen",total:"gesamt",values:"Werte",including:"einschlielich",or:"oder",iqr:"Interquartilsabstnde {0}",max:"Maximalwert",min:"Minimalwert",percentile:"Perzentil P{0}",tukey_bottom:"Unterer Ausreier",tukey_top:"Oberer Ausreier",quartile_first:"Unteres Quartil Q1",quartile_third:"Oberes Quartil Q3",median:"Medianwert"},message:{data:"analysiere Daten",draw:"Darstellung wird gerendert",initializing:"initialisiere {0}",loading:"Daten werden geladen",tooltipReset:"Tooltips zurcksetzen",ui:"aktualisiere Oberflche"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","BIP","HVAC","ID","IT","FuE","TV","UI"]}},{}],72:[function(e,t,n){t.exports={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",mute:"hide",order:"order",search:"search",shape:"shape",size:"size",solo:"isolate",style:"style",temp:"temporary segments",text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L","Minutes-Seconds":"%I:%M:%S %p","Minutes-Milliseconds":"%H:%M:%S.%L","Seconds-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",iqr:"interquartile range for {0}",loading:"loading...",max:"maximum",median:"median",min:"minimum",more:"{0} more",moreInfo:"click for more info",or:"or",noResults:"no results matching {0}.",percentile:"{0} percentile",primary:"primary connections",quartile_first:"first quartile",quartile_third:"third quartile",share:"share",total:"total",tukey_bottom:"bottom tukey",tukey_top:"top tukey",values:"values"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"],visualization:{bar:"Bar Chart",box:"Box Plot",bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",paths:"Paths",pie:"Pie Chart",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",table:"Table",tree_map:"Tree Map"}}},{}],73:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," "],dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},dev:{accepted:"{0} no es un valor aceptado para {1}, por favor utilice uno de los siguientes: {2}.",deprecated:"el mtodo {0} ha sido eliminado, por favor, actualiza tu cdigo para utilizar {1}.",noChange:"{0} no se actualiza porque no cambi.",noContainer:"no se puede encontrar un contenedor en la pgina correspondiente a {0}.",of:"de",oldStyle:"propiedades de estilo para {0} ahora se han incorporado directamente en. {1} ().",sameEdge:"los vnculos no se pueden enlazar con si mismos. eliminando automticamente el vnculo {0} que se autorreferencia.",set:"{0} se ha establecido.",setLong:"{0} ha sido establecido a {1}.",setContainer:"defina un div contenedor utilizando .container ()"},error:{accepted:"{0} no es un {1} aceptado para visualizaciones de {2}, por favor utilice uno de los siguientes: {3}.",connections:"no hay conexiones disponibles para {0}.",data:"No hay datos disponibles",dataYear:"no hay datos disponibles para {0}.",lib:"{0} visualizaciones requieren cargar las siguientes libreras: {1}.",libs:"{0} visualizaciones requieren cargar las siguientes libreras: {1}.",method:"{0} visualizaciones requieren establecer el mtodo {1}.",methods:"{0} visualizaciones requieren establecer los siguientes mtodos: {1}."},lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],method:{active:"segmentos activos",color:"color",depth:"profundidad",dev:"detallado",focus:"foco",icon:"cono",id:"id",height:"alto",labels:"rtulo",legend:"leyenda",margin:"margen",messages:"mensajes de estado",order:"orden",search:"bsqueda",shape:"forma",size:"tamao",style:"estilo",temp:"segmentos temporales",text:"texto",time:"tiempo",timeline:"lnea de tiempo",total:"segmentos totales",type:"tipo",width:"anchura",x:"eje x",y:"eje Y",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"aislar"},time:["fecha","da","mes","hora","ao"],visualization:{bubbles:"Burbujas",chart:"Grfico",geo_map:"Mapa",line:"Grfico de linea",network:"Red",rings:"Anillos",scatter:"Grfico De Dispersin",stacked:"rea Apilada",tree_map:"Tree Map",bar:"Grfico De Barras",box:"Diagrama de Cajas",paths:"Caminos",pie:"Grfico de Pastel",table:"Tabla"},ui:{and:"y",back:"atrs",collapse:"click para cerrar",error:"error",expand:"haga clic para ampliar",loading:"Cargando ...",more:"{0} ms",moreInfo:"clic para ms informacin",noResults:"no se encontraron resultados para {0}.",primary:"relaciones principales",share:"porcentaje",total:"total",values:"valores",including:"Incluyendo",or:"o",iqr:"rango intercuartil para {0}",max:"mximo",min:"mnimo",percentile:"{0} percentil",tukey_bottom:"Tukey inferior",tukey_top:"la parte superior de Tukey",quartile_first:"primer cuartil",quartile_third:"tercer cuartil",median:"mediana"},message:{data:"analizando los datos",draw:"visualizando",initializing:"inicializando {0}",loading:"cargando datos",tooltipReset:"restableciendo las descripciones emergentes",ui:"actualizando la interfaz de usuario"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","UI"]}},{}],74:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," "],dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],shortMonths:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."]},dev:{accepted:"{0} n'est pas une option valide pour {1}, les valeurs possibles sont: {2}.",deprecated:"{0} a t limin de la version courante, mettez  jour votre code source avec {1}.",noChange:"{0} n'a pas t mis  jour car inchang.",noContainer:"impossible de trouver un contenant correspondant  {0}.",of:"de",oldStyle:"les proprits de {0} ont t imbriques dans .{1}().",sameEdge:"un arc ne peut pas boucler sur lui mme. L'auto-rfrence est automatiquement limine {0}.",set:"{0} a t mis  jour.",setLong:"{0} a t mis  jour  {1}.",setContainer:"merci de choisir un div qui utilise .container()"},error:{accepted:"{0} n'est pas correct {1} pour {2} visualisations, merci d'utilisez une des options suivantes: {3}.",connections:"Pas de connections disponibles pour {0}.",data:"Pas de donnes disponibles",dataYear:"Pas de donnes disponibles pour {0}.",lib:"La visualisation de {0} ncessite le chargement de la librairie {1}.",libs:"La visualisation de {0} ncessite le chargement des librairies {1}.",method:"La visualisation du {0} exige la dfinition de {1}.",methods:"La visualisation du {0} exige les dfinitions de {1}."},lowercase:["un","une","de","des","et","mais","les","ou","pour","avec","comme","par","vers","si","dans","prs","ni","dessus","que","le","la","via","sinon","alors"],method:{active:"segments actifs",color:"couleur",depth:"profondeur",dev:"verbeux",focus:"focus",icon:"cone",id:"id",height:"hauteur",labels:"labels",legend:"lgende",margin:"marge",messages:"messages",order:"ordre",search:"recherche",shape:"format",size:"taille",style:"style",temp:"segments temporaires",text:"texte",time:"temps",timeline:"ligne temporelle",total:"segments totaux",type:"type",width:"largeur",x:"axe x",y:"axe y",zoom:"zoom",mode:"mode",mute:"cacher",solo:"isoler"},time:["anne","date","jour","heure","mois"],visualization:{bubbles:"Bulles",chart:"Graphique",geo_map:"Carte",line:"Courbes",network:"Rseau",rings:"Anneaux",scatter:"Nuage de points",stacked:"Aires empiles",tree_map:"Arbre",bar:"Diagramme en barres",box:"Botes  Moustaches",paths:"Chemins",pie:"Camembert",table:"Table"},ui:{and:"et",back:"retour",collapse:"clic pour rduire",error:"erreur",expand:"clic pour agrandir",loading:"chargement ...",more:"plus {0}",moreInfo:"clic pour plus d'information",noResults:"pas de rsultat correspondant  {0}.",primary:"connections primaires",share:"part",total:"total",values:"valeurs",including:"incluant",or:"ou",iqr:"gamme interquartile pour {0}",max:"maximum",min:"le minimum",percentile:"{0} percentile",tukey_bottom:"tukey bas",tukey_top:"top tukey",quartile_first:"premier quartile",quartile_third:"le troisime quartile",median:"mdian"},message:{data:"analyse des donnes",draw:"trac en cours",initializing:"Initialisation {0}",loading:"chargement",tooltipReset:"rinitialisation des bulles",ui:"rafraichissement de l'interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","IT","TV","UI"]}},{}],75:[function(e,t,n){t.exports={format:{decimal:".",thousands:",",grouping:[3],currency:["",""],dateTime:"%Y/%m/%d %a %X",date:"%Y/%m/%d",time:"%H:%M:%S",periods:["",""],days:["","","","","","",""],shortDays:["","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],shortMonths:["1","2","3","4","5","6","7","8","9","10","11","12"]},error:{accepted:"{0}  {1} {2}       : {3}.",connections:"{0}   .",data:" ",dataYear:"{0}   .",lib:"{0}  {1}   .",libs:"{0}       : {1}.",method:"{0}   {1}   .",methods:"{0}      : {1}."},lowercase:[""],method:{active:" ",color:"",depth:"",dev:"",focus:"",icon:"",id:"",height:"",labels:"",legend:"",margin:"",messages:" ",order:"",search:"",shape:"",size:"",style:"",temp:" ",text:"",time:"",timeline:" ",total:" ",type:"",width:"",x:"X ",y:"Y ",zoom:"",mode:"",mute:"",solo:""},time:["","","","",""],visualization:{bubbles:" ",chart:"",geo_map:"",line:" ",network:" ",rings:"",scatter:"",stacked:"  ",tree_map:" ",bar:" ",box:" ",paths:"",pie:" ",table:""},ui:{and:"",back:"",collapse:" ",error:"",expand:" ",loading:"  ...",more:"{0} ",moreInfo:"   ",noResults:"   {0}.",primary:" ",share:"",total:"",values:"",including:"... ",or:"",iqr:"    {0}",max:"",min:"",percentile:"{0}  ",tukey_bottom:" Tukey",tukey_top:" Tukey",quartile_first:"1 ",quartile_third:"3 ",median:""},message:{data:"  ",draw:"  ",initializing:" {0}",loading:"  ",tooltipReset:" ",ui:"UI  "},uppercase:["CEO"," ","   (CFO)","CFO","CNC","COO","","CPU","CPU","GDP","HVAC","ID","IT","R & D","TV","UI"]}},{}],76:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," ."],dateTime:"%A, %e %B %Y . %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},error:{accepted:"{0}     {1} {2} ,      : {3}.",connections:"     {0}.",data:" ",dataYear:"     {0}.",lib:"{0}      {1} .",libs:"{0}      : {1}.",method:"{0}     {1} .",methods:"{0}      : {1}."},lowercase:["a","","","","","","","",""],method:{active:" ",color:"",depth:"",dev:"",focus:"",icon:"",id:"",height:"",labels:"",legend:"",margin:"",messages:"  ",order:" ",search:"",shape:"",size:"",style:"",temp:" ",text:"",time:"",timeline:"",total:" ",type:"",width:"",x:"x ",y:"Y ",zoom:"",mode:"",mute:" ",solo:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:" ",line:" ",network:"",rings:"",scatter:" ",stacked:" ",tree_map:"    ",bar:" ",box:" ",paths:"",pie:" ",table:""},ui:{and:"",back:"",collapse:"    ",error:"",expand:"  ",loading:"  ...",more:"{0} ",moreInfo:"   ",noResults:"       {0}.",primary:" ",share:"",total:"",values:"",including:"",or:"",iqr:"interquartile   {0}",max:"",min:"",percentile:"{0} ",tukey_bottom:" Tukey",tukey_top:" Tukey",quartile_first:" ",quartile_third:" ",median:""},message:{data:"  ",draw:"  ",initializing:" {0}",loading:"  ",tooltipReset:"  ",ui:"   "},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"]}},{}],77:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},dev:{accepted:"{0} no  um valor vlido para {1}, por favor use um dos seguintes procedimentos: {2}.",deprecated:"{0} mtodo foi removido, por favor atualize seu cdigo para utilizar {1}.",noChange:"{0} no foi atualizado porque ele no mudou.",noContainer:"No foi possvel encontrar um local na pgina correspondente a {0}.",of:"do",oldStyle:"propriedades de estilo para {0} j foram incorporados diretamente no. {1} ().",sameEdge:"bordas no podem vincular a si mesmos. removendo automaticamente borda de auto-referncia {0}.",set:"{0} foi definido.",setLong:"{0} foi definido para {1}.",setContainer:"por favor, defina um div utilizando .container()"},error:{accepted:"{0} no  um {1} reconhecido para visualizaes {2}, favor usar um dos seguintes procedimentos: {3}.",connections:"No h conexes disponveis para {0}.",data:"No h dados disponveis",dataYear:"No h dados disponveis para {0}.",lib:"A visualizao {0} necessita que seja carregado a biblioteca {1}.",libs:"A visualizao {0} necessita que seja carregado as bibliotecas {1}.",method:"A visualizao {0} exige a definio do mtodo {1}.",methods:"A visualizao {0} exige a definio dos mtodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{
active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"cone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"mensagens de status",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporrios",text:"texto",time:"Tempo",timeline:"cronograma",total:"segmentos totais",type:"digitar",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"isolar"},time:["data","dia","ms","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Grfico",geo_map:"Mapa",line:"Grfico de Linha",network:"Rede",rings:"Anis",scatter:"disperso",stacked:"Evoluo",tree_map:"Tree Map",bar:"Grfico de Barras",box:"box Plot",paths:"caminhos",pie:"Carta de torta",table:"Mesa"},ui:{and:"e",back:"voltar",collapse:"clique para entrar em colapso",error:"erro",expand:"clique para expandir",loading:"carregando ...",more:"mais {0}",moreInfo:"Clique para mais informaes",noResults:"nenhum resultado para {0}.",primary:"conexes primrias",share:"participao",total:"total",values:"valores",including:"Incluindo",or:"ou",iqr:"intervalo interquartil para {0}",max:"mximo",min:"mnimo",percentile:"{0} percentil",tukey_bottom:"tukey bottom",tukey_top:"tukey topo",quartile_first:"primeiro quartil",quartile_third:"terceiro quartil",median:"mediana"},message:{data:"analisando dados",draw:"desenhando visualizao",initializing:"inicializando {0}",loading:"carregando dados",tooltipReset:"redefinindo as dicas",ui:"atualizando interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","P&D","TV","IU"]}},{}],78:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},error:{accepted:"{0} no  uma {1} vlida para a visualizao {2}, por favor escolha uma das seguintes: {3}.",connections:"no existem ligaes disponveis para {0}.",data:"no existem dados disponveis",dataYear:"no existem dados disponveis para {0}.",lib:"a visualizao {0} necessita que a biblioteca {1} seja carregada.",libs:"a visualizao {0} necessita que as seguintes bibliotecas sejam carregadas: {1}.",method:"A visualizao {0} exige a definio do mtodo {1}.",methods:"A visualizao {0} exige a definio dos seguintes mtodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"cone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"estado",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporrios",text:"texto",time:"tempo",timeline:"linha temporal",total:"segmentos totais",type:"digitar",width:"largura",x:"eixo dos xx",y:"eixo dos yy",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"isolar"},time:["data","dia","ms","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Diagrama",geo_map:"Mapa",line:"Grfico de Linha",network:"Grafo",rings:"Anis",scatter:"Grfico de Disperso",stacked:"Grfico de rea",tree_map:"Tree Map",bar:"Grfico de Barras",box:"Diagrama de Caixa e Bigodes",paths:"caminhos",pie:"Grfico de Setores",table:"Mesa"},ui:{and:"e",back:"voltar",collapse:"Clique para colapsar",error:"erro",expand:"clique para expandir",loading:"a carregar ...",more:"mais {0}",moreInfo:"Clique para mais informaes",noResults:"nenhum resultado para {0}.",primary:"ligaes principais",share:"proporo",total:"total",values:"valores",including:"Incluindo",or:"ou",iqr:"intervalo interquartil para {0}",max:"mximo",min:"mnimo",percentile:"{0} percentil",tukey_bottom:"tukey bottom",tukey_top:"tukey topo",quartile_first:"primeiro quartil",quartile_third:"terceiro quartil",median:"mediana"},message:{data:"a analisar os dados",draw:"a desenhar a visualizao",initializing:"a inicializar {0}",loading:"a carregar os dados",tooltipReset:"a actualizar as caixas de informao",ui:"a actualizar o interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","IU"]}},{}],79:[function(e,t,n){t.exports={format:{decimal:",",thousands:"",grouping:[3],currency:[""," ."],dateTime:"%A, %e %B %Y . %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},error:{accepted:"{0}    {1}  {2} , ,     : {3}.",connections:" ,   {0}.",data:" ",dataYear:"   {0}.",lib:"{0}    {1} .",libs:"{0}     : {1}.",method:"{0}    {1} .",methods:"{0}     : {1}."},lowercase:["","","","","",""," ","","","","","","","","","",""," ","",""],method:{active:" ",color:"",depth:"",dev:"",focus:"",icon:"",id:" ",height:"",labels:"",legend:"",margin:"",messages:"  ",order:"",search:"",shape:"",size:"",style:"",temp:" ",text:"",time:"",timeline:"",total:" ",type:"",width:"",x:" ",y:" Y",zoom:"",mode:"",mute:"",solo:""},time:[""," ","","",""],visualization:{bubbles:"",chart:"",geo_map:" Geo",line:" ",network:"",rings:"",scatter:"Scatter Plot",stacked:"Stacked ",tree_map:" ",bar:"",box:"Box ",paths:"",pie:" ",table:""},ui:{and:" ",back:"",collapse:",  ",error:"",expand:",  ",loading:" ...",more:"{0} ",moreInfo:"    ",noResults:" ,  {0}.",primary:" ",share:"",total:"",values:"",including:"  ",or:"",iqr:"   {0}",max:"",min:"",percentile:"{0} ",tukey_bottom:" ",tukey_top:" ",quartile_first:" ",quartile_third:" ",median:""},message:{data:" ",draw:" ",initializing:" {0}",loading:" ",tooltipReset:"  ",ui:"  "},uppercase:["ID"]}},{}],80:[function(e,t,n){t.exports={format:{decimal:".",thousands:",",grouping:[3],currency:["",""],dateTime:"%A %B %e %Y %X",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["",""],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},error:{accepted:"{0}{2}{1}, {3}.",connections:"{0}",data:"",dataYear:"{0}",lib:"{0}{1}",libs:"{0}{1}",method:"{0}{1}",methods:"{0}{1}"},lowercase:["","","","","...","","","","","..."],method:{active:"",color:"",depth:"",dev:"",focus:"",icon:"",id:"",height:"",labels:"",legend:"",margin:"",messages:"",order:"",search:"",shape:"",size:"",style:"",temp:"",text:"",time:"",timeline:"",total:"",type:"",width:"",x:"X",y:"Y",zoom:"",mode:"",mute:"",solo:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:"",line:"",network:"",rings:"",scatter:"",stacked:"",tree_map:"",bar:"",box:"",paths:"",pie:"",table:""},ui:{and:"",back:"",collapse:"",error:"",expand:"",loading:"...",more:"{0}",moreInfo:"",noResults:"{0}",primary:"",share:"",total:"",values:"",including:"",or:"",iqr:"{0}",max:"",min:"",percentile:"{0}",tukey_bottom:"",tukey_top:"",quartile_first:"",quartile_third:"",median:""},message:{data:"",draw:"",initializing:"{0}",loading:"",tooltipReset:"",ui:"UI"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","","",""]}},{}],81:[function(e,t,n){t.exports={de_DE:e("./languages/de_DE.js"),en_US:e("./languages/en_US.coffee"),es_ES:e("./languages/es_ES.js"),fr_FR:e("./languages/fr_FR.js"),ko_KR:e("./languages/ko_KR.js"),mk_MK:e("./languages/mk_MK.js"),pt_BR:e("./languages/pt_BR.js"),pt_PT:e("./languages/pt_PT.js"),ru_RU:e("./languages/ru_RU.js"),zh_CN:e("./languages/zh_CN.js")}},{"./languages/de_DE.js":71,"./languages/en_US.coffee":72,"./languages/es_ES.js":73,"./languages/fr_FR.js":74,"./languages/ko_KR.js":75,"./languages/mk_MK.js":76,"./languages/pt_BR.js":77,"./languages/pt_PT.js":78,"./languages/ru_RU.js":79,"./languages/zh_CN.js":80}],82:[function(e,t,n){var r,o,a,i,l,s,u,c,f;o=e("../../util/copy.coffee"),l=e("../console/print.coffee"),s=e("./process/detect.coffee"),u=e("./set.coffee"),c=e("../../string/format.js"),f=e("../../object/validate.coffee"),t.exports=function(e,t){var n,r,l;l=[];for(n in t)r=t[n],e[n]=o(r),e[n].initialized=i(e,e[n],n),l.push(e.self[n]=a(e,n));return l},i=function(e,t,n,r){var o,a,u,d,p;t.previous=!1,t.changed=!1,t.initialized=!1,t.callback=!1,"init"in t&&!("value"in t)&&(t.value=t.init(e),delete t.init),"process"in t&&(t.value=s(e,t,t.value));for(p in t)if("deprecates"===p)for(a=t[p]instanceof Array?t[p]:[t[p]],u=0,d=a.length;u<d;u++)o=a[u],e.self[o]=function(t,n){return function(o){var a,i,s;return s=e.format.locale.value.dev.deprecated,t="."+t+"()",i=r?'"'+n+'" in .'+r+"()":"."+n+"()",a=r||n,l.error(c(s,t,i),a),e.self}}(o,n);else"global"===p?n in e||(e[n]=[]):"value"!==p&&f(t[p])&&i(e,t[p],p,n);return!0},a=function(e,t){return function(n,o){var a,i,s,u,d,p,h,v;if(a="accepted"in e[t]?e[t].accepted:null,"function"==typeof a&&(a=a(e)),a instanceof Array||(a=[a]),n===Object)return e[t];if(!arguments.length&&a.indexOf(void 0)<0)return"value"in e[t]?e[t].value:e[t];if("style"===t&&"object"==typeof n){v=e.format.locale.value.dev.oldStyle;for(p in n)l.warning(c(v,'"'+p+'"',p),p),e.self[p](n[p])}if("font"===t){"string"==typeof n&&(n={family:n}),h=!0,s=function(e,t,n,r){f(e[n])&&t in e[n]&&(f(e[n][t])?e[n][t].process?e[n][t].value=e[n][t].process(r):e[n][t].value=r:e[n][t]=r)},i=function(e,t,n){var r;if(f(e)){if(h)for(r in e)s(e,t,r,n);else"font"in e&&s(e,t,"font",n);h=!1;for(r in e)i(e[r],t,n)}};for(u in n)d=n[u],"secondary"!==u&&(f(d)&&(d=d.value),d&&i(e,u,d))}return r(e,t,e,t,n),"function"==typeof o&&(e[t].callback=o),!1===e[t].chainable?e[t].value:e.self}},r=function(e,t,n,o,a){var i,l,s,c;if(["accepted","changed","initialized","previous","process"].indexOf(o)<0)if(c=f(a),s=f(n[o])&&"objectAccess"in n[o]&&!1===n[o].objectAccess,i=c&&(s||!("value"in a)&&(!f(n[o])||!(d3.keys(a)[0]in n[o]))),null===a||!c||i)u(e,t,n,o,a);else if(c)for(l in a)r(e,t,n[o],l,a[l])}},{"../../object/validate.coffee":175,"../../string/format.js":176,"../../util/copy.coffee":210,"../console/print.coffee":54,"./process/detect.coffee":90,"./set.coffee":96}],83:[function(e,t,n){t.exports=function(e){return e||(e=!1),{accepted:[!1,Array,Function,Number,Object,String],callback:{accepted:[!1,Function],value:!1},global:e,process:Array,value:[]}}},{}],84:[function(e,t,n){var r;r=e("../../../client/rtl.coffee"),t.exports=function(e){var t;return t=["left","center","right"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="left"),{accepted:t,process:function(e){return r?"left"===e?"right":"right"===e?"left":e:e},value:e}}},{"../../../client/rtl.coffee":42}],85:[function(e,t,n){t.exports=function(e){var t;return t=["line-through","none","overline","underline"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}},{}],86:[function(e,t,n){var r,o;o=e("../../../font/validate.coffee"),r=["Fira Sans","Source Sans Pro","Open Sans","Ubuntu","sans-serif"],t.exports=function(e){return void 0===e&&(e=r),{process:o,value:e}}},{"../../../font/validate.coffee":105}],87:[function(e,t,n){t.exports=function(e){var t;return t=["top","middle","bottom"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="bottom"),{accepted:t,mapping:{top:"0ex",middle:"0.5ex",bottom:"1ex"},process:function(e){return this.text=e,this.mapping[e]},value:e}}},{}],88:[function(e,t,n){t.exports=function(e){var t;return t=["capitalize","lowercase","none","uppercase"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}},{}],89:[function(e,t,n){t.exports=function(e,t,n){var r;return t.history&&t.history.reset(),e.constructor===String?e.indexOf("/")>=0?(n.url=e,[]):(r=d3.selectAll(e),r.size()?r:(e.indexOf(".")>=0&&(n.url=e),[])):e}},{}],90:[function(e,t,n){var r,o;r=e("../../../util/copy.coffee"),o=e("../../../array/update.coffee"),t.exports=function(e,t,n){return t.process===Array?o(r(t.value),n):"object"==typeof t.process&&"string"==typeof n?t.process[n]:"function"==typeof t.process?t.process(n,e,t):n}},{"../../../array/update.coffee":37,"../../../util/copy.coffee":210}],91:[function(e,t,n){var r;r=e("../../../client/css.coffee"),t.exports=function(e,t,n){return!1===e||e.indexOf("fa-")<0||0===e.indexOf("fa-")&&r("font-awesome")?e:n.fallback}},{"../../../client/css.coffee":38}],92:[function(e,t,n){t.exports=function(e,t){var n,r,o,a,i,l,s,u,c,f,d,p,h;if("string"==typeof e){for(e=e.split(" "),n=r=0,i=e.length;r<i;n=++r)h=e[n],e[n]=parseFloat(h,10);e=1===e.length?e[0]:2===e.length?{top:e[0],right:e[1],bottom:e[0],left:e[1]}:3===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[1]}:4===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[3]}:0}if(p=["top","right","bottom","left"],"number"==typeof e)for(o=0,l=p.length;o<l;o++)d=p[o],t[d]=e;else for(a=0,s=p.length;a<s;a++)d=p[a],t[d]=e[d];for(t.css="",f=[],n=c=0,u=p.length;c<u;n=++c)d=p[n],n&&(t.css+=" "),f.push(t.css+=t[d]+"px");return f}},{}],93:[function(e,t,n){var r,o,a,i;r=e("../../array/contains.coffee"),o=e("../../string/format.js"),a=e("../../string/list.coffee"),i=e("../console/print.coffee"),t.exports=function(e,t,n,l,s){var u,c,f,d,p,h,v,g;if("function"==typeof t&&(t=t(e)),t instanceof Array||(t=[t]),!1===(c=r(t,n))&&void 0!==n){for(h=[],g=JSON.stringify(n),"string"!=typeof n&&(g='"'+g+'"'),d=0,p=t.length;d<p;d++)u=t[d],"string"==typeof u?h.push('"'+u+'"'):"function"==typeof u?h.push(u.toString().split("()")[0].substring(9)):void 0===u?h.push("undefined"):h.push(JSON.stringify(u));h=a(h,e.format.locale.value.ui.or),e.type&&["mode","shape"].indexOf(l)>=0?(v=e.format.locale.value.error.accepted,f=e.format.locale.value.visualization[e.type.value]||e.type.value,i.warning(o(v,g,l,f,h),l)):(v=e.format.locale.value.dev.accepted,i.warning(o(v,g,s,h),l))}return!c}},{"../../array/contains.coffee":35,"../../string/format.js":176,"../../string/list.coffee":177,"../console/print.coffee":54}],94:[function(e,t,n){t.exports=function(e){var t;return t=["auto","optimizeSpeed","crispEdges","geometricPrecision"],t.indexOf(e)>=0||(e="crispEdges"),{accepted:t,value:e}}},{}],95:[function(e,t,n){var r,o;o=e("../../object/validate.coffee"),r=function(e,t){var n;e.changed&&(e.changed=!1),"draw"===t&&(e.frozen=!1,e.update=!0,e.first=!1);for(n in e)n.indexOf("d3po")<0&&o(e[n])&&r(e[n],n)},t.exports=r},{"../../object/validate.coffee":175}],96:[function(e,t,n){var r,o,a,i,l,s,u,c,f;r=e("../../util/copy.coffee"),o=e("../../util/d3selection.coffee"),f=e("../../object/validate.coffee"),a=e("../../object/merge.coffee"),i=e("../console/print.coffee"),l=e("./process/detect.coffee"),s=e("./rejected.coffee"),u=e("../../string/format.js"),c=e("../../array/update.coffee"),t.exports=function(e,t,n,d,p){var h,v,g,m,y,x,b,w,_,k,z,M,A,j;if(M="value"!==d&&d&&d!==t?'"'+d+'" '+e.format.locale.value.dev.of+" ."+t+"()":"."+t+"()",h="value"===d&&"accepted"in n?n.accepted:f(n[d])&&"accepted"in n[d]?n[d].accepted:[p],!s(e,h,p,t,M)){if(f(n[d])&&"value"in n[d]&&(k=d,n=n[d],d="value"),"value"===d&&"process"in n&&(p=l(e,n,p)),n[d]instanceof Array||n[d]!==p||void 0===p){if(n.changed=!0,n.loaded&&(n.loaded=!1),"history"in e&&"draw"!==t&&(v=r(n),v.method=t,e.history.chain.push(v)),n.previous=n[d],"id"in e&&"value"===d&&"nesting"in n)if("id"!==t){if("object"!=typeof n.nesting&&(n.nesting={}),f(p)){for(x in p)"string"==typeof p[x]&&(p[x]=[p[x]]);n.nesting=a(n.nesting,p),e.id.value in n.nesting||(n.nesting[e.id.value]=p[d3.keys(p)[0]])}else p instanceof Array?n.nesting[e.id.value]=p:n.nesting[e.id.value]=[p];n[d]=n.nesting[e.id.value][0]}else p instanceof Array?(n.nesting=p,"depth"in e&&e.depth.value<p.length?n[d]=p[e.depth.value]:(n[d]=p[0],"depth"in e&&(e.depth.value=0))):(n[d]=p,n.nesting=[p],"depth"in e&&(e.depth.value=0));else"depth"===t?(p>=e.id.nesting.length?e.depth.value=e.id.nesting.length-1:e.depth.value=p<0?0:p,e.id.value=e.id.nesting[e.depth.value],"object"==typeof e.text.nesting&&(_=e.text.nesting[e.id.value])&&(e.text.nesting[e.id.value]="string"==typeof _?[_]:_,e.text.value=_ instanceof Array?_[0]:_)):f(n[d])&&f(p)?n[d]=a(n[d],p):n[d]=p;"value"===d&&n.global&&(y=n[d].length>0,(b=k||d)in e&&(y&&e.data[b].indexOf(t)<0||!y&&e.data[b].indexOf(t)>=0)&&(e.data[b]=c(e.data[b],t))),"value"===d&&n.dataFilter&&e.data&&e.data.filters.indexOf(t)<0&&e.data.filters.push(t),e.dev.value&&n.changed&&void 0!==n[d]&&(w=n[d]instanceof Array&&n[d].length>10,m=o(n[d]),A="function"==typeof n[d],j=w||m||A?null:"string"==typeof n[d]?n[d]:JSON.stringify(n[d]),null!==j&&j.length<260?(z=e.format.locale.value.dev.setLong,i.log(u(z,M,'"'+j+'"'))):(z=e.format.locale.value.dev.set,i.log(u(z,M))))}else z=e.format.locale.value.dev.noChange,e.dev.value&&i.comment(u(z,M));"value"===d&&n.callback&&!n.url&&(g="function"==typeof n.callback?n.callback:n.callback.value)&&g(p,e.self)}}},{"../../array/update.coffee":37,"../../object/merge.coffee":174,"../../object/validate.coffee":175,"../../string/format.js":176,"../../util/copy.coffee":210,"../../util/d3selection.coffee":211,"../console/print.coffee":54,"./process/detect.coffee":90,"./rejected.coffee":93}],97:[function(e,t,n){var r=e("../console/print.coffee"),o=e("../../string/format.js");t.exports=function(e){if(e.dev.value){var t="analyzing edges list";r.time(t)}var n=e.types[e.type.value].requirements;n instanceof Array||(n=[n]);var a=n.indexOf("nodes")>=0&&!e.nodes.value;if(a){e.nodes.value=[];var i=[];e.nodes.changed=!0}e.edges.value.forEach(function(t){["source","target"].forEach(function(n){var r=typeof t[e.edges[n]];if("object"!==r)if("number"!==r||a||"number"===e.data.keys[e.id.value])if(a&&i.indexOf(t[e.edges[n]])>=0)t[e.edges[n]]=e.nodes.value.filter(function(r){return r[e.id.value]===t[e.edges[n]]})[0];else{var o={};o[e.id.value]=t[e.edges[n]],t[e.edges[n]]=o}else t[e.edges[n]]=e.nodes.value[t[e.edges[n]]];var l=t[e.edges[n]];a&&i.indexOf(l[e.id.value])<0&&(i.push(l[e.id.value]),e.nodes.value.push(l))}),"keys"in e.data||(e.data.keys={}),e.id.value in e.data.keys||(e.data.keys[e.id.value]=typeof t[e.edges.source][e.id.value])}),e.edges.value=e.edges.value.filter(function(t){var n=t[e.edges.source][e.id.value];if(n===t[e.edges.target][e.id.value]){var a=e.format.locale.value.dev.sameEdge;return r.warning(o(a,'"'+n+'"'),"edges"),!1}return!0}),e.edges.linked=!0,e.dev.value&&r.timeEnd(t)}},{"../../string/format.js":176,"../console/print.coffee":54}],98:[function(e,t,n){var r=e("./hideElement.js");t.exports=function(e){function t(e,t){[].forEach.call(t.attributes,function(t){if(/^data-/.test(t.name)){var n=t.name.substr(5).replace(/-(.)/g,function(e,t){return t.toUpperCase()});e[n]=t.value}}),n.forEach(function(n){null!==t.getAttribute(n)&&(e[n]=t.getAttribute(n))})}var n=[e.color.value,e.icon.value,e.keywords.value,e.alt.value,"style"];e.text.value||e.self.text("text"),n=n.concat(e.id.nesting),e.self.data({element:e.data.value});var o=e.data.element.value.node().tagName.toLowerCase(),a=e.data.element.value.attr("type"),i=[];if("select"===o){var l=e.data.element.value.node().id;l&&e.self.container({id:l}),e.data.element.value.selectAll("option").each(function(n,r){var o={};if(o.text=d3.select(this).text(),t(o,this),i.push(o),this.selected)for(var r=e.id.nesting.length-1;r>=0;r--){var a=e.id.nesting[r];if(a in o){e.self.focus(o[a]);break}}})}else if("input"===o&&"radio"===a){var s=e.data.element.value.node().getAttribute("name");s&&e.self.container({id:s}),e.data.element.value.each(function(n,o){var a={};t(a,this);var l=a[e.id.value]||this.id||!1;if(l&&isNaN(parseFloat(l))){var s=d3.select("label[for="+l+"]");s.empty()||(a.text=s.html(),s.call(r))}i.push(a),this.checked&&e.self.focus(a[e.id.value])})}!e.focus.value.length&&i.length&&(e.data.element.value.node().selectedIndex=0,e.self.focus(i[0][e.id.value]));var u=d3.select("legend[for="+e.container.id+"]");u.empty()||(e.self.title(u.html()),u.call(r));var c=!!e.container.value&&e.container.value.node().tagName.toLowerCase();return!1!==e.container.value&&"body"!==c||(e.container.value=d3.select(e.data.element.value.node().parentNode)),e.data.element.value.call(r),i}},{"./hideElement.js":99}],99:[function(e,t,n){t.exports=function(e){e.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}},{}],100:[function(e,t,n){var r=e("../console/print.coffee");t.exports=function(e){if("network"===e.type.value){if(e.dev.value){var t="analyzing node positions";r.time(t)}if(e.nodes.value.filter(function(e){return"number"==typeof e.x&&"number"==typeof e.y}).length===e.nodes.value.length)e.nodes.positions=!0;else{var n=d3.layout.force().size([e.width.viz,e.height.viz]).nodes(e.nodes.value).links(e.edges.value),o=e.edges.strength.value;o&&("string"==typeof o?n.linkStrength(function(e){return e[o]}):n.linkStrength(o));n.start();for(var a=50;a>0&&(n.tick(),!(n.alpha()<.01));--a);n.stop(),e.nodes.positions=!0}e.dev.value&&r.timeEnd(t)}}},{"../console/print.coffee":54}],101:[function(e,t,n){var r;r=e("numeric"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j;for(null==t&&(t={}),null==t.maxDegree&&(t.maxDegree=5),n=e.length,x=Number.MAX_VALUE,l=null,a=function(){var n,r,o;for(o=[],c=n=1,r=t.maxDegree+1;1<=r?n<r:n>r;c=1<=r?++n:--n)o.push(function(){var t,n,r;for(r=[],n=0,t=e.length;n<t;n++)y=e[n],r.push(Math.pow(y[0],c));return r}());return o}(),A=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)y=e[t],r.push(y[1]);return r}(),d=v=0,w=1<<t.maxDegree;0<=w?v<w:v>w;d=0<=w?++v:--v){for(i=[function(){var e,t,r;for(r=[],b=e=0,t=n;0<=t?e<t:e>t;b=0<=t?++e:--e)r.push(1);return r}()],f=[0],p=m=0,_=t.maxDegree;0<=_?m<_:m>_;p=0<=_?++m:--m)(d&1<<p)>0&&(i.push(a[p]),f.push(p+1));o=r.transpose(i),h=f.length,s=r.dot(r.dot(r.inv(r.dot(i,o)),i),A),j=r.dot(o,s),k=r.sub(A,j),M=r.dot(k,k),z=M/(n-h),g=-.5*n*Math.log(2*Math.PI)-.5*n*Math.log(z)-M/(2*z),u=-2*g+h*(Math.log(n)-Math.log(2*Math.PI)),u<x&&(x=u,l=[f,s,j])}return l}},{numeric:8}],102:[function(e,t,n){var r;r=e("static-kdtree"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h;return null==t&&(t=10),h=r(e),u=function(){var n,r,o;for(o=[],n=0,r=e.length;n<r;n++)c=e[n],o.push(h.knn(c,t+1).slice(1));return o}(),p=function(t,n){var r,o,a,i,l,s;for(r=e[t],o=e[n],i=0,t=l=0,s=r.length;0<=s?l<s:l>s;t=0<=s?++l:--l)a=r[t]-o[t],i+=a*a;return i},i=function(){var n,r,a;for(a=[],o=n=0,r=e.length;0<=r?n<r:n>r;o=0<=r?++n:--n)a.push(p(o,u[o][t-1]));return a}(),f=function(e,t){return Math.max(p(e,t),i[t])},l=function(e){var n,r,o,a,i;for(a=0,i=u[e],r=0,o=i.length;r<o;r++)n=i[r],a+=f(e,n);return t/a},s=function(){var t,n,r;for(r=[],o=t=0,n=e.length;0<=n?t<n:t>n;o=0<=n?++t:--t)r.push(l(o));return r}(),d=function(){var r,i,l,c,f,d;for(d=[],o=r=0,c=e.length;0<=c?r<c:r>c;o=0<=c?++r:--r){for(n=0,f=u[o],i=0,l=f.length;i<l;i++)a=f[i],n+=s[a];n/=t,d.push([o,n/s[o]])}return d}(),d.sort(function(e,t){return t[1]-e[1]})}},{"static-kdtree":10}],103:[function(e,t,n){t.exports=function(e){var t,n,r;return n=d3.median(e),t=d3.median(e.map(function(e){return Math.abs(e-n)})),r=e.map(function(e,r){return[r,Math.abs(e-n)/t]}),r.sort(function(e,t){return t[1]-e[1]})}},{}],104:[function(e,t,n){var r;r=e("../core/font/tester.coffee"),t.exports=function(e,t,n){var o,a,i,l,s,u,c;return n||(n={}),t=t||{},u=n.parent||r("svg").append("text"),l=[],e instanceof Array||(e=[e]),c=u.selectAll("tspan").data(e),o={left:"0px",position:"absolute",top:"0px",x:0,y:0},s=0,"letter-spacing"in t&&(s=parseFloat(t["letter-spacing"]),delete t["letter-spacing"]),i=function(e){var t;return t=0,s&&(t=(d3.select(e).text().length-1)*s),e.getComputedTextLength()+t},a=function(e){return e.parentNode.getBBox().height||e.getBoundingClientRect().height},c.enter().append("tspan").text(String).style(t).attr(o).each(function(e){if("function"==typeof n.mod)return n.mod(this)}).each(function(e){var t,n,r;return t=d3.select(this).selectAll("tspan"),t.size()?(r=[],t.each(function(){return r.push(i(this))}),r=d3.max(r)):r=i(this),n=a(this),l.push({height:n,text:e,width:r})}),c.remove(),n.parent||u.remove(),l}},{"../core/font/tester.coffee":70}],105:[function(e,t,n){var r,o;r=e("../core/font/tester.coffee"),o=function(e){var t,n,a,i,l,s,u,c,f,d,p,h,v,g;for(e instanceof Array||(e=e.split(",")),l=0,u=e.length;l<u;l++)a=e[l],a.trim();if(i=e.join(", "),t=o.complete,i in t)return t[i];for(p=function(e){return v.append("span").style("font-family",e).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")},h=function(e,t){var n,r,o;return n=p(e),r=n.node().offsetWidth,o=t.node().offsetWidth,n.remove(),r!==o},v=r("div"),f=p("monospace"),d=p("sans-serif"),s=0,c=e.length;s<c;s++)if(n=e[s],g=h(n+",monospace",f),g||(g=h(n+",sans-serif",d)),g){g=n;break}return g||(g="sans-serif"),f.remove(),d.remove(),t[i]=g,g},o.complete={},t.exports=o},{"../core/font/tester.coffee":70}],106:[function(e,t,n){var r=e("../array/sort.coffee"),o=e("../core/methods/attach.coffee"),a=e("../core/data/format.js"),i=e("../core/data/keys.coffee"),l=e("../core/data/load.coffee"),s=e("../core/fetch/data.js"),u=e("../client/ie.js"),c=e("../core/methods/reset.coffee"),f=e("../core/console/print.coffee");t.exports=function(){var t={types:{auto:e("./types/auto.js"),button:e("./types/button/button.coffee"),drop:e("./types/drop/drop.coffee"),toggle:e("./types/toggle.js")}};return t.self=function(e){var n=t.data.value instanceof Array&&t.data.value.length>t.data.large;if(t.draw.timing=t.draw.first||n||u?0:t.timing.ui,t.data.value instanceof Array){if(t.dev.value&&f.group('drawing "'+t.type.value+'"'),t.data.changed&&(t.data.cache={},i(t,"data"),a(t)),t.data.viz=s(t),t.data.sort.value&&(t.data.changed||t.order.changed||t.order.sort.changed)&&r(t.data.viz,t.order.value||t.text.value,t.order.sort.value,t.color.value,t),!1===t.focus.value&&["auto","button"].indexOf(t.type.value)<0){var o=t.data.element.value;if(o&&"select"===o.node().tagName.toLowerCase()){var d=o.property("selectedIndex");d=d<0?0:d;var p=o.selectAll("option")[0][d],h=p.getAttribute("data-"+t.id.value)||p.getAttribute(t.id.value);h&&(t.focus.value=h)}!1===t.focus.value&&t.data.viz.length&&(t.focus.value=t.data.viz[0][t.id.value]),t.dev.value&&!1!==t.focus.value&&f.log('"value" set to "'+t.focus.value+'"')}var v=function(e,n){n="number"!=typeof n?1===t.id.nesting.length?0:t.id.nesting.length-1:n;var r=t.id.nesting[n];return n>0&&(!(r in e)||e[r]instanceof Array)?v(e,n-1):r};if(t.data.changed){"auto"===t.search.value?t.data.viz.length>10?(t.search.enabled=!0,t.dev.value&&f.log("Search enabled.")):(t.search.enabled=!1,t.dev.value&&f.log("Search disabled.")):t.search.enabled=t.search.value;var g=t.data.element.value?t.data.element.value.node().tagName.toLowerCase():"";if(t.data.element.value&&"select"===g){var m=[];for(var y in t.data.nested.all)m=m.concat(t.data.nested.all[y]);options=t.data.element.value.selectAll("option").data(m,function(e){var t=!!e&&v(e);return!!(e&&t in e)&&e[t]}),options.exit().remove(),options.enter().append("option"),options.each(function(e){var n=v(e),r=n===t.id.value?t.text.value||t.id.value:!0!==t.text.nesting&&n in t.text.nesting?t.text.nesting[n]:n;for(var o in e)"object"!=typeof e[o]&&(o===r&&d3.select(this).html(e[o]),["alt","value"].indexOf(o)>=0?d3.select(this).attr(o,e[o]):d3.select(this).attr("data-"+o,e[o]));e[n]===t.focus.value?this.selected=!0:this.selected=!1})}}else if(t.focus.changed&&t.data.element.value){var x=t.data.element.value.node().tagName.toLowerCase();if("select"===x)t.data.element.value.selectAll("option").each(function(e){e[v(e)]===t.focus.value?this.selected=!0:this.selected=!1});else{var x=t.data.element.value.attr("type").toLowerCase();"radio"===x&&t.data.element.value.each(function(e){this.value===t.focus.value?this.checked=!0:this.checked=!1})}}if("auto"!==t.type.value){if(!t.container.ui){t.container.ui=t.container.value.selectAll("div#d3po_"+t.type.value+"_"+t.container.id).data(["container"]);var b=t.data.element.value?t.data.element.value[0][0]:null;if(b)if(b.id)b="#"+b.id;else{var w=b.getAttribute(t.id.value)?t.id.value:"data-"+t.id.value;b=b.getAttribute(w)?"["+w+"="+b.getAttribute(w)+"]":null}t.container.ui.enter().insert("div",b).attr("id","d3po_"+t.type.value+"_"+t.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}t.container.ui.style("display",t.ui.display.value),t.container.ui.transition().duration(t.draw.timing).style("margin",t.ui.margin.css);var _=t.container.ui.selectAll("div.d3po_title").data(t.title.value?[t.title.value]:[]);_.enter().insert("div","#d3po_"+t.type.value+"_"+t.container.id).attr("class","d3po_title").style("display","inline-block"),_.style("color",t.font.color).style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("padding",t.ui.padding.css).style("border-color","transparent").style("border-style","solid").style("border-width",t.ui.border+"px").text(String).each(function(e){t.margin.left=this.offsetWidth})}if(t.data.value.length){var k=t.format.locale.value.visualization[t.type.value];t.dev.value&&f.time("drawing "+k),t.types[t.type.value](t),t.dev.value&&f.timeEnd("drawing "+k)}else!t.data.url||t.data.loaded&&!t.data.stream||l(t,"data",t.self.draw);t.dev.value&&f.timeEnd("total draw time"),c(t)}},o(t,{active:e("./methods/active.coffee"),alt:e("./methods/alt.coffee"),color:e("./methods/color.coffee"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),data:e("./methods/data.js"),depth:e("./methods/depth.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.js"),focus:e("./methods/focus.coffee"),font:e("./methods/font.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),history:e("./methods/history.coffee"),hover:e("./methods/hover.coffee"),
icon:e("./methods/icon.coffee"),id:e("./methods/id.coffee"),keywords:e("./methods/keywords.coffee"),margin:e("./methods/margin.coffee"),open:e("./methods/open.coffee"),order:e("./methods/order.coffee"),remove:e("./methods/remove.coffee"),search:e("./methods/search.coffee"),select:e("./methods/select.coffee"),selectAll:e("./methods/selectAll.coffee"),text:e("./methods/text.coffee"),timing:e("./methods/timing.coffee"),title:e("./methods/title.coffee"),type:e("./methods/type.coffee"),ui:e("./methods/ui.coffee"),width:e("./methods/width.coffee")}),t.self}},{"../array/sort.coffee":36,"../client/ie.js":39,"../core/console/print.coffee":54,"../core/data/format.js":58,"../core/data/keys.coffee":60,"../core/data/load.coffee":61,"../core/fetch/data.js":66,"../core/methods/attach.coffee":82,"../core/methods/reset.coffee":95,"./methods/active.coffee":107,"./methods/alt.coffee":108,"./methods/color.coffee":109,"./methods/config.coffee":110,"./methods/container.coffee":111,"./methods/data.js":112,"./methods/depth.coffee":113,"./methods/dev.coffee":114,"./methods/draw.js":115,"./methods/focus.coffee":116,"./methods/font.coffee":117,"./methods/format.coffee":118,"./methods/height.coffee":119,"./methods/history.coffee":120,"./methods/hover.coffee":121,"./methods/icon.coffee":122,"./methods/id.coffee":123,"./methods/keywords.coffee":124,"./methods/margin.coffee":125,"./methods/open.coffee":126,"./methods/order.coffee":127,"./methods/remove.coffee":128,"./methods/search.coffee":129,"./methods/select.coffee":130,"./methods/selectAll.coffee":131,"./methods/text.coffee":132,"./methods/timing.coffee":133,"./methods/title.coffee":134,"./methods/type.coffee":135,"./methods/ui.coffee":136,"./methods/width.coffee":137,"./types/auto.js":138,"./types/button/button.coffee":139,"./types/drop/drop.coffee":144,"./types/toggle.js":161}],107:[function(e,t,n){e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Number,String],value:!1}},{"../../core/methods/filter.coffee":83}],108:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],mute:r(!0),solo:r(!0),value:"alt"}},{"../../core/methods/filter.coffee":83}],109:[function(e,t,n){t.exports={accepted:[String],value:"color"}},{}],110:[function(e,t,n){t.exports={accepted:[Object],objectAccess:!1,process:function(e,t){var n,r;for(n in e)r=e[n],n in t.self&&t.self[n](r);return e},value:{}}},{}],111:[function(e,t,n){var r;r=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1===e?d3.select("body"):r(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e))},value:d3.select("body")}},{"../../util/d3selection.coffee":211}],112:[function(e,t,n){var r=e("../../util/d3selection.coffee"),o=e("../../core/methods/process/data.coffee");t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},element:{process:function(e,t){var n=!1;return r(e)?n=e:"string"!=typeof e||d3.select(e).empty()||(n=d3.select(e)),n&&t.self.container(d3.select(n.node().parentNode)),n},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],large:400,mute:[],process:function(e,t){return"default"===t.container.id&&e.length&&t.self.container({id:"default"+e.length}),o(e,t,this)},solo:[],sort:{accepted:[Boolean],value:!1},value:!1}},{"../../core/methods/process/data.coffee":89,"../../util/d3selection.coffee":211}],113:[function(e,t,n){t.exports={accepted:[Number],value:0}},{}],114:[function(e,t,n){t.exports={accepted:[Boolean],value:!1}},{}],115:[function(e,t,n){var r=e("../../util/d3selection.coffee"),o=e("../../core/parse/hideElement.js"),a=e("../../core/parse/element.js"),i=e("../../core/console/print.coffee"),l=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(!t.data.value||t.data.value instanceof Array&&!r(t.data.value)?t.data.element.value&&t.data.element.value.call(o):t.data.value=a(t),void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var n=t.format.locale.value.dev.setContainer;i.warning(n,"container")}else if(t.container.value.empty()){var n=t.format.locale.value.dev.noContainer,s=t.container.selector||"";i.warning(l(n,'"'+s+'"'),"container")}else t.dev.value&&i.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var u={};t.history.chain.forEach(function(e){var t=e.method;delete e.method,u[t]=e}),e(u),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.coffee":54,"../../core/parse/element.js":98,"../../core/parse/hideElement.js":99,"../../string/format.js":176,"../../util/d3selection.coffee":211}],116:[function(e,t,n){t.exports={accepted:[!1,Number,String],deprecates:"highlight",process:function(e,t){var n,r,o,a,i,l,s,u,c,f;if((r=t.data.element.value)&&["string","number"].indexOf(typeof e)>=0)if(o=r.node().tagName.toLowerCase(),a=r.attr("type"),"select"===o)for(f=r.selectAll("option"),i=l=0,u=f.length;l<u;i=++l)(n=f[i])&&n[t.id.value]===e&&(r.node().selectedIndex=i);else if("input"===o&&"radio"===a)for(s=0,c=r.length;s<c;s++)n=r[s],this.checked=n&&n[t.id.value]===e;return e},value:!1}},{}],117:[function(e,t,n){var r,o,a,i;a=e("../../core/methods/font/family.coffee"),r=e("../../core/methods/font/align.coffee"),o=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={align:r(),color:"#444444",decoration:o(),family:a(),secondary:{align:r(),color:"#444444",decoration:o(),family:a(),size:12,spacing:0,transform:i(),weight:400},size:12,spacing:0,transform:i(),weight:400}},{"../../core/methods/font/align.coffee":84,"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],118:[function(e,t,n){var r,o,a,i;r=e("../../number/format.coffee"),o=e("../../core/locale/locale.coffee"),a=e("../../object/merge.coffee"),i=e("../../string/title.coffee"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(o)},process:function(e){var t,n;return t="en_US",n=o[t],e!==t&&(n=a(n,o[e])),this.language=e,n},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var n,o;return t||(t={}),o=t.vars||{},o.time&&o.time.value&&t.key===o.time.value?(n=e.constructor===Date?e:new Date(e),o.data.time.format(n)):"number"==typeof e?(this.number.value||r)(e,t):"string"==typeof e?(this.text.value||i)(e,t):JSON.stringify(e)}}},{"../../core/locale/locale.coffee":81,"../../number/format.coffee":173,"../../object/merge.coffee":174,"../../string/title.coffee":179}],119:[function(e,t,n){t.exports={accepted:[!1,Number],max:600,secondary:!1,value:!1}},{}],120:[function(e,t,n){t.exports={back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[]}},{}],121:[function(e,t,n){t.exports={accepted:[Boolean,Number,String],value:!1}},{}],122:[function(e,t,n){var r;r=e("../../core/methods/process/icon.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:r,rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:r,rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:r,rotate:0,value:"fa-angle-down"},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:r,rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:r,rotate:0,value:"fa-check"},style:{accepted:[Object,String],value:"default"},value:"icon"}},{"../../core/methods/process/icon.coffee":91}],123:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,String],dataFilter:!0,mute:r(!0),nesting:["value"],solo:r(!0),value:"value"}},{"../../core/methods/filter.coffee":83}],124:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],mute:r(!0),solo:r(!0),value:"keywords"}},{"../../core/methods/filter.coffee":83}],125:[function(e,t,n){var r;r=e("../../core/methods/process/margin.coffee"),t.exports={accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),t=e,r(e,this),t},value:0}},{"../../core/methods/process/margin.coffee":92}],126:[function(e,t,n){t.exports={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}},{}],127:[function(e,t,n){t.exports={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],deprecates:["sort"],value:"asc"},value:!1}},{}],128:[function(e,t,n){t.exports={accepted:[void 0,Function],process:function(e,t){this.initialized&&t.container.ui.remove(),delete t.container.ui},value:void 0}},{}],129:[function(e,t,n){t.exports={accepted:["auto",Boolean],process:function(e){return"Boolean"==typeof e&&(this.enabled=e),e},term:"",value:"auto"}},{}],130:[function(e,t,n){t.exports={accepted:[String],chainable:!1,process:function(e,t){var n;return n=t.container.value,n&&e?n.select(e):e},value:void 0}},{}],131:[function(e,t,n){t.exports={accepted:[String],chainable:!1,process:function(e,t){var n;return n=t.container.value,n&&e?n.selectAll(e):e},value:void 0}},{}],132:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,String],nesting:!0,mute:r(!0),solo:r(!0),secondary:{accepted:[!1,String],nesting:!0,value:!1},value:!1}},{"../../core/methods/filter.coffee":83}],133:[function(e,t,n){t.exports={mouseevents:60,ui:200}},{}],134:[function(e,t,n){var r,o,a,i;r=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),a=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:r(),family:o(),size:16,transform:i(),weight:400},link:!1,process:function(e,t){var n;return 0===t.container.id.indexOf("default")&&e&&(n=a(e).toLowerCase(),t.self.container({id:n})),e},value:!1}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88,"../../string/strip.js":178}],135:[function(e,t,n){t.exports={accepted:function(e){return d3.keys(e.types)},value:"auto"}},{}],136:[function(e,t,n){var r,o,a,i,l;a=e("../../core/methods/font/family.coffee"),r=e("../../core/methods/font/align.coffee"),o=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/process/margin.coffee"),l=e("../../core/methods/font/transform.coffee"),t.exports={align:r("center"),border:1,color:{primary:{process:function(e,t){var n;return n=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(n).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:r("center"),color:"#444",decoration:o(),family:a(),size:11,transform:l(),weight:400},margin:{process:function(e){var t;return void 0===e&&(e=this.value),t=e,i(e,this),t},value:5},padding:{process:function(e){var t;return void 0===e&&(e=this.value),t=e,i(e,this),t},value:5}}},{"../../core/methods/font/align.coffee":84,"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88,"../../core/methods/process/margin.coffee":92}],137:[function(e,t,n){t.exports={accepted:[!1,Number],secondary:!1,value:!1}},{}],138:[function(e,t,n){t.exports=function(e){var t=e.data.value.length;1===t?e.self.type("button").draw():t<5?e.self.type("toggle").draw():e.self.type("drop").draw()}},{}],139:[function(e,t,n){t.exports=function(t){var n,r,o,a,i,l,s,u;return l=e("../../../core/console/print.coffee"),o=e("./functions/color.coffee"),a=e("./functions/icons.js"),i=e("./functions/mouseevents.coffee"),s=e("./functions/style.js"),n=t.container.ui.selectAll("div.d3po_node").data(t.data.viz,function(e){return e[t.id.value]}),t.dev.value&&l.time("enter"),n.enter().append("div").attr("class","d3po_node").call(o,t).call(s,t).call(a,t).call(i,t),t.dev.value&&l.timeEnd("enter"),t.draw.update||t.draw.timing?(t.dev.value&&l.time("ordering"),n.order(),t.dev.value&&l.timeEnd("ordering"),u=n):(r=[t.focus.previous,t.focus.value,t.hover.previous,t.hover.value].filter(function(e){return e}),u=n.filter(function(e){return r.indexOf(e[t.id.value])>=0})),t.dev.value&&l.time("update"),u.classed("d3po_button_active",function(e){return t.focus.value===e[t.id.value]}),t.draw.timing?u.transition().duration(t.draw.timing).call(o,t).call(s,t):u.call(o,t).call(s,t),u.call(a,t).call(i,t),t.dev.value&&l.timeEnd("update"),n.exit().remove()}},{"../../../core/console/print.coffee":54,"./functions/color.coffee":140,"./functions/icons.js":141,"./functions/mouseevents.coffee":142,"./functions/style.js":143}],140:[function(e,t,n){t.exports=function(t,n){var r,o;return r=e("../../../../color/legible.coffee"),e("../../../../color/lighter.coffee"),o=e("../../../../color/text.coffee"),t.style("background-color",function(e){var t;return t=n.focus.value===e[n.id.value]?n.ui.color.secondary.value:n.ui.color.primary.value,n.hover.value===e[n.id.value]&&(t=d3.rgb(t).darker(.15).toString()),t}).style("color",function(e){var t,a,i,l;return l=n.focus.value===e[n.id.value]?.75:1,i=e[n.icon.value]&&n.data.viz.length<n.data.large,!i&&e[n.color.value]?a=r(e[n.color.value]):(t=n.focus.value===e[n.id.value]?n.ui.color.secondary.value:n.ui.color.primary.value,n.hover.value===e[n.id.value]&&(t=d3.rgb(t).darker(.15).toString()),a=o(t)),a=d3.rgb(a),"rgba("+a.r+","+a.g+","+a.b+","+l+")"}).style("border-color",n.ui.color.secondary.value)}},{"../../../../color/legible.coffee":46,"../../../../color/lighter.coffee":47,"../../../../color/text.coffee":52}],141:[function(e,t,n){var r=e("../../../../client/prefix.coffee"),o=e("../../../../client/rtl.coffee");t.exports=function(e,t){var n="right"===t.font.align.value&&!o||o&&"right"===t.font.align.value;e.each(function(e,a){var i=["label"];e[t.icon.value]&&t.data.viz.length<=t.data.large&&i.push("icon");var l=t.icon.button.value;e[t.id.value]===t.focus.value&&t.icon.select.value?(l=t.icon.select.value,i.push("selected")):l&&!1!==e.d3po.icon&&i.push("selected");var s=0,u=d3.select(this).selectAll("div.d3po_button_element").data(i,function(e){return e});u.enter().append("div").style("display",function(e){return"label"===e?"block":"absolute"}),u.order().attr("class",function(e){var t="";return"selected"===e&&0===l.indexOf("fa-")&&(t=" fa "+l),"d3po_button_element d3po_button_"+e+t}).html(function(n){if("label"===n){var r=t.text.value&&t.text.value in e&&!(e[t.text.value]instanceof Array)?t.text.value:t.id.value;return t.format.value(e[r])}return"selected"===n&&l.indexOf("fa-")<0?l:""}).style("background-image",function(n){return"icon"===n?"url('"+e[t.icon.value]+"')":"none"}).style("background-color",function(n){return"icon"===n&&"knockout"===e.style?e[t.color.value]||t.ui.color.primary.value:"transparent"}).style("background-size","100%").style("text-align",function(e){return"label"===e?t.font.align.value:"center"}).style("position",function(e){return"label"==e?"static":"absolute"}).style("width",function(e){return"label"===e?"auto":(s=t.height.value?t.height.value-(t.ui.padding.top+t.ui.padding.bottom)-2*t.ui.border:t.font.size+t.ui.border)+"px"}).style("height",function(e){return"icon"===e?s+"px":"auto"}).style("margin-top",function(e){if("label"===e)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var n=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===e)var n=t.font.size;else var n=s;return-n/2+"px"}).style("top",function(e){return"label"===e?"auto":"50%"}).style("left",function(e){return"icon"===e&&!n||"selected"===e&&n?t.ui.padding.left+"px":"auto"}).style("right",function(e){return"icon"===e&&n||"selected"===e&&!n?t.ui.padding.right+"px":"auto"}).style(r()+"transition",function(e){return"selected"===e?t.draw.timing/1e3+"s":"none"}).style(r()+"transform",function(e){var n="selected"===e?t.icon.select.rotate:"none";return"string"==typeof n?n:"rotate("+n+"deg)"}).style("opacity",function(e){return"selected"===e?t.icon.select.opacity:1}),u.exit().remove();var c=d3.select(this).selectAll(".d3po_button_label");if(s>0){var f=t.ui.padding;f=3===i.length?f.top+"px "+(2*f.right+s)+"px "+f.bottom+"px "+(2*f.left+s)+"px":i.indexOf("icon")>=0&&!o||i.indexOf("selected")>=0&&o?f.top+"px "+f.right+"px "+f.bottom+"px "+(2*f.left+s)+"px":f.top+"px "+(2*f.right+s)+"px "+f.bottom+"px "+f.left+"px",c.style("padding",f)}else c.style("padding",t.ui.padding.css);if("number"==typeof t.width.value){var d=t.width.value;d-=parseFloat(c.style("padding-left"),10),d-=parseFloat(c.style("padding-right"),10),d-=2*t.ui.border,d+="px"}else var d="auto";c.style("width",d)})}},{"../../../../client/prefix.coffee":41,"../../../../client/rtl.coffee":42}],142:[function(e,t,n){t.exports=function(t,n,r){var o,a;return r=e("./color.coffee"),o=e("../../../../client/pointer.coffee"),a=e("../../../../client/ie.js"),t.on(o.over,function(e,t){return n.self.hover(e[n.id.value]),a||!n.draw.timing?d3.select(this).style("cursor","pointer").call(r,n):d3.select(this).style("cursor","pointer").transition().duration(n.timing.mouseevents).call(r,n)}).on(o.out,function(e){return n.self.hover(!1),a||!n.draw.timing?d3.select(this).style("cursor","auto").call(r,n):d3.select(this).style("cursor","auto").transition().duration(n.timing.mouseevents).call(r,n)}).on(o.click,function(e){return!1!==n.focus.value?n.self.focus(e[n.id.value]).draw():n.focus.callback?n.focus.callback(e,n.self):void 0})}},{"../../../../client/ie.js":39,"../../../../client/pointer.coffee":40,"./color.coffee":140}],143:[function(e,t,n){t.exports=function(e,t){e.style("position","relative").style("margin",t.ui.margin.css).style("display",t.ui.display.value).style("border-style","solid").style("border-width",t.ui.border+"px").style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("letter-spacing",t.font.spacing+"px")}},{}],144:[function(e,t,n){t.exports=function(t){var n,r,o,a,i,l,s,u,c,f,d;return o=e("./functions/element.coffee"),a=e("./functions/keyboard.coffee"),d=e("./functions/window.js"),f=e("./functions/width.js"),n=e("./functions/button.js"),s=e("./functions/selector.js"),u=e("./functions/title.js"),l=e("./functions/search.js"),i=e("./functions/list.js"),r=e("./functions/data.js"),c=e("./functions/update.js"),t.margin.top=0,t.margin.title=0,o(t),a(t),d(t),f(t),n(t),s(t),u(t),l(t),i(t),r(t),c(t)}},{"./functions/button.js":147,"./functions/data.js":148,"./functions/element.coffee":149,"./functions/keyboard.coffee":152,"./functions/list.js":153,"./functions/search.js":155,"./functions/selector.js":156,"./functions/title.js":157,"./functions/update.js":158,"./functions/width.js":159,"./functions/window.js":160}],145:[function(e,t,n){t.exports=function(e,t,n){var r=[],n=n||e.active.value;if(n instanceof Array)for(var o=0;o<n.length;o++)r.push(this(e,t,n[o]));else{var a=typeof n;"number"===a?r.push(e.depth.value===n):"function"===a?r.push(n(t)):r.push(t===n)}return r.indexOf(!0)>=0}},{}],146:[function(e,t,n){var r=e("../../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&r.time("rotating arrow");var t="&#x276f;"===e.icon.drop.value?90:0;if(e.open.value!=e.open.flipped.value)var n=180+t;else var n=t;e.container.button.icon({select:{opacity:e.open.value?.5:1,rotate:n}}).draw(),e.dev.value&&r.timeEnd("rotating arrow")}},{"../../../../core/console/print.coffee":54}],147:[function(e,t,n){var r=e("../../../../util/copy.coffee"),o=e("../../../../client/pointer.coffee"),a=e("../../../form.js"),i=e("../../../../core/console/print.coffee");t.exports=function(e){if("button"in e.container||(e.dev.value&&i.time("creating main button"),e.container.button=a().container(e.container.ui).type("button").ui({margin:0}),e.dev.value&&i.timeEnd("creating main button")),e.focus.changed||e.data.changed||e.depth.changed){var t=e.depth.value,n=r(e.data.value.filter(function(n){for(var r=!1,o=0;o<e.id.nesting.length;o++){var a=e.id.nesting[o];if(r=a in n&&n[a]===e.focus.value){t=o;break}}return r})[0]);n||(n=e.container.button.data()[0]||e.data.viz[0]),e.container.button.data([n]).id(e.id.nesting).depth(t)}var l=!0===e.hover.value&&e.focus.value;e.container.button.draw({update:e.draw.update}).focus("").font(e.font).format(e.format).hover(l).icon({button:e.icon.drop.value,select:e.icon.drop.value,value:e.icon.value}).text(e.text.value).timing({ui:e.draw.timing}).ui({border:e.ui.border,color:e.ui.color,padding:e.ui.padding.css}).width(e.width.value).draw();var s=e.container.button.container(Object).ui;e.margin.top+=s.node().offsetHeight||s.node().getBoundingClientRect().height,s.on(o.click,function(){e.self.open(!e.open.value).draw()})}},{"../../../../client/pointer.coffee":40,"../../../../core/console/print.coffee":54,"../../../../util/copy.coffee":210,"../../../form.js":106}],148:[function(e,t,n){var r=e("../../../../string/format.js"),o=e("../../../../string/strip.js");t.exports=function(e){if(e.data.url&&!e.data.loaded){var t={};t[e.text.value||e.id.value]=e.format.value(e.format.locale.value.ui.loading),e.data.filtered=[t],e.data.changed="loading"!==e.data.lastFilter,e.data.lastFilter="loading"}else if(e.open.value)if(e.search.term){var n=o(e.search.term).split("_"),a=[e.id.value,e.text.value,e.alt.value,e.keywords.value];a=a.filter(function(e){return e}),n=n.filter(function(e){return""!==e});var i=[],l=[],s=[],u=[];if(e.id.nesting.forEach(function(t){u=u.concat(e.data.nested.all[t])}),u.forEach(function(t){var r=!1;a.forEach(function(a){if(!r&&a in t&&"string"==typeof t[a]){var u=t[a].toLowerCase();if([e.text.value,e.id.value].indexOf(a)>=0&&0===u.indexOf(e.search.term))i.push(t),r=!0;else if(u.indexOf(e.search.term)>=0)l.push(t),r=!0;else{var c=o(u).split("_");for(var f in c){if(r)break;for(var d in n)if(0===c[f].indexOf(n[d])){s.push(t),r=!0;break}}}}})}),e.data.filtered=d3.merge([i,l,s]),e.data.filtered.forEach(function(e,t){e.d3po_order=t}),e.data.changed=!0,e.data.lastFilter="search",0===e.data.filtered.length){var c={},f=e.format.value(e.format.locale.value.ui.noResults);c[e.text.value||e.id.value]=r(f,'"'+e.search.term+'"'),e.data.filtered=[c]}}else e.data.filtered=e.data.viz,e.data.changed="viz"!==e.data.lastFilter,e.data.lastFilter="viz",e.id.nesting.length>1&&e.depth.value<e.id.nesting.length-1&&(e.data.filtered=e.data.filtered.filter(function(t){return"endPoint"in t.d3po&&t.d3po.endPoint===e.depth.value&&(t.d3po.icon=!1),!0}),e.data.changed="depth"!==e.data.lastFilter,e.data.lastFilter="depth");else e.data.filtered=[]}},{"../../../../string/format.js":176,"../../../../string/strip.js":178}],149:[function(e,t,n){t.exports=function(e){if(e.data.element.value)return e.data.element.value.on("focus."+e.container.id,function(){return e.self.hover(!0).draw()}),e.data.element.value.on("blur."+e.container.id,function(){if(!e.search.enabled||d3.event.relatedTarget!==e.container.value.select("input").node())return e.self.open(!1).hover(!1).draw()}),e.data.element.value.on("change."+e.container.id,function(){return e.self.focus(this.value).draw()}),e.data.element.value.on("keydown.cancel_"+e.container.id,function(){if(9!==d3.event.keyCode)return d3.event.preventDefault()})}},{}],150:[function(e,t,n){t.exports=function(e){var t=e.height.secondary,n=e.container.button.container().node().getBoundingClientRect(),r=window.innerHeight-n.bottom-2*e.ui.border-e.ui.margin.top-e.ui.margin.bottom-e.ui.padding.top-e.ui.padding.bottom;r<3*n.height&&(r=n.top-10,e.self.open({flipped:!0})),"number"!=typeof t&&(t=r),t>e.height.max&&(t=e.height.max),e.self.height({secondary:t})}},{}],151:[function(e,t,n){var r,o,a,i;r=e("./active.js"),o=e("../../../../util/copy.coffee"),a=e("../../../form.js"),i=e("../../../../core/console/print.coffee"),t.exports=function(e){var t,n,l;e.open.value&&(e.dev.value&&i.time("updating list items"),"items"in e.container||(e.container.items=a().container(e.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1)),n=e.draw.timing?e.data.large:1,l=o(e.order),l.value=e.search.term.length?"d3po_order":e.order.value,t=e.depth.value===e.id.nesting.length-1,(e.focus.changed||!1===e.container.items.focus())&&e.container.items.focus(e.focus.value,function(t){var n,o,a,i;o=e.data.filtered.filter(function(n){return n[e.id.value]===t})[0],e.depth.value<e.id.nesting.length-1&&e.id.nesting[e.depth.value+1]in o?(a=e.depth.value,i=e.id.solo.value,e.history.states.push(function(){return e.self.depth(a).id({solo:i}).draw()}),e.self.depth(e.depth.value+1).id({solo:[t]}).draw()):(e.depth.changed||e.self.open(!1),n=t!==e.focus.value,n&&e.active.value&&(n=r(e,t)),n&&e.self.focus(t).draw())}),e.container.items.active(e.active.value).data({large:n,sort:e.data.sort.value,value:e.data.filtered}).draw({update:e.draw.update}).font(e.font.secondary).format(e.format).hover(e.hover.value).id(e.id.value).icon({button:!t&&e.icon.next,select:!!t&&e.icon.select,value:e.icon.value}).order(l).text(e.text.secondary.value||e.text.value).timing({ui:e.draw.timing}).ui({color:{primary:1===e.id.nesting.length?e.ui.color.primary.value:e.ui.color.secondary.value,secondary:e.ui.color.secondary.value},padding:e.ui.padding.css}).draw(),e.dev.value&&i.timeEnd("updating list items"))}},{"../../../../core/console/print.coffee":54,"../../../../util/copy.coffee":210,"../../../form.js":106,"./active.js":145}],152:[function(e,t,n){t.exports=function(e){return d3.select(window).on("keydown."+e.container.id,function(){var t,n,r,o,a,i,l,s,u,c,f,d,p;if(u=d3.event.keyCode,e.open.value||!0===e.hover.value){for(f=!0===e.hover.value?"focus":"hover",l=!1,d=e.data.filtered,i=s=0,c=d.length;s<c;i=++s)if(t=d[i],t[e.id.value]===e[f].value){l=i;break}if(9===u&&e.open.value&&(!e.search.enabled||e.search.enabled&&!d3.event.shiftKey))return e.self.open(!1).hover(!1).draw();if([38,40].indexOf(u)>=0)return!1===l?l=0:38===u?e.open.value&&(l<=0?l=e.data.filtered.length-1:l-=1):40===u&&e.open.value&&(l>=e.data.filtered.length-1?l=0:l+=1),a="boolean"!=typeof e.hover.value?e.data.filtered[l][e.id.value]:e.focus.value,e.self.hover(a).open(!0).draw();if(13===u)return"boolean"!=typeof e.hover.value?(n=e.data.filtered.filter(function(t){return t[e.id.value]===e.hover.value})[0],r=e.depth.value,r<e.id.nesting.length-1&&e.id.nesting[r+1]in n?(p=e.id.solo.value,o=function(){return e.self.depth(r).id({solo:p}).draw()},e.history.states.push(o),e.self.depth(e.depth.value+1).id({solo:[e.hover.value]}).draw()):e.self.focus(e.hover.value).hover(!0).draw()):e.self.hover(e.focus.value).open(!0).draw();if(27===u){if(e.open.value)return e.self.open(!1).hover(!0).draw();if(!0===e.hover.value)return e.self.hover(!1).draw()}}})}},{}],153:[function(e,t,n){var r=e("../../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&r.time("populating list"),e.container.list=e.container.selector.selectAll("div.d3po_drop_list").data(["list"]),e.container.list.enter().append("div").attr("class","d3po_drop_list").attr("id","d3po_drop_list_"+e.container.id).style("overflow-y","auto").style("overflow-x","hidden"),e.dev.value&&r.timeEnd("populating list")}},{"../../../../core/console/print.coffee":54}],154:[function(e,t,n){var r=e("../../../../core/console/print.coffee");t.exports=function(e){if(e.open.value){e.dev.value&&r.time("calculating height");var t=!1;if("none"==e.container.selector.style("display"))var t=!0;t&&e.container.selector.style("display","block");var n=e.container.selector.style("height"),o=e.container.selector.property("scrollTop"),a=e.container.list.style("max-height"),i=e.container.list.property("scrollTop");e.container.selector.style("height","auto"),e.container.list.style("max-height","200000px"),e.container.listHeight=parseFloat(e.container.selector.style("height"),10),e.container.list.style("max-height",a).property("scrollTop",i),e.container.selector.style("height",n).property("scrollTop",o);var l=!1;if(e.container.listHeight>e.height.secondary&&(e.container.listHeight=e.height.secondary,l=!0),t&&e.container.selector.style("display","none"),e.dev.value&&r.timeEnd("calculating height"),l){e.dev.value&&r.time("calculating scroll position");var s=e.container.list.select("div").selectAll("div.d3po_node"),u=s[0][0],c="boolean"!=typeof e.hover.value?e.hover.value:e.focus.value;s.each(function(t,n){t[e.id.value]===c&&(u=this)});var t=!1;"none"===e.container.selector.style("display")&&(t=!0,e.container.selector.style("display","block"));var f=u.offsetTop,d=u.offsetHeight||u.getBoundingClientRect().height,p=e.container.list.property("scrollTop");t&&e.container.selector.style("display","none"),t||e.data.changed||e.depth.changed?e.container.listScroll=f:(e.container.listScroll=p,f<p?e.container.listScroll=f:f+d>p+e.height.secondary-e.search.height&&(e.container.listScroll=f-(e.height.secondary-d-e.search.height))),e.dev.value&&r.timeEnd("calculating scroll position")}else e.container.listScroll=0}else e.container.listScroll=e.container.list.property("scrollTop"),e.container.listHeight=0}},{"../../../../core/console/print.coffee":54}],155:[function(e,t,n){var r=e("../../../../client/prefix.coffee"),o=e("../../../../core/console/print.coffee");t.exports=function(t){function n(e){e.style("padding",t.ui.padding.css).style("display","block").style("background-color",d3.rgb(t.ui.color.primary.value).darker(.15).toString())}function a(e){var n=t.width.secondary-2*t.ui.padding.left-2*t.ui.padding.right+2*t.ui.border;e.style("padding",t.ui.padding.left/2+t.ui.padding.right/2+"px").style("width",n+"px").style("border-width","0px").style("font-family",t.font.secondary.family.value).style("font-size",t.font.secondary.size+"px").style("font-weight",t.font.secondary.weight).style("text-align",t.font.secondary.align).style("outline","none").style(r()+"border-radius","0").attr("placeholder",t.format.value(t.format.locale.value.method.search))}t.dev.value&&o.time("creating search");var i=e("./data.js"),l=e("./items.coffee"),s=e("./update.js");t.container.search=t.container.selector.selectAll("div.d3po_drop_search").data(t.search.enabled?["search"]:[]),t.draw.timing?(t.container.search.transition().duration(t.draw.timing).call(n),t.container.search.select("input").transition().duration(t.draw.timing).call(a)):(t.container.search.call(n),t.container.search.select("input").call(a)),t.container.search.enter().insert("div","#d3po_drop_list_"+t.container.id).attr("class","d3po_drop_search").attr("id","d3po_drop_search_"+t.container.id).call(n).append("input").attr("id","d3po_drop_input_"+t.container.id).style("-webkit-appearance","none").call(a),t.container.search.select("input").on("keyup."+t.container.id,function(e){var n=this.value;t.search.term!==n&&(t.search.term=n,i(t),l(t),s(t))}),t.container.search.exit().remove();var u=t.container.selector.style("display");t.container.selector.style("display","block"),t.search.height=t.search.enabled?t.container.search.node().offsetHeight||t.container.search.node().getBoundingClientRect().height:0,t.container.selector.style("display",u),t.search.enabled&&(t.margin.title+=t.search.height),t.dev.value&&o.timeEnd("creating search")}},{"../../../../client/prefix.coffee":41,"../../../../core/console/print.coffee":54,"./data.js":148,"./items.coffee":151,"./update.js":158}],156:[function(e,t,n){t.exports=function(e){e.container.selector=e.container.ui.selectAll("div.d3po_drop_selector").data(["selector"]),
e.container.selector.enter().append("div").attr("class","d3po_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),e.container.selector.style("padding",e.ui.border+"px")}},{}],157:[function(e,t,n){var r=e("../../../../client/pointer.coffee"),o=e("../../../../color/lighter.coffee"),a=e("../../../../core/console/print.coffee"),i=e("../../../../color/text.coffee");t.exports=function(e){function t(t){t.style("padding",e.ui.padding.css).style("display","block").style("background-color",e.ui.color.secondary.value).style("font-family",e.font.secondary.family.value).style("font-size",e.font.secondary.size+"px").style("font-weight",e.font.secondary.weight).style("text-align",e.font.secondary.align).style("color",i(e.ui.color.secondary.value))}function n(t){if(!t.empty()){var n=0===e.icon.back.value.indexOf("fa-")?" fa "+e.icon.back.value:"";n="d3po_drop_back"+n;var r=0===e.icon.back.value.indexOf("fa-")?"":e.icon.back.value;t.style("position","absolute").attr("class",n).style("top",e.ui.padding.top+e.font.secondary.size/2/2.5+"px").html(r)}}function l(t){var n=u?e.focus.value:e.format.locale.value.ui.back;t.text(e.format.value(n)).style("padding","0px "+(e.ui.padding.left+e.ui.padding.right)+"px")}if(e.open.value){e.dev.value&&a.time("creating title and back button");var s=1===e.id.solo.value.length&&e.depth.value>0,u=s,c=e.container.button.data(Object).viz[0];u=!0;for(var f=0;f<e.id.nesting.length;f++){var d=e.id.nesting[f];if(d in c&&c[d]===e.focus.value){u=!1;break}}e.container.title=e.container.selector.selectAll("div.d3po_drop_title").data(s?["title"]:[]),e.draw.timing?(e.container.title.transition().duration(e.draw.timing).call(t),e.container.title.select("div.d3po_drop_title_text").transition().duration(e.draw.timing).call(l)):(e.container.title.call(t),e.container.title.select("div.d3po_drop_title_text").call(l)),e.container.title.select("span.d3po_drop_back").call(n);var p=e.container.title.enter().insert("div","#d3po_drop_list_"+e.container.id).attr("class","d3po_drop_title").attr("id","d3po_drop_title_"+e.container.id).call(t);p.append("span").attr("id","d3po_drop_back_"+e.container.id).attr("class","d3po_drop_back").call(n),p.append("div").attr("id","d3po_drop_title_text_"+e.container.id).attr("class","d3po_drop_title_text").call(l),e.container.title.on(r.over,function(t,n){var r=o(e.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("background-color",r).style("color",i(r))}).on(r.out,function(t){var n=e.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("background-color",n).style("color",i(n))}).on(r.click,function(t){e.history.back()}),e.container.title.exit().remove(),s&&(e.margin.title+=e.container.title.node().offsetHeight||e.container.title.node().getBoundingClientRect().height),e.dev.value&&a.timeEnd("creating title and back button")}}},{"../../../../client/pointer.coffee":40,"../../../../color/lighter.coffee":47,"../../../../color/text.coffee":52,"../../../../core/console/print.coffee":54}],158:[function(e,t,n){var r=e("./items.coffee"),o=e("./height.js"),a=e("../../../../core/console/print.coffee"),i=e("./scroll.js"),l=e("./arrow.js");t.exports=function(e){function t(t){var n=e.open.flipped.value;t.style("top",function(){return n?"auto":e.margin.top-e.ui.border+"px"}).style("bottom",function(){return n?e.margin.top+e.ui.border+"px":"auto"})}function n(n){n.style("left",function(){return"left"===e.font.align.value?e.margin.left+"px":"center"===e.font.align.value?e.margin.left-(e.width.secondary-e.width.value)/2+"px":"auto"}).style("right",function(){return"right"===e.font.align.value?"0px":"auto"}).style("height",e.container.listHeight+"px").style("padding",e.ui.border+"px").style("background-color",e.ui.color.secondary.value).style("z-index",function(){return e.open.value?"9999":"-1"}).style("width",e.width.secondary-2*e.ui.border+"px").style("opacity",e.open.value?1:0).call(t)}function s(n){n.style("display",e.open.value?null:"none").call(t),e.search.enabled&&e.open.value&&e.container.selector.select("div.d3po_drop_search input").node().focus()}e.draw.timing?e.container.ui.transition().duration(e.draw.timing).each("start",function(){e.open.value&&d3.select(this).style("z-index",9999)}).style("margin",e.ui.margin.css).each("end",function(){e.open.value||d3.select(this).style("z-index","auto")}):e.container.ui.style("margin",e.ui.margin.css).style("z-index",function(){return e.open.value?9999:"auto"}),r(e),o(e),i(e),l(e),e.dev.value&&a.time("drawing list");var u=e.open.value?e.height.secondary-e.margin.title:0;e.draw.timing?(e.container.selector.transition().duration(e.draw.timing).each("start",function(){d3.select(this).style("display",e.open.value?"block":null)}).call(n).each("end",function(){d3.select(this).transition().duration(e.draw.timing).call(s)}),e.container.list.transition().duration(e.draw.timing).style("width",e.width.secondary-2*e.ui.border+"px").style("max-height",u+"px").tween("scroll",function(e){return function(){var t=d3.interpolateNumber(this.scrollTop,e);return function(e){this.scrollTop=t(e)}}}(e.container.listScroll))):(e.container.selector.call(n).call(s),e.container.list.style("width",e.width.secondary-2*e.ui.border+"px").style("max-height",u+"px").property("scrollTop",e.container.listScroll)),e.dev.value&&a.timeEnd("drawing list")}},{"../../../../core/console/print.coffee":54,"./arrow.js":146,"./height.js":150,"./items.coffee":151,"./scroll.js":154}],159:[function(e,t,n){var r=e("../../../../util/copy.coffee"),o=e("../../../../core/font/tester.coffee"),a=e("../../../form.js"),i=e("../../../../core/console/print.coffee"),l=e("../../../../object/validate.coffee");t.exports=function(e){function t(t){var r="primary"===t?"value":t,l="value"===r?e.icon.drop.value:e.icon.select.value||e.icon.drop.value,s="value"===r?e.text.value:e.text.secondary.value||e.text.value,u="value"===r?e.font:e.font.secondary;e.dev.value&&i.time("calculating "+t+" width");var c=a().container(o()).data({large:9999,value:n}).draw({update:!1}).font(u).format(e.format).icon({button:l,value:e.icon.value}).id(e.id.value).timing({ui:0}).text(s||e.id.value).type("button").ui({border:"primary"===t?e.ui.border:0,display:"inline-block",margin:0,padding:e.ui.padding.css}).width(!1).draw(),f=[];c.selectAll("div.d3po_node").each(function(e){f.push(this.offsetWidth+1)}).remove();var d={};d[r]=d3.max(f),e.self.width(d),e.dev.value&&i.timeEnd("calculating "+t+" width")}var n=[];for(var s in e.data.nested.all){var u=e.data.nested.all[s],c=l(e.text.nesting)&&s in e.text.nesting?e.text.nesting[s][0]:s;[e.id.value,e.text.value].indexOf(c)<0&&(u=r(u),u.forEach(function(t){t[e.text.value||e.id.value]=t[c]})),n=n.concat(u)}"number"!=typeof e.width.value&&t("primary"),"number"!=typeof e.width.secondary&&(e.text.secondary.value&&e.text.value!==e.text.secondary.value?t("secondary"):e.self.width({secondary:e.width.value}))}},{"../../../../core/console/print.coffee":54,"../../../../core/font/tester.coffee":70,"../../../../object/validate.coffee":175,"../../../../util/copy.coffee":210,"../../../form.js":106}],160:[function(e,t,n){var r=e("../../../../util/child.coffee"),o=function(e,t){if(void 0===t)var t=window;d3.select(t).on("click."+e.container.id,function(){var t=d3.event.target||d3.event.toElement,n=t.parentNode;n&&["d3po_node","d3po_drop_title"].indexOf(n.className)>=0&&(t=n.parentNode),t&&n&&!r(e.container.ui,t)&&(e.open.value||e.hover.value)&&e.self.open(!1).hover(!1).draw()});try{var n=window.parent.location.host===window.location.host}catch(e){var n=!1}n&&t.self!==window.top&&o(e,t.parent)};t.exports=o},{"../../../../util/child.coffee":208}],161:[function(e,t,n){var r=e("../form.js");t.exports=function(e){"buttons"in e.container||(e.container.buttons=r().container(e.container.ui).type("button"));var t=e.data.viz.length,n=!!e.width.value&&e.width.value/t,o=e.container.ui.selectAll("div.d3po_toggle").data(e.data.viz,function(t){return t[e.id.value]});o.exit().remove(),o.enter().append("div").attr("class","d3po_toggle").style("display","inline-block").style("vertical-align","top"),o.order().each(function(t){"form"in t.d3po||(t.d3po.form=r().container(d3.select(this)));var o=e.id.nesting.length>e.depth.value?e.id.nesting[e.depth.value+1]:e.id.value;t[o]instanceof Array?t.d3po.form.container({id:e.container.id+"_"+t[e.id.value]}).data(t[o]).id(e.id.nesting.slice(1)).type("drop"):t.d3po.form.data([t]).id(e.id.value).type("button"),t.d3po.form.color(e.color).focus(e.focus.value,function(t){t!==e.focus.value&&e.self.focus(t).draw()}).hover(e.hover.value).icon({select:!1,value:e.icon.value}).font(e.font).format(e.format).order(e.order).text(e.text.value).ui({border:e.ui.border,color:e.ui.color,display:"inline-block",margin:0,padding:e.ui.padding.css}).width(n).draw()}),e.data.element.value&&e.data.element.value.on("focus."+e.container.id,function(){e.self.focus(this.value).hover(this.value).draw()}).on("blur."+e.container.id,function(){e.self.hover(!1).draw()})}},{"../form.js":106}],162:[function(e,t,n){var r,o,a,i,l,s,u,c,f,d,p;d=e("simplify-js"),t.exports=function(e,t){var n,o,i,s,u,f,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re,oe,ae,ie,le,se,ue,ce,fe,de,pe,he,ve,ge,me,ye,xe;if(e.length<3)return null;if(b=[],v=.5,u=5,null==t&&(t={}),null==t.maxAspectRatio&&(t.maxAspectRatio=15),null==t.minWidth&&(t.minWidth=0),null==t.minHeight&&(t.minHeight=0),null==t.tolerance&&(t.tolerance=.02),null==t.nTries&&(t.nTries=20),null!=t.angle&&(t.angle instanceof Array?f=t.angle:"number"==typeof t.angle?f=[t.angle]:"string"!=typeof t.angle||isNaN(t.angle)||(f=[Number(t.angle)])),null==f&&(f=d3.range(-90,90+u,u)),null!=t.aspectRatio&&(t.aspectRatio instanceof Array?g=t.aspectRatio:"number"==typeof t.aspectRatio?g=[t.aspectRatio]:"string"!=typeof t.aspectRatio||isNaN(t.aspectRatio)||(g=[Number(t.aspectRatio)])),null!=t.origin&&t.origin instanceof Array&&(Z=t.origin[0]instanceof Array?t.origin:[t.origin]),0===(h=Math.abs(d3.geom.polygon(e).area())))return null;if(te=d3.extent(e,function(e){return e[0]}),U=te[0],D=te[1],ne=d3.extent(e,function(e){return e[1]}),Y=ne[0],R=ne[1],ve=Math.min(D-U,R-Y)*t.tolerance,he=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)W=e[t],r.push({x:W[0],y:W[1]});return r}(),ve>0&&(he=d(he,ve),e=function(){var e,t,n;for(n=[],e=0,t=he.length;e<t;e++)W=he[e],n.push([W.x,W.y]);return n}()),t.vdebug&&b.push({type:"simplify",poly:e}),re=d3.extent(e,function(e){return e[0]}),U=re[0],D=re[1],oe=d3.extent(e,function(e){return e[1]}),Y=oe[0],R=oe[1],[[U,Y],[D,Y],[D,R],[U,R]],ae=[D-U,R-Y],y=ae[0],m=ae[1],me=Math.min(y,m)/50,null==Z)for(Z=[],x=d3.geom.polygon(e).centroid(),a(x,e)&&Z.push(x);Z.length<t.nTries;)de=Math.random()*y+U,pe=Math.random()*m+Y,fe=[de,pe],a(fe,e)&&Z.push(fe);for(t.vdebug&&b.push({type:"origins",points:Z}),T=0,P=null,z=0,E=f.length;z<E;z++)for(i=f[z],s=-i*Math.PI/180,t.vdebug&&b.push({type:"angle",angle:i}),_=M=0,S=Z.length;M<S;_=++M)for(X=Z[_],ie=r(e,X,s),Q=ie[0],$=ie[1],le=r(e,X,s+Math.PI/2),J=le[0],K=le[1],H=[],null!=Q&&null!=$&&H.push([(Q[0]+$[0])/2,(Q[1]+$[1])/2]),null!=J&&null!=K&&H.push([(J[0]+K[0])/2,(J[1]+K[1])/2]),t.vdebug&&b.push({type:"modifOrigin",idx:_,p1W:Q,p2W:$,p1H:J,p2H:K,modifOrigins:H}),A=0,O=H.length;A<O;A++)if(G=H[A],t.vdebug&&b.push({type:"origin",cx:G[0],cy:G[1]}),se=r(e,G,s),Q=se[0],$=se[1],null!==Q&&null!==$&&(V=Math.min(p(G,Q),p(G,$)),B=2*Math.sqrt(V),ue=r(e,G,s+Math.PI/2),J=ue[0],K=ue[1],null!==J&&null!==K&&(L=Math.min(p(G,J),p(G,K)),q=2*Math.sqrt(L),!(B*q<T))))for(null!=g?o=g:(I=Math.max(1,t.minWidth/q,T/(q*q)),C=Math.min(t.maxAspectRatio,B/t.minHeight,B*B/T),o=d3.range(I,C+v,v)),F=0,N=o.length;F<N;F++)if(n=o[F],j=Math.max(t.minWidth,Math.sqrt(T*n)),!((ce=Math.min(B,q*n))*q<T))for(ce-j>=me&&t.vdebug&&b.push({type:"aRatio",aRatio:n});ce-j>=me;)ge=(j+ce)/2,w=ge/n,ye=G[0],xe=G[1],ee=[[ye-ge/2,xe-w/2],[ye+ge/2,xe-w/2],[ye+ge/2,xe+w/2],[ye-ge/2,xe+w/2]],ee=c(ee,s,G),l(ee,e)?(k=!0,T=ge*w,P={cx:ye,cy:xe,width:ge,height:w,angle:i},j=ge):(k=!1,ce=ge),t.vdebug&&b.push({type:"rectangle",cx:ye,cy:xe,width:ge,height:w,areaFraction:ge*w/h,angle:i,insidePoly:k});return[P,T,b]},p=function(e,t){var n,r;return n=t[0]-e[0],r=t[1]-e[1],n*n+r*r},s=function(e,t,n){var r,o,a,i;return i=t[1]<n[1]?[t,n]:[n,t],r=i[0],o=i[1],e[1]!==o[1]&&e[1]!==r[1]||(e[1]+=Number.MIN_VALUE),!(e[1]>o[1]||e[1]<r[1])&&(!(e[0]>r[0]&&e[0]>o[0])&&(e[0]<r[0]&&e[0]<o[0]||(a=(o[1]-r[1])/(o[0]-r[0]),(e[1]-r[1])/(e[0]-r[0])>a)))},a=function(e,t){var n,r,o,a,i;for(a=-1,i=t.length,r=t[i-1],o=0;++a<i;)n=r,r=t[a],s(e,n,r)&&o++;return o%2!=0},i=function(e,t,n){var r,o,a;return r=1e-9,o=e[0],a=e[1],!(o<Math.min(t[0],n[0])-r||o>Math.max(t[0],n[0])+r||a<Math.min(t[1],n[1])-r||a>Math.max(t[1],n[1])+r)},o=function(e,t,n,r){var o,a,i,l,s,u,c,f,d,p;return f=1e-9,l=e[0]-t[0],u=e[1]-t[1],s=n[0]-r[0],c=n[1]-r[1],i=l*c-u*s,Math.abs(i)<f?null:(o=e[0]*t[1]-e[1]*t[0],a=n[0]*r[1]-n[1]*r[0],d=(o*s-a*l)/i,p=(o*c-a*u)/i,[d,p])},f=function(e,t,n,r){var a;return null!=(a=o(e,t,n,r))&&(i(a,e,t)&&i(a,n,r))},l=function(e,t){var n,r,o,i,l,s,u,c;for(l=-1,u=e.length,c=t.length,o=e[u-1];++l<u;)for(n=o,o=e[l],s=-1,i=t[c-1];++s<c;)if(r=i,i=t[s],f(n,o,r,i))return!1;return a(e[0],t)},u=function(e,t,n){var r,o,a,i;return null==n&&(n=[0,0]),a=e[0]-n[0],i=e[1]-n[1],r=Math.cos(t),o=Math.sin(t),[r*a-o*i+n[0],o*a+r*i+n[1]]},c=function(e,t,n){var r,o,a,i;for(i=[],r=0,o=e.length;r<o;r++)a=e[r],i.push(u(a,t,n));return i},r=function(e,t,n){var r,a,l,s,u,c,f,d,h,v,g,m,y,x,b;for(u=1e-9,t=[t[0]+u*Math.cos(n),t[1]+u*Math.sin(n)],x=t[0],b=t[1],m=[x+Math.cos(n),b+Math.sin(n)],f=0,Math.abs(m[0]-x)<u&&(f=1),c=-1,v=e.length,a=e[v-1],d=Number.MAX_VALUE,h=Number.MAX_VALUE,l=null,s=null;++c<v;)r=a,a=e[c],null!=(g=o(t,m,r,a))&&i(g,r,a)&&(y=p(t,g),g[f]<t[f]?y<d&&(d=y,l=g):g[f]>t[f]&&y<h&&(h=y,s=g));return[l,s]}},{"simplify-js":9}],163:[function(e,t,n){t.exports=function(e,t,n){var r,o,a,i;return o={x:0,y:0},e<0&&(e=2*Math.PI+e),"square"===n?(a=Math.PI/180*45,e<=Math.PI?e<Math.PI/2?e<a?(o.x+=t,i=Math.tan(e)*t,o.y+=i):(o.y+=t,r=t/Math.tan(e),o.x+=r):e<Math.PI-a?(o.y+=t,r=t/Math.tan(Math.PI-e),o.x-=r):(o.x-=t,i=Math.tan(Math.PI-e)*t,o.y+=i):e<3*Math.PI/2?e<a+Math.PI?(o.x-=t,i=Math.tan(e-Math.PI)*t,o.y-=i):(o.y-=t,r=t/Math.tan(e-Math.PI),o.x-=r):e<2*Math.PI-a?(o.y-=t,r=t/Math.tan(2*Math.PI-e),o.x+=r):(o.x+=t,i=Math.tan(2*Math.PI-e)*t,o.y-=i)):(o.x+=t*Math.cos(e),o.y+=t*Math.sin(e)),o}},{}],164:[function(e,t,n){var r;r=e("../geom/offset.coffee"),t.exports=function(e){var t,n,o,a,i,l,s,u,c,f,d,p,h,v,g,m;if(!e)return[];for(e=e.slice(1).slice(0,-1).split(/L|A/),f=[],o=0,i=e.length;o<i;o++)if(c=e[o],c=c.split(" "),1===c.length)f.push(c[0].split(",").map(function(e){return parseFloat(e)}));else{for(d=f[f.length-1],a=c.pop().split(",").map(function(e){return parseFloat(e)}),p=parseFloat(c.shift().split(",")[0]),m=Math.sqrt(Math.pow(a[0]-d[0],2)+Math.pow(a[1]-d[1],2)),t=Math.acos((p*p+p*p-m*m)/(2*p*p)),u="1"===c[1].split(",")[0],u&&(t=2*Math.PI-t),l=t/(2*Math.PI)*(p*Math.PI*2),h=l/5,v=Math.atan2(-d[1],-d[0])-Math.PI,g=t/h,n=g;n<t;)s=r(v+n,p),f.push([s.x,s.y]),n+=g;f.push(a)}return f}},{"../geom/offset.coffee":163}],165:[function(e,t,n){var r,o,a;r={},r.version="1.9.8 - Cornflower",r.repo="https://github.com/alexandersimoes/d3po/",r.array={comparator:e("./array/comparator.coffee"),contains:e("./array/contains.coffee"),sort:e("./array/sort.coffee"),update:e("./array/update.coffee")},r.client={css:e("./client/css.coffee"),ie:e("./client/ie.js"),pointer:e("./client/pointer.coffee"),prefix:e("./client/prefix.coffee"),rtl:e("./client/rtl.coffee"),scroll:e("./client/scroll.js"),scrollbar:e("./client/scrollbar.coffee"),touch:e("./client/touch.coffee")},r.color={legible:e("./color/legible.coffee"),lighter:e("./color/lighter.coffee"),mix:e("./color/mix.coffee"),random:e("./color/random.coffee"),scale:e("./color/scale.coffee"),sort:e("./color/sort.coffee"),text:e("./color/text.coffee"),validate:e("./color/validate.coffee")},r.data={bestRegress:e("./data/bestRegress.coffee"),lof:e("./data/lof.coffee"),mad:e("./data/mad.coffee")},r.font={sizes:e("./font/sizes.coffee"),validate:e("./font/validate.coffee")},r.form=e("./form/form.js"),r.geom={largestRect:e("./geom/largestRect.coffee"),offset:e("./geom/offset.coffee"),path2poly:e("./geom/path2poly.coffee")},r.network={cluster:e("./network/cluster.coffee"),distance:e("./network/distance.coffee"),normalize:e("./network/normalize.coffee"),shortestPath:e("./network/shortestPath.coffee"),smallestGap:e("./network/smallestGap.coffee"),subgraph:e("./network/subgraph.coffee")},r.number={format:e("./number/format.coffee")},r.object={merge:e("./object/merge.coffee"),validate:e("./object/validate.coffee")},r.string={format:e("./string/format.js"),list:e("./string/list.coffee"),strip:e("./string/strip.js"),title:e("./string/title.coffee")},r.textwrap=e("./textwrap/textwrap.coffee"),r.tooltip={create:e("./tooltip/create.js"),move:e("./tooltip/move.coffee"),remove:e("./tooltip/remove.coffee")},r.util={buckets:e("./util/buckets.coffee"),child:e("./util/child.coffee"),closest:e("./util/closest.coffee"),copy:e("./util/copy.coffee"),d3selection:e("./util/d3selection.coffee"),dataurl:e("./util/dataURL.coffee"),uniques:e("./util/uniques.coffee")},r.viz=e("./viz/viz.coffee"),a=e("./client/css.coffee"),o=e("./core/console/print.coffee"),a("d3po.css")&&o.warning("d3po.css has been deprecated, you do not need to load this file.",r.repo+"releases/tag/v1.4.0"),"undefined"!=typeof window&&(window.d3po=r),t.exports=r},{"./array/comparator.coffee":34,"./array/contains.coffee":35,"./array/sort.coffee":36,"./array/update.coffee":37,"./client/css.coffee":38,"./client/ie.js":39,"./client/pointer.coffee":40,"./client/prefix.coffee":41,"./client/rtl.coffee":42,"./client/scroll.js":43,"./client/scrollbar.coffee":44,"./client/touch.coffee":45,"./color/legible.coffee":46,"./color/lighter.coffee":47,"./color/mix.coffee":48,"./color/random.coffee":49,"./color/scale.coffee":50,"./color/sort.coffee":51,"./color/text.coffee":52,"./color/validate.coffee":53,"./core/console/print.coffee":54,"./data/bestRegress.coffee":101,"./data/lof.coffee":102,"./data/mad.coffee":103,"./font/sizes.coffee":104,"./font/validate.coffee":105,"./form/form.js":106,"./geom/largestRect.coffee":162,"./geom/offset.coffee":163,"./geom/path2poly.coffee":164,"./network/cluster.coffee":167,"./network/distance.coffee":168,"./network/normalize.coffee":169,"./network/shortestPath.coffee":170,"./network/smallestGap.coffee":171,"./network/subgraph.coffee":172,"./number/format.coffee":173,"./object/merge.coffee":174,"./object/validate.coffee":175,"./string/format.js":176,"./string/list.coffee":177,"./string/strip.js":178,"./string/title.coffee":179,"./textwrap/textwrap.coffee":203,"./tooltip/create.js":204,"./tooltip/move.coffee":205,"./tooltip/remove.coffee":206,"./util/buckets.coffee":207,"./util/child.coffee":208,"./util/closest.coffee":209,"./util/copy.coffee":210,"./util/d3selection.coffee":211,"./util/dataURL.coffee":212,"./util/uniques.coffee":213,"./viz/viz.coffee":336}],166:[function(e,t,n){window.d3=e("d3"),window.topojson=e("topojson")},{d3:3,topojson:33}],167:[function(e,t,n){var r;r=e("./normalize.coffee"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T;if(h=[],null==t&&(t={}),(null==t.nodes||"object"!=typeof t.nodes)&&(O=r(e,t),e=O[0],t=O[1],null===t))return null;t.distance,j=t.nodeid,T=t.startpoint,p=t.endpoint,E=t.nodes,S={};for(g in E)S[g]={node:E[g].node,degree:0};for(k=0,_={},v=0,b=e.length;v<b;v++)d=e[v],o=j(T(d)),a=j(p(d)),o in _||(_[o]={}),a in _||(_[a]={}),a in _[o]||(_[o][a]=0,_[a][o]=0,k++,S[o].degree+=1,S[a].degree+=1);u={},n=0;for(g in S)A=S[g],u[g]={score:A.degree/(2*k),nodes:[g]};for(o in _)for(a in _[o])_[o][a]=1/(2*k)-S[o].degree*S[a].degree/(4*k*k);for(m=0;m<1e3;){f=-1,z=void 0,M=void 0;for(o in _)for(a in _[o])_[o][a]>f&&(f=_[o][a],z=o,M=a);if(f<0)break;for(x in _[z])x!==M&&(x in _[M]?_[M][x]+=_[z][x]:_[M][x]=_[z][x]-2*u[M].score*u[x].score,_[x][M]=_[M][x]),delete _[x][z];for(x in _[M])x in _[z]||x===M||(_[M][x]-=2*u[z].score*u[x].score,_[x][M]=_[M][x]);for(N=u[z].nodes,y=0,w=N.length;y<w;y++)A=N[y],u[M].nodes.push(A);u[M].score+=u[z].score,t.vdebug&&h.push({type:"merge",father:M,child:z,nodes:u[M].nodes}),delete u[z],delete _[z],n+=f,m++}return s=function(){var e;e=[];for(i in u)c=u[i],e.push([i,c.nodes.length]);return e}(),s.sort(function(e,t){return t[1]-e[1]}),F=function(){var e,t,n;for(n=[],e=0,t=s.length;e<t;e++)l=s[e],n.push(u[l[0]].nodes);return n}(),[F,h]}},{"./normalize.coffee":169}],168:[function(e,t,n){t.exports=function(e,t){var n,r;return e instanceof Array||(e=[e.x,e.y]),t instanceof Array||(t=[t.x,t.y]),n=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]),Math.sqrt(n*n+r*r)}},{}],169:[function(e,t,n){var r;r=e("../core/console/print.coffee"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T;if(O=t.source,F=t.target,i=t.directed,l=t.distance,A=t.nodeid,N=t.startpoint,c=t.endpoint,n=t.K,T=t.vdebug,i||(i=!1),null==n&&(n=1),null==A?A=function(e){return e}:"string"==typeof A&&(A=function(e){return function(t){return t[e]}}(A)),null!=O&&"object"==typeof O&&(O=A(O)),null!=F&&"object"==typeof F&&(F=A(F)),null==N?N=function(e){return e.source}:"string"==typeof N&&(N=function(e){return function(t){return t[e]}}(N)),null==c?c=function(e){return e.target}:"string"==typeof c&&(c=function(e){return function(t){return t[e]}}(c)),null==l)l=function(e){return 1};else if("number"==typeof l)l=function(e){return function(t){return e}}(l);else if("string"==typeof l)l=function(e){return function(t){return t[e]}}(l);else if(l instanceof Array){for(u={},d=m=0,b=e.length;m<b;d=++m)s=e[d],o=A(N(s)),a=A(c(s)),u[o+"_"+a]=l[d];l=function(e){return o=A(N(e)),a=A(c(e)),u[o+"_"+a]}}for(j={},y=0,w=e.length;y<w;y++){for(s=e[y],z=N(s),M=c(s),v=A(z),g=A(M),E=[z,M],x=0,_=E.length;x<_;x++)k=E[x],(p=A(k))in j||(j[p]={node:k,outedges:[]});j[v].outedges.push(s),i||j[g].outedges.push(s)}return f=null,0===e.length?f="The length of edges is 0":n<0?f="K can not have negative value":null==l(e[0])?f="Check the distance function/attribute":null==N(e[0])?f="Check the startpoint function/attribute":null==c(e[0])?f="Check the endpoint function/attribute":(h=A(N(e[0])),null==h||"string"!=(S=typeof h)&&"number"!==S?f="Check the nodeid function/attribute":null==O||O in j?null==F||F in j||(f="The target is not in the graph"):f="The source is not in the graph"),null!=f?(r.error(f),null):[e,{source:O,target:F,directed:i,distance:l,nodeid:A,startpoint:N,endpoint:c,K:n,nodes:j,vdebug:T}]}},{"../core/console/print.coffee":54}],170:[function(e,t,n){var r,o;r=e("heap"),o=e("./normalize.coffee"),t.exports=function(e,t,n){var a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T;if(null==n&&(n={}),n.source=t,(null==n.nodes||"object"!=typeof n.nodes)&&(M=o(e,n),e=M[0],n=M[1],null===n))return null;t=n.source,N=n.target,u=n.directed,c=n.distance,_=n.nodeid,O=n.startpoint,d=n.endpoint,a=n.K,k=n.nodes;for(g in k)w=k[g],w.count=0;for(h=new r(function(e,t){return e.distance-t.distance}),T={},null==N&&(T[t]=!0),h.push({edge:null,target:t,distance:0}),b=0,S=[];!h.empty()&&(b=Math.max(b,h.size()),z=h.pop(),F=z.target,k[F].count++,null==N?S.push(z):F===N&&S.push(z),S.length!==a);)if(k[F].count<=a)for(A=k[F].outedges,v=0,y=A.length;v<y;v++){if(f=A[v],i=_(O(f)),s=_(d(f)),u||s!==F||(j=[s,i],i=j[0],s=j[1]),null==N){if(T[s])continue;T[s]=!0}l=z.distance+c(f),h.push({edge:f,previous:z,target:s,distance:l})}for(p=function(t){for(e=[];null!=t.edge;)e.push(t.edge),t=t.previous;return e.reverse()},m=0,x=S.length;m<x;m++)E=S[m],null!=N&&(delete E.target,E.edges=p(E)),delete E.edge,delete E.previous;return S}},{"./normalize.coffee":169,heap:4}],171:[function(e,t,n){var r;r=e("./distance.coffee"),t.exports=function(e,t){var n,o;return t||(t={}),n=[],o=d3.geom.quadtree().x(function(e){return t.accessor?t.accessor(e)[0]:e[0]}).y(function(e){return t.accessor?t.accessor(e)[1]:e[1]}),o(e).visit(function(e){var o,a,i,l,s,u,c,f;if(!e.leaf)for(c=e.nodes,o=0,i=c.length;o<i;o++)if((s=c[o])&&s.point)if(t.origin)n.push(r(s,t));else for(f=e.nodes,a=0,l=f.length;a<l;a++)(u=f[a])&&u.point&&u.point!==s.point&&n.push(r(s,u));return!1}),t.all?n.sort(function(e,t){return e-t}):d3.min(n)}},{"./distance.coffee":168}],172:[function(e,t,n){var r;r=e("./normalize.coffee"),t.exports=function(e,t,n){var o,a,i,l,s,u,c,f,d,p,h,v;return null==n&&(n={}),n.source=t,null!=n.nodes&&"object"==typeof n.nodes||(p=r(e,n),e=p[0],null!==(n=p[1]))?(t=n.source,i=n.directed,l=n.distance,f=n.nodeid,h=n.startpoint,u=n.endpoint,o=n.K,d=n.nodes,v={},v[t]=!0,a=function(e,t){var n,r,s,c,p,g,m,y,x;for(m=d[e].outedges,x=[],c=0,p=m.length;c<p;c++)s=m[c],n=f(h(s)),r=f(u(s)),i||r!==e||(y=[r,n],n=y[0],r=y[1]),r in v?x.push(void 0):(g=t+l(s),g<=o?(v[r]=!0,x.push(a(r,g))):x.push(void 0));return x},a(t,0),{nodes:function(){var e;e=[];for(c in v)e.push(d[c].node);return e}(),edges:function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)s=e[t],f(h(s))in v&&f(u(s))in v&&r.push(s);return r}()}):null}},{"./normalize.coffee":169}],173:[function(e,t,n){var r;r=e("../core/locale/languages/en_US.coffee"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h;return void 0===e||null===e||!1===e?"":(t||(t={}),s="locale"in t?t.locale:r,d=s.time.slice(),o=d3.locale(s.format),t||(t={}),p=t.vars||{},a=t.key,i=!("labels"in t)||t.labels,l=e.toString().split(".")[0].length,p.time&&p.time.value&&d.push(p.time.value),"string"==typeof a&&d.indexOf(a.toLowerCase())>=0?u=e:"share"===a?(u=0===e?0:e>=100?o.numberFormat(",f")(e):e>99?o.numberFormat(".3g")(e):o.numberFormat(".2g")(e),u+="%"):e<10&&e>-10?(l=e.toString().split("."),c=1,l.length>1&&(c=d3.min([parseFloat(l[1]).toString().length,2]),-1<e&&e<1||(h=l[1].length-parseFloat(l[1]).toString().length,c+=1+h)),u=o.numberFormat("."+c+"g")(e)):l>3?(f=d3.formatPrefix(e).symbol,f=f.replace("G","B"),e=d3.formatPrefix(e).scale(e),e=o.numberFormat(".3g")(e),e=e.replace(s.format.decimal,"."),e=parseFloat(e)+"",e=e.replace(".",s.format.decimal),u=e+f):u=3===l?o.numberFormat(",f")(e):0===e?0:e===parseInt(e,10)?o.numberFormat(".2")(e):o.numberFormat(".3g")(e),u.length>2&&""+u.indexOf(".0")===u.length-2&&(u=u.slice(0,u.length-2)),i&&a&&"format"in p&&a in p.format.affixes.value?(n=p.format.affixes.value[a],n[0]+u+n[1]):u)}},{"../core/locale/languages/en_US.coffee":72}],174:[function(e,t,n){var r,o;r=e("../util/d3selection.coffee"),o=e("./validate.coffee"),t.exports=function(e,t){var n,a;return n=function(e,t,a){var i,l,s;l=[];for(i in e)s=e[i],void 0!==s?!a&&o(s)?("object"!=typeof t[i]&&(t[i]={}),l.push(n(s,t[i],0===i.indexOf("d3po")))):!r(s)&&s instanceof Array?l.push(t[i]=s.slice(0)):l.push(t[i]=s):l.push(void 0);return l},a={},e&&n(e,a),t&&n(t,a),a}},{"../util/d3selection.coffee":211,"./validate.coffee":175}],175:[function(e,t,n){t.exports=function(e){return e&&e.constructor===Object}},{}],176:[function(e,t,n){t.exports=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.unkeyed_index=0,t.replace(/\{(\w*)\}/g,function(n,r){if(""===r&&(r=t.unkeyed_index,t.unkeyed_index++),r==+r)return"undefined"!==e[r]?e[r]:n;for(var o=0;o<e.length;o++)if("object"==typeof e[o]&&void 0!==e[o][r])return e[o][r];return n}.bind(t))}},{}],177:[function(e,t,n){var r,o;r=e("./format.js"),o=e("../core/locale/languages/en_US.coffee").ui,t.exports=function(e,t,n,a){var i;return e instanceof Array?(e=e.slice(0),t||(t=o.and),a||(a=o.moreText),2===e.length?e.join(" "+t+" "):(n&&e.length>n&&(i=e.length-n+1,e=e.slice(0,n-1),e[n-1]=r(a,i)),e.length>1&&(e[e.length-1]=t+" "+e[e.length-1]),e.join(", "))):e}},{"../core/locale/languages/en_US.coffee":72,"./format.js":176}],178:[function(e,t,n){t.exports=function(e){var t=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"],n=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]];return e+="",""+e.replace(/[^A-Za-z0-9\-_]/g,function(e){if(" "===e)return"_";if(t.indexOf(e)>=0)return"";for(var r=e,o=0;o<n.length;o++)if(new RegExp(n[o][0]).test(e)){r=n[o][1];break}return r})}},{}],179:[function(e,t,n){var r;r=e("../core/locale/languages/en_US.coffee"),t.exports=function(e,t){var n,o,a,i;return e?(t||(t={}),t.key,"."===e.charAt(e.length-1)?e.charAt(0).toUpperCase()+e.substr(1):(a="locale"in this?this.locale.value:r,i=a.lowercase.map(function(e){return e.toLowerCase()}),o=a.uppercase,o=o.concat(o.map(function(e){return e+"s"})),n=o.map(function(e){return e.toLowerCase()}),e.replace(/[^\s!-#%&(-\x2A,-:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]*/g,function(t,r){var a;return t?(a=n.indexOf(t.toLowerCase()),a>=0?o[a]:i.indexOf(t.toLowerCase())>=0&&0!==r&&r!==e.length-1?t.toLowerCase():t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()):""}))):""}},{"../core/locale/languages/en_US.coffee":72}],180:[function(e,t,n){var r,o;r=e("./foreign.coffee"),o=e("./tspan.coffee"),t.exports=function(e){e.text.html.value?r(e):o(e)}},{"./foreign.coffee":181,"./tspan.coffee":184}],181:[function(e,t,n){t.exports=function(e){var t,n,r,o,a;a=e.container.value,r=a.attr("font-family")||a.style("font-family"),t=e.align.value||a.attr("text-anchor")||a.style("text-anchor"),n=a.attr("fill")||a.style("fill"),o=a.attr("opacity")||a.style("opacity"),t="end"===t?"right":"middle"===t?"center":"left",d3.select(a.node().parentNode).append("foreignObject").attr("width",e.width.value+"px").attr("height",e.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",r).style("font-size",e.size.value[1]+"px").style("color",n).style("text-align",t).style("opacity",o).text(e.text.current)}},{}],182:[function(e,t,n){t.exports=function(e){var t,n,r,o,a,i,l,s,u,c;if(n=e.container.value,o=n.node().previousElementSibling,i=o?o.tagName.toLowerCase():"",o&&(o=d3.select(o)),e.container.x=e.x.value||parseFloat(n.attr("x"),10),e.container.y=e.y.value||parseFloat(n.attr("y"),10),o&&(e.shape.accepted.indexOf(i)>=0&&e.self.shape(i),"rect"===i?(u=parseFloat(o.attr("x"),10)||0,c=parseFloat(o.attr("y"),10)||0,!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||(s=parseFloat(o.attr("width")),e.self.width(s)),e.height.value||(r=parseFloat(o.attr("height")),e.self.height(r))):"circle"===i?(a=parseFloat(o.attr("r"),10),u=parseFloat(o.attr("cx"),10)||0,u-=a,c=parseFloat(o.attr("cy"),10)||0,c-=a,
!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||e.self.width(2*a,10),e.height.value||e.self.height(2*a,10)):(e.width.value||e.self.width(500),e.height.value||e.self.height(500))),e.container.x||(e.container.x=0),e.container.y||(e.container.y=0),e.width.inner=e.width.value-2*e.padding.value,e.height.inner=e.height.value-2*e.padding.value,l=n.attr("font-size")||n.style("font-size"),l=parseFloat(l,10),e.container.fontSize=l,e.container.dy=parseFloat(n.attr("dy"),10),!e.size.value)return e.resize.value?e.self.size([4,80]):e.self.size([l/2,l])}},{}],183:[function(e,t,n){t.exports=function(e){var t;if(e.text.value||(t=e.container.value.text())&&(t.indexOf("tspan")>=0&&(t.replace(/\<\/tspan\>\<tspan\>/g," "),t.replace(/\<\/tspan\>/g,""),t.replace(/\<tspan\>/g,"")),t=t.replace(/(\r\n|\n|\r)/gm,""),t=t.replace(/^\s+|\s+$/g,""),e.self.text(t)),e.text.value instanceof Array?e.text.phrases=e.text.value.filter(function(e){return["string","number"].indexOf(typeof e)>=0}):e.text.phrases=[e.text.value+""],!e.align.value)return e.container.align=e.container.value.style("text-anchor")||e.container.value.attr("text-anchor")}},{}],184:[function(e,t,n){var r;r=e("../../client/rtl.coffee"),t.exports=function(e){var t,n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F;return d=function(t){var r;return r=!v||t?e.container.value.append("tspan"):e.container.value.insert("tspan","tspan"),r.attr("x",S+"px").attr("dy",n+"px").style("baseline-shift","0%").attr("dominant-baseline","alphabetic")},f=-90===e.rotate.value||90===e.rotate.value,A=f?e.height.inner:e.width.inner,l=f?e.width.inner:e.height.inner,t="circle"===e.shape.value?"middle":e.align.value||e.container.align||"start",O="end"===t||"start"===t&&r?A:"middle"===t?A/2:0,M=e.valign.value||"top",S=e.container.x+O,a=e.resize.value?e.size.value[1]:e.container.fontSize||e.size.value[0],n=e.container.dy||1.1*a,_=null,h=null,j=null,v=!1,F=0,"circle"===e.shape.value&&("middle"===M?F=l/n%1*n/2:"end"===M&&(F=l/n%1*n)),e.container.value.attr("text-anchor",t).attr("font-size",a+"px").style("font-size",a+"px").attr("x",e.container.x).attr("y",e.container.y),z=function(){if(_.remove(),v?(s++,_=e.container.value.select("tspan")):(s--,_=d3.select(e.container.value.node().lastChild)),!_.empty())return j=_.text().match(/[^\s-]+-?/g),o()},u=function(){var t;return"circle"===e.shape.value?(t=(s-1)*n+F,t>l/2&&(t+=n),2*Math.sqrt(t*(A/2*2-t))):A},o=function(){var t,n;return j&&j.length?(n=j.pop(),t=n.charAt(n.length-1),1===n.length&&e.text.split.value.indexOf(n)>=0?o():(e.text.split.value.indexOf(t)>=0&&(n=n.substr(0,n.length-1)),_.text(j.join(" ")+" "+n+"..."),_.node().getComputedTextLength()>u()?o():void 0)):z()},p=function(t){var n,r,o,a;if(n=_.text(),a="",v){if(" "===(a=e.text.current.charAt(e.text.current.length-h.length-1)))for(o="",r=2;" "===a;)o+=" ",a=e.text.current.charAt(e.text.current.length-h.length-r),r++;else o="";h=t+o+h,_.text(t+o+n)}else{if(" "===(a=e.text.current.charAt(h.length)))for(o="",r=1;" "===a;)o+=" ",a=e.text.current.charAt(h.length+r),r++;else o="";h+=o+t,_.text(n+o+t)}if(Math.floor(_.node().getComputedTextLength())>u()||"\n"===a)return _.text(n),n.length&&(_=d()),_.text(t),v?s--:s++},w=1,s=null,c=null,E=function(){var t,r,o,a,i,u;for(e.container.value.text("").html(""),j=e.text.words.slice(),v&&j.reverse(),h="",_=d(!0),s=w,r=0,o=j.length;r<o;r++){if(u=j[r],s*n>l){z();break}for(p(u),i=!0;i;){for(a=e.text.current.charAt(h.length),t=1;" "===a;)a=e.text.current.charAt(h.length+t),t++;i=e.text.split.value.indexOf(a)>=0,i&&p(a)}}return s*n>l&&z(),c=Math.abs(s-w)+1},E(),c=0,e.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return c++}),"circle"===e.shape.value&&(b=l-c*n)>n&&("middle"===M?(w=1+(b/n/2>>0),E()):"bottom"===M&&(v=!0,w=l/n>>0,E())),c=0,e.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return c++}),"top"===M?N=0:(i=c*n,N="middle"===M?l/2-i/2:l-i),N-=.2*n,k="translate(0,"+N+")",180===e.rotate.value||-180===e.rotate.value?(y=e.container.x+A/2,x=e.container.y+l/2):(g=e.rotate.value<0?A:l,y=e.container.x+g/2,x=e.container.y+g/2),m="rotate("+e.rotate.value+", "+y+", "+x+")",e.container.value.attr("transform",m+k)}},{"../../client/rtl.coffee":42}],185:[function(e,t,n){var r,o,a,i;r=e("./flow.coffee"),o=e("../../font/sizes.coffee"),i=function(e){var t;e.text.phrases.length&&(e.text.current=e.text.phrases.shift()+"",e.text.words=e.text.current.match(e.text.split.break),t=e.text.current.charAt(0),t!==e.text.words[0].charAt(0)&&(e.text.words[0]=t+e.text.words[0]),e.container.value.html(""),e.resize.value?a(e):r(e))},t.exports=i,a=function(e){var t,n,a,l,s,u,c,f,d,p,h,v,g,m,y,x,b;for(b=[],c=0;c<e.text.words.length;)t=c===e.text.words.length-1?"":" ",b.push(e.text.words[c]+t),c++;p=-90===e.rotate.value||90===e.rotate.value,y=p?e.height.inner:e.width.inner,s=p?e.width.inner:e.height.inner,h=Math.floor(e.size.value[1]),f="circle"===e.shape.value?.75*y:y,g=o(b,{"font-size":h+"px"},{parent:e.container.value}),d=d3.max(g,function(e){return e.width}),n=1.165+y/s*.11,m=d3.sum(g,function(t){var n;return n=e.container.dy||1.2*h,t.width*n})*n,l="circle"===e.shape.value?Math.PI*Math.pow(y/2,2):f*s,(d>f||m>l)&&(a=Math.sqrt(l/m),x=f/d,v=d3.min([a,x]),h=d3.max([e.size.value[0],Math.floor(h*v)])),u=Math.floor(.8*s),h>u&&(h=u),d*(h/e.size.value[1])<=f?(h!==e.size.value[1]&&e.self.size([e.size.value[0],h]),r(e)):i(e)}},{"../../font/sizes.coffee":104,"./flow.coffee":180}],186:[function(e,t,n){t.exports={accepted:[!1,"start","middle","end","left","center","right"],process:function(e){var t;return t=["left","center","right"].indexOf(e),t>=0&&(e=this.accepted[t+1]),e},value:!1}},{}],187:[function(e,t,n){arguments[4][110][0].apply(n,arguments)},{dup:110}],188:[function(e,t,n){var r;r=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1!==e&&(r(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e)))},value:!1}},{"../../util/d3selection.coffee":211}],189:[function(e,t,n){arguments[4][114][0].apply(n,arguments)},{dup:114}],190:[function(e,t,n){var r,o;r=e("../../core/console/print.coffee"),o=e("../../string/format.js"),t.exports={accepted:[void 0],process:function(e,t){var n,a;return!1===this.initialized?e:(!1===t.container.value?(a=t.format.locale.value.dev.setContainer,r.warning(a,"container")):t.container.value.empty()?(a=t.format.locale.value.dev.noContainer,n=t.container.selector||"",r.warning(o(a,'"'+n+'"'),"container")):(t.dev.value&&r.time("total draw time"),t.container.value.call(t.self)),e)},value:void 0}},{"../../core/console/print.coffee":54,"../../string/format.js":176}],191:[function(e,t,n){var r,o;r=e("../../core/locale/locale.coffee"),o=e("../../object/merge.coffee"),t.exports={accepted:[Function,String],locale:{accepted:function(){return d3.keys(r)},process:function(e){var t,n;return t="en_US",n=r[t],e!==t&&(n=o(n,r[e])),this.language=e,n},value:"en_US"},process:function(e,t){if(this.initialized&&"string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},value:"en_US"}},{"../../core/locale/locale.coffee":81,"../../object/merge.coffee":174}],192:[function(e,t,n){t.exports={accepted:[!1,Number],value:!1}},{}],193:[function(e,t,n){arguments[4][192][0].apply(n,arguments)},{dup:192}],194:[function(e,t,n){arguments[4][114][0].apply(n,arguments)},{dup:114}],195:[function(e,t,n){t.exports={accepted:[-180,-90,0,90,180],value:0}},{}],196:[function(e,t,n){t.exports={accepted:["circle","square"],value:!1}},{}],197:[function(e,t,n){t.exports={accepted:[Array,!1],value:!1}},{}],198:[function(e,t,n){t.exports={accepted:[!1,Array,Number,String],html:{accepted:[Boolean],value:!1},init:function(e){var t;return t=this.split.value,this.split.break=new RegExp("[^\\s\\"+t.join("\\")+"]+\\"+t.join("?\\")+"?","g"),!1},split:{accepted:[Array],process:function(e){return this.break=new RegExp("[^\\s\\"+e.join("\\")+"]+\\"+e.join("?\\")+"?","g"),e},value:["-","/",";",":","&"]}}},{}],199:[function(e,t,n){t.exports={accepted:[!1,"top","middle","bottom"],value:!1}},{}],200:[function(e,t,n){arguments[4][192][0].apply(n,arguments)},{dup:192}],201:[function(e,t,n){arguments[4][192][0].apply(n,arguments)},{dup:192}],202:[function(e,t,n){arguments[4][192][0].apply(n,arguments)},{dup:192}],203:[function(e,t,n){var r,o,a,i,l;r=e("../core/methods/attach.coffee"),a=e("./helpers/parseSize.coffee"),o=e("../core/console/print.coffee"),i=e("./helpers/parseText.coffee"),l=e("./helpers/wrap.coffee"),t.exports=function(){var t;return t={self:function(e){return e.each(function(){a(t),t.size.value[0]<=t.height.inner?(i(t),l(t)):t.container.value.html(""),t.dev.value&&o.timeEnd("total draw time")}),t.self}},r(t,{align:e("./methods/align.coffee"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),padding:e("./methods/padding.coffee"),resize:e("./methods/resize.coffee"),rotate:e("./methods/rotate.coffee"),text:e("./methods/text.coffee"),shape:e("./methods/shape.coffee"),size:e("./methods/size.coffee"),valign:e("./methods/valign.coffee"),width:e("./methods/width.coffee"),x:e("./methods/x.coffee"),y:e("./methods/y.coffee")}),t.self}},{"../core/console/print.coffee":54,"../core/methods/attach.coffee":82,"./helpers/parseSize.coffee":182,"./helpers/parseText.coffee":183,"./helpers/wrap.coffee":185,"./methods/align.coffee":186,"./methods/config.coffee":187,"./methods/container.coffee":188,"./methods/dev.coffee":189,"./methods/draw.coffee":190,"./methods/format.coffee":191,"./methods/height.coffee":192,"./methods/padding.coffee":193,"./methods/resize.coffee":194,"./methods/rotate.coffee":195,"./methods/shape.coffee":196,"./methods/size.coffee":197,"./methods/text.coffee":198,"./methods/valign.coffee":199,"./methods/width.coffee":200,"./methods/x.coffee":201,"./methods/y.coffee":202}],204:[function(e,t,n){function r(){d3.selectAll("div.d3po_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3po_tooltip_data_help").style("background-color","#ccc")}var o=e("../core/locale/languages/en_US.coffee"),a=e("../client/pointer.coffee"),i=e("../color/legible.coffee"),l=e("./move.coffee"),s=e("../client/prefix.coffee"),u=e("../client/rtl.coffee"),c=e("./remove.coffee"),f=e("../client/scroll.js"),d=e("../client/scrollbar.coffee"),p=e("../string/list.coffee"),h=e("../color/text.coffee");t.exports=function(e){var t=e.fullscreen?250:200,n=s();e.width=e.width||t,e.max_width=e.max_width||386,e.id=e.id||"default",e.size=e.fullscreen||e.html?"large":"small",e.offset=e.offset||0,e.arrow_offset=e.arrow?8:0,e.x=e.x||0,e.y=e.y||0,e.parent=e.parent||d3.select("body"),e.curtain=e.curtain||"#fff",e.curtainopacity=e.curtainopacity||.8,e.background=e.background||"#fff",e.fontcolor=e.fontcolor||"#444",e.fontfamily=e.fontfamily||"sans-serif",e.fontweight=e.fontweight||"normal",e.fontsize=e.fontsize||"12px",e.style=e.style||"default",e.zindex="small"==e.size?2e3:500,e.locale=e.locale||o,e.stacked=e.stacked||!1;var v=e.parent?e.parent.node().offsetHeight||e.parent.node().getBoundingClientRect().height:0;if(e.iconsize||(e.iconsize="small"==e.size?22:50),e.parent.node()===document.body){e.limit=[window.innerWidth+f.x(),window.innerHeight+f.y()];var g=d();document.body.scrollHeight>window.innerHeight&&(e.limit[0]-=g)}else e.limit=[parseFloat(e.parent.style("width"),10),parseFloat(e.parent.style("height"),10)];if(e.title instanceof Array){var m=e.locale.ui.and,y=e.locale.ui.more;e.title=p(e.title,m,3,y)}if(c(e.id),e.anchor={},e.fullscreen)e.anchor.x="center",e.anchor.y="center",e.x=e.parent?e.parent.node().offsetWidth/2:window.innerWidth/2,e.y=e.parent?v/2:window.innerHeight/2;else if(e.align){var x=e.align.split(" ");e.anchor.y=x[0],x[1]?e.anchor.x=x[1]:e.anchor.x="center"}else e.anchor.x="center",e.anchor.y="top";var b=e.width-30;if(e.fullscreen){e.parent.append("div").attr("id","d3po_tooltip_curtain_"+e.id).attr("class","d3po_tooltip_curtain").style("background-color",e.curtain).style("opacity",e.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(a.click,function(){c(e.id)})}var w=e.parent.append("div").datum(e).attr("id","d3po_tooltip_id_"+e.id).attr("class","d3po_tooltip d3po_tooltip_"+e.size).style("color",e.fontcolor).style("font-family",e.fontfamily).style("font-weight",e.fontweight).style("font-size",e.fontsize+"px").style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").on(a.out,r);e.max_height&&w.style("max-height",e.max_height+"px"),e.fixed?(w.style("z-index",500),e.mouseevents=!0):w.style("z-index",2e3);var _=w.append("div").datum(e).attr("class","d3po_tooltip_container").style("background-color",e.background).style("padding","6px");if(e.fullscreen&&e.html&&!e.stacked){z=e.parent?.75*e.parent.node().offsetWidth:.75*window.innerWidth,B=e.parent?.75*v:.75*window.innerHeight,_.style("width",z+"px").style("height",B+"px");var k=_.append("div").attr("class","d3po_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",e.width+"px")}else{if("auto"==e.width){var z="auto";_.style("max-width",e.max_width+"px")}else var z=e.width-14+"px";var k=_.style("width",z)}if(e.title||e.icon)var M=k.append("div").attr("class","d3po_tooltip_header").style("position","relative").style("z-index",1);if(e.fullscreen){w.append("div").attr("class","d3po_tooltip_close").style("background-color",e.color).style("color",h(e.color)).style("position","absolute").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(a.over,function(){d3.select(this).style("cursor","pointer").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(a.out,function(){d3.select(this).style("cursor","auto").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(a.click,function(){c(e.id)});d3.select("body").on("keydown.esc_"+e.id,function(){27===d3.event.keyCode&&(c(e.id),d3.select("body").on("keydown.esc_"+e.id,null))})}if(e.mouseevents){if(!0!==e.mouseevents){var A=d3.select(e.mouseevents).on(a.out),j=function(){var t=d3.event.toElement||d3.event.relatedTarget;if(t)var n="string"==typeof t.className?t.className:t.className.baseVal,o=0==n.indexOf("d3po_tooltip");else var o=!1;t&&(E(w.node(),t)||E(e.mouseevents,t)||o)||(A(d3.select(e.mouseevents).datum()),r(),d3.select(e.mouseevents).on(a.out,A))},E=function(e,t){for(var n=t.parentNode;null!==n;){if(n==e)return!0;n=n.parentNode}return!1};d3.select(e.mouseevents).on(a.out,j),w.on(a.out,j);var S=d3.select(e.mouseevents).on(a.move);S&&w.on(a.move,S)}}else w.style("pointer-events","none");if(e.arrow){w.append("div").attr("class","d3po_tooltip_arrow").style("background-color",e.background).style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(n+"transform","rotate(45deg)").style("z-index",-1)}if(e.icon){var O=M.append("div").attr("class","d3po_tooltip_icon").style("width",e.iconsize+"px").style("height",e.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+e.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==e.style&&O.style("background-color",e.color),b-=O.node().offsetWidth}if(e.title){var N=e.max_width-6;e.icon&&(N-=e.iconsize+6),N+="px";M.append("div").attr("class","d3po_tooltip_title").style("max-width",N).style("color",e.icon?e.fontcolor:i(e.color)).style("vertical-align","top").style("width",b+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===e.size?"18px":"16px").style("line-height","large"===e.size?"20px":"17px").style("padding","large"===e.size?"3px 6px":"3px").text(e.title)}if(e.description){k.append("div").attr("class","d3po_tooltip_description").style("font-size","12px").style("padding","6px").text(e.description)}if(e.data||e.html&&!e.fullscreen)var F=k.append("div").attr("class","d3po_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(e.data){var T=0,C={},q=null;e.data.forEach(function(t,o){t.group&&q!=t.group&&(q=t.group,F.append("div").attr("class","d3po_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(t.group));var l=F.append("div").attr("class","d3po_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(t);!0===t.highlight?l.style("color",i(e.color)):(t.allColors||t.highlight!==e.color)&&l.style("color",i(t.highlight));var c=l.append("div").attr("class","d3po_tooltip_data_name").style("display","inline-block").html(t.name).on(a.out,function(){d3.event.stopPropagation()});if(t.link&&c.style("cursor","pointer").on(a.click,t.link),t.value instanceof Array){var f=e.locale.ui.and,d=e.locale.ui.more;t.value=list(t.value,f,3,d)}var p=l.append("div").attr("class","d3po_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").html(t.value).on(a.out,function(){d3.event.stopPropagation()});if(u?p.style("left","6px"):p.style("right","6px"),e.mouseevents&&t.desc){var h=l.append("div").attr("class","d3po_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(n+"transition","height 0.5s").style("width","85%").text(t.desc).on(a.out,function(){d3.event.stopPropagation()}),v=h.node().offsetHeight||h.node().getBoundingClientRect().height;h.style("height","0px");var g=c.append("div").attr("class","d3po_tooltip_data_help").style("background-color","#ccc").style(n+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(s+"transition","background-color 0.5s").text("?").on(a.over,function(){var e=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",e),h.style("height",v+"px")}).on(a.out,function(){d3.event.stopPropagation()});c.style("cursor","pointer").on(a.over,function(){r();var e=d3.select(this.parentNode).style("color");g.style("background-color",e),h.style("height",v+"px")}),l.on(a.out,function(){d3.event.stopPropagation(),r()})}var m=parseFloat(p.style("width"),10);m>e.width/2&&(m=e.width/2),m>T&&(T=m),o!=e.data.length-1&&(t.group&&t.group==e.data[o+1].group||!t.group&&!e.data[o+1].group)&&F.append("div").attr("class","d3po_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")}),F.selectAll(".d3po_tooltip_data_name").style("width",function(){return parseFloat(d3.select(this.parentNode).style("width"),10)-T-30+"px"}),F.selectAll(".d3po_tooltip_data_value").style("width",T+"px").each(function(e){var t=parseFloat(d3.select(this).style("height"),10);C[e.name]=t}),F.selectAll(".d3po_tooltip_data_name").style("min-height",function(e){return C[e.name]+"px"})}!e.html||e.fullscreen&&!e.stacked||(F.append("div").html(e.html),e.js&&e.js(_));var P=k.append("div").attr("class","d3po_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(e.footer&&P.html(e.footer),e.height=w.node().offsetHeight||w.node().getBoundingClientRect().height,e.html&&e.fullscreen&&!e.stacked){var B=e.height-12,z=w.node().offsetWidth-e.width-44;_.append("div").attr("class","d3po_tooltip_html").style("width",z+"px").style("height",B+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(e.html),e.js&&e.js(_)}if(e.width=w.node().offsetWidth,"center"!=e.anchor.y?e.height+=e.arrow_offset:e.width+=e.arrow_offset,e.data||(!e.fullscreen||e.stacked)&&e.html){if(!e.fullscreen||e.stacked)var D=e.fixed?v-e.y-10:v-10,B=e.height<D?e.height:D;else var B=e.height;B-=parseFloat(_.style("padding-top"),10),B-=parseFloat(_.style("padding-bottom"),10),M&&(B-=M.node().offsetHeight||M.node().getBoundingClientRect().height,B-=parseFloat(M.style("padding-top"),10),B-=parseFloat(M.style("padding-bottom"),10)),P&&(B-=P.node().offsetHeight||P.node().getBoundingClientRect().height,B-=parseFloat(P.style("padding-top"),10),B-=parseFloat(P.style("padding-bottom"),10)),F.style("max-height",B+"px")}e.height=w.node().offsetHeight||w.node().getBoundingClientRect().height,l(e.x,e.y,e.id)}},{"../client/pointer.coffee":40,"../client/prefix.coffee":41,"../client/rtl.coffee":42,"../client/scroll.js":43,"../client/scrollbar.coffee":44,"../color/legible.coffee":46,"../color/text.coffee":52,"../core/locale/languages/en_US.coffee":72,"../string/list.coffee":177,"./move.coffee":205,"./remove.coffee":206}],205:[function(e,t,n){var r,o;o=e("../client/scroll.js"),t.exports=function(e,t,n){var a,i,l;return n||(n="default"),l=d3.select("div#d3po_tooltip_id_"+n),l.node()&&(a=l.datum(),a.cx=e,a.cy=t,a.fixed||(i="body"===a.parent.node().tagName.toLowerCase()?[o.x(),o.y()]:[0,0],"center"!==a.anchor.y?("right"===a.anchor.x?a.x=a.cx-a.arrow_offset-4:"center"===a.anchor.x?a.x=a.cx-a.width/2:"left"===a.anchor.x&&(a.x=a.cx-a.width+a.arrow_offset+2),"bottom"===a.anchor.y?a.flip=a.cy+a.height+a.offset<=a.limit[1]:"top"===a.anchor.y&&(a.flip=a.cy-a.height-a.offset<i[1]),a.flip?a.y=a.cy+a.offset+a.arrow_offset:a.y=a.cy-a.height-a.offset-a.arrow_offset):(a.y=a.cy-a.height/2,"right"===a.anchor.x?a.flip=a.cx+a.width+a.offset<=a.limit[0]:"left"===a.anchor.x&&(a.flip=a.cx-a.width-a.offset<i[0]),"center"===a.anchor.x?(a.flip=!1,a.x=a.cx-a.width/2):a.flip?a.x=a.cx+a.offset+a.arrow_offset:a.x=a.cx-a.width-a.offset),a.x<i[0]?a.x=i[0]:a.x+a.width>a.limit[0]&&(a.x=a.limit[0]-a.width),a.y<i[1]?a.y=i[1]:a.y+a.height>a.limit[1]&&(a.y=a.limit[1]-a.height)),l.style("top",a.y+"px").style("left",a.x+"px"),a.arrow&&l.selectAll(".d3po_tooltip_arrow").call(r)),l},r=function(e){return e.style("bottom",function(e){return"center"===e.anchor.y||e.flip?"auto":"-5px"}).style("right",function(e){return"center"!==e.anchor.y||e.flip?"auto":"-5px"}).style("top",function(e){return"center"!==e.anchor.y&&e.flip?"-5px":"center"===e.anchor.y?"50%":"auto"}).style("left",function(e){return"center"===e.anchor.y&&e.flip?"-5px":"center"!==e.anchor.y?"50%":"auto"}).style("margin-left",function(e){var t;return"center"===e.anchor.y?"auto":(t="right"===e.anchor.x?-e.width/2+e.arrow_offset/2:"left"===e.anchor.x?e.width/2-2*e.arrow_offset-5:-5,e.cx-e.width/2-5<t?(t=e.cx-e.width/2-5)<2-e.width/2&&(t=2-e.width/2):-(e.limit[0]-e.cx-e.width/2+5)>t&&(t=-(e.limit[0]-e.cx-e.width/2+5))>e.width/2-11&&(t=e.width/2-11),t+"px")}).style("margin-top",function(e){var t;return"center"!==e.anchor.y?"auto":(t="bottom"===e.anchor.y?-e.height/2+e.arrow_offset/2-1:"top"===e.anchor.y?e.height/2-2*e.arrow_offset-2:-9,e.cy-e.height/2-e.arrow_offset<t?(t=e.cy-e.height/2-e.arrow_offset)<4-e.height/2&&(t=4-e.height/2):-(e.limit[1]-e.cy-e.height/2+e.arrow_offset)>t&&(t=-(e.limit[1]-e.cy-e.height/2+e.arrow_offset))>e.height/2-22&&(t=e.height/2-22),t+"px")})}},{"../client/scroll.js":43}],206:[function(e,t,n){t.exports=function(e){return e?(d3.selectAll("div#d3po_tooltip_curtain_"+e).remove(),d3.selectAll("div#d3po_tooltip_id_"+e).remove()):(d3.selectAll("div.d3po_tooltip_curtain").remove(),d3.selectAll("div.d3po_tooltip").remove())}},{}],207:[function(e,t,n){t.exports=function(e,t){var n;return[],n=1/(t-1)*(e[1]-e[0]),d3.range(e[0],e[1]+n,n)}},{}],208:[function(e,t,n){var r;r=e("./d3selection.coffee"),t.exports=function(e,t){var n;if(!e||!t)return!1;for(r(e)&&(e=e.node()),r(e)&&(t=t.node()),n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1}},{"./d3selection.coffee":211}],209:[function(e,t,n){t.exports=function(e,t){var n,r;return t.constructor===String?(r=e.indexOf(t),r>-1?e[r]:e[0]):(n=e[0],e.forEach(function(e){if(Math.abs(t-e)<Math.abs(t-n))return n=e}),n)}},{}],210:[function(e,t,n){var r,o,a;o=e("../object/merge.coffee"),a=e("../object/validate.coffee"),r=function(e){var t;return a(e)?o(e):e instanceof Array?(t=[],e.forEach(function(e){return t.push(r(e))}),t):e},t.exports=r},{"../object/merge.coffee":174,"../object/validate.coffee":175}],211:[function(e,t,n){var r;r=e("../client/ie.js"),t.exports=function(e){return r?"object"==typeof e&&e instanceof Array&&"size"in e&&"select"in e:e instanceof d3.selection}},{"../client/ie.js":39}],212:[function(e,t,n){t.exports=function(e,t){var n;n=new Image,n.src=e,n.crossOrigin="Anonymous",n.onload=function(){var e,n;e=document.createElement("canvas"),e.width=this.width,e.height=this.height,n=e.getContext("2d"),n.drawImage(this,0,0),t.call(this,e.toDataURL("image/png")),e=null}}},{}],213:[function(e,t,n){var r,o;r=e("../object/validate.coffee"),o=function(e,t,n,a,i,l){var s,u,c,f,d,p,h,v,g,m,y,x,b,w;if(void 0===e)return[];if(a&&void 0===i&&(i=a.id.value),l=!0===l&&void 0===l,e instanceof Array||(e=[e]),m=[],void 0===t)return e.reduce(function(e,t){var n;return n=JSON.stringify(t),m.indexOf(n)<0&&(e.indexOf(t)<0&&e.push(t),m.push(n)),e},[]);if(w=[],s=function(e){var t;if(void 0!==e&&null!==e&&(t=JSON.stringify(e),m.indexOf(t)<0))return w.push(e),m.push(t)},"function"==typeof n&&a)for(c=0,p=e.length;c<p;c++)for(u=e[c],b=o(n(a,u,t,i)),f=0,h=b.length;f<h;f++)x=b[f],s(x);else if("function"==typeof t)for(d=0,v=e.length;d<v;d++)u=e[d],b=t(u),s(b);else for(y=0,g=e.length;y<g;y++)u=e[y],r(u)&&(b=u[t],s(b));return l?w.sort(function(e,t){return e-t}):w},t.exports=o},{"../object/validate.coffee":175}],214:[function(e,t,n){t.exports=function(e){var t,n,r,o,a;for(e.container.value.style("position",function(){var e,t;return e=d3.select(this).style("position"),t=["absolute","fixed"].indexOf(e)>=0,t?e:"relative"}),e.container.changed&&e.container.value.html(""),o=["width","height"],n=0,r=o.length;n<r;n++)a=o[n],e[a].value||(t=function(n){var r,o;return void 0===n.tagName||["BODY","HTML"].indexOf(n.tagName)>=0?(o=window["inner"+a.charAt(0).toUpperCase()+a.slice(1)],r=document!==n&&d3.select(n),r&&("width"===a?(o-=parseFloat(r.style("margin-left"),10),o-=parseFloat(r.style("margin-right"),10),o-=parseFloat(r.style("padding-left"),10),o-=parseFloat(r.style("padding-right"),10)):(o-=parseFloat(r.style("margin-top"),10),o-=parseFloat(r.style("margin-bottom"),10),o-=parseFloat(r.style("padding-top"),10),o-=parseFloat(r.style("padding-bottom"),10))),e[a].value=o<=20?e[a].small:o):"number"==typeof(o=parseFloat(d3.select(n).style(a),10))&&o>0?e[a].value=o:"BODY"!==n.tagName?t(n.parentNode):void 0},t(e.container.value.node()),1===d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"));e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px")}},{}],215:[function(e,t,n){var r=e("../../core/data/format.js"),o=e("../../core/data/color.js"),a=e("../../core/data/keys.coffee"),i=e("../../core/data/load.coffee"),l=e("./ui/drawer.js"),s=e("./ui/legend.js"),u=e("./ui/timeline.coffee"),c=e("./errorCheck.js"),f=e("../../core/fetch/data.js"),d=e("./finish.js"),p=e("./focus/tooltip.coffee"),h=e("./ui/history.coffee"),v=e("../../core/parse/edges.js"),g=e("../../core/parse/nodes.js"),m=e("../../core/console/print.coffee"),y=e("../../tooltip/remove.coffee"),x=e("./types/run.coffee"),b=e("./shapes/draw.js"),w=e("../../string/format.js"),_=e("./svg/enter.js"),k=e("./svg/update.js"),z=e("./ui/titles.js"),M=e("../../object/validate.coffee");t.exports=function(e){var t=[],n=e.type.value,A=e.format.locale.value,j=A.message.ui,E=A.message.draw;if(["data","attrs","coords","nodes","edges"].forEach(function(n){e.error.value||e[n].loaded||!e[n].url||t.push({function:function(e,t){i(e,n,t)},message:A.message.loading,wait:!0})}),e.draw.update){var S=A.visualization[n]||n,O=e.types[n].setup||!1,N=e.types[n].requirements||[],F=w(A.message.initializing,S),T=A.message.data;N instanceof Array||(N=[N]),S=S.toLowerCase(),e.error.value||"function"!=typeof O||t.push({function:function(e){if(e.dev.value){var t="running "+S+" setup";m.time(t)}O(e),e.dev.value&&m.timeEnd(t)},message:F}),e.container.changed&&t.push({function:_,message:F}),n in e.g.apps||t.push({function:function(e){if(e.dev.value){var t="creating "+S+" group";m.time(t)}e.g.apps[n]=e.g.app.append("g").attr("id",n).attr("opacity",0),e.dev.value&&m.timeEnd(t)},message:F}),e.data.changed&&t.push({function:function(e){e.data.cache={},delete e.nodes.restricted,delete e.edges.restricted,a(e,"data")},message:T}),e.attrs.changed&&t.push({function:function(e){a(e,"attrs")},message:T}),t.push({function:function(e){if(!e.color.type||e.color.changed||e.data.changed||e.attrs.changed||e.id.changed||e.depth.changed||e.id.solo.changed||!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed)){if(e.color.valueScale=!1,e.dev.value){var t="checking color type";m.time(t)}if(e.color.type=!1,e.color.value){var n=e.color.value;M(n)&&(n=n[e.id.value]?n[e.id.value]:n[d3.keys(n)[0]]),e.data.keys&&n in e.data.keys?e.color.type=e.data.keys[n]:e.attrs.keys&&n in e.attrs.keys&&(e.color.type=e.attrs.keys[n])}else e.data.keys&&(e.color.type=e.data.keys[e.id.value]);e.dev.value&&m.timeEnd(t)}},message:T}),N.indexOf("edges")>=0&&e.edges.value&&(!e.edges.linked||e.edges.changed)&&t.push({function:v,message:T}),N.indexOf("nodes")>=0&&e.edges.value&&(!e.nodes.positions||e.nodes.changed||e.type.changed)&&t.push({function:g,message:T}),(e.data.changed||e.time.changed||e.time.format.changed||e.type.changed||e.id.changed||e.x.scale.changed&&[e.x.scale.value,e.x.scale.previous].indexOf("discrete")>=0||e.y.scale.changed&&[e.y.scale.value,e.y.scale.previous].indexOf("discrete")>=0)&&t.push({function:r,message:T}),e.error.value||t.push({function:function(e){var t=e.time.fixed.value?["all"]:null;if(e.dev.value){var n=t?"fetching pool data":"fetching data";m.time(n)}e.data.pool=f(e,t),e.dev.value&&m.timeEnd(n),t?(e.dev.value&&m.time("fetching data for current year"),e.data.viz=f(e),e.dev.value&&m.timeEnd("fetching data for current year")):e.data.viz=e.data.pool,e.draw.timing=e.data.viz.length<e.data.large?e.timing.transitions:0},message:T}),e.error.value||t.push({check:function(e){return e.color.value&&"number"===e.color.type&&!1===e.color.valueScale},function:o,message:T})}return t.push({function:function(e){if(e.dev.value){var t=e.format.locale.value.message.tooltipReset;m.time(t)}e.type.previous&&n!==e.type.previous&&y(e.type.previous),y(n),e.dev.value&&m.timeEnd(t)},message:j}),e.error.value||t.push({function:c,message:j}),t.push({function:function(e){if(e.margin.process(),z(e),!e.error.value)if(e.draw.update)l(e),u(e),s(e);else{e.dev.value&&m.time("calculating margins");var t=e.container.value.select("div#d3po_drawer").node().offsetHeight||e.container.value.select("div#d3po_drawer").node().getBoundingClientRect().height,n=e.g.timeline.node().getBBox();n=e.timeline.value?n.height+e.ui.padding:0;var r=e.g.legend.node().getBBox();r=e.legend.value?r.height+e.ui.padding:0,e.margin.bottom+=t+n+r,e.dev.value&&m.timeEnd("calculating margins")}h(e),e.height.viz-=e.margin.top+e.margin.bottom,e.width.viz-=e.margin.left+e.margin.right},message:j}),e.error.value||t.push({function:p,message:j}),t.push({function:k,message:E}),!e.error.value&&e.draw.update&&t.push({function:[x,b],message:E}),
t.push({function:d,message:E}),t}},{"../../core/console/print.coffee":54,"../../core/data/color.js":56,"../../core/data/format.js":58,"../../core/data/keys.coffee":60,"../../core/data/load.coffee":61,"../../core/fetch/data.js":66,"../../core/parse/edges.js":97,"../../core/parse/nodes.js":100,"../../object/validate.coffee":175,"../../string/format.js":176,"../../tooltip/remove.coffee":206,"./errorCheck.js":216,"./finish.js":217,"./focus/tooltip.coffee":218,"./shapes/draw.js":228,"./svg/enter.js":241,"./svg/update.js":242,"./types/run.coffee":245,"./ui/drawer.js":246,"./ui/history.coffee":247,"./ui/legend.js":248,"./ui/timeline.coffee":250,"./ui/titles.js":251}],216:[function(e,t,n){var r=e("../../core/fetch/text.js"),o=e("../../core/console/print.coffee"),a=e("../../core/methods/rejected.coffee"),i=e("../../string/format.js"),l=e("../../string/list.coffee");t.exports=function(e){e.dev.value&&o.time("checking for errors");var t=["id"],n=e.types[e.type.value].requirements;n&&(n instanceof Array?t=t.concat(e.types[e.type.value].requirements):t.push(n));var s=[];if(t.forEach(function(t){if("string"==typeof t)e[t].value||s.push('"'+t+'"');else if("function"==typeof t){var n=t(e);!n.status&&n.text&&s.push('"'+n.text+'"')}}),s.length>1){var u=e.format.locale.value.error.methods,c=e.format.locale.value.visualization[e.type.value]||e.type.value,f=e.format.locale.value.ui.and;s=l(s,f),e.error.internal=i(u,c,s)}else if(1===s.length){var u=e.format.locale.value.error.method,c=e.format.locale.value.visualization[e.type.value]||e.type.value;e.error.internal=i(u,c,s[0])}if(!e.error.internal&&t.indexOf("edges")>=0&&t.indexOf("focus")>=0){if(0==e.edges.connections(e.focus.value[0],e.id.value).length){var d=r(e,e.focus.value[0],e.depth.value),u=e.format.locale.value.error.connections;e.error.internal=i(u,'"'+d+'"')}}var t=["d3"];e.types[e.type.value].libs&&(t=t.concat(e.types[e.type.value].libs));var s=[];if(t.forEach(function(e){window[e]||s.push('"'+e+'"')}),s.length>1){var u=e.format.locale.value.error.libs,c=e.format.locale.value.visualization[e.type.value],f=e.format.locale.value.ui.and;s=l(s,f),e.error.internal=i(u,c,s)}else if(1===s.length){var u=e.format.locale.value.error.lib,c=e.format.locale.value.visualization[e.type.value];e.error.internal=i(u,c,s[0])}var p=e.shape.accepted(e);p instanceof Array||(p=[p]);var h=e.shape.value;if(h&&!a(e,p,h,"shape")||e.self.shape(p[0]),"modes"in e.types[e.type.value]){var v=e.types[e.type.value].modes;v instanceof Array||(v=[v]);var g=e.type.mode.value;g&&!a(e,v,g,"mode")||e.self.type({mode:v[0]})}e.dev.value&&o.timeEnd("checking for errors")}},{"../../core/console/print.coffee":54,"../../core/fetch/text.js":68,"../../core/methods/rejected.coffee":93,"../../string/format.js":176,"../../string/list.coffee":177}],217:[function(e,t,n){var r=e("./shapes/edges.js"),o=e("./shapes/paths.js"),a=e("./ui/message.js"),i=e("./focus/viz.js"),l=e("../../core/methods/reset.coffee"),s=e("../../core/console/print.coffee"),u=e("./shapes/labels.js"),c=e("../../string/title.coffee"),f=e("./zoom/bounds.coffee"),d=e("./zoom/labels.coffee"),p=e("./zoom/mouse.coffee");t.exports=function(e){if(e.draw.first?setTimeout(function(){i(e)},e.draw.timing):i(e),!e.error.value){var t=e.zoom.viewport||e.zoom.bounds;e.types[e.type.value].zoom&&e.zoom.value&&t?(e.dev.value&&s.time("calculating zoom"),e.draw.first||e.zoom.reset?f(e,t,0):(e.type.changed||e.focus.changed||e.height.changed||e.width.changed||e.nodes.changed||e.legend.changed||e.timeline.changed||e.ui.changed)&&f(e,t),e.dev.value&&s.timeEnd("calculating zoom")):(e.zoom.bounds=[[0,0],[e.width.viz,e.height.viz]],e.zoom.scale=1,f(e))}var n=e.zoom.size?e.zoom.size.width:e.width.viz,h=e.zoom.size?e.zoom.size.height:e.height.viz,v=e.zoom.bounds?e.zoom.bounds[0][0]:0,g=e.zoom.bounds?e.zoom.bounds[0][1]:0;if(e.g.overlay.attr("width",n).attr("height",h).attr("x",v).attr("y",g),e.error.value||(e.draw.update?(e.edges.path?o(e):r(e),u(e,"data"),e.edges.label&&!e.edges.path&&setTimeout(function(){u(e,"edges")},e.draw.timing+200)):(e.labels.value||e.labels.changed)&&e.types[e.type.value].zoom&&e.zoom.value&&e.draw.timing&&setTimeout(function(){d(e)},e.draw.timing)),!e.error.value){var m=e.types[e.type.value].requirements||[];m instanceof Array||(m=[m]);var y=m.indexOf("data")>=0;e.error.internal||e.data.viz&&e.returned.nodes.length||!y||(e.error.internal=e.format.locale.value.error.data)}var x=e.type.previous;if(x&&e.type.value!=x&&e.g.apps[x]&&(e.dev.value&&s.time('hiding "'+x+'"'),e.draw.timing?e.g.apps[x].transition().duration(e.draw.timing).attr("opacity",0):e.g.apps[x].attr("opacity",0),e.dev.value&&s.timeEnd()),!e.error.value){var b=y&&0===e.data.viz.length||e.error.internal||e.error.value?0:e.focus.value.length&&e.types[e.type.value].zoom&&e.zoom.value?1-e.tooltip.curtain.opacity:1,w=e.draw.timing;e.group.transition().duration(w).attr("opacity",b),e.g.data.transition().duration(w).attr("opacity",b),e.g.edges.transition().duration(w).attr("opacity",b)}e.error.value?a(e,e.error.value):e.error.internal?(e.error.internal=c(e.error.internal),s.warning(e.error.internal),a(e,e.error.internal),e.error.internal=null):a(e),setTimeout(function(){l(e),e.types[e.type.value].zoom&&e.zoom.value?(e.g.zoom.datum(e).call(e.zoom.behavior.on("zoom",p)),e.zoom.scroll.value||e.g.zoom.on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("wheel.zoom",null),e.zoom.click.value||e.g.zoom.on("dblclick.zoom",null),e.zoom.pan.value||e.g.zoom.on("mousedown.zoom",null).on("mousemove.zoom",null)):e.g.zoom.call(e.zoom.behavior.on("zoom",null)).on("dblclick.zoom",null).on("mousedown.zoom",null).on("mousemove.zoom",null).on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("touchstart.zoom",null).on("wheel.zoom",null)},e.draw.timing)}},{"../../core/console/print.coffee":54,"../../core/methods/reset.coffee":95,"../../string/title.coffee":179,"./focus/viz.js":219,"./shapes/edges.js":229,"./shapes/labels.js":231,"./shapes/paths.js":233,"./ui/message.js":249,"./zoom/bounds.coffee":252,"./zoom/labels.coffee":254,"./zoom/mouse.coffee":255}],218:[function(e,t,n){var r,o,a,i;r=e("../tooltip/create.js"),o=e("../../../core/fetch/value.coffee"),a=e("../../../core/console/print.coffee"),i=e("../../../tooltip/remove.coffee"),t.exports=function(e){var t,n,l;n=e.focus,!e.error.internal&&1===n.value.length&&n.value.length&&!e.small&&n.tooltip.value?(e.dev.value&&a.time("drawing focus tooltip"),t=e.data.pool.filter(function(t){return o(e,t,e.id.value)===n.value[0]}),t.length>=1?t=t[0]:(t={},t[e.id.value]=n.value[0]),l=e.labels.padding,r({anchor:"top left",arrow:!1,data:t,fullscreen:!1,id:"visualization_focus",length:"long",maxheight:e.height.viz-2*l,mouseevents:!0,offset:0,vars:e,width:e.tooltip.large,x:e.width.value-e.margin.right-l,y:e.margin.top+l}),e.width.viz-=e.tooltip.large+2*l,e.dev.value&&a.timeEnd("drawing focus tooltip")):i("visualization_focus")}},{"../../../core/console/print.coffee":54,"../../../core/fetch/value.coffee":69,"../../../tooltip/remove.coffee":206,"../tooltip/create.js":243}],219:[function(t,n,r){var o=t("../../../client/pointer.coffee"),a=t("../../../client/ie.js"),i=t("../../../core/fetch/value.coffee"),l=t("../../../core/console/print.coffee"),s=t("../../../util/uniques.coffee");n.exports=function(t){if(t.g.edge_focus.selectAll("g").remove(),t.g.data_focus.selectAll("g").remove(),t.focus.value.length&&t.types[t.type.value].zoom&&t.zoom.value){t.dev.value&&l.time("drawing focus elements");var n=t.g.edges.selectAll("g");if(n.size()>0){n.each(function(e){var n=e[t.edges.source][t.id.value],r=e[t.edges.target][t.id.value];if(n==t.focus.value[0]||r==t.focus.value[0]){var o=t.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(o).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}});var r=t.edges.arrows.value;t.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",t.color.focus).style("stroke-width",function(){return a&&t.types[t.type.value].zoom?0:t.edges.size.value?d3.select(this).style("stroke-width"):2*t.data.stroke.width}).attr("marker-start",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3po)var o="_"+e.d3po.bucket;else var o="";return"source"==n&&r?"url(#d3po_edge_marker_focus"+o+")":"none"}).attr("marker-end",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3po)var o="_"+e.d3po.bucket;else var o="";return"target"==n&&r?"url(#d3po_edge_marker_focus"+o+")":"none"}),t.g.edge_focus.selectAll("text").style("fill",t.color.focus)}var u=s(t.edges.connections(t.focus.value[0],t.id.value,!0),t.id.value,i,t);u.push(t.focus.value[0]);var c=[],f=[],d=[0],p=[0];t.g.data.selectAll("g").each(function(n){if(u.indexOf(n[t.id.value])>=0){var r=t.g.data_focus.node().appendChild(this.cloneNode(!0)),r=d3.select(r).datum(n).attr("opacity",1);"coordinates"==t.shape.value?t.zoom.viewport=t.path.bounds(t.zoom.coords[n.d3po.id]):"d3po"in n&&("x"in n.d3po&&c.push(n.d3po.x),"y"in n.d3po&&f.push(n.d3po.y),"r"in n.d3po?(d.push(n.d3po.r),p.push(n.d3po.r)):("width"in n.d3po&&d.push(n.d3po.width/2),"height"in n.d3po&&p.push(n.d3po.height/2)));for(e in o){var a=d3.select(this).on(o[e]);a&&r.on(o[e],a)}}});if(c.length&&f.length){var h=d3.extent(c),v=d3.extent(f),g=d3.max(d),m=d3.max(p);t.zoom.viewport=[[h[0]-g,v[0]-m],[h[1]+g,v[1]+m]]}t.g.data_focus.selectAll("path").style("stroke-width",a&&t.types[t.type.value].zoom?0:2*t.data.stroke.width),t.dev.value&&l.timeEnd("drawing focus elements")}else t.zoom.viewport=!1}},{"../../../client/ie.js":39,"../../../client/pointer.coffee":40,"../../../core/console/print.coffee":54,"../../../core/fetch/value.coffee":69,"../../../util/uniques.coffee":213}],220:[function(e,t,n){var r,o,a,i;i=e("./style.coffee"),o=e("../../../geom/largestRect.coffee"),a=e("../../../geom/path2poly.coffee"),r={start:{},end:{}},t.exports=function(e,t,n,l){var s,u,c,f;s=d3.svg.arc().innerRadius(0).outerRadius(function(e){return e.d3po.r}).startAngle(function(e){return e.d3po.startAngle}).endAngle(function(e){return e.d3po.endAngle}),c=function(t){var n,r;return e.labels.value&&(t.d3po.label?t.d3po_label=t.d3po.label:(n=a(s(t)),r=o(n,{angle:0}),r[0]?t.d3po_label={w:r[0].width,h:r[0].height,x:r[0].cx,y:r[0].cy}:delete t.d3po_label)),[t]},e.draw.timing?(f=d3.svg.arc().innerRadius(0).outerRadius(function(e){return e.d3po.r}).startAngle(function(e){return void 0===r.start[e.d3po.id]&&(r.start[e.d3po.id]=0),isNaN(r.start[e.d3po.id])&&(r.start[e.d3po.id]=e.d3po.startAngle),r.start[e.d3po.id]}).endAngle(function(e){return void 0===r.end[e.d3po.id]&&(r.end[e.d3po.id]=0),isNaN(r.end[e.d3po.id])&&(r.end[e.d3po.id]=e.d3po.endAngle),r.end[e.d3po.id]}),u=function(e,t){return e.attrTween("d",function(e){var n,o,a,i;return void 0===t?(i=e.d3po.startAngle,n=e.d3po.endAngle):0===t&&(i=0,n=0),a=d3.interpolate(r.start[e.d3po.id],i),o=d3.interpolate(r.end[e.d3po.id],n),function(t){return r.start[e.d3po.id]=a(t),r.end[e.d3po.id]=o(t),f(e)}})},n.append("path").attr("class","d3po_data").call(i,e).attr("d",f),t.selectAll("path.d3po_data").data(c).transition().duration(e.draw.timing).call(i,e).call(u),l.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(u,0)):(n.append("path").attr("class","d3po_data"),t.selectAll("path.d3po_data").data(c).call(i,e).attr("d",s))}},{"../../../geom/largestRect.coffee":162,"../../../geom/path2poly.coffee":164,"./style.coffee":237}],221:[function(e,t,n){var r=e("../../../core/fetch/text.js"),o=e("../../../font/sizes.coffee"),a=e("../../../geom/largestRect.coffee"),i=e("./style.coffee");t.exports=function(e,t,n,l){var s=d3.svg.area().x(function(e){return e.d3po.x}).y0(function(e){return e.d3po.y0}).y1(function(e){return e.d3po.y}).interpolate(e.shape.interpolate.value),u=d3.svg.area().x(function(e){return e.d3po.x}).y0(function(e){return e.d3po.y0}).y1(function(e){return e.d3po.y0}).interpolate(e.shape.interpolate.value);n.append("path").attr("class","d3po_data").attr("d",function(e){return u(e.values)}).call(i,e);var c={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value};t.selectAll("path.d3po_data").data(function(t){if(e.labels.value&&t.values.length>1){var n=d3.max(t.values,function(e){return e.d3po.y0-e.d3po.y}),i=!1;if(n>e.labels.font.size){var l=[],s=[],u=r(e,t);t.values.forEach(function(e){l.push([e.d3po.x,e.d3po.y]),s.push([e.d3po.x,e.d3po.y0])}),l=l.concat(s.reverse());var f=null;if(u.length){var d=o(u[0],c);f=d[0].width/d[0].height}i=a(l,{angle:d3.range(-70,71,1),aspectRatio:f,tolerance:0})}if(i&&i[0]){var p={w:~~i[0].width,h:~~i[0].height,x:~~i[0].cx,y:~~i[0].cy,angle:-1*i[0].angle,padding:2,names:u};0!==i[0].angle?p.translate={x:p.x,y:p.y}:p.translate=!1,p.w>=10&&p.h>=10&&(t.d3po_label=p)}}return[t]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).attr("d",function(e){return s(e.values)}).call(i,e):t.selectAll("path.d3po_data").attr("d",function(e){return s(e.values)}).call(i,e)}},{"../../../core/fetch/text.js":68,"../../../font/sizes.coffee":104,"../../../geom/largestRect.coffee":162,"./style.coffee":237}],222:[function(e,t,n){var r=(e("../../../core/fetch/text.js"),e("../../../geom/largestRect.coffee"),e("./style.coffee"));t.exports=function(e,t,n,o){function a(e){e.attr("transform","scale(1)")}function i(e){e.attr("transform",function(e){var t=Math.min(e.d3po.width,e.d3po.height);return"scale("+Math.floor(t/16)+")"})}n.append("path").attr("class","d3po_data").attr("d","M5-6.844L3.594-5.407L-2,0.188l-1.594-1.594L-5-2.844L-7.844,0l1.438,1.406l3,3L-2,5.843l1.406-1.438l7-7L7.844-4L5-6.844z").call(a).call(r,e),t.selectAll("path.d3po_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(i).call(r,e):t.selectAll("path.d3po_data").call(i).call(r,e)}},{"../../../core/fetch/text.js":68,"../../../geom/largestRect.coffee":162,"./style.coffee":237}],223:[function(e,t,n){var r,o,a;e("../../../core/fetch/value.coffee"),r=e("../../../core/fetch/color.coffee"),o=e("../../../color/lighter.coffee"),a=e("./segments.coffee"),t.exports=function(e,t,n){var i,l,s,u;return l=e.d3po.shape||t.shape.value,"line"===t.shape.value&&"circle"!==l?"none":"area"===t.shape.value||"active"===l||"line"===t.shape.value?r(t,e):"temp"===l?n?r(t,e):"url(#d3po_hatch_"+e.d3po.id+")":e.d3po.static?o(r(t,e),.75):(i=a(t,e,"active"),s=a(t,e,"temp"),u=a(t,e,"total"),!t.active.value&&!t.temp.value||!0===i||i&&u&&i>=u&&!s||i&&!u?r(t,e):t.active.spotlight.value?t.color.missing:o(r(t,e),.75))}},{"../../../color/lighter.coffee":47,"../../../core/fetch/color.coffee":65,"../../../core/fetch/value.coffee":69,"./segments.coffee":236}],224:[function(e,t,n){var r,o,a,i,l,s,u,c;r=e("../../../util/copy.coffee"),o=e("../../../network/distance.coffee"),a=e("../../../core/fetch/text.js"),i=e("../../../font/sizes.coffee"),s=e("../../../geom/largestRect.coffee"),u=e("../../../geom/path2poly.coffee"),c=e("./style.coffee"),l={},t.exports=function(e,t,n,f){var d,p;return d=d3.geo[e.coords.projection.value](),d.center&&d.center(e.coords.center),e.zoom.scale||(e.zoom.scale=1),e.zoom.area=1/e.zoom.scale/e.zoom.scale,e.path=d3.geo.path().projection(d),e.draw.timing?t.selectAll("path.d3po_data").attr("d",e.path).transition().duration(e.draw.timing).call(c,e):t.selectAll("path.d3po_data").attr("d",e.path).call(c,e),n.append("path").attr("id",function(e){return e.id}).attr("class","d3po_data").attr("d",e.path).call(c,e),p=e.old_height!==e.height.viz||e.height.changed||e.old_width!==e.width.viz||e.width.changed,e.old_height=e.height.viz,e.old_width=e.width.viz,e.coords.changed||p||e.coords.mute.changed||e.coords.solo.changed||e.type.changed||e.text.changed||e.coords.projection.changed||e.labels.changed?(e.zoom.bounds=null,e.zoom.reset=!0,e.zoom.coords={},t.each(function(t){var n,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S;if(e.coords.simplify.value&&t.geometry.coordinates.length>1){for(m=[],c=[],n=0,b=r(t),A=r(t),t.geometry.coordinates=t.geometry.coordinates.filter(function(t,r){var o;return A.geometry.coordinates=[t],(o=e.path.area(A))>0&&(c.push(o),o>n&&(b.geometry.coordinates=[t],n=o),!0)}),p=e.path.centroid(b),j=t.geometry.coordinates,y=x=0,w=j.length;x<w;y=++x)d=j[y],A.geometry.coordinates=[d],m.push(o(e.path.centroid(A),p));g=m.reduce(function(e,t,n){return t&&e.push(c[n]/t),e},[]),v=d3.quantile(g,e.coords.threshold.value),A.geometry.coordinates=t.geometry.coordinates.filter(function(e,t){var n,r;return r=m[t],n=c[t],0===r||n/r>=v}),h=b.geometry.coordinates[0],h&&"MultiPolygon"===b.geometry.type&&(h=h[0],b.geometry.coordinates[0]=h,b.geometry.type="Polygon")}else A=t,b=t,h=t.geometry.coordinates[0];return e.zoom.coords[t.d3po.id]=A,delete t.d3po_label,e.labels.value&&(_=a(e,t),h&&_.length&&(k=u(e.path(b)),S={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value},z=null,1===_[0].split(" ").length&&(E=i(_[0],S)[0],z=E.width/E.height),(M=s(k,{angle:0,aspectRatio:z}))&&(M=M[0],t.d3po_label={anchor:"middle",valign:"center",h:M.height,w:M.width,x:M.cx,y:M.cy,names:_}))),l[t.id]=t.d3po_label,f=e.path.bounds(A),e.zoom.bounds?(e.zoom.bounds[0][0]>f[0][0]&&(e.zoom.bounds[0][0]=f[0][0]),e.zoom.bounds[0][1]>f[0][1]&&(e.zoom.bounds[0][1]=f[0][1]),e.zoom.bounds[1][0]<f[1][0]&&(e.zoom.bounds[1][0]=f[1][0]),e.zoom.bounds[1][1]<f[1][1]?e.zoom.bounds[1][1]=f[1][1]:void 0):e.zoom.bounds=f})):e.focus.value.length?void 0:(e.zoom.viewport=!1,t.each(function(e){return e.d3po_label=l[e.id]}))}},{"../../../core/fetch/text.js":68,"../../../font/sizes.coffee":104,"../../../geom/largestRect.coffee":162,"../../../geom/path2poly.coffee":164,"../../../network/distance.coffee":168,"../../../util/copy.coffee":210,"./style.coffee":237}],225:[function(e,t,n){var r=e("./style.coffee");t.exports=function(e,t,n,o){function a(e){e.attr("d",d3.svg.symbol().type("cross").size(10))}function i(e){e.attr("d",d3.svg.symbol().type("cross").size(function(e){var t=Math.min(e.d3po.width,e.d3po.height);return d3.scale.pow().exponent(2)(t/2)}))}n.append("path").attr("class","d3po_data").call(a).call(r,e),t.selectAll("path.d3po_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(i).call(r,e):t.selectAll("path.d3po_data").call(i).call(r,e)}},{"./style.coffee":237}],226:[function(e,t,n){var r=e("./style.coffee");t.exports=function(e,t,n,o){function a(e){e.attr("d",d3.svg.symbol().type("diamond").size(10))}function i(e){e.attr("d",d3.svg.symbol().type("diamond").size(function(e){var t=Math.min(e.d3po.width,e.d3po.height);return d3.scale.pow().exponent(2)(t/2)}))}n.append("path").attr("class","d3po_data").call(a).call(r,e),t.selectAll("path.d3po_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(i).call(r,e):t.selectAll("path.d3po_data").call(i).call(r,e)}},{"./style.coffee":237}],227:[function(e,t,n){var r=e("./style.coffee");t.exports=function(e,t,n,o){function a(t,n,r,o){if(!n)var n=0;if("number"!=typeof r)var r=void 0;if("number"!=typeof o)var o=void 0;t.attrTween("d",function(t){if(void 0==r)var a=t.d3po.r?t.d3po.r:d3.max([t.d3po.width,t.d3po.height]);else var a=r;if(void 0==o)var i=t.d3po.segments[t.d3po.shape];else var i=o;e.arcs[t.d3po.shape][t.d3po.id]||(e.arcs[t.d3po.shape][t.d3po.id]={r:0},e.arcs[t.d3po.shape][t.d3po.id].a=2*Math.PI);var s=d3.interpolate(e.arcs[t.d3po.shape][t.d3po.id].r,a+n),u=d3.interpolate(e.arcs[t.d3po.shape][t.d3po.id].a,i);return function(n){return e.arcs[t.d3po.shape][t.d3po.id].r=s(n),e.arcs[t.d3po.shape][t.d3po.id].a=u(n),l(t)}})}function i(e){return e.d3po.label?e.d3po_label=e.d3po.label:delete e.d3po_label,[e]}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var l=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3po.shape][t.d3po.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){return t.d3po.static?0:e.arcs[t.d3po.shape][t.d3po.id].r*e.data.donut.size}).outerRadius(function(t){return e.arcs[t.d3po.shape][t.d3po.id].r});e.draw.timing?(o.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(a,0,0).each("end",function(t){delete e.arcs[t.d3po.shape][t.d3po.id]}),t.selectAll("path.d3po_data").data(i).transition().duration(e.draw.timing).call(a).call(r,e),n.append("path").attr("class","d3po_data").transition().duration(0).call(a,0,0).call(r,e).transition().duration(e.draw.timing).call(a).call(r,e)):(o.selectAll("path.d3po_data").each(function(t){delete e.arcs[t.d3po.shape][t.d3po.id]}),n.append("path").attr("class","d3po_data"),t.selectAll("path.d3po_data").data(i).call(a).call(r,e))}},{"./style.coffee":237}],228:[function(e,t,n){var r=e("../../../util/child.coffee"),o=e("../../../util/closest.coffee"),a=e("../tooltip/create.js"),i=e("../../../client/pointer.coffee"),l=e("../../../core/fetch/value.coffee"),s=e("../../../core/fetch/color.coffee"),u=e("../../../core/fetch/text.js"),c=e("../../../color/legible.coffee"),f=e("../../../core/console/print.coffee"),d=e("../../../tooltip/remove.coffee"),p=e("./segments.coffee"),h=e("./fill.js"),v=e("../../../string/strip.js"),g=e("../../../client/touch.coffee"),m=e("../zoom/propagation.coffee"),y=e("../../../util/uniques.coffee"),x=e("../../../object/validate.coffee"),b=e("../zoom/direction.coffee"),w={arc:e("./arc.coffee"),area:e("./area.js"),check:e("./check.js"),coordinates:e("./coordinates.coffee"),cross:e("./cross.js"),diamond:e("./diamond.js"),donut:e("./donut.js"),line:e("./line.js"),radial:e("./radial.coffee"),rect:e("./rect.coffee"),triangle_down:e("./triangle_down.js"),triangle_up:e("./triangle_up.js"),whisker:e("./whisker.coffee")};t.exports=function(e){function t(t){if(!t.d3po.id){t.d3po.id="";for(var n=0;n<=e.depth.value;n++)t.d3po.id+=l(e,t,e.id.nesting[n])+"_";t.d3po.id+=O,["x","y","x2","y2"].forEach(function(n){if("discrete"==e[n].scale.value){var r=l(e,t,e[n].value);r.constructor===Date&&(r=r.getTime()),t.d3po.id+="_"+r}}),t.d3po.suffix&&(t.d3po.id+="_"+t.d3po.suffix),t.d3po.id=v(t.d3po.id)}return t}function n(t,n){var r=e.types[e.type.value].scale,o=1;r&&(x[r]&&e.shape.value in r?o=r[e.shape.value]:"function"==typeof r?o=r(e,e.shape.value):"number"==typeof r&&(o=r)),o=n?o:1,t.attr("transform",function(e){if(["line","area","coordinates"].indexOf(O)<0){return"translate("+(e.d3po.x||0)+","+(e.d3po.y||0)+")scale("+o+")"}return"scale("+o+")"})}function _(t){t.attr("id",function(e){return"d3po_group_"+e.d3po.id}).attr("class",function(t){var n=e.class.value?" "+l(e,t,e.class.value):"";return"d3po_"+O+n})}function k(t){if(t&&e.g.edges.selectAll("g").size()>0){e.g.edge_hover.selectAll("*").remove(),e.g.edges.selectAll("g").each(function(n){var r=t[e.id.value],o=n[e.edges.source][e.id.value],a=n[e.edges.target][e.id.value];if(o==r||o=="left_"+r||o=="right_"+r||a==r||a=="left_"+r||a=="right_"+r){var i=e.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(i).datum(n).attr("opacity",1).selectAll("line, path").datum(n)}});var n=e.edges.arrows.value;e.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",e.color.primary).style("stroke-width",function(t){return e.edges.path&&t.dy?Math.max(1,t.dy):e.edges.size.value?d3.select(this).style("stroke-width"):2*e.data.stroke.width}).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var o="_"+t.d3po.bucket;else var o="";return"source"==r&&n?"url(#d3po_edge_marker_highlight"+o+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var o="_"+t.d3po.bucket;else var o="";return"target"==r&&n?"url(#d3po_edge_marker_highlight"+o+")":"none"}),e.g.edge_hover.selectAll("text").style("fill",e.color.primary),e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",1),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",.5)):e.g.edge_hover.attr("opacity",1)}else e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",1)):e.g.edge_hover.selectAll("*").remove()}var z=e.returned.nodes||[],M=e.returned.edges||[];e.draw.timing=z.length<e.data.large&&M.length<e.edges.large?e.timing.transitions:0;var A={arc:"arc",area:"area",check:"check",circle:"rect",coordinates:"coordinates",cross:"cross",donut:"donut",diamond:"diamond",line:"line",plus:"cross",radial:"radial",rect:"rect",square:"rect",triangle_down:"triangle_down",triangle:"triangle_up",triangle_up:"triangle_up",whisker:"whisker"},j={};z.forEach(function(t){var n=t.d3po&&t.d3po.shape?t.d3po.shape:e.shape.value;n in A&&(t.d3po&&(t.d3po.shape=n),n=A[n],j[n]||(j[n]=[]),j[n].push(t))});for(var E in A)if(!(A[E]in j)||0===d3.keys(j).length){var S=e.g.data.selectAll("g.d3po_"+A[E]);e.draw.timing?S.transition().duration(e.draw.timing).attr("opacity",0).remove():S.remove()}for(var O in j){var N=e.g.data.selectAll("g.d3po_"+O).data(j[O],function(n){if(n.d3po||(n.d3po={}),"coordinates"===O)return n.d3po.id=n.id,n.id;if(!n.d3po.id)if(n.values)n.values.forEach(function(e){e=t(e),e.d3po.shape="circle"}),n.d3po.id=n.key;else if(n=t(n),!n.d3po.segments){n.d3po.segments={donut:2*Math.PI};var r=p(e,n,"active"),o=p(e,n,"temp"),a=p(e,n,"total");a&&(n.d3po.segments.active=r?r/a*(2*Math.PI):0,n.d3po.segments.temp=o?o/a*(2*Math.PI)+n.d3po.segments.active:0)}return!!n.d3po&&n.d3po.id});if(e.draw.timing)var F=N.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();else var F=N.exit().remove();e.draw.timing?N.transition().duration(e.draw.timing).call(n).call(_):N.call(n).call(_);var T=e.draw.timing?0:1,C=N.enter().append("g").attr("opacity",T).call(n).call(_);e.draw.timing&&C.transition().duration(e.draw.timing).attr("opacity",1),N.order(),e.dev.value&&f.time('drawing "'+O+'" shapes'),w[O](e,N,C,F,n),e.dev.value&&f.timeEnd('drawing "'+O+'" shapes'),["rect","donut"].indexOf(O)>=0&&e.types[e.type.value].fill&&(e.dev.value&&f.time('filling "'+O+'" shapes'),h(e,N,C,F,n),e.dev.value&&f.timeEnd('filling "'+O+'" shapes'))}if(k(),e.tooltip.value)e.g.data.selectAll("g").on(i.over,function(t){if(g&&m(e,d3.event),d3.event.buttons||!e.mouse.value||!e.mouse.over.value||e.draw.frozen||t.d3po&&t.d3po.static)d(e.type.value);else{var r="function"!=typeof e.mouse.over.value;if("function"==typeof e.mouse.over.value&&(r=e.mouse.over.value(t,e.self)),r){var l=b(t.d3po_data||t,e),s="function"==typeof e.mouse.viz||"function"==typeof e.mouse.viz[i.click]||e.zoom.value&&(e.types[e.type.value].zoom||t.d3po.threshold&&t.d3po.merged||1===l||-1===l&&e.history.states.length&&!e.tooltip.value.long);if(d3.select(this).style("cursor",s?"pointer":"auto").transition().duration(e.timing.mouseevents).call(n,!0),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",1),e.covered=!1,t.values&&e.axes.discrete){var u="x"===e.axes.discrete?0:1,c=d3.mouse(e.container.value.node())[u],f=y(t.values,function(t){return t.d3po[e.axes.discrete]}),p=o(f,c);t.d3po_data=t.values[f.indexOf(p)],t.d3po=t.values[f.indexOf(p)].d3po}var h=t.d3po_data?t.d3po_data:t;a({vars:e,data:h}),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.over]&&e.mouse.viz[i.over](t.d3po_data||t,e),k(t)}}}).on(i.move,function(t){if(g&&m(e,d3.event),d3.event.buttons||!e.mouse.value||!e.mouse.move.value||e.draw.frozen||t.d3po&&t.d3po.static)d(e.type.value);else{var n="function"!=typeof e.mouse.move.value;if("function"==typeof e.mouse.move.value&&(n=e.mouse.move.value(t,e.self)),n){var r=b(t.d3po_data||t,e),l="function"==typeof e.mouse.viz||"function"==typeof e.mouse.viz[i.click]||e.zoom.value&&(e.types[e.type.value].zoom||t.d3po.threshold&&t.d3po.merged||1===r||-1===r&&e.history.states.length&&!e.tooltip.value.long);d3.select(this).style("cursor",l?"pointer":"auto");e.types[e.type.value].tooltip;if(t.values&&e.axes.discrete){var s="x"===e.axes.discrete?0:1,u=d3.mouse(e.container.value.node())[s],c=y(t.values,function(t){return t.d3po[e.axes.discrete]}),f=o(c,u);t.d3po_data=t.values[c.indexOf(f)],t.d3po=t.values[c.indexOf(f)].d3po}var p=t.d3po_data?t.d3po_data:t;a({vars:e,data:p}),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.move]&&e.mouse.viz[i.move](t.d3po_data||t,e)}}}).on(i.out,function(t){if(g&&m(e,d3.event),!d3.event.buttons&&e.mouse.value&&e.mouse.out.value){var o="function"!=typeof e.mouse.out.value;if("function"==typeof e.mouse.out.value&&(o=e.mouse.out.value(t,e.self)),o){r(this,d3.event.toElement)||e.draw.frozen||t.d3po&&t.d3po.static||(d3.select(this).transition().duration(e.timing.mouseevents).call(n),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),e.covered||d(e.type.value),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.out]&&e.mouse.viz[i.out](t.d3po_data||t,e),k())}}else d(e.type.value)});else{var q=function(){m(e,d3.event)};e.g.data.selectAll("g").on(i.over,q).on(i.move,q).on(i.out,q)}d3.select(window).on("scroll.d3po",function(){d(e.type.value)}),e.g.data.selectAll("g").on(i.click,function(t){if((!e.mouse.viz||!1!==e.mouse.viz.click)&&e.mouse.value&&e.mouse.click.value&&!d3.event.defaultPrevented&&!e.draw.frozen&&(!t.d3po||!t.d3po.static)){var r="function"!=typeof e.mouse.click.value;if("function"==typeof e.mouse.click.value&&(r=e.mouse.click.value(t,e.self)),r){if(t.values&&e.axes.discrete){var f="x"===e.axes.discrete?0:1,p=d3.mouse(e.container.value.node())[f],h=y(t.values,function(t){return t.d3po[e.axes.discrete]}),v=o(h,p);t.d3po_data=t.values[h.indexOf(v)],t.d3po=t.values[h.indexOf(v)].d3po}"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.out]?e.mouse.viz[i.out](t.d3po_data||t,e):e.mouse.viz[i.click]&&e.mouse.viz[i.click](t.d3po_data||t,e);var g=b(t.d3po_data||t,e),m=e.id.solo.value,x=u(e,t)[0],w=c(s(e,t)),_=e.title.sub.value||!1,z=e.title.sub.font.color,M=e.title.total.font.color;if(t.d3po.threshold&&t.d3po.merged&&e.zoom.value)e.history.states.push(function(){e.self.id({solo:m}).title({sub:{font:{color:z},value:_},total:{font:{color:M}}}).draw()}),e.self.id({solo:m.concat(y(t.d3po.merged,e.id.value,l,e))}).title({sub:{font:{color:w},value:x},total:{font:{color:w}}}).draw();else if(1===g&&e.zoom.value){var A=l(e,t.d3po_data||t,e.id.value);e.history.states.push(function(){e.self.depth(e.depth.value-1).id({solo:m}).title({sub:{font:{color:z},value:_},total:{font:{color:M}}}).draw()}),e.self.depth(e.depth.value+1).id({solo:m.concat(A)}).title({sub:{font:{color:w},value:x},total:{font:{color:w}}}).draw()}else if(-1===g&&e.zoom.value&&e.history.states.length&&!e.tooltip.value.long)e.history.back();else if(e.types[e.type.value].zoom&&e.zoom.value)k(),d3.select(this).transition().duration(e.timing.mouseevents).call(n),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),d(e.type.value),e.draw.update=!1,t&&t[e.id.value]!=e.focus.value[0]?e.self.focus(t[e.id.value]).draw():e.self.focus(!1).draw();else if(e.types[e.type.value].requirements.indexOf("focus")<0){k();var j=t.d3po_data?t.d3po_data:t;a({vars:e,data:j})}}}})}},{"../../../client/pointer.coffee":40,"../../../client/touch.coffee":45,"../../../color/legible.coffee":46,"../../../core/console/print.coffee":54,"../../../core/fetch/color.coffee":65,"../../../core/fetch/text.js":68,"../../../core/fetch/value.coffee":69,"../../../object/validate.coffee":175,"../../../string/strip.js":178,"../../../tooltip/remove.coffee":206,"../../../util/child.coffee":208,"../../../util/closest.coffee":209,"../../../util/uniques.coffee":213,"../tooltip/create.js":243,"../zoom/direction.coffee":253,"../zoom/propagation.coffee":256,"./arc.coffee":220,"./area.js":221,"./check.js":222,"./coordinates.coffee":224,"./cross.js":225,"./diamond.js":226,"./donut.js":227,"./fill.js":230,"./line.js":232,"./radial.coffee":234,"./rect.coffee":235,"./segments.coffee":236,"./triangle_down.js":238,"./triangle_up.js":239,"./whisker.coffee":240}],
229:[function(e,t,n){var r=e("../../../util/buckets.coffee"),o=e("../../../geom/offset.coffee");t.exports=function(e){function t(t){t.attr("opacity",0).style("stroke-width",0).style("stroke",e.background.value).style("fill","none")}function n(t){var n=e.edges.arrows.value;t.attr("opacity",function(t){return"number"===h?p:"function"===h?p(t,e):e.edges.opacity.scale.value(t[p])}).style("stroke-width",function(t){return e.edges.scale(t[e.edges.size.value])}).style("stroke",e.edges.color).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var o="_"+t.d3po.bucket;else var o="";return"source"==r&&n?"url(#d3po_edge_marker_default"+o+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var o="_"+t.d3po.bucket;else var o="";return"target"==r&&n?"url(#d3po_edge_marker_default"+o+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function a(t){t.attr("x1",function(t){return t[e.edges.source].d3po.edges[t[e.edges.target][e.id.value]].x}).attr("y1",function(t){return t[e.edges.source].d3po.edges[t[e.edges.target][e.id.value]].y}).attr("x2",function(t){return t[e.edges.target].d3po.edges[t[e.edges.source][e.id.value]].x}).attr("y2",function(t){return t[e.edges.target].d3po.edges[t[e.edges.source][e.id.value]].y})}function i(e){e.attr("d",function(e){return v(e.d3po.spline)})}function l(t){if(delete t.d3po_label,e.g.edges.selectAll("line, path").size()<e.edges.large&&e.edges.label&&t[e.edges.label]){if("spline"in t.d3po)var n=this.getTotalLength(),r=this.getPointAtLength(n/2),o=this.getPointAtLength(n/2-.1*n),a=this.getPointAtLength(n/2+.1*n),i=Math.atan2(a.y-o.y,a.x-o.x),l=i*(180/Math.PI),s=(this.parentNode.getBBox(),.8*n),u=r.x,c=r.y;else var f=(this.getBBox(),t[e.edges.source]),d=t[e.edges.target],p={x:f.d3po.edges[d[e.id.value]].x,y:f.d3po.edges[d[e.id.value]].y},h={x:d.d3po.edges[f[e.id.value]].x,y:d.d3po.edges[f[e.id.value]].y},v=h.x-p.x,g=h.y-p.y,r={x:h.x-v/2,y:h.y-g/2},i=Math.atan2(g,v),l=i*(180/Math.PI),n=Math.sqrt(v*v+g*g),s=n,u=r.x,c=r.y;s+=2*e.labels.padding;var m=0;e.edges.arrows.value&&(m="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,m/=e.zoom.behavior.scaleExtent()[1],s-=2*m),(l<-90||l>90)&&(l-=180),s*e.zoom.behavior.scaleExtent()[0]>20&&(t.d3po_label={x:u,y:c,translate:{x:u,y:c},w:s,h:15+2*e.labels.padding,angle:l,anchor:"middle",valign:"center",color:e.edges.color,resize:!1,names:[e.format.value(t[e.edges.label])],background:1})}}var s=e.returned.edges||[],u=e.zoom.behavior.scaleExtent()[0];if("string"==typeof e.edges.size.value){var c=d3.extent(s,function(t){return t[e.edges.size.value]}),f=d3.min(e.returned.nodes||[],function(e){return e.d3po.r})*(2*e.edges.size.scale);e.edges.scale=d3.scale.sqrt().domain(c).range([e.edges.size.min,f*u])}else{var d="number"==typeof e.edges.size.value?e.edges.size.value:e.edges.size.min;e.edges.scale=function(){return d}}var p=e.edges.opacity.value,h=typeof p;e.edges.opacity.changed&&"string"===h&&e.edges.opacity.scale.value.domain(d3.extent(s,function(e){return e[p]})).range([e.edges.opacity.min.value,1]);var v=d3.svg.line().interpolate(e.edges.interpolate.value),g=e.edges.arrows.value?"string"==typeof e.edges.size.value?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof e.edges.size.value)for(var m=r(e.edges.scale.range(),4),y=[],x=0;x<3;x++)y.push(m[x+1]+(m[1]-m[0])*(x+2)*2);else var b="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,y="number"==typeof e.edges.size.value?e.edges.size.value/b:b;var w=e.defs.selectAll(".d3po_edge_marker").data(g,String),_=function(t){t.attr("d",function(t){var n=t.split("_");if(2==n.length&&e.edges.scale){n=parseInt(n[1]);var r=y[n]}else var r=y;return"target"==e.edges.arrows.direction.value?"M 0,-"+r/2+" L "+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2:"M 0,-"+r/2+" L -"+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2}).attr("fill",function(t){var n=t.split("_")[0];return"default"==n?e.edges.color:"focus"==n?e.color.focus:e.color.primary}).attr("transform","scale("+1/u+")")};e.draw.timing?(w.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),w.select("path").transition().duration(e.draw.timing).attr("opacity",1).call(_)):(w.exit().remove(),w.select("path").attr("opacity",1).call(_));var k=e.draw.timing?0:1,z=w.enter().append("marker").attr("id",function(e){return"d3po_edge_marker_"+e}).attr("class","d3po_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",k).attr("vector-effect","non-scaling-stroke").call(_);e.draw.timing&&z.transition().duration(e.draw.timing).attr("opacity",1);var M="string"==typeof e.edges.size.value?r(e.edges.scale.domain(),4):null,A=e.edges.arrows.direction.value,j=s.filter(function(t){if(t.d3po||(t.d3po={}),t.d3po.id="edge_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],!0!==t.d3po.spline){if(M){var n=t[e.edges.size.value];t.d3po.bucket=n<M[1]?0:n<M[2]?1:2;var r=.85*y[t.d3po.bucket]/u}else{delete t.d3po.bucket;var r=.85*y/u}var a=t[e.edges.source],i=t[e.edges.target];if(!a.d3po||!i.d3po)return!1;var l=Math.atan2(a.d3po.y-i.d3po.y,a.d3po.x-i.d3po.x),s=Math.atan2(i.d3po.y-a.d3po.y,i.d3po.x-a.d3po.x),c="source"==A&&e.edges.arrows.value?a.d3po.r+r:a.d3po.r,f="target"==A&&e.edges.arrows.value?i.d3po.r+r:i.d3po.r,d=o(l,c,e.shape.value),p=o(s,f,e.shape.value);return"edges"in a.d3po||(a.d3po.edges={}),a.d3po.edges[i[e.id.value]]={x:a.d3po.x-d.x,y:a.d3po.y-d.y},"edges"in i.d3po||(i.d3po.edges={}),i.d3po.edges[a[e.id.value]]={x:i.d3po.x-p.x,y:i.d3po.y-p.y},!0}return!1}),E=e.g.edges.selectAll("g.d3po_edge_line").data(j,function(e){return e.d3po.id}),S=s.filter(function(t){if(t.d3po.spline){if(M){var n=t[e.edges.size.value];t.d3po.bucket=n<M[1]?0:n<M[2]?1:2;var r=.85*y[t.d3po.bucket]/u}else{delete t.d3po.bucket;var r=.85*y/u}var a=t[e.edges.source],i=t[e.edges.target],l=a.d3po.edges?a.d3po.edges[i[e.id.value]]||{}:{},s=i.d3po.edges?i.d3po.edges[a[e.id.value]]||{}:{},c=e.edges.arrows.value&&"source"==A?r:0,f=e.edges.arrows.value&&"target"==A?r:0,d=a.d3po.x>i.d3po.x?.9:1.1,p=a.d3po.x>i.d3po.x?1.1:.9,h="number"==typeof l.angle?l.angle:Math.atan2(a.d3po.y-i.d3po.y,a.d3po.x-i.d3po.x)*d,v=o(h,a.d3po.r+c,e.shape.value),g="number"==typeof s.angle?s.angle:Math.atan2(i.d3po.y-a.d3po.y,i.d3po.x-a.d3po.x)*p,m=o(g,i.d3po.r+f,e.shape.value),x=[a.d3po.x-v.x,a.d3po.y-v.y],b=!!l.offset&&o(h,l.offset),w=b?[x[0]-b.x,x[1]-b.y]:x,_=[i.d3po.x-m.x,i.d3po.y-m.y],k=!!s.offset&&o(g,s.offset),z=k?[_[0]-k.x,_[1]-k.y]:_,j=z[0]-w[0],E=z[1]-w[1],S="number"==typeof l.radius?l.radius:Math.sqrt(j*j+E*E)/4,O="number"==typeof s.radius?s.radius:Math.sqrt(j*j+E*E)/4,N=o(h,S-a.d3po.r-2*c),F=o(g,O-i.d3po.r-2*f);t.d3po.spline=[x,_];var T=Math.abs(Math.atan2(a.d3po.y-i.d3po.y,a.d3po.x-i.d3po.x)).toFixed(5),C=Math.abs(h).toFixed(5),q=Math.abs(g-Math.PI).toFixed(5);return(C!==q||[C,q].indexOf(T)<0)&&(t.d3po.spline.splice(1,0,[w[0]-N.x,w[1]-N.y],[z[0]-F.x,z[1]-F.y]),b&&t.d3po.spline.splice(1,0,w),k&&t.d3po.spline.splice(t.d3po.spline.length-1,0,z)),!0}return!1}),O=e.g.edges.selectAll("g.d3po_edge_path").data(S,function(e){return e.d3po.id});e.draw.timing?(E.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),E.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),O.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),E.selectAll("line").data(function(e){return[e]}).transition().duration(e.draw.timing).call(a).call(n).each("end",l),O.selectAll("path").data(function(e){return[e]}).transition().duration(e.draw.timing).call(i).call(n).each("end",l),E.enter().append("g").attr("class","d3po_edge_line").append("line").call(a).call(t).transition().duration(e.draw.timing).call(n).each("end",l),O.enter().append("g").attr("class","d3po_edge_path").append("path").call(i).call(t).transition().duration(e.draw.timing).call(n).each("end",l)):(E.exit().remove(),O.exit().remove(),E.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),O.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),E.selectAll("line").data(function(e){return[e]}).call(a).call(n).call(l),O.selectAll("path").data(function(e){return[e]}).call(i).call(n).call(l),E.enter().append("g").attr("class","d3po_edge_line").append("line").call(a).call(t).call(n).call(l),O.enter().append("g").attr("class","d3po_edge_path").append("path").call(i).call(t).call(n).call(l))}},{"../../../geom/offset.coffee":163,"../../../util/buckets.coffee":207}],230:[function(e,t,n){var r=e("../../../util/copy.coffee"),o=e("../../../core/fetch/color.coffee"),a=(e("../../../core/fetch/value.coffee"),e("./segments.coffee")),i=e("./style.coffee");t.exports=function(e,t,n,l){function s(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function u(t,n){n||(n=0),t.attr("x",function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.width)/2-n/2}).attr("y",function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.height)/2-n/2}).attr("width",function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.width)+n}).attr("height",function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.height)+n}).attr("rx",function(t){var r=t.d3po.r?2*t.d3po.r:t.d3po.width;return["circle","donut"].indexOf(e.shape.value)>=0?(r+n)/2:0}).attr("ry",function(t){var r=t.d3po.r?2*t.d3po.r:t.d3po.height;return["circle","donut"].indexOf(e.shape.value)>=0?(r+n)/2:0}).attr("shape-rendering",function(t){return["square"].indexOf(e.shape.value)>=0?e.shape.rendering.value:"auto"})}function c(t,n,r,o){n||(n=0),"number"!=typeof r&&(r=void 0),"number"!=typeof o&&(o=void 0),t.attrTween("d",function(t){if(void 0===r)var a=t.d3po.r?t.d3po.r:d3.max([t.d3po.width,t.d3po.height]);else var a=r;if(void 0===o)var i=t.d3po.segments[t.d3po.shape];else var i=o;e.arcs[t.d3po.shape][t.d3po.id]||(e.arcs[t.d3po.shape][t.d3po.id]={r:0},e.arcs[t.d3po.shape][t.d3po.id].a="donut"===t.d3po.shape?2*Math.PI:0);var l=d3.interpolate(e.arcs[t.d3po.shape][t.d3po.id].r,a+n),s=d3.interpolate(e.arcs[t.d3po.shape][t.d3po.id].a,i);return function(n){return e.arcs[t.d3po.shape][t.d3po.id].r=l(n),e.arcs[t.d3po.shape][t.d3po.id].a=s(n),f(t)}})}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var f=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3po.shape][t.d3po.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){return t.d3po.static||"donut"!==e.shape.value?0:e.arcs[t.d3po.shape][t.d3po.id].r*e.data.donut.size}).outerRadius(function(t){var n=e.arcs[t.d3po.shape][t.d3po.id].r;return"donut"===e.shape.value?n:2*n});t.each(function(t){function n(t){t.attr("stroke",h).attr("stroke-width",1).attr("shape-rendering",e.shape.rendering.value)}var l=a(e,t,"active"),f=a(e,t,"temp"),d=a(e,t,"total"),p=d3.select(this),h=o(e,t),v=[],g=[];if(d&&e.types[e.type.value].fill){if(f){var m=r(t);m.d3po.shape="temp",v.push(m),g=["temp"]}if(l&&(l<d||f)){var m=r(t);m.d3po.shape="active",v.push(m)}}var y=e.defs.selectAll("pattern#d3po_hatch_"+t.d3po.id).data(g);e.draw.timing?(y.selectAll("rect").transition().duration(e.draw.timing).style("fill",h),y.selectAll("line").transition().duration(e.draw.timing).style("stroke",h)):(y.selectAll("rect").style("fill",h),y.selectAll("line").style("stroke",h));var x=y.enter().append("pattern").attr("id","d3po_hatch_"+t.d3po.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");x.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",h).attr("fill-opacity",.25),x.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(n),x.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(n),x.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(n);var b=v.length?[t]:[],w=p.selectAll("#d3po_clip_"+t.d3po.id).data(b);w.enter().insert("clipPath",".d3po_mouse").attr("id","d3po_clip_"+t.d3po.id).append("rect").attr("class","d3po_clipping").call(s),e.draw.timing?(w.selectAll("rect").transition().duration(e.draw.timing).call(u),w.exit().transition().delay(e.draw.timing).remove()):(w.selectAll("rect").call(u),w.exit().remove());var _=p.selectAll("path.d3po_fill").data(v);_.transition().duration(e.draw.timing).call(i,e).call(c),_.enter().insert("path","rect.d3po_mouse").attr("class","d3po_fill").attr("clip-path","url(#d3po_clip_"+t.d3po.id+")").transition().duration(0).call(i,e).call(c,0,void 0,0).transition().duration(e.draw.timing).call(c).call(i,e),_.exit().transition().duration(e.draw.timing).call(c,0,void 0,0).remove()})}},{"../../../core/fetch/color.coffee":65,"../../../core/fetch/value.coffee":69,"../../../util/copy.coffee":210,"./segments.coffee":236,"./style.coffee":237}],231:[function(e,t,n){var r=(e("../../../util/copy.coffee"),e("../../../core/fetch/text.js")),o=e("../../../core/fetch/value.coffee"),a=e("../../../color/mix.coffee"),i=e("../../../core/console/print.coffee"),l=(e("../../../client/rtl.coffee"),e("./segments.coffee")),s=e("./color.coffee"),u=e("../../../string/list.coffee"),c=e("../../../color/text.coffee"),f=e("../../../textwrap/textwrap.coffee");t.exports=function(e,t){var n=e.types[e.type.value].zoom?e.zoom.behavior.scaleExtent():[1,1],d=e.g[t].selectAll("g"),p=function(t){t.attr("opacity",function(t){var r=parseFloat(d3.select(this).attr("font-size"),10);return t.visible=r*(e.zoom.scale/n[1])>=2,t.visible?1:0})},h=function(t){e.draw.timing?t.transition().duration(e.draw.timing).attr("opacity",0).remove():t.remove()},v=function(t){var r="bottom"===e.labels.valign.value?"top":"bottom";t.attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).attr("stroke","none").attr("pointer-events",function(e){return e.mouse?"auto":"none"}).attr("fill",function(t){if(t.color)return t.color;var n=s(t.parent,e),r=c(n),o=t.text?.15:1;return a(n,r,.2,o)}).each(function(t){if(t.resize instanceof Array){t.resize[0],t.resize[1]}var o=t.resize,a=!0;if(t.text){o instanceof Array||(o=[9,50],a=t.resize);var i=t.y-t.h*n[1]/2+t.padding/2;"bottom"===r&&(i+=t.h*n[1]/2),f().align("center").container(d3.select(this)).height(t.h*n[1]/2).padding(t.padding/2).resize(a).size(o).text(e.format.value(100*t.text,{key:"share",vars:e})).width(t.w*n[1]).valign(r).x(t.x-t.w*n[1]/2+t.padding/2).y(i).draw()}else{t.resize instanceof Array||(o=[7,n[1]/n[0]*40],a=t.resize);var l="bottom"===e.labels.valign.value?t.share:0;f().align(t.anchor||e.labels.align.value).container(d3.select(this)).height(t.h*n[1]-t.share).padding(t.padding/2).resize(a).size(o).shape(t.shape||"square").text(t.names).valign(e.labels.valign.value).width(t.w*n[1]).x(t.x-t.w*n[1]/2+t.padding/2).y(t.y-t.h*n[1]/2+t.padding/2+l).draw()}}).attr("transform",function(e){var t=d3.select(this).attr("transform")||"",r=e.angle||0,o=e.translate&&e.translate.x?e.translate.x:0,a=e.translate&&e.translate.y?e.translate.y:0;return t.length&&(t=t.split(")").slice(-3).join(")")),"rotate("+r+","+o+","+a+")scale("+1/n[1]+")translate("+(e.x*n[1]-e.x)+","+(e.y*n[1]-e.y)+")"+t})};if("edges"===t||e.labels.value){if(e.dev.value){var g="drawing "+t+" labels";i.time(g)}d.each(function(t){function a(t){var n="string"==typeof s.background?s.background:"none"===e.background.value?"#ffffff":e.background.value,r="string"==typeof s.background?s.background:n,o=_.attr("transform").split(")");o.pop(),o.pop(),o.push(""),o=o.join(")"),t.attr("fill",r).attr(S).attr("transform",o)}var i=t.d3po&&"label"in t.d3po&&!t.d3po.label,s=t.d3po_label||null,c=t.d3po_share,f=t.d3po.text?t.d3po.text:s&&s.names?s.names:e.labels.text.value?o(e,t,e.labels.text.value):r(e,t),d=s&&"group"in s?s.group:d3.select(this),g=0,m=e.types[e.type.value].fill;if(f instanceof Array||(f=[f]),s)if(["line","area"].indexOf(e.shape.value)>=0)var y=!0;else if(t&&"d3po"in t)var x=l(e,t,"active"),b=l(e,t,"temp"),w=l(e,t,"total"),y=!b&&!x||x>=w||!x&&b>=w;if(i||!(s&&s.force||y)&&m)delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h);else{if(c&&t.d3po.share&&c.w-2*e.labels.padding>=10&&c.h-2*e.labels.padding>=10&&"middle"!=e.labels.valign.value){c.resize=!1!==e.labels.resize.value&&(!(c&&"resize"in c)||c.resize),c.padding=e.labels.padding,c.text=t.d3po.share,c.parent=t;var _=d.selectAll("text#d3po_share_"+t.d3po.id).data([c],function(e){return e.w+""+e.h+e.text});e.draw.timing&&1===e.zoom.scale?(_.transition().duration(e.draw.timing/2).call(v),_.enter().append("text").attr("id","d3po_share_"+t.d3po.id).attr("class","d3po_share").attr("opacity",0).call(v).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).attr("opacity",1)):(_.attr("opacity",1).call(v),_.enter().append("text").attr("id","d3po_share_"+t.d3po.id).attr("class","d3po_share").attr("opacity",1).call(v)),g=_.node().getBBox().height+e.labels.padding,_.exit().call(h)}else d.selectAll("text.d3po_share").call(h);if(s&&(s.resize=!1!==e.labels.resize.value&&(!(s&&"resize"in s)||s.resize),s.padding="number"==typeof s.padding?s.padding:e.labels.padding),s&&s.w*n[1]-s.padding>=20&&s.h*n[1]-s.padding>=10&&f.length){for(var k=e.format.locale.value.ui.and,z=e.format.locale.value.ui.more,M=0;M<f.length;M++)f[M]instanceof Array&&(f[M]=u(f[M],k,3,z));s.names=f,s.share=g,s.parent=t;var _=d.selectAll("text#d3po_label_"+t.d3po.id).data([s],function(e){return!!e&&e.w+"_"+e.h+"_"+e.x+"_"+e.y+"_"+e.names.join("_")}),A=s.resize?void 0:e.labels.font.size*n[0]+"px";if(e.draw.timing&&1===e.zoom.scale?(_.transition().duration(e.draw.timing/2).call(v).call(p),_.enter().append("text").attr("font-size",A).attr("id","d3po_label_"+t.d3po.id).attr("class","d3po_label").attr("opacity",0).call(v).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).call(p)):(_.attr("opacity",1).call(v).call(p),_.enter().append("text").attr("font-size",A).attr("id","d3po_label_"+t.d3po.id).attr("class","d3po_label").call(v).call(p)),_.exit().call(h),0===_.size()||0===_.selectAll("tspan").size())delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h);else{if(s.background){var j=["background"],E=_.node().getBBox(),S={height:E.height,width:E.width,x:E.x,y:E.y>0?E.y:-E.height/2};S.width+=e.labels.padding*n[0],S.height+=e.labels.padding*n[0],S.x-=e.labels.padding*n[0]/2,S.y-=e.labels.padding*n[0]/2;var O=_.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0];O=O.replace(/([^a-z])\s([^a-z])/gi,"$1,$2"),O=O.split(","),O.length>1&&(O=O[O.length-1],O=O.substring(0,O.length-1),S.y+=parseFloat(O))}else var j=[],S={};var N=d.selectAll("rect#d3po_label_bg_"+t.d3po.id).data(j),F="number"==typeof s.background?s.background:"string"==typeof s.background?1:.6;e.draw.timing?(N.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),N.transition().duration(e.draw.timing).attr("opacity",F).call(a),N.enter().insert("rect",".d3po_label").attr("id","d3po_label_bg_"+t.d3po.id).attr("class","d3po_label_bg").attr("opacity",0).call(a).transition().duration(e.draw.timing).attr("opacity",F)):(N.exit().remove(),N.enter().insert("rect",".d3po_label").attr("id","d3po_label_bg_"+t.d3po.id).attr("class","d3po_label_bg"),N.attr("opacity",F).call(a))}}else delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h)}}),e.dev.value&&i.timeEnd(g)}else{if(e.dev.value){var g="removing "+t+" labels";i.time(g)}d.selectAll("text.d3po_label, rect.d3po_label_bg").call(h),e.g.labels.selectAll("text.d3po_label, rect.d3po_label_bg").call(h),e.dev.value&&i.timeEnd(g)}}},{"../../../client/rtl.coffee":42,"../../../color/mix.coffee":48,"../../../color/text.coffee":52,"../../../core/console/print.coffee":54,"../../../core/fetch/text.js":68,"../../../core/fetch/value.coffee":69,"../../../string/list.coffee":177,"../../../textwrap/textwrap.coffee":203,"../../../util/copy.coffee":210,"./color.coffee":223,"./segments.coffee":236}],232:[function(e,t,n){function r(e){e.attr("x",function(e){return e.d3po.x}).attr("y",function(e){return e.d3po.y}).attr("width",0).attr("height",0)}function o(e,t){void 0===t&&(t=0),e.attr("x",function(e){var n=e.d3po.r?2*e.d3po.r:e.d3po.width;return e.d3po.x-(n/2+t/2)}).attr("y",function(e){var n=e.d3po.r?2*e.d3po.r:e.d3po.height;return e.d3po.y-(n/2+t/2)}).attr("width",function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.width)+t}).attr("height",function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.height)+t}).attr("rx",function(e){return((e.d3po.r?2*e.d3po.r:e.d3po.width)+t)/2}).attr("ry",function(e){return((e.d3po.r?2*e.d3po.r:e.d3po.height)+t)/2})}function a(e,t,n,r){var a=e.draw.timing?e.timing.mouseevents:0;void 0===r&&(r=0),a?(d3.select(t.parentNode).selectAll("path.d3po_line").transition().duration(a).style("stroke-width",function(t){var o=n;if(o.constructor!==Number){var a=c(e,t,n);o=a&&a.length?d3.max(a):e.data.stroke.width}return o+r}),d3.select(t.parentNode).selectAll("rect").transition().duration(a).style("stroke-width",function(t){var r=n;if(r.constructor!==Number){var o=c(e,t,n);r=o&&o.length?d3.max(o):e.data.stroke.width}return r}).call(o,r)):(d3.select(t.parentNode).selectAll("path.d3po_line").style("stroke-width",function(t){var o=n;if(o.constructor!==Number){var a=c(e,t,n);o=a&&a.length?d3.max(a):e.data.stroke.width}return o+r}),d3.select(t.parentNode).selectAll("rect").style("stroke-width",function(t){var r=n;if(r.constructor!==Number){var o=c(e,t,n);r=o&&o.length?d3.max(o):e.data.stroke.width}return r}).call(o,r))}var i=e("../../../util/copy.coffee"),l=e("../../../util/closest.coffee"),s=e("../../../client/pointer.coffee"),u=e("./style.coffee"),c=e("../../../core/fetch/value.coffee");t.exports=function(e,t,n,f){var d=d3.svg.line().x(function(e){return e.d3po.x}).y(function(e){return e.d3po.y}).interpolate(e.shape.interpolate.value),p=e.size.value||e.data.stroke.width,h=e[e.axes.discrete],v=function(t){var n=p;if(n.constructor!==Number){var r=c(e,t,p);n=r&&r.length?d3.max(r):e.data.stroke.width}return n<15?15:n},g=h.ticks.values.map(function(e){return e.constructor===Date?e.getTime():e});t.each(function(t){var n=!1,f=[],m=[],y=i(t),x=d3.select(this);y.values=[],y.segment_key=y.key,t.values.forEach(function(r,o,a){var s=c(e,r,h.value);s.constructor===Date&&(s=s.getTime());var u=g.indexOf(l(g,s));!1===n||n===u-1?(y.values.push(r),y.segment_key+="_"+u):(y.values.length>1?f.push(y):m.push(y.values[0]),y=i(t),y.values=[r]),o===a.length-1&&(y.values.length>1?f.push(y):m.push(y.values[0])),n=u});var b=x.selectAll("path.d3po_line").data(f,function(e){return e.d3po||(e.d3po={}),e.d3po.shape="line",e.segment_key}),w=x.selectAll("rect.d3po_anchor").data(m,function(e){return e.d3po||(e.d3po={}),e.d3po.r=p,e.d3po.id});e.draw.timing?(b.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),b.transition().duration(e.draw.timing).attr("d",function(e){return d(e.values)}).call(u,e),b.enter().append("path").attr("class","d3po_line").style("stroke-linecap","round").attr("d",function(e){return d(e.values)}).call(u,e).attr("opacity",0).transition().duration(e.draw.timing).attr("opacity",1),w.enter().append("rect").attr("class","d3po_anchor").attr("id",function(e){return e.d3po.id}).call(r).call(u,e),w.transition().duration(e.draw.timing).call(o).call(u,e),w.exit().transition().duration(e.draw.timing).call(r).remove()):(b.exit().remove(),b.enter().append("path").attr("class","d3po_line").style("stroke-linecap","round"),b.attr("d",function(e){return d(e.values)}).call(u,e),w.enter().append("rect").attr("class","d3po_anchor").attr("id",function(e){return e.d3po.id}),w.exit().remove(),w.call(o).call(u,e));var _=x.selectAll("path.d3po_mouse").data(f,function(e){return e.segment_key});_.enter().append("path").attr("class","d3po_mouse").attr("d",function(e){return d(e.values)}).style("stroke","black").style("stroke-width",v).style("fill","none").style("stroke-linecap","round").attr("opacity",0),_.on(s.over,function(t){!e.draw.frozen&&e.mouse.value&&e.mouse.over.value&&a(e,this,p,2)}).on(s.out,function(t){!e.draw.frozen&&e.mouse.value&&e.mouse.out.value&&a(e,this,p,0)}),e.draw.timing?_.transition().duration(e.draw.timing).attr("d",function(e){return d(e.values)}).style("stroke-width",v):_.attr("d",function(e){return d(e.values)}).style("stroke-width",v),_.exit().remove()})}},{"../../../client/pointer.coffee":40,"../../../core/fetch/value.coffee":69,"../../../util/closest.coffee":209,"../../../util/copy.coffee":210,"./style.coffee":237}],233:[function(e,t,n){t.exports=function(e){function t(t){t.attr("d",e.edges.path).style("stroke-width",function(e){return Math.max(1,e.dy)}).style("stroke","#ddd").style("fill","none").attr("transform",function(e){return"translate("+e.d3po.x+","+e.d3po.y+")"})}var n=e.returned.edges||[],r=e.g.edges.selectAll("g.d3po_edge_path").data(n,function(t){return t.d3po.id="path_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],t.d3po.id});e.draw.timing?(r.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),r.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),r.selectAll("path").data(function(e){return[e]}).transition().duration(e.draw.timing).call(t),r.enter().append("g").attr("class","d3po_edge_path").append("path").style("stroke-width",0).transition().duration(e.draw.timing).call(t)):(r.exit().remove(),r.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),r.selectAll("path").data(function(e){return[e]}).call(t),r.enter().append("g").attr("class","d3po_edge_path").append("path").call(t))}},{}],234:[function(e,t,n){var r,o,a,i;i=e("./style.coffee"),a={},r={},o={r:{},a:{}},t.exports=function(e,t,n,l){var s,u,c,f,d;c=e.id.nesting[e.depth.value+1],f=d3.svg.line.radial().interpolate("linear-closed").radius(function(e){return e.d3po.r}).angle(function(e){return e.d3po.a}),s=function(t){return e.labels.value&&(t.d3po.label?t.d3po_label=t.d3po.label:delete t.d3po_label),[t]},e.draw.timing?(t.each(function(t){var n,r,o,a,i;for(a=t[c],i=[],r=0,o=a.length;r<o;r++)n=a[r],i.push(n.d3po.id=n[e.id.value]+"_"+n[c]);return i}),u=d3.svg.line.radial().interpolate("linear-closed").radius(function(e,t){return void 0===a[e.d3po.id]&&(a[e.d3po.id]=0),isNaN(a[e.d3po.id])&&(a[e.d3po.id]=e.d3po.r),a[e.d3po.id]}).angle(function(e,t){return void 0===r[e.d3po.id]&&(r[e.d3po.id]=e.d3po.a),isNaN(r[e.d3po.id])&&(r[e.d3po.id]=e.d3po.a),r[e.d3po.id]}),d=function(e,t){return e.attrTween("d",function(e){var n,i,l,s,f,d,p;for(p=e[c],l=s=0,f=p.length;s<f;l=++s)i=p[l],n=i.d3po.a,void 0===t?d=i.d3po.r:0===t&&(d=0),o.a[i.d3po.id]=d3.interpolate(r[i.d3po.id],n),o.r[i.d3po.id]=d3.interpolate(a[i.d3po.id],d);return function(t){var n,s,f;for(f=e[c],l=n=0,s=f.length;n<s;l=++n)i=f[l],r[i.d3po.id]=o.a[i.d3po.id](t),a[i.d3po.id]=o.r[i.d3po.id](t);return u(e[c])}})},n.append("path").attr("class","d3po_data").call(i,e).attr("d",function(e){return u(e[c])}),t.selectAll("path.d3po_data").data(s).transition().duration(e.draw.timing).call(i,e).call(d),l.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(d,0)):(n.append("path").attr("class","d3po_data"),t.selectAll("path.d3po_data").data(s).call(i,e).attr("d",function(e){return f(e[c])}))}},{"./style.coffee":237}],235:[function(e,t,n){var r;r=e("./style.coffee"),t.exports=function(e,t,n,o){var a,i,l;return a=function(t){var n,r;return e.labels.value&&!t.d3po.label?(r=t.d3po.r?2*t.d3po.r:t.d3po.width,n=t.d3po.r?2*t.d3po.r:t.d3po.height,t.d3po_label={w:r,h:n,x:0,y:0},t.d3po_share={w:r,h:n,x:0,y:0},t.d3po_label.shape="circle"===t.d3po.shape?"circle":"square"):t.d3po.label?t.d3po_label=t.d3po.label:delete t.d3po_label,[t]},i=function(e){return e.attr("x",function(e){return e.d3po.init&&"x"in e.d3po.init?e.d3po.init.x:e.d3po.init&&"width"in e.d3po.init?-e.d3po.width/2:0}).attr("y",function(e){return e.d3po.init&&"y"in e.d3po.init?e.d3po.init.y:e.d3po.init&&"height"in e.d3po.init?-e.d3po.height/2:0}).attr("width",function(e){return e.d3po.init&&"width"in e.d3po.init?e.d3po.init.width:0}).attr("height",function(e){return e.d3po.init&&"height"in e.d3po.init?e.d3po.init.height:0})},l=function(t){return t.attr("x",function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.width)/2}).attr("y",function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.height)/2}).attr("width",function(e){return e.d3po.r?2*e.d3po.r:e.d3po.width}).attr("height",function(e){return e.d3po.r?2*e.d3po.r:e.d3po.height}).attr("rx",function(e){var t,n;return t="circle"===e.d3po.shape,n=e.d3po.r?2*e.d3po.r:e.d3po.width,t?(n+2)/2:0}).attr("ry",function(e){var t,n;return n="circle"===e.d3po.shape,t=e.d3po.r?2*e.d3po.r:e.d3po.height,n?(t+2)/2:0}).attr("transform",function(e){return"rotate"in e.d3po?"rotate("+e.d3po.rotate+")":""}).attr("shape-rendering",function(t){return"square"!==t.d3po.shape||"rotate"in t.d3po?"auto":e.shape.rendering.value})},e.draw.timing?(n.append("rect").attr("class","d3po_data").call(i).call(r,e),t.selectAll("rect.d3po_data").data(a).transition().duration(e.draw.timing).call(l).call(r,e),o.selectAll("rect.d3po_data").transition().duration(e.draw.timing).call(i)):(n.append("rect").attr("class","d3po_data"),t.selectAll("rect.d3po_data").data(a).call(l).call(r,e))}},{"./style.coffee":237}],236:[function(e,t,n){var r;r=e("../../../core/fetch/value.coffee"),t.exports=function(e,t,n){var o;return o=e[n].value,o?n in t.d3po?t.d3po[n]:r(e,t,o):t.d3po[n]}},{"../../../core/fetch/value.coffee":69}],237:[function(e,t,n){var r,o,a;r=e("./color.coffee"),o=e("../../../client/ie.js"),a=e("../../../core/fetch/value.coffee"),t.exports=function(e,t){return e.attr("fill",function(e){return e.d3po&&e.d3po.spline?"none":r(e,t)}).style("stroke",function(e){var n;return e.d3po&&e.d3po.stroke?e.d3po.stroke:(n=e.values?r(e.values[0],t):r(e,t,!0),d3.rgb(n).darker(.6))}).style("stroke-width",function(e){var n;if(o&&t.types[t.type.value].zoom)return 0;if("line"===e.d3po.shape&&t.size.value){if(t.size.value.constructor===Number)return t.size.value;if((n=a(t,e,t.size.value))&&n.length)return d3.max(n)}return t.data.stroke.width}).attr("opacity",t.data.opacity).attr("vector-effect","non-scaling-stroke")}},{"../../../client/ie.js":39,"../../../core/fetch/value.coffee":69,"./color.coffee":223}],238:[function(e,t,n){var r=e("./style.coffee");t.exports=function(e,t,n,o){function a(e){e.attr("d",d3.svg.symbol().type("triangle-down").size(10))}function i(e){e.attr("d",d3.svg.symbol().type("triangle-down").size(function(e){var t=Math.min(e.d3po.width,e.d3po.height);return d3.scale.pow().exponent(2)(t/2)}))}n.append("path").attr("class","d3po_data").call(a).call(r,e),t.selectAll("path.d3po_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(i).call(r,e):t.selectAll("path.d3po_data").call(i).call(r,e)}},{"./style.coffee":237}],239:[function(e,t,n){var r=e("./style.coffee");t.exports=function(e,t,n,o){function a(e){e.attr("d",d3.svg.symbol().type("triangle-up").size(10))}function i(e){e.attr("d",d3.svg.symbol().type("triangle-up").size(function(e){var t=Math.min(e.d3po.width,e.d3po.height);return d3.scale.pow().exponent(2)(t/2)}))}n.append("path").attr("class","d3po_data").call(a).call(r,e),t.selectAll("path.d3po_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(i).call(r,e):t.selectAll("path.d3po_data").call(i).call(r,e)}},{"./style.coffee":237}],240:[function(e,t,n){t.exports=function(e,t,n,r){var o,a,i,l,s,u,c,f,d;a=function(e){return e.d3po.text?e.d3po_label={w:f,h:f,x:0,y:0,background:"#fff",resize:!1,
angle:["left","right"].indexOf(e.d3po.position)>=0?90:0}:e.d3po.label?e.d3po_label=e.d3po.label:delete e.d3po_label,[e]},d=function(t){return t.style("stroke-width",e.data.stroke.width).style("stroke","#444").attr("fill","none").attr("shape-rendering",e.shape.rendering.value)},i=function(e){return e.attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0)},c=function(e){return e.attr("x1",function(e){var t,n;return["top","bottom"].indexOf(e.d3po.position)>=0?0:(t=e.d3po.offset||0,n=e.d3po.width||0,(t<0?-n:n)+t)}).attr("x2",function(e){return["top","bottom"].indexOf(e.d3po.position)>=0?0:e.d3po.offset||0}).attr("y1",function(e){var t,n;return["left","right"].indexOf(e.d3po.position)>=0?0:(n=e.d3po.offset||0,t=e.d3po.height||0,(n<0?-t:t)+n)}).attr("y2",function(e){return["left","right"].indexOf(e.d3po.position)>=0?0:e.d3po.offset||0}).attr("marker-start","url(#d3po_whisker_marker)")},l=e.defs.selectAll("#d3po_whisker_marker").data([0]),l.enter().append("marker").attr("id","d3po_whisker_marker").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("line"),o=t.datum(),o?(u=o.d3po.position,s=["top","bottom"].indexOf(u)>=0?"horizontal":"vertical",f="horizontal"===s?o.d3po.width:o.d3po.height):(s="horizontal",f=0),l.select("line").attr("x1","horizontal"===s?-f/2:0).attr("x2","horizontal"===s?f/2:0).attr("y1","vertical"===s?-f/2:0).attr("y2","vertical"===s?f/2:0).call(d).style("stroke-width",2*e.data.stroke.width),e.draw.timing?(n.append("line").attr("class","d3po_data").call(d).call(i),t.selectAll("line.d3po_data").data(a).transition().duration(e.draw.timing).call(d).call(c),r.selectAll("line.d3po_data").transition().duration(e.draw.timing).call(i)):(n.append("line").attr("class","d3po_data"),t.selectAll("line.d3po_data").data(a).call(d).call(c))}},{}],241:[function(e,t,n){var r=e("../../../client/pointer.coffee"),o=e("../../../client/prefix.coffee"),a=e("../../../core/console/print.coffee"),i=e("../../../client/touch.coffee"),l=e("../zoom/propagation.coffee");t.exports=function(e){e.dev.value&&a.time("creating SVG elements"),e.svg=e.container.value.selectAll("svg#d3po").data([0]),e.svg.enter().insert("svg","#d3po_message").attr("id","d3po").attr("width",e.width.value).attr("height",e.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink"),e.g.bg=e.svg.selectAll("rect#bg").data(["bg"]),e.g.bg.enter().append("rect").attr("id","bg").attr("fill",e.background.value).attr("stroke","none").attr("width",e.width.value).attr("height",e.height.value),e.g.timeline=e.svg.selectAll("g#timeline").data(["timeline"]),e.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+e.height.value+")"),e.g.legend=e.svg.selectAll("g#key").data(["key"]),e.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+e.height.value+")"),e.g.footer=e.svg.selectAll("g#footer").data(["footer"]),e.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+e.height.value+")");var t="clipping_"+e.container.id;e.g.clipping=e.svg.selectAll("#clipping").data(["clipping"]),e.g.clipping.enter().append("clipPath").attr("id",t).append("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container=e.svg.selectAll("g#container").data(["container"]),e.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#"+t+")").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.g.zoom=e.g.container.selectAll("g#zoom").data(["zoom"]),e.g.zoom.enter().append("g").attr("id","zoom"),e.g.viz=e.g.zoom.selectAll("g#d3po_viz").data(["d3po_viz"]),e.g.viz.enter().append("g").attr("id","d3po_viz"),e.g.overlay=e.g.viz.selectAll("rect#d3po_overlay").data([{id:"d3po_overlay"}]),e.g.overlay.enter().append("rect").attr("id","d3po_overlay").attr("width",e.width.value).attr("height",e.height.value).attr("opacity",0),e.g.overlay.on(r.move,function(t){i&&l(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",o()+"grab"):d3.select(this).style("cursor","auto")}).on(r.up,function(t){i&&l(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",o()+"grab"):d3.select(this).style("cursor","auto")}).on(r.down,function(t){i&&l(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",o()+"grabbing"):d3.select(this).style("cursor","auto")}),e.g.app=e.g.viz.selectAll("g#app").data(["app"]),e.g.app.enter().append("g").attr("id","app"),e.g.edges=e.g.viz.selectAll("g#edges").data(["edges"]),e.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),e.g.edge_focus=e.g.viz.selectAll("g#focus").data(["focus"]),e.g.edge_focus.enter().append("g").attr("id","focus"),e.g.edge_hover=e.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),e.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),e.g.data=e.g.viz.selectAll("g#data").data(["data"]),e.g.data.enter().append("g").attr("id","data").attr("opacity",0),e.g.data_focus=e.g.viz.selectAll("g#data_focus").data(["data_focus"]),e.g.data_focus.enter().append("g").attr("id","data_focus"),e.g.labels=e.g.viz.selectAll("g#d3po_labels").data(["d3po_labels"]),e.g.labels.enter().append("g").attr("id","d3po_labels"),e.defs=e.svg.selectAll("defs").data(["defs"]),e.defs.enter().append("defs"),e.dev.value&&a.timeEnd("creating SVG elements")}},{"../../../client/pointer.coffee":40,"../../../client/prefix.coffee":41,"../../../client/touch.coffee":45,"../../../core/console/print.coffee":54,"../zoom/propagation.coffee":256}],242:[function(e,t,n){var r=e("../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&r.time("updating SVG elements"),e.draw.timing?(e.container.value.transition().duration(e.draw.timing).style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.bg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").transition().duration(e.draw.timing).attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.transition().duration(e.draw.timing).attr("transform","translate("+e.margin.left+","+e.margin.top+")")):(e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.attr("width",e.width.value).attr("height",e.height.value),e.g.bg.attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.attr("transform","translate("+e.margin.left+","+e.margin.top+")")),e.dev.value&&r.timeEnd("updating SVG elements")}},{"../../../core/console/print.coffee":54}],243:[function(e,t,n){var r=e("../../../array/sort.coffee"),o=e("../../../tooltip/create.js"),a=e("../../../core/data/nest.js"),i=e("./data.js"),l=e("../../../core/fetch/color.coffee"),s=e("../../../core/fetch/text.js"),u=e("../../../core/fetch/value.coffee"),c=e("../../../object/merge.coffee"),f=e("../../../tooltip/remove.coffee"),d=e("../shapes/segments.coffee"),p=e("../../../client/scroll.js"),h=e("../../../util/uniques.coffee"),v=e("../../../object/validate.coffee"),g=e("../zoom/direction.coffee");t.exports=function(e){function t(t){function p(e){return"string"==typeof n[e].value?n[e].value:n.format.locale.value.method[e]}var g,w="depth"in e?e.depth:y,A={},j=n.id.nesting[w+1]in m?w+1:w,E=n.id.nesting[j],T="merged"in m.d3po?m.d3po.merged:m[E];T instanceof Array||(T=[T]);var C=u(n,m,n.size.value);if(n.tooltip.children.value){if(T=T.slice(0),T.length>1&&v(T[0])&&(T=a(n,T,[E])),n.size.value&&v(T[0])){var q=[],P=T.filter(function(e){if(!(null===u(n,e,n.size.value)||"d3po"in e&&e.d3po.merged))return!0;q.push(e)});r(P,n.size.value,"desc",[],n),T=P.concat(q)}var B=!0===n.tooltip.children.value?3:n.tooltip.children.value,D="short"===M?B:n.data.large,R=T.length,I=d3.min([R,D]);g={values:[]};for(var L=0;L<I&&T.length;L++){var V=T.shift(),U=s(n,V,j)[0],Y=v(V)?u(n,V,E,j):V;if(Y!==m[n.id.nesting[w]]&&U&&!g[U]){var H=v(V)?u(n,V,n.size.value,E):null,X=l(n,V,E);g[U]=!H||H instanceof Array?"":n.format.value(H,{key:n.size.value,vars:n,data:V});var G={};G[U]=g[U],g.values.push(G),X&&(g.d3po_colors||(g.d3po_colors={}),g.d3po_colors[U]=X)}else L--}R>I&&(g.d3poMore=R-I)}m.d3po.tooltip&&(A=c(A,m.d3po.tooltip)),n.tooltip.size.value&&(C&&"number"!=typeof n.size.value&&(A[p("size")]=C),n.axes.opposite&&n[n.axes.opposite].value!==n.size.value&&(A[p(n.axes.opposite)]=u(n,m,n[n.axes.opposite].value)),n.axes.opposite&&n[n.axes.opposite+"2"].value!==n.size.value&&(A[p(n.axes.opposite+"2")]=u(n,m,n[n.axes.opposite+"2"].value)),n.color.valueScale&&(A[p("color")]=u(n,m,n.color.value)));var Z=d(n,m,"active"),W=d(n,m,"temp"),J=d(n,m,"total");"number"==typeof Z&&Z>0&&J&&(A[p("active")]=Z+"/"+J+" ("+n.format.value(Z/J*100,{key:"share",vars:n,data:m})+")"),"number"==typeof W&&W>0&&J&&(A[p("temp")]=W+"/"+J+" ("+n.format.value(W/J*100,{key:"share",vars:n,data:m})+")"),n.tooltip.share.value&&m.d3po.share&&(A.share=n.format.value(100*m.d3po.share,{key:"share",vars:n,data:m}));var j="depth"in e?e.depth:y,Q=e.title||s(n,m,j)[0],K=h(m,n.icon.value,u,n,n.id.nesting[j]),$=e.titleOnly?[]:i(n,m,M,A,g,j);if(K=1===K.length&&"string"==typeof K[0]&&K[0],$.length>0||S||!m.d3po_label&&"short"==M&&Q||m.d3po_label&&(!("visible"in m.d3po_label)||"visible"in m.d3po_label&&!1===m.d3po_label.visible)){Q||(Q=n.format.value(Y,{key:n.id.value,vars:n}));var j="d3po"in m&&"merged"in m.d3po?y-1:"depth"in e?e.depth:y;if(j<0&&(j=0),j=n.id.nesting[j],"string"==typeof n.icon.style.value)var ee=n.icon.style.value;else if("object"==typeof n.icon.style.value&&n.icon.style.value[j])var ee=n.icon.style.value[j];else var ee="default";var te=n.tooltip.small;e.width?te=e.width:k&&(te=n.tooltip.large);var ne=!k&&"long"!==e.length||k&&n.tooltip.fullscreen.value?d3.select("body"):n.container.value;!e.description&&m&&n.tooltip.sub.value&&(e.description=u(n,m,n.tooltip.sub.value)),o({align:z,arrow:b,locale:n.format.locale.value,background:n.tooltip.background,curtain:n.tooltip.curtain.color,curtainopacity:n.tooltip.curtain.opacity,fontcolor:n.tooltip.font.color,fontfamily:n.tooltip.font.family.value,fontsize:n.tooltip.font.size,fontweight:n.tooltip.font.weight,data:$,color:l(n,m),allColors:!0,footer:!1===e.footer?e.footer:S,fullscreen:k,html:t,js:e.js,icon:K,id:_,max_height:e.maxheight,max_width:te,mouseevents:x,offset:F,parent:ne,stacked:n.tooltip.stacked.value,style:ee,title:Q,description:e.description,width:e.width||k||0!=$.length?te:"auto",x:O,y:N})}else f(_)}"d3po"in e.data||(e.data.d3po={});var n=e.vars,m=e.data,y="d3po"in m&&"depth"in m.d3po?m.d3po.depth:n.depth.value,x=(e.ex,!!e.mouseevents&&e.mouseevents),b=!("arrow"in e)||e.arrow,w=u(n,m,n.id.value),_=e.id||n.type.value;if(!d3.event||"click"!=d3.event.type||!n.tooltip.html.value&&!n.tooltip.value.long||"fullscreen"in e){var k=!1,z=e.anchor||n.tooltip.anchor,M=e.length||"short",A=g(m,n);if(-1===A){var j=n.id.nesting[y-1];u(n,w,j)}var E="";if(n.mouse.click.value&&(!n.mouse.viz||!1!==n.mouse.viz.click))if(1===A&&n.zoom.value)var E=n.format.value(n.format.locale.value.ui.expand);else if(-1===A&&n.zoom.value&&n.history.states.length&&!n.tooltip.value.long)var E=n.format.value(n.format.locale.value.ui.collapse);else if(n.small||"short"!=M||!n.tooltip.html.value&&!n.tooltip.value.long||1===n.focus.value.length&&n.focus.value[0]==w){if("long"==M)var E=n.footer.value||""}else var E=n.format.locale.value.ui.moreInfo;var S=!!E.length&&n.format.value(E,{key:"footer",vars:n})}else{var k=!0,b=!1,x=!0,M="long",S=n.footer.value;n.covered=!0}if("x"in e)var O=e.x;else if("static"===n.types[n.type.value].tooltip){var O=m.d3po.x;n.zoom.translate&&n.zoom.scale&&(O=n.zoom.translate[0]+O*n.zoom.scale),O+=n.margin.left,"long"!==e.length&&(N+=p.x(),O+=n.container.value.node().getBoundingClientRect().left,O+=parseFloat(n.container.value.style("padding-left"),10))}else var O=d3.mouse(d3.select("html").node())[0];if("y"in e)var N=e.y;else if("static"==n.types[n.type.value].tooltip){var N=m.d3po.y;n.zoom.translate&&n.zoom.scale&&(N=n.zoom.translate[1]+N*n.zoom.scale),N+=n.margin.top,"long"!==e.length&&(N+=p.y(),N+=n.container.value.node().getBoundingClientRect().top,N+=parseFloat(n.container.value.style("padding-top"),10))}else var N=d3.mouse(d3.select("html").node())[1];if("offset"in e)var F=e.offset;else if("static"==n.types[n.type.value].tooltip){var F=m.d3po.r?m.d3po.r:m.d3po.height/2;n.zoom.scale&&(F*=n.zoom.scale)}else var F=3;if(k||"long"===e.length)if("string"==typeof n.tooltip.html.value)t(n.tooltip.html.value);else if("function"==typeof n.tooltip.html.value)t(n.tooltip.html.value(w));else if(n.tooltip.html.value&&"object"==typeof n.tooltip.html.value&&n.tooltip.html.value.url){var T=n.tooltip.html.value.url;"function"==typeof T&&(T=T(w)),d3.json(T,function(e){t(n.tooltip.html.value.callback?n.tooltip.html.value.callback(e):e)})}else t(e.html);else t(e.html)}},{"../../../array/sort.coffee":36,"../../../client/scroll.js":43,"../../../core/data/nest.js":62,"../../../core/fetch/color.coffee":65,"../../../core/fetch/text.js":68,"../../../core/fetch/value.coffee":69,"../../../object/merge.coffee":174,"../../../object/validate.coffee":175,"../../../tooltip/create.js":204,"../../../tooltip/remove.coffee":206,"../../../util/uniques.coffee":213,"../shapes/segments.coffee":236,"../zoom/direction.coffee":253,"./data.js":244}],244:[function(e,t,n){var r=e("../../../util/copy.coffee"),o=e("../../../core/fetch/value.coffee"),a=e("../../../core/fetch/color.coffee"),i=e("../../../core/fetch/text.js"),l=e("../../../color/legible.coffee"),s=e("../../../object/merge.coffee"),u=e("../../../client/prefix.coffee"),c=e("../../../string/format.js"),f=e("../../../object/validate.coffee");t.exports=function(e,t,n,d,p,h){function v(n,r){if(e.attrs.value[r])var a=r;else var a=null;r&&(r=e.format.value(r));var i=m[n]||o(e,t,n,a);if(f(i))w.push({name:e.format.value(n),value:e.format.value(i.value,{key:i.key,vars:e}),group:r});else if(null!=i&&"undefined"!=i&&!(i instanceof Array)&&("string"==typeof i&&i.indexOf("d3po_other")<0||"string"!=typeof i)){var l=e.format.locale.value.ui[n]?e.format.value(e.format.locale.value.ui[n]):e.format.value(n),s=x.indexOf(n)>=0;i instanceof Array?i.forEach(function(r){r=e.format.value(r,{key:n,vars:e,data:t})}):i=e.format.value(i,{key:n,vars:e,data:t});var u={name:l,value:i,highlight:s,group:r};if(e.descs.value)if("function"==typeof e.descs.value){var c=e.descs.value(n);"string"==typeof c&&(u.desc=c)}else n in e.descs.value&&(u.desc=e.descs.value[n]);w.push(u)}}if(e.small)return[];if(!n)var n="long";if("long"==n)var g="short";else var g="long";var m={};if(d&&"string"==typeof d)d=[d];else if(d&&"object"==typeof d){m=s(m,d);var d=[];for(var y in m)d.push(y)}else if(!d)var d=[];var x=[];if(e.tooltip.value instanceof Array)var b=e.tooltip.value;else if("string"==typeof e.tooltip.value)var b=[e.tooltip.value];else{if(e.tooltip.value[e.id.nesting[h]])var b=e.tooltip.value[e.id.nesting[h]];else var b=e.tooltip.value;b instanceof Array||(b=b[n]?b[n]:b[g]?[]:s({"":[]},b)),"string"==typeof b?b=[b]:b instanceof Array||(b=s({"":[]},b))}var w=[];if(b.constructor===Array&&(b={"":b}),e.id.nesting.length&&h<e.id.nesting.length-1){var b=r(b);e.id.nesting.forEach(function(e,t){t>h&&b[e]&&delete b[e]})}for(var _ in b){b[_].constructor!==Array&&(b[_]=[b[_]]);for(var k=d.length;k>0;k--)b[_].indexOf(d[k-1])>=0&&d.splice(k-1,1)}if(e.tooltip.value.long&&"object"==typeof e.tooltip.value.long){for(var _ in e.tooltip.value.long)for(var k=d.length;k>0;k--){var z=d[k-1];e.tooltip.value.long[_].indexOf(z)>=0&&(b[_]||(b[_]=[]),b[_].push(z),d.splice(k-1,1))}}d.length&&(b[""]||(b[""]=[]),b[""]=b[""].concat(d));for(var _ in b)b[_].forEach(function(e){v(e,_)});if(p){var M=e.format.locale.value.ui.including,A=p.d3po_colors;p.values.forEach(function(t){var n=d3.keys(t)[0];w.push({group:e.format.value(M),highlight:!(!A||!A[n])&&A[n],name:n,value:t[n]})}),p.d3poMore&&w.push({group:e.format.value(M),highlight:!0,name:c(e.format.locale.value.ui.more,p.d3poMore),value:""})}if(e.tooltip.connections.value&&"long"===n){var j=e.edges.connections(t[e.id.value],e.id.value,!0);j.length&&j.forEach(function(t){var n=e.data.viz.filter(function(n){return n[e.id.value]===t[e.id.value]}),n=n.length?n[0]:t,r=i(e,n)[0],o=a(e,n),s=e.tooltip.font.size,c="square"==e.shape.value?0:s;styles=["background-color: "+o,"border-color: "+l(o),"border-style: solid","border-width: "+e.data.stroke.width+"px","display: inline-block","height: "+s+"px","left: 0px","position: absolute","width: "+s+"px","top: 0px",u()+"border-radius: "+c+"px"],node="<div style='"+styles.join("; ")+";'></div>";var f=function(){e.self.focus([n[e.id.value]]).draw()};w.push({group:e.format.value(e.format.locale.value.ui.primary),highlight:!1,link:f,name:"<div id='d3potooltipfocuslink_"+n[e.id.value]+"' class='d3po_tooltip_focus_link' style='position:relative;padding-left:"+1.5*s+"px;'>"+node+r+"</div>"})})}return w}},{"../../../client/prefix.coffee":41,"../../../color/legible.coffee":46,"../../../core/fetch/color.coffee":65,"../../../core/fetch/text.js":68,"../../../core/fetch/value.coffee":69,"../../../object/merge.coffee":174,"../../../object/validate.coffee":175,"../../../string/format.js":176,"../../../util/copy.coffee":210}],245:[function(e,t,n){var r;r=e("../../../core/console/print.coffee"),t.exports=function(e){var t,n,o,a,i,l,s,u,c,f;if(e.group=e.g.apps[e.type.value],e.mouse.viz=!1,e.edges.path=!1,f=e.types[e.type.value],u=f.requirements||[],o=u.indexOf("data")>=0,a=!o||o&&e.data.viz.length,!e.error.internal&&a){for(t=e.format.locale.value.visualization[e.type.value],e.dev.value&&r.time("running "+t),s=e.data.viz,i=0,l=s.length;i<l;i++)n=s[i],n.d3po&&(delete n.d3po.shape,delete n.d3po.label,delete n.d3po.rotate,delete n.d3po.share);c=f(e),e.dev.value&&r.timeEnd("running "+t)}else c=null;e.returned={nodes:[],edges:null},c instanceof Array?e.returned.nodes=c:c&&(c.nodes&&(e.returned.nodes=c.nodes),c.edges&&(e.returned.edges=c.edges))}},{"../../../core/console/print.coffee":54}],246:[function(e,t,n){var r=e("../../../util/copy.coffee"),o=e("../../../form/form.js"),a=e("../../../core/console/print.coffee"),i=e("../../../object/validate.coffee");t.exports=function(e){var t=e.ui.value&&e.ui.value.length,n=e.ui.position.value;e.dev.value&&t&&a.time("drawing custom UI elements");var l=e.container.value.selectAll("div#d3po_drawer").data(["d3po_drawer"]);l.enter().append("div").attr("id","d3po_drawer");var s={};e.ui.position.accepted.forEach(function(t){s[t]=t==n?e.margin.bottom+"px":"auto"}),l.style("text-align",e.ui.align.value).style("position","absolute").style("width",e.width.value-2*e.ui.padding+"px").style("height","auto").style(s);var u=l.selectAll("div.d3po_drawer_ui").data(t?e.ui.value:[],function(e){return e.method||!1});u.exit().remove(),u.enter().append("div").attr("class","d3po_drawer_ui").style("display","inline-block"),u.style("padding",e.ui.padding+"px").each(function(t){t.form||(t.form=o().container(d3.select(this)).data({sort:!1}).id("id").text("text"));var n,a;"string"==typeof t.method&&t.method in e?(n=e[t.method].value,a=function(n){n!==e[t.method].value&&e.self[t.method](n).draw()}):(n=t.focus||t.value[0],i(n)&&(n=n[d3.keys(n)[0]]),"function"==typeof t.method&&(a=function(r){r!==n&&(n=r,t.focus=r,t.method(r,e.self))}));var l,s=[];t.label?l=t.label:"string"==typeof t.method&&t.method in e&&(l=e.format.locale.value.method[t.method]||t.method),t.value.forEach(function(t){var n={};i(t)?(n.id=t[d3.keys(t)[0]],n.text=e.format.value(d3.keys(t)[0])):(n.id=t,n.text=e.format.value(t)),s.push(n)});var u=r(e.ui.font);u.align=r(e.font.align),u.secondary=r(u),t.form.data(s).font(u).focus(t.value.length>1&&n).focus({callback:a}).format(e.format.locale.language).format({number:e.format.number.value,text:e.format.text.value}).title(e.format.value(l)).type(t.type||"auto").ui({align:e.ui.align.value,border:e.ui.border,color:{primary:e.ui.color.primary.value,secondary:e.ui.color.secondary.value},padding:e.ui.padding,margin:0}).width(t.width||!1).draw()});var c=l.node().offsetHeight||l.node().getBoundingClientRect().height;c&&(e.margin[n]+=c),e.dev.value&&t&&a.timeEnd("drawing custom UI elements")}},{"../../../core/console/print.coffee":54,"../../../form/form.js":106,"../../../object/validate.coffee":175,"../../../util/copy.coffee":210}],247:[function(e,t,n){var r,o,a,i;r=e("../../../client/pointer.coffee"),o=e("../../../color/lighter.coffee"),a=e("../../../core/console/print.coffee"),i=e("../../../client/css.coffee"),t.exports=function(e){var t,n,l,s,u,c,f,d,p,h,v,g,m,y;return!e.small&&e.history.states.length>0?(e.dev.value&&a.time("drawing back button"),t=e.container.value.selectAll("div#d3po_back_button").data(["d3po_back_button"]).style("position","relative").style("z-index",1900),d=e.title.sub.font.size,n=e.title.sub.font.color,s=e.title.sub.font.family.value,y=e.title.sub.font.weight,f=e.title.sub.padding,v=!1,e.title.sub.value&&["start","left"].indexOf(e.title.sub.font.align)<0?v="sub":e.title.total.value&&["start","left"].indexOf(e.title.total.font.align)<0?v="total":e.title.value&&["start","left"].indexOf(e.title.font.align)<0&&(v="title"),v?(p=function(e){var t;return t=e.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0],t=t.replace(/([^a-z])\s([^a-z])/gi,"$1,$2"),t=t.split(","),t=t[t.length-1],parseFloat(t.substring(0,t.length-1))},g=e.svg.select(".d3po_title."+v),m=p(g)+p(g.select("text"))):(m=e.margin.top-e.title.padding,c=d+2*f,e.margin.top+=c),l=parseFloat(e.container.value.style("padding-top"),10),m+=l,l=parseFloat(e.container.value.style("padding-left"),10),u=e.margin.left+d/2+l,h=function(e){return e.style("position","absolute").style("left",u+"px").style("top",m+"px").style("color",n).style("font-family",s).style("font-weight",y).style("font-size",d+"px")},t.enter().append("div").attr("id","d3po_back_button").style("opacity",0).call(h).html(function(){var t;return i("font-awesome")&&0===e.icon.back.value.indexOf("fa-")?(t="<i class='fa "+e.icon.back.value,t+="' style='margin-top:2px;margin-right:4px;'></i>"):t=e.icon.back.value+" ",t+e.format.value(e.format.locale.value.ui.back)}),t.on(r.over,function(){if(!e.small&&e.history.states.length>0)return d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("color",o(n,.25))}).on(r.out,function(){if(!e.small&&e.history.states.length>0)return d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("color",n)}).on(r.click,function(){return e.history.back()}).transition().duration(e.draw.timing).style("opacity",1).call(h),e.dev.value?a.timeEnd("drawing back button"):void 0):e.container.value.selectAll("div#d3po_back_button").transition().duration(e.draw.timing).style("opacity",0).remove()}},{"../../../client/css.coffee":38,"../../../client/pointer.coffee":40,"../../../color/lighter.coffee":47,"../../../core/console/print.coffee":54}],248:[function(e,t,n){var r=e("../../../array/sort.coffee"),o=e("../../../util/buckets.coffee"),a=e("../../../util/copy.coffee"),i=e("../tooltip/create.js"),l=e("../../../core/data/nest.js"),s=e("../../../util/dataURL.coffee"),u=e("../../../client/pointer.coffee"),c=e("../../../core/fetch/value.coffee"),f=e("../../../core/fetch/color.coffee"),d=e("../../../core/fetch/text.js"),p=e("../../../core/console/print.coffee"),h=e("../../../tooltip/remove.coffee"),v=e("../../../color/text.coffee"),g=e("../../../util/uniques.coffee"),m=e("../../../client/scroll.js"),y=e("../../../string/strip.js"),x=e("../../../textwrap/textwrap.coffee"),b=(e("../../../client/touch.coffee"),e("../../../object/validate.coffee"));t.exports=function(e){function t(t){t.attr("transform",function(t,n){return"translate("+(T+n*(e.ui.padding+_))+","+e.ui.padding+")"})}function n(t){t.attr("width",_).attr("height",_).attr("fill",function(t){d3.select(this.parentNode).select("text").remove();var n=g(t,e.icon.value,c,e,I),r=f(e,t,I);if(e.legend.icons.value&&1===n.length&&"string"==typeof n[0]){n=n[0];var o,a=y(n+"_"+r),i=e.icon.style.value,l=e.defs.selectAll("pattern#"+a).data([a]);o="string"==typeof i?e.icon.style.value:b(i)&&i[I]?i[I]:"default",r="knockout"==o?r:"none",l.select("rect").transition().duration(e.draw.timing).attr("fill",r).attr("width",_).attr("height",_),l.select("image").transition().duration(e.draw.timing).attr("width",_).attr("height",_);var u=l.enter().append("pattern").attr("id",a).attr("width",_).attr("height",_);return u.append("rect").attr("fill",r).attr("stroke","none").attr("width",_).attr("height",_),u.append("image").attr("xlink:href",n).attr("width",_).attr("height",_).each(function(e){0===n.indexOf("/")||n.indexOf(window.location.hostname)>=0?s(n,function(e){l.select("image").attr("xlink:href",e)}):l.select("image").attr("xlink:href",n)}),"url(#"+a+")"}if(e.legend.labels.value){var p;if(p=e.legend.text.value?[c(e,t,e.legend.text.value,R)]:d(e,t,R),1===p.length&&!(p[0]instanceof Array)&&p[0].length){var h=d3.select(this.parentNode).append("text"),m=e.legend.font.size;m instanceof Array||(m=[m]),h.attr("font-size",m[m.length-1]+"px").attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("stroke","none").attr("fill",v(r)).attr("x",0).attr("y",0).each(function(t){x().align("middle").container(d3.select(this)).height(_).padding(e.ui.padding).resize(m.length>1).size(m).text(p[0]).width(_).valign("middle").draw()}),h.select("tspan").empty()&&h.remove()}}return r})}var w=!0,_=0;if(!e.error.internal&&e.color.value&&!e.small&&e.legend.value)if(e.color.valueScale)if(e.color.valueScale){e.dev.value&&p.time("drawing color scale"),e.g.legend.selectAll("g.d3po_color").transition().duration(e.draw.timing).attr("opacity",0).remove();var k=e.color.valueScale.domain(),z=e.color.valueScale.range();k.length<=2&&(k=o(k,6));var M=e.g.legend.selectAll("g.d3po_scale").data(["scale"]);M.enter().append("g").attr("class","d3po_scale").attr("opacity",0);var A=e.container.id+"_legend_heatmap",j=M.selectAll("#"+A).data(["heatmap"]);j.enter().append("linearGradient").attr("id",A).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var E=j.selectAll("stop").data(d3.range(0,z.length));E.enter().append("stop").attr("stop-opacity",1),E.attr("offset",function(e){return Math.round(e/(z.length-1)*100)+"%"}).attr("stop-color",function(e){return z[e]}),E.exit().remove();var S=M.selectAll("rect#gradient").data(["gradient"]);S.enter().append("rect").attr("id","gradient").attr("x",function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.legend.gradient.height).attr("stroke",e.legend.font.color).attr("stroke-width",1).style("fill","url(#"+A+")");var O=M.selectAll("text.d3po_tick").data(d3.range(0,k.length));O.enter().append("text").attr("class","d3po_tick").attr("stroke","none").attr("x",function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",function(t){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding});var N=0;O.order().attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("font-size",e.legend.font.size+"px").style("text-anchor",e.legend.font.align).attr("fill",e.legend.font.color).text(function(t){return e.format.value(k[t],{key:e.color.value,vars:e})}).attr("y",function(t){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding}).each(function(e){var t=Math.ceil(this.getBBox().width);t>N&&(N=t)}),N+=2*e.labels.padding;var F=N*(k.length-1);if(F+N<e.width.value){F+N<e.width.value/2&&(F=e.width.value/2,N=F/k.length,F-=N);var T;T="start"==e.legend.align?e.ui.padding:"end"==e.legend.align?e.width.value-e.ui.padding-F:e.width.value/2-F/2,O.transition().duration(e.draw.timing).attr("x",function(e){return T+N*e}),O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var C=M.selectAll("rect.d3po_tick").data(d3.range(0,k.length));C.enter().append("rect").attr("class","d3po_tick").attr("x",function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),C.transition().duration(e.draw.timing).attr("x",function(e){return T+N*e-(0===e?1:0)}).attr("y",e.ui.padding).attr("width",1).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),C.exit().transition().duration(e.draw.timing).attr("width",0).remove(),S.transition().duration(e.draw.timing).attr("x",function(t){return"middle"==e.legend.align?e.width.value/2-F/2:"end"==e.legend.align?e.width.value-F-e.ui.padding:e.ui.padding}).attr("y",e.ui.padding).attr("width",F).attr("height",e.legend.gradient.height),M.transition().duration(e.draw.timing).attr("opacity",1),e.dev.value&&p.timeEnd("drawing color scale")}else w=!1}else w=!1;else{e.dev.value&&p.time("grouping data by colors");var q;if(e.nodes.value&&e.types[e.type.value].requirements.indexOf("nodes")>=0){if(q=a(e.nodes.restriced||e.nodes.value),e.data.viz.length)for(var P=0;P<q.length;P++){var B=e.data.viz.filter(function(t){return t[e.id.value]===q[P][e.id.value]});B.length&&(q[P]=B[0])}}else q=e.data.viz;q.length&&"key"in q[0]&&"values"in q[0]&&(q=d3.merge(q.map(function(e){return e.values})));var D=function(t){return f(e,t,R)},R=0,I=e.id.value,L=e.id.nesting.indexOf(e.color.value);if(L>=0)R=L,I=e.id.nesting[L];else for(var V=0;V<=e.depth.value;V++){R=V,I=e.id.nesting[V];var U=g(q,function(t){return c(e,t,I)}),Y=g(q,D);if(U.length>=Y.length&&Y.length>1)break}var H=[e.color.value],z=l(e,q,H,!1);e.dev.value&&p.timeEnd("grouping data by color");var X=e.width.value;_=e.legend.size;var F=_*z.length+e.ui.padding*(z.length+1);if(_ instanceof Array){e.dev.value&&p.time("calculating legend size");for(var P=_[1];P>=_[0];P--)if(F=P*z.length+e.ui.padding*(z.length+1),X>=F){_=P;break}e.dev.value&&p.timeEnd("calculating legend size")}else"number"!=typeof _&&!1!==_&&(_=30);if(X<F||1==z.length)w=!1;else{if(F-=2*e.ui.padding,e.dev.value&&p.time("sorting legend"),"function"==typeof e.legend.order.value)z=e.legend.order.value(z);else{var G=e[e.legend.order.value].value,Z=e.color.value;G?"color"!==e.legend.order.value&&(Z=[]):G=e[e.color.value].value,r(z,G,e.legend.order.sort.value,Z,e,R)}e.dev.value&&p.timeEnd("sorting legend"),e.dev.value&&p.time("drawing legend");var T;T="start"==e.legend.align?e.ui.padding:"end"==e.legend.align?X-e.ui.padding-F:X/2-F/2,e.g.legend.selectAll("g.d3po_scale").transition().duration(e.draw.timing).attr("opacity",0).remove();var W={},J=e.g.legend.selectAll("g.d3po_color").data(z,function(t){var n=f(e,t,I);return n in W||(W[n]=-1),++W[n]+"_"+n});J.enter().append("g").attr("class","d3po_color").attr("opacity",0).call(t).append("rect").attr("class","d3po_color").attr("stroke","none").call(n),J.order().transition().duration(e.draw.timing).call(t).attr("opacity",1).selectAll("rect.d3po_color").call(n),J.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.legend.tooltip.value&&J.on(u.over,function(t,n){d3.select(this).style("cursor","pointer");var r,o=this.getBoundingClientRect(),a=o.left+_/2+m.x(),l=o.top+_/2+m.y()+5,s=c(e,t,I),f=e.id.nesting.indexOf(I);r=e.legend.title.value?c(e,t,e.legend.title.value,R):f>=0?d(e,t,f)[0]:e.format.value(c(e,t,e.color.value,I),{key:e.color.value,vars:e,data:t});var p,h;if(e.legend.filters.value&&!(s instanceof Array)){p="<div style='text-align:center;'>";var v=e.format.locale.value;p+="<div class='mute'>"+e.format.value(v.method.mute)+"</div>",p+="<div class='solo'>"+e.format.value(v.method.solo)+"</div>",p+="</div>",h=function(t){
var n={border:"1px solid #ccc",display:"inline-block",margin:"1px 2px",padding:"3px 5px"};t.select(".mute").style(n).on(u.over,function(){d3.select(this).style("cursor","pointer")}).on(u.click,function(){var t=e.id.mute.value;e.history.states.push(function(){e.self.id({mute:t}).draw()}),e.self.id({mute:s}).draw()}),t.select(".solo").style(n).on(u.over,function(){d3.select(this).style("cursor","pointer")}).on(u.click,function(){var t=e.id.solo.value;e.history.states.push(function(){e.self.id({solo:t}).draw()}),e.self.id({solo:s}).draw()})}}i({data:t,html:p,js:h,depth:R,footer:!1,vars:e,x:a,y:l,mouseevents:this,title:r,titleOnly:!e.legend.data.value,offset:.4*_})}).on(u.out,function(t){h(e.type.value)}),e.dev.value&&p.timeEnd("drawing legend")}}else w=!1;if(e.legend.value&&key&&w){if(e.dev.value&&p.time("positioning legend"),_)var Q=_+e.ui.padding;else var K=e.g.legend.node().getBBox(),Q=K.height+K.y;0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding),e.margin.bottom+=Q,e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+(e.height.value-e.margin.bottom)+")"),e.dev.value&&p.timeEnd("positioning legend")}else e.dev.value&&p.time("hiding legend"),e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")"),e.dev.value&&p.timeEnd("hiding legend")}},{"../../../array/sort.coffee":36,"../../../client/pointer.coffee":40,"../../../client/scroll.js":43,"../../../client/touch.coffee":45,"../../../color/text.coffee":52,"../../../core/console/print.coffee":54,"../../../core/data/nest.js":62,"../../../core/fetch/color.coffee":65,"../../../core/fetch/text.js":68,"../../../core/fetch/value.coffee":69,"../../../object/validate.coffee":175,"../../../string/strip.js":178,"../../../textwrap/textwrap.coffee":203,"../../../tooltip/remove.coffee":206,"../../../util/buckets.coffee":207,"../../../util/copy.coffee":210,"../../../util/dataURL.coffee":212,"../../../util/uniques.coffee":213,"../tooltip/create.js":243}],249:[function(e,t,n){var r=(e("../../../client/pointer.coffee"),e("../../../color/text.coffee"));t.exports=function(e,t){function n(t){t.style(a).style("position","absolute").style("background-color",l).style("text-align","center").style("left",function(){return"center"==i?"50%":"0px"}).style("width",function(){return"center"==i?"auto":e.width.value+"px"}).style("margin-left",function(){return"center"==i?-this.offsetWidth/2+"px":"0px"}).style("top",function(){return"center"==i?"50%":"top"==i?"0px":"auto"}).style("bottom",function(){return"bottom"==i?"0px":"auto"}).style("margin-top",function(){if("large"==o){return-(this.offsetHeight||this.getBoundingClientRect().height)/2+"px"}return"0px"})}t=e.messages.value?t:null;var o=e.messages.style.value||(t===e.error.internal?"large":e.messages.style.backup);if("large"===o)var a=e.messages,i="center";else{if(e.footer.value)var a=e.footer;else if(e.title.value)var a=e.title;else if(e.title.sub.value)var a=e.title.sub;else if(e.title.total.value)var a=e.title.total;else var a=e.title.sub;var i=a.position}var a={color:a.font.color,"font-family":a.font.family.value,"font-weight":a.font.weight,"font-size":a.font.size+"px",padding:a.padding+"px"},l=e.messages.background.value;l||"none"!==(l=e.background.value)&&"transparent"!==l||(l=r(a.color)),e.g.message=e.container.value.selectAll("div#d3po_message").data(["message"]),e.g.message.enter().append("div").attr("id","d3po_message").attr("opacity",0).append("div").attr("class","d3po_message_text").style("display","block"),e.g.message.select(".d3po_message_text").text(t||e.g.message.text());navigator.onLine;e.g.message.style("display",t?"inline-block":"none").call(n).style("opacity",t?1:0)}},{"../../../client/pointer.coffee":40,"../../../color/text.coffee":52}],250:[function(e,t,n){var r,o,a,i,l,s,u,c,f;r=e("../../../util/closest.coffee"),o=e("../../../client/css.coffee"),e("../../../font/sizes.coffee"),a=e("../../../client/pointer.coffee"),i=e("../../../color/mix.coffee"),s=e("../../../client/prefix.coffee"),u=e("../../../core/console/print.coffee"),c=e("../../../color/text.coffee"),f=e("../../../core/data/time.coffee"),l=!1,t.exports=function(e){var t,n,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re,oe,ae,ie;if(!e.timeline.value||e.error.internal&&e.data.missing||e.small||!e.data.time||!(e.data.time.values.length>1))return e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")");if(e.dev.value&&u.time("drawing timeline"),H={"font-weight":e.ui.font.weight,"font-family":e.ui.font.family.value,"font-size":e.ui.font.size+"px","text-anchor":"middle"},ie=e.data.time.ticks.map(function(e){return new Date(e)}),J=f(e,{values:ie,style:H}),te=J.values.map(Number),W=J.format,e.time.solo.value.length)for(w=d3.extent(e.time.solo.value),b=_=0,M=w.length;_<M;b=++_)m=w[b],m.constructor!==Date&&(m+="",4===m.length&&parseInt(m)+""===m&&(m+="/01/01"),m=new Date(m),w[b]=m);else w=d3.extent(ie);if(ae=ie.slice(),re=d3.max(J.sizes.map(function(e){return e.height})),k=1+~~d3.max(J.sizes.map(function(e){return e.width})),k+=2*e.ui.padding,K=e.timeline.height.value||re+2*e.ui.padding,ee=k*ie.length,P=K,V=K-2*e.ui.padding>=re,t=e.width.value-2*e.ui.padding,V&&e.timeline.play.value&&(t-=P+e.ui.padding),!V||te.length<ie.length||t<k*te.length){for(S=k,k=(t-k)/ie.length,ee=k*ie.length,$=1,G=1+~~(S/(ee/te.length));G<te.length-1&&(te.length-1)%G!=0;)G++;te=te.filter(function(e,t){return t%G==0})}else $=0,j=new Date(ie[0]),I=e.data.time.stepType,j["set"+I](j["get"+I]()+ie.length),ae.push(j);return D=new Date(w[0]),D=r(ae,D),y=new Date(w[1]),$||y["set"+e.data.time.stepType](y["get"+e.data.time.stepType]()+1),y=r(ae,y),oe=ae.map(Number),E=oe.indexOf(+D),A=oe.indexOf(+y),p=[D,y],R="start"===e.timeline.align?e.ui.padding:"end"===e.timeline.align?e.width.value-e.ui.padding-ee:e.width.value/2-ee/2,V&&e.timeline.play.value&&(R+=(P+e.ui.padding)/2),L=function(){return clearInterval(l),l=!1,N.call(F,"icon")},v=function(){var e,t,n;if(null!==d3.event.sourceEvent){if(l&&L(),p=d.extent(),n=r(ae,p[0]),t=r(ae,p[1]),n===t&&(E=oe.indexOf(+n),n<p[0]||0===E?t=ae[E+1]:n=ae[E-1]),E=oe.indexOf(+n),(A=oe.indexOf(+t))-E>=1)e=[n,t];else if(E+1<=ie.length)e=[n,ae[E+1]];else{for(e=[n],b=1;b<=1;)E+b<=ie.length?e.push(ae[E+b]):e.unshift(ae[E-(E+b-ie.length)]),b++;e=[e[0],e[e.length-1]]}return p=e,U.attr("fill",Y),d3.select(this).call(d.extent(e))}},B=function(){var t;return A-E==ie.length-$?t=[]:(t=oe.filter(function(e,t){return t>=E&&t<A+$}),t=t.map(function(e){return new Date(e)})),q(),e.self.time({solo:t}).draw()},g=function(){var t,n,o,a;if(null!==d3.event.sourceEvent&&(e.time.solo.value.length?(a=d3.extent(e.time.solo.value),o=oe.indexOf(+r(ae,a[0])),n=oe.indexOf(+r(ae,a[1])),t=o!==E||n!==A):t=A-E!=ie.length-$,t))return B()},O=e.g.timeline.selectAll("rect.d3po_timeline_play").data(V&&e.timeline.play.value?[0]:[]),C=function(t){return t.attr("width",P+1).attr("height",K+1).attr("fill",e.ui.color.primary.value).attr("stroke",e.ui.color.primary.value).attr("stroke-width",1).attr("x",R-P-1-e.ui.padding).attr("y",e.ui.padding)},O.enter().append("rect").attr("class","d3po_timeline_play").attr("shape-rendering","crispEdges").attr("opacity",0).call(C),O.transition().duration(e.draw.timing).call(C),O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),N=e.g.timeline.selectAll("text.d3po_timeline_playIcon").data(V&&e.timeline.play.value?[0]:[]),F=function(t,n){var r;return n=e.timeline.play[n],o("font-awesome")?(n=n.awesome,r="FontAwesome"):(n=n.fallback,r="inherit"),t.style("font-family",r).text(n)},T=function(t){var n;return n=K/2+e.ui.padding+1,t.attr("fill",c(e.ui.color.primary.value)).attr("stroke","none").attr(H).attr("x",R-(P-1)/2-e.ui.padding).attr("y",n).attr("dy","0.5ex").call(F,l?"pause":"icon")},N.enter().append("text").attr("class","d3po_timeline_playIcon").call(T).style("pointer-events","none").attr("opacity",0),N.call(T).transition().duration(e.draw.timing).attr("opacity",1),N.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),q=function(){return A-E==ie.length-$?(O.on(a.hover,null).on(a.click,null).transition().duration(e.draw.timing).attr("opacity",.3),N.transition().duration(e.draw.timing).attr("opacity",.3)):(O.on(a.over,function(){return d3.select(this).style("cursor","pointer")}).on(a.out,function(){return d3.select(this).style("cursor","auto")}).on(a.click,function(){return l?L():(N.call(F,"pause"),A===ie.length?(A-=E,E=0):(E++,A++),B(),l=setInterval(function(){return A===ie.length-$?L():(E++,A++,B())},e.timeline.play.timing.value))}).transition().duration(e.draw.timing).attr("opacity",1),N.transition().duration(e.draw.timing).attr("opacity",1))},q(),Y=function(t){var n,r,o;return r=$?t<=p[1]:t<p[1],t>=p[0]&&r?(o=1,n=c(e.ui.color.secondary.value)):(o=.5,n=c(e.ui.color.primary.value)),$&&e.background.value&&"none"!==e.background.value&&(n=d3.rgb(c(e.background.value))),n=d3.rgb(n),"rgba("+n.r+","+n.g+","+n.b+","+o+")"},n=e.g.timeline.selectAll("rect.d3po_timeline_background").data(["background"]),n.enter().append("rect").attr("class","d3po_timeline_background").attr("shape-rendering","crispEdges").attr("width",ee+2).attr("height",K+2).attr("fill",e.ui.color.primary.value).attr("x",R-1).attr("y",e.ui.padding),n.transition().duration(e.draw.timing).attr("width",ee+2).attr("height",K+2).attr("fill",e.ui.color.primary.value).attr("x",R-1).attr("y",e.ui.padding),Z=e.g.timeline.selectAll("g#ticks").data(["ticks"]),Z.enter().append("g").attr("id","ticks").attr("transform","translate("+e.width.value/2+","+e.ui.padding+")"),h=e.g.timeline.selectAll("g#brush").data(["brush"]),h.enter().append("g").attr("id","brush"),z=e.g.timeline.selectAll("g#labels").data(["labels"]),z.enter().append("g").attr("id","labels"),U=z.selectAll("text").data(ie,function(e,t){return t}),U.enter().append("text").attr("stroke","none").attr("y",0).attr("dy","0.5ex").attr("x",0),ne=d3.time.scale().domain(d3.extent(ae)).rangeRound([0,ee]),U.order().attr(H).text(function(e,t){return te.indexOf(+e)>=0?W(e):""}).attr("opacity",function(t,n){return e.data.time.dataSteps.indexOf(n)>=0?1:.4}).attr("fill",Y).attr("transform",function(t,n){var r,o;return r=R+ne(t),$||(r+=k/2),o=K/2+e.ui.padding+1,$&&(o+=K/2+re),"translate("+Math.round(r)+","+Math.round(o)+")"}),U.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),d=d3.svg.brush().x(ne).extent(p).on("brush",v).on("brushend",g),X=e.axes.discrete&&e[e.axes.discrete].value===e.time.value?e[e.axes.discrete].ticks.color:e.x.ticks.color,Z.attr("transform","translate("+R+","+(e.ui.padding+1)+")").transition().duration(e.draw.timing).call(d3.svg.axis().scale(ne).orient("top").ticks(function(){return ae}).tickFormat("").tickSize(-K).tickPadding(0)).selectAll("line").attr("stroke-width",1).attr("shape-rendering","crispEdges").attr("stroke",function(t){return te.indexOf(+t)>=0?X:i(X,e.background.value,.4,1)}),Z.selectAll("path").attr("fill","none"),h.attr("transform","translate("+R+","+(e.ui.padding+1)+")").attr("opacity",1).call(d),U.attr("pointer-events","none"),h.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",K).attr("shape-rendering","crispEdges").on(a.move,function(){var t;return t=e.timeline.hover.value,["grab","grabbing"].indexOf(t)>=0&&(t=s()+t),d3.select(this).style("cursor",t)}),h.selectAll("rect.extent").attr("opacity",.75).attr("height",K).attr("fill",e.ui.color.secondary.value).attr("shape-rendering","crispEdges").on(a.move,function(){var t;return t=e.timeline.hover.value,["grab","grabbing"].indexOf(t)>=0&&(t=s()+t),d3.select(this).style("cursor",t)}),e.timeline.handles.value?(x=h.selectAll("g.resize").selectAll("rect.d3po_handle").data(["d3po_handle"]),x.enter().insert("rect","rect").attr("class","d3po_handle"),x.attr("fill",e.timeline.handles.color).attr("transform",function(t){return"translate("+("resize e"===this.parentNode.className.baseVal?-e.timeline.handles.size:0)+",0)"}).attr("width",e.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",e.timeline.handles.opacity),h.selectAll("g.resize").selectAll("rect").attr("height",K)):h.selectAll("g.resize").remove(),Q=e.g.timeline.node().getBBox(),0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding),e.margin.bottom+=Q.height+Q.y,e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+Math.round(e.height.value-e.margin.bottom-e.ui.padding/2)+")"),e.margin.bottom+=e.ui.padding,e.dev.value?u.time("drawing timeline"):void 0}},{"../../../client/css.coffee":38,"../../../client/pointer.coffee":40,"../../../client/prefix.coffee":41,"../../../color/mix.coffee":48,"../../../color/text.coffee":52,"../../../core/console/print.coffee":54,"../../../core/data/time.coffee":64,"../../../font/sizes.coffee":104,"../../../util/closest.coffee":209}],251:[function(e,t,n){var r=e("../../../client/pointer.coffee"),o=e("../../../core/fetch/value.coffee"),a=e("../../../core/console/print.coffee"),i=e("../../../client/rtl.coffee"),l=e("../../../textwrap/textwrap.coffee");t.exports=function(e){function t(t){t.attr("font-size",function(e){return e.style.font.size}).attr("fill",function(t){return t.link?e.links.font.color:t.style.font.color}).attr("font-family",function(t){return t.link?e.links.font.family.value:t.style.font.family.value}).attr("font-weight",function(t){return t.link?e.links.font.weight:t.style.font.weight}).style("text-decoration",function(t){return t.link?e.links.font.decoration.value:t.style.font.decoration.value}).style("text-transform",function(t){return t.link?e.links.font.transform.value:t.style.font.transform.value})}function n(e){var t=e.style.font.align;return"center"==t?"middle":"left"==t&&!i||"right"==t&&i?"start":"left"==t&&i||"right"==t&&!i?"end":t}var s=e.size.value?e.size.value:"number"===e.color.type&&e.color.value;if(e.data.viz&&e.title.total.value&&!e.small)if(s){e.dev.value&&a.time("calculating total value");var u=e.data.pool;e.focus.value.length&&(u=e.data.viz.filter(function(t){return t[e.id.value]==e.focus.value[0]}));var c,f=e.aggs.value[s]||"sum";if(f.constructor===Function?c=f(u):(u=u.reduce(function(t,n){var r=o(e,n,s);return r instanceof Array?t=t.concat(r):t.push(r),t},[]),c=d3[f](u)),0!==c&&null!==c&&void 0!==c||(c=!1),"number"==typeof c){var d="";if(e.data.mute.length||e.data.solo.length||e.focus.value.length){var p=d3.sum(e.data.value,function(t){if(e.time.solo.value.length>0)var n=e.time.solo.value.indexOf(o(e,t,e.time.value))>=0;else if(e.time.mute.value.length>0)var n=e.time.solo.value.indexOf(o(e,t,e.time.value))<0;else var n=!0;if(n)return o(e,t,s)});if(p>c){var d=c/p*100,h=e.format.value(p,{key:e.size.value,vars:e});d=" ("+e.format.value(d,{key:"share",vars:e})+" of "+h+")"}}c=e.format.value(c,{key:e.size.value,vars:e});var v=e.title.total.value,g=v.prefix||e.format.value(e.format.locale.value.ui.total)+": ";c=g+c,v.suffix&&(c+=v.suffix),c+=d}e.dev.value&&a.timeEnd("calculating total value")}else var c=!1;else var c=!1;var m=[];if(e.footer.value&&m.push({link:e.footer.link,style:e.footer,type:"footer",value:e.footer.value}),!e.small){if(e.title.value){var y=e.title.value;"function"==typeof y&&(y=y(e.self)),m.push({link:e.title.link,style:e.title,type:"title",value:y})}if(e.title.sub.value){var y=e.title.sub.value;"function"==typeof y&&(y=y(e.self)),m.push({link:e.title.sub.link,style:e.title.sub,type:"sub",value:y})}e.title.total.value&&c&&m.push({link:e.title.total.link,style:e.title.total,type:"total",value:c})}e.dev.value&&a.time("drawing titles");var x=e.svg.selectAll("g.d3po_title").data(m,function(e){return e.type}),b=e.title.width||e.width.value-e.margin.left-e.margin.right;x.enter().append("g").attr("class",function(e){return"d3po_title "+e.type}).attr("opacity",0).append("text").attr("stroke","none").call(t),x.each(function(r){var o=d3.select(this).select("text").call(t),a=n(r);l().align(a).container(o).height(e.height.value/2).size(!1).text(r.value).width(b).draw(),r.y=e.margin[r.style.position],e.margin[r.style.position]+=this.getBBox().height+2*r.style.padding}).on(r.over,function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",e.links.hover.color).attr("font-family",e.links.hover.family.value).attr("font-weight",e.links.hover.weight).style("text-decoration",e.links.hover.decoration.value).style("text-transform",e.links.hover.transform.value)}).on(r.out,function(n){n.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","auto").select("text").call(t)}).on(r.click,function(e){if(e.link){var t="/"!=e.link.charAt(0)?"_blank":"_self";window.open(e.link,t)}}).attr("opacity",1).attr("transform",function(t){var r=t.style.position,o="top"==r?0+t.y:e.height.value-t.y;"bottom"==r?o-=this.getBBox().height+t.style.padding:o+=t.style.padding;var a=n(t);if("start"===a)var i=e.margin.left+e.title.padding;else{d3.select(this).select("text").node().getBBox().width;i="middle"===a?e.width.value/2-b/2:e.width.value-b-e.margin.right-e.title.padding}return"translate("+i+","+o+")"}),x.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.margin.top>0&&(e.margin.top+=e.title.padding),e.margin.bottom>0&&(e.margin.bottom+=e.title.padding);var w=e.title.height;w&&e.margin[e.title.position]<w&&(e.margin[e.title.position]=w),e.dev.value&&a.timeEnd("drawing titles")}},{"../../../client/pointer.coffee":40,"../../../client/rtl.coffee":42,"../../../core/console/print.coffee":54,"../../../core/fetch/value.coffee":69,"../../../textwrap/textwrap.coffee":203}],252:[function(e,t,n){var r,o;r=e("./labels.coffee"),o=e("./transform.coffee"),t.exports=function(e,t,n){var a,i,l,s,u,c,f,d,p;return t||(t=e.zoom.bounds),"number"!=typeof n&&(n=e.timing.transitions),e.zoom.size={height:t[1][1]-t[0][1],width:t[1][0]-t[0][0]},p=e.types[e.type.value],l=e.coords.fit.value,a="auto"===l||p.requirements.indexOf("coords")<0?d3.max([e.zoom.size.width/e.width.viz,e.zoom.size.height/e.height.viz]):e.zoom.size[l]/e["app_"+l],u=d3.min([e.width.viz,e.height.viz]),c=p.zoom?2*e.coords.padding:0,f=(u-c)/u/a,i=e.zoom.behavior.scaleExtent(),i[0]!==i[1]&&t!==e.zoom.bounds||e.zoom.behavior.scaleExtent([f,16*f]),s=e.zoom.behavior.scaleExtent()[1],f>s&&(f=s),e.zoom.scale=f,d=[e.width.viz/2-e.zoom.size.width*f/2-t[0][0]*f,e.height.viz/2-e.zoom.size.height*f/2-t[0][1]*f],e.zoom.translate=d,e.zoom.behavior.translate(d).scale(f),e.zoom.size={height:e.zoom.bounds[1][1]-e.zoom.bounds[0][1],width:e.zoom.bounds[1][0]-e.zoom.bounds[0][0]},e.zoom.reset=!1,(e.labels.value||e.labels.changed)&&r(e),o(e,n)}},{"./labels.coffee":254,"./transform.coffee":257}],253:[function(e,t,n){t.exports=function(e,t){var n,r,o;return r=t.id.nesting.length-1,n=t.depth.value,o=t.id.nesting[n+1],!1===t.types[t.type.value].nesting?0:(e.d3po.merged||o in e&&n<r)&&(!e||o in e)?1:!(n===r&&n>0||e&&o&&!(o in e))||!t.small&&t.tooltip.html.value?0:-1}},{}],254:[function(e,t,n){var r;r=e("../../../core/console/print.coffee"),t.exports=function(e){var t,n;if(e.dev.value&&r.time("determining label visibility"),n=e.zoom.behavior.scaleExtent(),t=function(t){return t.attr("opacity",function(t){var r;return t||(t={}),r=parseFloat(d3.select(this).attr("font-size"),10),t.visible=r*(e.zoom.scale/n[1])>=2,t.visible?1:0})},e.draw.timing?e.g.viz.selectAll("text.d3po_label").transition().duration(e.draw.timing).call(t):e.g.viz.selectAll("text.d3po_label").call(t),e.dev.value)return r.timeEnd("determining label visibility")}},{"../../../core/console/print.coffee":54}],255:[function(e,t,n){var r,o,a;r=e("./labels.coffee"),o=e("../../../tooltip/remove.coffee"),a=e("./transform.coffee"),t.exports=function(e){var t,n,i,l,s,u,c,f,d,p,h;return n=d3.event.sourceEvent?d3.event.sourceEvent.type:null,s=d3.event.translate,l=d3.event.scale,i=e.zoom.bounds,f=(e.width.viz-e.zoom.size.width*l)/2,c=f>0?f:0,u=f>0?e.width.viz-f:e.width.viz,h=(e.height.viz-e.zoom.size.height*l)/2,p=h>0?h:0,d=h>0?e.height.viz-h:e.height.viz,s[0]+i[0][0]*l>c?s[0]=-i[0][0]*l+c:s[0]+i[1][0]*l<u&&(s[0]=u-i[1][0]*l),s[1]+i[0][1]*l>p?s[1]=-i[0][1]*l+p:s[1]+i[1][1]*l<d&&(s[1]=d-i[1][1]*l),e.zoom.behavior.translate(s).scale(l),e.zoom.translate=s,e.zoom.scale=l,"wheel"===n&&o(e.type.value),(e.labels.value||e.labels.changed)&&("wheel"===n?(t=e.draw.timing?100:250,clearTimeout(e.zoom.wheel),e.zoom.wheel=setTimeout(function(){return r(e)},t)):r(e)),"dblclick"===n?a(e,e.timing.transitions):a(e,0)}},{"../../../tooltip/remove.coffee":206,"./labels.coffee":254,"./transform.coffee":257}],256:[function(e,t,n){t.exports=function(e,t){var n,r,o,a;r=e.zoom,t||(t=d3.event),a=r.scale>r.behavior.scaleExtent()[0],n=e.types[e.type.value].zoom&&r.value&&r.scroll.value,(o=t.touches&&t.touches.length>1&&n)||a||t.stopPropagation()}},{}],257:[function(e,t,n){t.exports=function(e,t){var n;return"number"!=typeof t&&(t=e.timing.transitions),n="translate("+e.zoom.translate+")",n+="scale("+e.zoom.scale+")",t?e.g.viz.transition().duration(t).attr("transform",n):e.g.viz.attr("transform",n)}},{}],258:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:"active_var",mute:r(!0),solo:r(!0),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:!1},value:!1}},{"../../core/methods/filter.coffee":83}],259:[function(e,t,n){t.exports={accepted:[Object],deprecated:"nesting_aggs",objectAccess:!1,value:{}}},{}],260:[function(e,t,n){var r;r=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Object,String],delimiter:{accepted:String,value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},keys:{},process:r,value:!1}},{"../../core/methods/process/data.coffee":89}],261:[function(e,t,n){var r,o;r=e("../../core/methods/process/margin.coffee"),o=e("../../core/methods/rendering.coffee"),t.exports={background:{color:"#fafafa",rendering:o(),stroke:{color:"#ccc",width:1}},margin:{accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),t=e,r(e,this),t},value:10},mirror:{accepted:[Boolean],deprecates:["mirror_axis","mirror_axes"],value:!1},ticks:{accepted:[Boolean],value:!0}}},{"../../core/methods/process/margin.coffee":92,"../../core/methods/rendering.coffee":94}],262:[function(e,t,n){t.exports={accepted:[String],value:"#ffffff"}},{}],263:[function(e,t,n){t.exports={accepted:[Function,String],value:!1}},{}],264:[function(e,t,n){var r,o;r=e("../../core/methods/filter.coffee"),o=e("../../color/scale.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],deprecates:"color_var",domain:{accepted:[!1,Array],value:!1},focus:"#444444",heatmap:["#282F6B","#419391","#AFD5E8","#EACE3F","#B35C1E","#B22200"],missing:"#eeeeee",mute:r(!0),primary:"#d74b03",range:["#B22200","#FFEE8D","#759143"],scale:{accepted:[Array,Function,"d3po","category10","category20","category20b","category20c"],process:function(e){return e instanceof Array?d3.scale.ordinal().range(e):"d3po"===e?o:"string"==typeof e?d3.scale[e]():e},value:"d3po"},solo:r(!0),secondary:"#e5b3bb",value:!1}},{"../../color/scale.coffee":50,"../../core/methods/filter.coffee":83}],265:[function(e,t,n){t.exports={accepted:[Array,Function,String],index:{accepted:[Boolean],value:!0},process:function(e,t){return"string"==typeof e&&(e=[e]),e},value:!1}},{}],266:[function(e,t,n){arguments[4][110][0].apply(n,arguments)},{dup:110}],267:[function(e,t,n){var r;r=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],id:"default",process:function(e,t){return!1!==e&&("default"===t.container.id&&t.self.container({id:"d3po_"+ +new Date}),r(e)?e.append("div"):e instanceof Array?d3.select(e[0][0]).append("div"):(this.selector=e,d3.select(e).append("div")))},value:!1}},{"../../util/d3selection.coffee":211}],268:[function(e,t,n){var r,o;r=e("../../core/methods/filter.coffee"),o=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],center:[0,0],filetype:{accepted:["json"],value:"json"},fit:{accepted:["auto","height","width"],value:"auto"},key:!1,mute:r(!1),padding:20,process:o,projection:{accepted:["albers","albersUsa","azimuthalEqualArea","azimuthalEquidistant","conicConformal","conicEqualArea","conicEquidistant","equirectangular","gnomonic","mercator","orthographic","stereographic","transverseMercator",Function],value:"mercator"},simplify:{accepted:[Boolean],value:!0},solo:r(!1),threshold:{accepted:[Number],value:.9},value:!1}},{"../../core/methods/filter.coffee":83,"../../core/methods/process/data.coffee":89}],269:[function(e,t,n){var r,o,a;r=e("../../core/fetch/value.coffee"),o=e("../../client/ie.js"),a=e("../../string/strip.js"),t.exports={accepted:[void 0,!0,Array,String],chainable:!1,data:[],process:function(e,t){var n,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I;if(void 0===t.returned)return[];if(e=e||t.cols.value,e instanceof Array?s=e:"string"==typeof e&&(s=[e]),c=[],R=[],t.title.value?(D=t.title.value,"function"==typeof D&&(D=D(t.self)),D=a(D),E=250,D=D.substr(0,E)):D="d3po Visualization Data",!0===e)for(s=d3.keys(t.data.keys),c.push(s),C=t.data.value,v=0,y=C.length;v<y;v++){for(f=C[v],B=[],g=0,x=s.length;g<x;g++)i=s[g],I=f[i],"string"===t.data.keys[i]&&(I='"'+I+'"'),B.push(I);c.push(B)}else{for(s||(s=[t.id.value],t.time.value&&s.push(t.time.value),t.size.value&&s.push(t.size.value),t.text.value&&s.push(t.text.value)),m=0,b=s.length;m<b;m++)i=s[m],R.push(t.format.value(i));for(c.push(R),q=t.returned.nodes,j=0,w=q.length;j<w;j++)if(O=q[j],null!=O.values&&O.values instanceof Array)for(P=O.values,S=0,_=P.length;S<_;S++){for(I=P[S],B=[],N=0,k=s.length;N<k;N++)l=s[N],I=r(t,I,l),"string"==typeof I&&(I='"'+I+'"'),B.push(I);c.push(B)}else{for(B=[],F=0,z=s.length;F<z;F++)l=s[F],B.push(r(t,O,l));c.push(B)}}for(u="data:text/csv;charset=utf-8,",h=T=0,M=c.length;T<M;h=++T)i=c[h],d=i.join(","),u+=h<c.length?d+"\n":d;return o?(n=new Blob([u],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob(n,D+".csv")):(p=encodeURI(u),A=document.createElement("a"),A.setAttribute("href",p),A.setAttribute("download",D+".csv"),A.click()),this.data=c,s},value:void 0}},{"../../client/ie.js":39,"../../core/fetch/value.coffee":69,"../../string/strip.js":178}],270:[function(e,t,n){var r;r=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},donut:{size:.35},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],keys:{},mute:[],large:400,opacity:.9,padding:{accepted:[Number],value:1},process:function(e,t){return r(e,t,this)},solo:[],stroke:{width:1},value:!1}},{"../../core/methods/process/data.coffee":89}],271:[function(e,t,n){t.exports={accepted:[Function,Number],value:0}},{}],272:[function(e,t,n){t.exports={accepted:[!1,Function,Object],value:!1}},{}],273:[function(e,t,n){arguments[4][114][0].apply(n,arguments)},{dup:114}],274:[function(e,t,n){var r=e("../../core/console/print.coffee"),o=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var n=t.format.locale.value.dev.setContainer;r.warning(n,"container")}else if(t.container.value.empty()){var n=t.format.locale.value.dev.noContainer,a=t.container.selector||"";r.warning(o(n,'"'+a+'"'),"container")}else t.dev.value&&r.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var i={};t.history.chain.forEach(function(e){var t=e.method;delete e.method,i[t]=e}),e(i),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.coffee":54,"../../string/format.js":176}],275:[function(e,t,n){var r=e("../../core/methods/process/data.coffee");t.exports={accepted:[!1,Array,Function,String],arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",connections:function(e,t,n){var r=this;if(!r.value)return[];if(!t)var t="id";var o=r.restricted||r.value,a=[];if(!e)return o;var i=o.filter(function(o){var i=!1;return o[r.source][t]==e?(i=!0,n&&a.push(o[r.target])):o[r.target][t]==e&&(i=!0,n&&a.push(o[r.source])),i});return n?a:i},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,large:100,limit:{accepted:[!1,Function,Number],value:!1},opacity:{accepted:[Function,Number,String],min:{accepted:[Number],value:.25},scale:{accepted:[Function],value:d3.scale.linear()},value:1},process:r,size:{accepted:[!1,Number,String],min:1,scale:.5,value:!1},source:"source",strength:{accepted:[!1,Function,Number,String],value:!1},target:"target",value:!1}},{"../../core/methods/process/data.coffee":89}],276:[function(e,t,n){t.exports={accepted:[Boolean,String],value:!1}},{}],277:[function(e,t,n){t.exports={accepted:[!1,Array,Function,Number,String],deprecates:"highlight",process:function(e){return!1===e?[]:e instanceof Array?e:[e]},tooltip:{accepted:[Boolean],value:!0},value:[]}},{}],278:[function(e,t,n){var r,o,a,i;r=e("../../core/methods/font/align.coffee"),o=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={align:r(),color:"#444444",decoration:o(),family:a(),secondary:{align:r(),color:"#444444",decoration:o(),family:a(),size:12,spacing:0,transform:i(),weight:400},size:12,spacing:0,transform:i(),weight:400}},{"../../core/methods/font/align.coffee":84,"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],279:[function(e,t,n){var r,o,a;o=e("../../core/methods/font/family.coffee"),r=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[!1,Number,String],font:{align:"center",color:"#444",decoration:r(),family:o(),size:11,transform:a(),weight:400},link:!1,padding:0,position:"bottom",value:!1}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],280:[function(e,t,n){var r,o,a,i;r=e("../../number/format.coffee"),o=e("../../core/locale/locale.coffee"),a=e("../../object/merge.coffee"),i=e("../../string/title.coffee"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(o)},process:function(e){var t,n;return t="en_US",n=o[t],e!==t&&(n=a(n,o[e])),this.language=e,n},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var n,o;return t||(t={}),t.locale||(t.locale=this.locale.value),o=t.vars||{},o.time&&o.time.value&&t.key===o.time.value?(n=e.constructor===Date?e:new Date(e),o.data.time.format(n)):"number"==typeof e?(this.number.value||r)(e,t):"string"==typeof e?(this.text.value||i)(e,t):JSON.stringify(e)}}},{"../../core/locale/locale.coffee":81,"../../number/format.coffee":173,"../../object/merge.coffee":174,"../../string/title.coffee":179}],281:[function(e,t,n){t.exports={accepted:[!1,Number],max:600,secondary:!1,small:200,value:!1}},{}],282:[function(e,t,n){var r,o,a,i,l,s,u,c;r=e("../../../core/methods/font/align.coffee"),o=e("../../../core/methods/font/decoration.coffee"),a=e("../../../core/methods/font/family.coffee"),i=e("../../../core/methods/filter.coffee"),s=e("../../../core/methods/font/position.coffee"),u=e("../../../core/methods/rendering.coffee"),c=e("../../../core/methods/font/transform.coffee"),l={x:"bottom",x2:"top",y:"left",
y2:"right"},t.exports=function(e){return{accepted:[Array,Boolean,Function,Object,String],affixes:{accepted:[Boolean],separator:{accepted:[Boolean,Array],value:!0},value:!1},axis:{accepted:[Boolean],color:"#444",font:{color:!1,decoration:o(!1),family:a(""),size:!1,spacing:0,transform:c(!1),weight:!1},rendering:u(),value:!0},dataFilter:!0,deprecates:[e+"axis",e+"axis_val",e+"axis_var"],domain:{accepted:[!1,Array],value:!1},grid:{accepted:[Boolean],color:"#ccc",rendering:u(),value:!0},label:{accepted:[Boolean,String],fetch:function(t){return!0===this.value?t.format.value(t[e].value,{key:e,vars:t}):this.value},font:{color:"#444",decoration:o(),family:a(),size:12,spacing:0,transform:c(),weight:400},padding:3,value:!0},lines:{accept:[!1,Array,Number,Object],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=e.filter(function(e){return!isNaN(e)}),e=e.length?e.join(", "):"none"),e},value:"10, 10"},color:"#888",font:{align:r("right"),color:"#444",background:{accepted:[Boolean],value:!0},decoration:o(),family:a(),padding:{accepted:[Number],value:10},position:s("middle"),size:12,transform:c(),weight:400},process:Array,rendering:u(),width:1,value:[]},mouse:{accept:[Boolean],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=e.filter(function(e){return!isNaN(e)}),e=e.length?e.join(", "):"none"),e},value:"none"},rendering:u(),width:2,value:!0},mute:i(!0),orient:{accepted:["top","right","bottom","left"],value:l[e]},padding:{accepted:[Number],value:.1},persist:{position:{accepted:[Boolean],value:!1},size:{accepted:[Boolean],value:!0}},range:{accepted:[!1,Array],value:!1},scale:{accepted:["linear","log","discrete","share"],deprecates:["layout","unique_axis",e+"axis_scale"],process:function(t,n){var r,o,a,i;for(a=["log","discrete","share"],r=0,o=a.length;r<o;r++)i=a[r],i===t?n.axes[i]=e:n.axes[i]===e&&(n.axes[i]=!1);return"discrete"===t&&(n.axes.opposite=0===e.indexOf("x")?"y":"x"),t},value:"linear"},solo:i(!0),stacked:{accepted:[Boolean],process:function(t,n){return t||n.axes.stacked!==e?t&&(n.axes.stacked=e):n.axes.stacked=!1,t},value:!1},ticks:{accepted:[!1,Array],color:"#ccc",font:{color:"#666",decoration:o(),family:a(),size:10,spacing:0,transform:c(),weight:400},labels:{accepted:[Boolean,Array],value:!0},rendering:u(),size:10,width:1,value:!1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}},{"../../../core/methods/filter.coffee":83,"../../../core/methods/font/align.coffee":84,"../../../core/methods/font/decoration.coffee":85,"../../../core/methods/font/family.coffee":86,"../../../core/methods/font/position.coffee":87,"../../../core/methods/font/transform.coffee":88,"../../../core/methods/rendering.coffee":94}],283:[function(e,t,n){t.exports={accepted:[Boolean],back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[],value:!0}},{}],284:[function(e,t,n){var r;r=e("../../core/methods/process/icon.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:r,rotate:0,value:"fa-angle-left"},deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:!1}},{"../../core/methods/process/icon.coffee":91}],285:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,String],dataFilter:!0,deprecates:["id_var","nesting"],grouping:{accepted:[Boolean],value:!0},mute:r(!0),nesting:["id"],solo:r(!0),value:"id"}},{"../../core/methods/filter.coffee":83}],286:[function(e,t,n){var r,o,a;r=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),a=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean],align:{accepted:["start","middle","end","left","center","right"],process:function(e){var t;return t=["left","center","right"].indexOf(e),t>=0&&(e=this.accepted[t]),e},value:"middle"},color:{accepted:[!1,String],value:!1},font:{decoration:r(),family:o(),size:11,transform:a(),weight:400},padding:7,resize:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},segments:2,valign:{accepted:[!1,"top","middle","bottom"],value:"middle"},value:!0}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],287:[function(e,t,n){var r;r=e("../../core/methods/font/family.coffee"),t.exports={accepted:[Boolean],align:"middle",data:{accepted:[Boolean],value:!0},filters:{accepted:[Boolean],value:!1},font:{align:"middle",color:"#444444",family:r(),size:[8,14],weight:400},gradient:{height:10},icons:{accepted:[Boolean],value:!0},labels:{accepted:[Boolean],value:!0},order:{accepted:["color","id","size","text",Function],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30],tooltip:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},title:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":86}],288:[function(e,t,n){var r,o,a;r=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),a=e("../../core/methods/font/transform.coffee"),t.exports={font:{color:"#444444",decoration:r(),family:o(),transform:a(),weight:400},hover:{color:"#444444",decoration:r(),family:o(),transform:a(),weight:400}}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],289:[function(e,t,n){arguments[4][125][0].apply(n,arguments)},{"../../core/methods/process/margin.coffee":92,dup:125}],290:[function(e,t,n){var r,o,a;r=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),a=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean,String],background:{accepted:[!1,String],value:!1},font:{color:"#444",decoration:r(),family:o(),size:16,transform:a(),weight:400},padding:5,style:{accepted:[!1,"small","large"],value:!1},value:!0}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],291:[function(e,t,n){t.exports={accepted:[Boolean],click:{accepted:[Boolean,Function],value:!0},move:{accepted:[Boolean,Function],value:!0},out:{accepted:[Boolean,Function],value:!0},over:{accepted:[Boolean,Function],value:!0},value:!0}},{}],292:[function(e,t,n){var r;r=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},overlap:.6,process:r,value:!1}},{"../../core/methods/process/data.coffee":89}],293:[function(e,t,n){t.exports={accepted:[Boolean,Function,String],agg:{accepted:[!1,Function,"sum","min","max","mean","median"],value:!1},deprecates:["sort"],sort:{accepted:["asc","desc"],value:"desc"},value:!1}},{}],294:[function(e,t,n){t.exports={accepted:[Boolean],value:!1,timeout:400,process:function(e,t){var n,r;return!!e&&(n=null,r=function(){var e,n,r;if(n=t.container.value.node().parentNode.getBoundingClientRect(),r=n.width,e=n.height,t.self.width(r),t.self.height(e),t.width.changed||t.height.changed)return t.self.draw()},d3.select(window).on("resize."+t.container.id,function(e){return function(t){return clearTimeout(n),n=setTimeout(r,e.timeout)}}(this)),e)}}},{}],295:[function(e,t,n){var r;r=e("../../core/methods/rendering.coffee"),t.exports={accepted:function(e){var t;return t=e.types[e.type.value].shapes,!t||t instanceof Array||(t=[t]),t.length?t:["square"]},interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:r(),value:!1}},{"../../core/methods/rendering.coffee":94}],296:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Number,Object,String],dataFilter:!0,deprecates:["value","value_var"],mute:r(!0),scale:{accepted:[Function],deprecates:"size_scale",domain:{min:{accepted:[!1,Number],value:!1},max:{accepted:[!1,Number],value:!1}},range:{max:{accepted:[Function,Number],value:function(e){return Math.floor(d3.max([d3.min([e.width.viz,e.height.viz])/15,6]))}},min:{accepted:[Function,Number],value:3}},value:d3.scale.sqrt()},solo:r(!0),threshold:{accepted:[Boolean,Function,Number],value:!1},value:!1}},{"../../core/methods/filter.coffee":83}],297:[function(e,t,n){t.exports={value:!1}},{}],298:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:["else_var","else"],mute:r(!0),solo:r(!0),value:!1}},{"../../core/methods/filter.coffee":83}],299:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],nesting:!0,mute:r(!0),solo:r(!0),value:!1}},{"../../core/methods/filter.coffee":83}],300:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:!0},format:{accepted:[!1,Array,Function,String],value:!1},mute:r(!1),solo:r(!1),value:!1}},{"../../core/methods/filter.coffee":83}],301:[function(e,t,n){t.exports={accepted:[Boolean],align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#666",opacity:1,size:3,stroke:"#666",value:!0},height:{accepted:[!1,Number],value:!1},play:{accepted:[Boolean],icon:{accepted:[!1,String],awesome:"",fallback:""},pause:{accepted:[!1,String],awesome:"",fallback:""},timing:{accepted:[Number],value:1500},value:!0},value:!0}},{}],302:[function(e,t,n){t.exports={mouseevents:60,transitions:600,ui:200}},{}],303:[function(e,t,n){var r,o,a,i;r=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),a=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:r(),family:o(),size:16,transform:i(),weight:400},height:!1,link:!1,padding:2,position:"top",process:function(e,t){var n;return 0===t.container.id.indexOf("default")&&e&&(n=a(e).toLowerCase(),t.self.container({id:n})),e},sub:{accepted:[!1,Function,String],deprecates:"sub_title",font:{align:"center",color:"#444444",decoration:r(),family:o(),size:12,transform:i(),weight:400},link:!1,padding:1,position:"top",value:!1},total:{accepted:[Boolean,Object],deprecates:"total_bar",font:{align:"center",color:"#444444",decoration:r(),family:o(),size:12,transform:i(),weight:400,value:!1},link:!1,padding:1,position:"top",value:!1},width:!1,value:!1}},{"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88,"../../string/strip.js":178}],304:[function(e,t,n){var r,o;r=e("../../core/methods/font/family.coffee"),o=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean,Array,Function,Object,String],anchor:"top center",background:"#ffffff",children:{accepted:[Boolean,Number],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ffffff",opacity:.8},deprecates:"tooltip_info",extent:{accepted:[Boolean],value:!0},font:{color:"#444",family:r(),size:12,transform:o(),weight:400},fullscreen:{accepted:[Boolean],value:!1},html:{accepted:[!1,Function,Object,String],deprecates:"click_function",value:!1},iqr:{accepted:[Boolean],value:!0},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225,stacked:{accepted:[Boolean],value:!1},sub:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],305:[function(e,t,n){var r;r=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:["total_var"],mute:r(!0),solo:r(!0),value:!1}},{"../../core/methods/filter.coffee":83}],306:[function(e,t,n){t.exports={accepted:function(e){return d3.keys(e.types)},mode:{accepted:function(e){return e.types[e.type.value].modes||[!1]},value:!1},value:"tree_map"}},{}],307:[function(e,t,n){var r,o,a,i;a=e("../../core/methods/font/family.coffee"),r=e("../../core/methods/font/align.coffee"),o=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Array,Boolean],align:r("center"),border:1,color:{primary:{process:function(e,t){var n;return n=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(n).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:o(),family:a(),size:11,transform:i(),weight:400},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"},value:!1}},{"../../core/methods/font/align.coffee":84,"../../core/methods/font/decoration.coffee":85,"../../core/methods/font/family.coffee":86,"../../core/methods/font/transform.coffee":88}],308:[function(e,t,n){t.exports={accepted:[!1,Number],secondary:!1,small:200,value:!1}},{}],309:[function(e,t,n){t.exports={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]).duration(0),click:{accepted:[Boolean],value:!0},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],deprecates:"scroll_zoom",value:!0},value:!0}},{}],310:[function(e,t,n){var r,o,a,i,l,s,u;e("../../util/closest.coffee"),o=e("../../core/fetch/value.coffee"),a=e("./helpers/graph/draw.coffee"),i=e("./helpers/graph/nest.coffee"),l=e("../../array/sort.coffee"),s=e("./helpers/graph/stack.coffee"),u=e("../../core/data/threshold.js"),r=function(e){var t,n,r,i,u,c,f,d,p,h,v;if(a(e,{buffer:e.axes.opposite,zero:!0}),i=e.x.domain.viz.concat(e.y.domain.viz),i.indexOf(void 0)>=0)return[];for(n=l(e.data.viz,null,null,null,e),r=e[e.axes.discrete],p=e[e.axes.opposite],u=0,f=n.length;u<f;u++)for(h=n[u],h.d3po||(h.d3po={}),v=h.values,c=0,d=v.length;c<d;c++)t=v[c],t.d3po||(t.d3po={}),t.d3po.x=r.scale.viz(o(e,t,r.value)),t.d3po.x+=e.axes.margin.viz.left,t.d3po.y=p.scale.viz(o(e,t,p.value)),t.d3po.y+=e.axes.margin.viz.top,t.d3po.merged instanceof Array&&(h.d3po.merged||(h.d3po.merged=[]),h.d3po.merged=h.d3po.merged.concat(t.d3po.merged)),t.d3po.text&&!h.d3po.text&&(h.d3po.text=t.d3po.text);return s(e,n)},r.filter=function(e,t){return i(e,u(e,t,e[e.axes.discrete].value))},r.requirements=["data","x","y"],r.setup=function(e){var t,n,r;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),e[e.axes.discrete].zerofill.value||e.self[e.axes.discrete]({zerofill:!0}),e[e.axes.opposite].stacked.value||"stacked"!==e.type.value||e.self[e.axes.opposite]({stacked:!0}),r=e[e.axes.opposite],n=e.size,!r.value&&n.value||n.changed&&n.previous===r.value?e.self[e.axes.opposite](n.value):!n.value&&r.value||r.changed&&r.previous===n.value?e.self.size(r.value):void 0},r.shapes=["area"],r.threshold=function(e){return 20/e.height.viz},r.tooltip="static",t.exports=r},{"../../array/sort.coffee":36,"../../core/data/threshold.js":63,"../../core/fetch/value.coffee":69,"../../util/closest.coffee":209,"./helpers/graph/draw.coffee":317,"./helpers/graph/nest.coffee":323,"./helpers/graph/stack.coffee":324}],311:[function(e,t,n){var r,o,a,i,l,s,u,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=e("../../util/buckets.coffee"),a=e("../../core/fetch/value.coffee"),i=e("./helpers/graph/draw.coffee"),l=e("./helpers/graph/nest.coffee"),s=e("./helpers/graph/stack.coffee"),u=e("../../util/uniques.coffee"),r=function(e){var t,n,r,l,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X;if(d=e.axes.discrete,g="x"===d?"height":"width",Y="x"===d?"width":"height",P=e.axes.opposite,r="x"===d?"left":"top",N="x"===d?"top":"left",i(e,{buffer:!0,zero:P}),v=e.x.domain.viz.concat(e.y.domain.viz),v.indexOf(void 0)>=0)return[];if(S=e.data.viz,e.axes.stacked)for(x=0,_=S.length;x<_;x++)R=S[x],s(e,R.values);for(V=e.axes[Y]/e[e.axes.discrete].ticks.values.length,D=e[e.axes.discrete].padding.value,D<1&&(D*=V),2*D>V&&(D=.1*V),j=V-2*D,e.axes.stacked||(e[d].persist.position.value?(I=e[d].value,h=c.call(e.id.nesting,I)>=0?d3.max(S,function(e){return e.values.length}):u(S,e.id.value,a,e).length,j/=h,F=V/2-j/2-D,H=d3.scale.ordinal(),1===h?H.domain([0]).range([0]):H.domain([0,h-1]).range([-F,F])):H=d3.scale.linear()),f=[],C=e[P],T=C.scale.viz.domain().slice(),0===P.indexOf("y")&&(T=T.reverse()),T[0]<=0&&T[1]>=0?X=0:T[0]<0?X(d3.max(T)):X=d3.min(T),e[d].persist.position.value&&!e.axes.stacked&&(y=u(d3.merge(S.map(function(e){return e.values})),e.id.value,a,e,e.id.value,!1),H.domain(y),1===y.length?H.range([0]):H.range(o(H.range(),y.length))),A=d3.max(S,function(e){return e.values.length}),b=0,k=S.length;b<k;b++)for(B=S[b],e.axes.stacked?(t=1,O=j):e[d].persist.position.value?(t=h,O=j):(t=B.values.length,e[d].persist.size.value?(O=j/A,F=V/2-O/2*(A-t)-O/2-D):(O=j/t,F=V/2-O/2-D),H.domain([0,t-1]),H.range([-F,F])),L=B.values,m=w=0,z=L.length;w<z;m=++w){if(l=L[m],E=e.axes.stacked?0:H(e[d].persist.position.value?a(e,l,e.id.value):m%t),e.axes.stacked)U=l.d3po[P],n=l.d3po[P+"0"];else{if(q=a(e,l,C.value),null===q&&(C=e[P+"2"],q=a(e,l,C.value)),0===q)continue;"log"===C.scale.value&&(X=q<0?-1:1),U=C.scale.viz(q),n=C.scale.viz(X)}p=a(e,l,e[d].value),l.d3po[d]=e[d].scale.viz(p),l.d3po[d]+=e.axes.margin.viz[r]+E,M=n-U,l.d3po[P]=n-M/2,e.axes.stacked||(l.d3po[P]+=e.axes.margin.viz[N]),delete l.d3po.r,l.d3po[Y]=O,l.d3po[g]=Math.abs(M),l.d3po.init={},l.d3po.init[P]=C.scale.viz(X),l.d3po.init[P]-=l.d3po[P],l.d3po.init[P]+=e.axes.margin.viz[N],l.d3po.init[Y]=l.d3po[Y],e.text.value?delete l.d3po.label:l.d3po.label=!1,f.push(l)}return f},r.filter=function(e,t){return l(e,t,e[e.axes.discrete].value)},r.requirements=["data","x","y"],r.setup=function(e){var t,n,r;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),r=e[e.axes.opposite],n=e.size,!r.value&&n.value||n.changed&&n.previous===r.value?e.self[e.axes.opposite](n.value):!n.value&&r.value||r.changed&&r.previous===n.value?e.self.size(r.value):void 0},r.shapes=["square"],t.exports=r},{"../../core/fetch/value.coffee":69,"../../util/buckets.coffee":207,"../../util/uniques.coffee":213,"./helpers/graph/draw.coffee":317,"./helpers/graph/nest.coffee":323,"./helpers/graph/stack.coffee":324}],312:[function(e,t,n){var r,o,a,i,l,s;o=e("../../core/fetch/value.coffee"),a=e("./helpers/graph/draw.coffee"),i=e("../../string/format.js"),l=e("../../string/strip.js"),s=e("../../util/uniques.coffee"),r=function(e){var t,n,r,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E;return a(e,{buffer:!0}),u=e.x.domain.viz.concat(e.y.domain.viz),u.indexOf(void 0)>=0?[]:(r=e.axes.discrete,b=e.axes.opposite,n="x"===r?e.axes.margin.viz.left:e.axes.margin.viz.top,x="x"===b?e.axes.margin.viz.left:e.axes.margin.viz.top,c="x"===r?"height":"width",E="x"===r?"width":"height",A=e.axes[E]/e[r].ticks.values.length,M=e.size.value,M="number"==typeof M?M:100,A=d3.min([A-2*e.labels.padding,M]),m=e.type.mode.value,m instanceof Array||(m=[m,m]),v=function(t){var n,r,a;r={};for(n in e.data.keys)a=s(t,n,o,e),r[n]=1===a.length?a[0]:a;return r},y=!1,p=[],f=e.format.value(e.format.locale.value.ui.iqr),d=e.format.value(e.format.locale.value.ui.max),g=e.format.value(e.format.locale.value.ui.min),w=e.format.value(e.format.locale.value.ui.percentile),t=e.format.value(e.format.locale.value.ui.tukey_bottom),j=e.format.value(e.format.locale.value.ui.tukey_top),_=e.format.value(e.format.locale.value.ui.quartile_first),k=e.format.value(e.format.locale.value.ui.quartile_third),h=e.format.value(e.format.locale.value.ui.median),z=[],d3.nest().key(function(t){return o(e,t,e[r].value)}).rollup(function(a){var u,M,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re;for(Z=e[b].scale.viz,te=a.map(function(t){return o(e,t,e[b].value)}),te.sort(function(e,t){return e-t}),s(te),C=d3.quantile(te,.25),V=d3.quantile(te,.5),W=d3.quantile(te,.75),J={},"tukey"===m[1]?(P=C-W,Q=W-1.5*P,K=j):"extent"===m[1]?(Q=d3.max(te),K=d):"number"==typeof m[1]&&(Q=d3.quantile(te,(100-m[1])/100),K=i(w,m[1])),Q=d3.min([d3.max(te),Q]),e.tooltip.extent.value&&(J[K]={key:e[b].value,value:Q}),e.tooltip.iqr.value&&(J[k]={key:e[b].value,value:W},J[h]={key:e[b].value,value:V},J[_]={key:e[b].value,value:C}),"tukey"===m[0]?(P=C-W,u=C+1.5*P,M=t):"extent"===m[0]?(u=d3.min(te),M=g):"number"==typeof m[0]&&(u=d3.quantile(te,m[0]/100),K=i(w,m[0])),u=d3.max([d3.min(te),u]),e.tooltip.extent.value&&(J[M]={key:e[b].value,value:u}),O=[],S=[],$=[],G=[],q=0,I=a.length;q<I;q++)N=a[q],ee=o(e,N,e[b].value),ee>=C&&ee<=W?O.push(N):ee>=u&&ee<C?S.push(N):ee<=Q&&ee>W?$.push(N):G.push(N);for(D=o(e,a[0],e[r].value),ne=e[r].scale.viz(D),ne+=n,R=e.format.value(D,{key:e[r].value,vars:e}),D.constructor===Date&&(D=D.getTime()),D=l(D),O=v(O),O.d3po={color:"white",id:"box_"+D,init:{},label:!1,shape:"square",stroke:"#444",text:i(f,R)},O.d3po[E]=A,O.d3po.init[E]=A,O.d3po[c]=Math.abs(Z(C)-Z(W)),O.d3po[r]=ne,re=d3.min([Z(C),Z(W)])+O.d3po[c]/2,re+=x,O.d3po[b]=re,O.d3po.tooltip=J,z.push(O),Y={d3po:{id:"median_line_"+D,position:"height"===c?"top":"right",shape:"whisker",static:!0}},X=e.format.value(V,{key:e[b].value,vars:e}),R={background:"#fff",names:[X],padding:0,resize:!1,x:0,y:0},F=Math.abs(Z(V)-Z(C)),T=Math.abs(Z(V)-Z(W)),H=2*d3.min([F,T]),U=2*e.data.stroke.width+2*e.labels.padding,R["width"===E?"w":"h"]=A-U,R["width"===c?"w":"h"]=H-U,Y.d3po.label=R,Y.d3po[E]=A,Y.d3po[r]=ne,Y.d3po[b]=Z(V)+x,z.push(Y),S=v(S),S.d3po={id:"bottom_whisker_line_"+D,offset:O.d3po[c]/2,position:"height"===c?"bottom":"left",shape:"whisker",static:!0},"x"===b&&(S.d3po.offset*=-1),S.d3po[c]=Math.abs(Z(u)-Z(C)),S.d3po[E]=A,S.d3po[r]=ne,S.d3po[b]=re,z.push(S),$=v($),$.d3po={id:"top_whisker_line_"+D,offset:O.d3po[c]/2,position:"height"===c?"top":"right",shape:"whisker",static:!0},"y"===b&&($.d3po.offset*=-1),$.d3po[c]=Math.abs(Z(Q)-Z(W)),$.d3po[E]=A,$.d3po[r]=ne,$.d3po[b]=re,z.push($),B=0,L=G.length;B<L;B++)N=G[B],N.d3po[r]=ne,N.d3po[b]=Z(o(e,N,e.y.value)),N.d3po[b]+=x,N.d3po.r=4,N.d3po.shape=e.shape.value;return y=!G.length&&Q-u==0,p.push(V),z=z.concat(G),a}).entries(e.data.viz),y&&1===s(p).length?[]:z)},r.modes=["tukey","extent",Array,Number],r.requirements=["data","x","y"],r.shapes=["circle","check","cross","diamond","square","triangle","triangle_up","triangle_down"],r.setup=function(e){var t;if(!e.axes.discrete)return t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})},t.exports=r},{"../../core/fetch/value.coffee":69,"../../string/format.js":176,"../../string/strip.js":178,"../../util/uniques.coffee":213,"./helpers/graph/draw.coffee":317}],313:[function(e,t,n){var r,o,a,i,l,s,u;r=e("../../array/sort.coffee"),l=e("../../core/fetch/value.coffee"),a=e("../../core/fetch/color.coffee"),i=e("../../core/fetch/text.js"),u=e("../../color/legible.coffee"),s=e("../../core/data/group.coffee"),o=function(e){var t,n,o,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U;if(m=s(e,e.data.viz),m=r(m,null,null,null,e),d=m.length,d<4?(o=d,O=1):(N=e.width.viz/e.height.viz,o=Math.ceil(Math.sqrt(d*N)),O=Math.ceil(Math.sqrt(d/N))),d>0)for(;(O-1)*o>=d;)O--;for(n=e.width.viz/o,t=e.height.viz/O,e.size.value?(D=e.size.scale.domain.min.value,B=e.size.scale.domain.max.value,v="number"==typeof D?D:d3.min(e.data.viz,function(t){return l(e,t,e.size.value,e.id.value,"min")}),h="number"==typeof B?B:d3.max(e.data.viz,function(t){return l(e,t,e.size.value,e.id.value)}),p=[v,h]):p=[0,0],E=5,T=d3.min([n,t])/2-2*E,_=e.labels.value&&!e.small&&T>=40?d3.max([20,d3.min([.25*T,50])]):0,T-=_,C=d3.min([T,e.size.scale.range.min.value]),F=e.size.scale.value.domain(p).rangeRound([C,T]),j=d3.layout.pack().children(function(e){return e.values}).padding(E).radius(function(e){return F(e)}).size([n-2*E,t-2*E-_]).value(function(e){return e.value}),f=[],S=0,y=x=0,k=m.length;x<k;y=++x){for(c=m[y],P=j.nodes(c),I=n*y%e.width.viz,U=t*S,b=0,z=P.length;b<z;b++)q=P[b],q.children?(A={d3po:{}},A[e.id.value]=q.key):A=q.d3po,A.d3po.depth=e.id.grouping.value?q.depth:e.depth.value,A.d3po.x=q.x,A.d3po.xOffset=I,A.d3po.y=q.y,A.d3po.yOffset=U+_,A.d3po.r=q.r,f.push(A);(y+1)%o==0&&S++}for(g=T/d3.max(f,function(e){return e.d3po.r}),R=j.size()[0]/2,V=j.size()[1]/2,w=0,M=f.length;w<M;w++)c=f[w],c.d3po.x=(c.d3po.x-R)*g+R+c.d3po.xOffset,c.d3po.y=(c.d3po.y-V)*g+V+c.d3po.yOffset,c.d3po.r=c.d3po.r*g,delete c.d3po.xOffset,delete c.d3po.yOffset,c.d3po.static=c.d3po.depth<e.depth.value&&e.id.grouping.value,!_||0!==c.d3po.depth&&!1!==e.id.grouping.value?delete c.d3po.label:(c.d3po.text=i(e,c[e.id.value],c.d3po.depth),L=_>3*e.labels.padding?e.labels.padding:0,c.d3po.label={x:0,y:-(T+L+_/2),w:2*T,h:_-L,padding:0,resize:!0,color:u(a(e,c,c.d3po.depth)),force:!0});return f.sort(function(e,t){return e.d3po.depth-t.d3po.depth})},o.fill=!0,o.requirements=["data"],o.scale=1.05,o.shapes=["circle","donut"],t.exports=o},{"../../array/sort.coffee":36,"../../color/legible.coffee":46,"../../core/data/group.coffee":59,"../../core/fetch/color.coffee":65,"../../core/fetch/text.js":68,"../../core/fetch/value.coffee":69}],314:[function(e,t,n){var r,o;o=e("../../../core/console/print.coffee"),r=function(e){var t,n;n={circle:"scatter",donut:"scatter",line:"line",square:"scatter",area:"stacked"},t=n[e.shape.value],o.warning('The "chart" visualization type has been deprecated and will be removed in version 2.0. Please use the "'+t+'" visualization type.'),e.self.type(t).draw()},r.shapes=["circle","donut","line","square","area"],t.exports=r},{"../../../core/console/print.coffee":54}],315:[function(e,t,n){var r;r=function(e){var t,n,r,o,a,i;return t=e.coords.value,r=e.coords.key||d3.keys(t.objects)[0],i=topojson.feature(t,t.objects[r]),n=i.features,a=e.coords.solo.value,o=e.coords.mute.value,n=n.filter(function(t){return t[e.id.value]=t.id,a.length?a.indexOf(t.id)>=0:!o.length||o.indexOf(t.id)<0})},r.libs=["topojson"],r.nesting=!1,r.requirements=["coords"],r.scale=1,r.shapes=["coordinates"],r.zoom=!0,t.exports=r},{}],316:[function(e,t,n){var r,o,a;r=e("../../../../core/fetch/color.coffee"),o=e("../../../../color/legible.coffee"),a=e("../../../../core/console/print.coffee"),t.exports=function(e){var t,n,i,l,s,u,c,f,d,p,h,v;for(t=e.axes,c=e.axes.margin.viz,l=t.stacked||!t.ticks.value?[]:e.data.viz,v=2*l.length>e.data.large?0:e.draw.timing,d=function(n,a){return 0===a.indexOf("y")?n.attr("x1",-2).attr("x2",-8).attr("y1",function(e){return e.d3po.y-c.top}).attr("y2",function(e){return e.d3po.y-c.top}):n.attr("x1",function(e){return e.d3po.x-c.left}).attr("x2",function(e){return e.d3po.x-c.left}).attr("y1",t.height+2).attr("y2",t.height+8),n.style("stroke",function(t){return o(r(e,t))}).style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value)},e.dev.value&&a.time("creating axis tick groups"),h=e.group.select("g#d3po_graph_plane").selectAll("g.d3po_data_tick").data(l,function(n){var r;return r=t.discrete?"_"+n.d3po[t.discrete]:"","tick_"+n[e.id.value]+"_"+n.d3po.depth+r}),h.enter().append("g").attr("class","d3po_data_tick").attr("opacity",0),e.dev.value&&a.timeEnd("creating axis tick groups"),f=["x","y"],s=0,u=f.length;s<u;s++)n=f[s],e.dev.value&&v&&a.time("creating "+n+" ticks"),i=v&&n!==t.discrete?l:[],p=h.selectAll("line.d3po_data_"+n).data(i,function(t){return"tick_"+t[e.id.value]+"_"+t.d3po.depth}),e.dev.value&&v&&a.timeEnd("creating "+n+" ticks"),e.dev.value&&v&&a.time("styling "+n+" ticks"),v>0?p.transition().duration(v).call(d,n):p.call(d,n),p.enter().append("line").attr("class","d3po_data_"+n).call(d,n),e.dev.value&&v&&a.timeEnd("styling "+n+" ticks");v>0?(h.transition().duration(v).attr("opacity",1),h.exit().transition().duration(v).attr("opacity",0).remove()):(h.attr("opacity",1),h.exit().remove())}},{"../../../../color/legible.coffee":46,"../../../../core/console/print.coffee":54,"../../../../core/fetch/color.coffee":65}],317:[function(e,t,n){var r,o,a,i;r=e("./includes/axes.coffee"),o=e("./includes/svg.coffee"),a=e("./includes/mouse.coffee"),i=e("./includes/plot.coffee"),t.exports=function(e,t){void 0===t&&(t={}),r(e,t),i(e,t),o(e,t),e.mouse.viz=!0===t.mouse&&a}},{"./includes/axes.coffee":318,"./includes/mouse.coffee":320,"./includes/plot.coffee":321,"./includes/svg.coffee":322}],318:[function(e,t,n){var r,o,a,i,l,s,u,c,f,d,p,h;r=e("../../../../../array/sort.coffee"),i=e("./buffer.coffee"),a=e("../../../../../util/buckets.coffee"),s=e("../../../../../core/fetch/data.js"),u=e("../../../../../core/fetch/value.coffee"),d=e("../../../../../core/console/print.coffee"),h=e("../../../../../util/uniques.coffee"),t.exports=function(e,t){var n,r,a,s,v,g,m,y,x,b,w,_;for(a=l(e),!a&&e.axes.dataset||(e.axes.dataset=c(e)),e.axes.scale=!(!t.buffer||!0===t.buffer)&&p(e,t.buffer),n=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"],v=0,m=n.length;v<m;v++)r=n[v],x=0===r.indexOf("x")?"y":"x",w=e.order.changed||e.order.sort.changed||!0===e.order.value&&e[x].changed,e[r].value&&(!e[r].ticks.values||a||w||e[r].value===e.time.value&&e.time.fixed.value)&&(e.dev.value&&d.time("calculating "+r+" axis"),e[r].reset=!0,e[r].ticks.values=!1,r===e.axes.discrete&&e[r].value!==e.time.value&&(e[r].ticks.values=h(e.axes.dataset,e[r].value,u,e)),_=!0===t.zero||0===r.indexOf(t.zero),b=o(e,r,_),0===r.indexOf("y")&&(b=b.reverse()),e[r].scale.viz=f(e,r,b),e[r].domain.viz=b,e.dev.value&&d.timeEnd("calculating "+r+" axis"));if(e.axes.mirror.value&&(s=d3.extent(e.y.domain.viz.concat(e.x.domain.viz)),e.x.domain.viz=s,e.x.scale.viz.domain(s),s=s.slice().reverse(),e.y.domain.viz=s,e.y.scale.viz.domain(s)),t.buffer)for(g=0,y=n.length;g<y;g++)(r=n[g])!==e.axes.discrete&&i(e,r,t.buffer)},l=function(e){var t,n,r,o,a,i,l,s,u,c,f,d,p;if(n=!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed),n||(n=e.id.solo.changed||e.id.mute.changed),n)return n;for(r=["data","time","id","depth","type","width","height","x","y","x2","y2"],o=0,s=r.length;o<s;o++)if(i=r[o],e[i].changed){n=!0;break}if(n)return n;for(p=["mute","range","scale","solo","stacked","zerofill"],f=["x","y","x2","y2"],a=0,u=f.length;a<u;a++)for(t=f[a],l=0,c=p.length;l<c;l++)if(d=p[l],e[t][d].changed){n=!0;break}return n},c=function(e){var t,n;return e.time.fixed.value?(n=d3.range(0,e.id.nesting.length),d3.merge(d3.merge([function(){var r,o,a;for(a=[],r=0,o=n.length;r<o;r++)t=n[r],a.push(s(e,"all",t));return a}()]))):e.data.viz},o=function(e,t,n,o){var a,i,l,s,c,f,d,p,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q;if(M=0===t.indexOf("x")?"y":"x",e[t].range.value&&2===e[t].range.value.length)return e[t].range.value.slice();if("share"===e[t].scale.value)return e[t].ticks.values=d3.range(0,1.1,.1),[0,1];if(e[t].stacked.value){for(F=[],A=e.axes.dataset,v=0,x=A.length;v<x;v++)d=A[v],d.values?F=F.concat(d.values):F.push(d);return c=d3.nest().key(function(t){return u(e,t,e[M].value)}).rollup(function(n){var r,o;return o=d3.sum(n,function(n){var r;return r=u(e,n,e[t].value),r>0?r:0}),r=d3.sum(n,function(n){var r;return r=u(e,n,e[t].value),r<0?r:0}),[r,o]}).entries(F),q=d3.merge(c.map(function(e){return e.values})),d3.extent(q)}if(e[t].value===e.time.value)return e.time.solo.value.length?d3.extent(e.time.solo.value).map(function(e){return e.constructor!==Date?(e+="",4===e.length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e)):e}):d3.extent(e.data.time.ticks);for(q=[],j=e.axes.dataset,g=0,b=j.length;g<b;g++)d=j[g],C=u(e,d,e[t].value),C instanceof Array?q=q.concat(C):q.push(C);if(q=q.filter(function(e){return null!==e}),t===e.axes.discrete){if(N=!0===e.order.value?e[M].value:e.order.value){for(O=e.order.sort.value,a=e.order.agg.value||e.aggs.value[N]||"max",i=typeof a,f=q.reduce(function(e,t){return e[t]=[],e},{}),E=e.axes.dataset,y=0,
w=E.length;y<w;y++)if(d=E[y],d.values)for(S=d.values,k=0,_=S.length;k<_;k++)T=S[k],p=u(e,T,e[t].value),f[p].push(u(e,T,N));else p=u(e,d,e[t].value),f[p].push(u(e,d,N));for(m in f)T=f[m],"string"===i?f[m]=d3[a](T):"function"===i&&(f[m]=a(T,N));return f=r(d3.entries(f),"value",O),f=f.reduce(function(e,t){return e.push(t.key),e},[])}return q[0].constructor===String?h(q).sort(function(e,t){return""+e.localeCompare(""+t)}):h(q).sort(function(e,t){return e-t})}return q.sort(function(e,t){return e-t}),"log"===e[t].scale.value&&(0===q[0]&&(q[0]=1),0===q[q.length-1]&&(q[q.length-1]=-1)),n&&(s=q.every(function(e){return e>0}),l=q.every(function(e){return e<0}),(s||l)&&(z=s?1:-1,q.push("log"===e[t].scale.value?z:0))),d3.extent(q)},f=function(e,t,n){var r,o,i,l,s;return o=0===t.indexOf("x")?e.width.viz:e.height.viz,l=e[t].scale.value,["discrete","share"].indexOf(l)>=0&&(l="linear"),s=10,"string"==typeof n[0]?(l="ordinal",r=a([0,o],n.length)):(r=[0,o],"linear"===e[t].scale.value&&(s=Math.floor(o/(4*e[t].ticks.font.size)))),e[t].scale.ticks=s,i=d3.scale[l]().domain(n).range(r),"clamp"in i&&i.clamp(!0),i},p=function(e,t){var n,r,o;return!0===t&&(t="size"),t in e&&(t=e[t].value),o=e.size.scale.range.min.value,"function"==typeof o&&(o=o(e)),r=e.size.scale.range.max.value,"function"==typeof r&&(r=r(e)),!1===t?e.size.scale.value.domain([0,1]).rangeRound([r,r]):"number"==typeof t?e.size.scale.value.domain([0,1]).rangeRound([t,t]):t?(e.dev.value&&d.time("calculating buffer scale"),n=d3.extent(e.axes.dataset,function(n){return u(e,n,t)||0}),n[0]===n[1]&&(o=r),e.dev.value&&d.timeEnd("calculating buffer scale"),e.size.scale.value.domain(n).rangeRound([o,r])):void 0}},{"../../../../../array/sort.coffee":36,"../../../../../core/console/print.coffee":54,"../../../../../core/fetch/data.js":66,"../../../../../core/fetch/value.coffee":69,"../../../../../util/buckets.coffee":207,"../../../../../util/uniques.coffee":213,"./buffer.coffee":319}],319:[function(e,t,n){var r,o;r=e("../../../../../util/buckets.coffee"),o=e("../../../../../util/closest.coffee"),t.exports=function(e,t,n){var a,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P;if("share"!==e[t].scale.value&&!e[t].range.value&&e[t].reset){if(O=e[t].scale.viz.copy(),"clamp"in O&&O.clamp(!1),t===e.axes.discrete){if(h=O.domain(),"string"==typeof h[0]){for(y=h.length;y>=0;)h.splice(y,0,"d3po_buffer_"+y),y--;return A=O.range(),A=r(d3.extent(A),h.length),e[t].scale.viz.domain(h).range(A)}if(0===t.indexOf("y")&&(h=h.slice().reverse()),1===e[t].ticks.values.length)h=[h[0],h[0]],e[t].value===e.time.value&&1!==e.data.time.ticks.length?(u=o(e.data.time.ticks,h[0]),N=e.data.time.ticks.indexOf(u),N>0?h[0]=e.data.time.ticks[N-1]:(d=e.data.time.ticks[N+1]-u,h[0]=new Date(u.getTime()-d)),N<e.data.time.ticks.length-1?h[1]=e.data.time.ticks[N+1]:(d=u-e.data.time.ticks[N-1],h[1]=new Date(u.getTime()+d))):(h[0]-=1,h[1]+=1);else if(e.axes.scale)p=Math.abs(h[1]-h[0]),i=p/(e[t].ticks.values.length-1),i/=2,j=O.range()[1],k=1.5*e.axes.scale.range()[1],m=O.invert(-k),g=O.invert(j+k),h[0]-i<m?(h[0]=h[0]-i,h[h.length-1]=h[h.length-1]+i):(h=[m,g],0===t.indexOf("y")&&(h=h.reverse()),v=O.domain(),(v=v[1]-v[0])||(h[0]-=1,h[1]+=1));else if(e[t].value===e.time.value)p=Math.abs(h[1]-h[0]),i=p/(e[t].ticks.values.length-1),i/=2,h[0]=h[0]-i,h[1]=h[1]+i;else{for(p=Math.abs(h[1]-h[0]),a=p/2,y=h.length,M=h.slice();y>=0;)f=y?M[y-1]+a:M[y]-a,h.splice(y,0,f),y--;A=O.range(),A=r(d3.extent(A),h.length),e[t].scale.viz.domain(h).range(A)}return 0===t.indexOf("y")&&(h=h.reverse()),e[t].scale.viz.domain(h)}if("x"===n&&0===t.indexOf("x")||"y"===n&&0===t.indexOf("y")||!0===n)return h=O.domain(),s=h[0]>=0&&h[1]>=0,l=h[0]<=0&&h[1]<=0,"log"===e[t].scale.value?(P=s?1:-1,s&&0===t.indexOf("y")&&(h=h.slice().reverse()),w=Math.pow(10,parseInt(Math.abs(h[0])).toString().length-1)*P,b=h[0]%w,x=b,b&&x/w<=.1&&(x+=w*P),_=0===b?w:x,h[0]-=_,0===h[0]&&(h[0]=P),C=Math.pow(10,parseInt(Math.abs(h[1])).toString().length-1)*P,T=h[1]%C,F=Math.abs(C-T),T&&F/C<=.1&&(F+=C*P),q=0===T?C:F,h[1]+=q,0===h[1]&&(h[1]=P),s&&0===t.indexOf("y")&&(h=h.reverse())):(P=0,0===t.indexOf("y")&&(h=h.slice().reverse()),S=h.filter(function(e){return e.constructor===String}),i=.05*Math.abs(h[1]-h[0])||1,S.length||(h[0]=h[0]-i,h[1]=h[1]+i,(s&&h[0]<P||l&&h[0]>P)&&(h[0]=P),(s&&h[1]<P||l&&h[1]>P)&&(h[1]=P)),0===t.indexOf("y")&&(h=h.reverse())),e[t].scale.viz.domain(h);if(e.axes.scale)return c=!1,e.axes.mirror.value&&(z=0===t.indexOf("y")?"x":"y",c=e[z].scale.viz,E=e.width.viz>e.height.viz?"x":"y"),t===E&&c?h=c.domain().slice().reverse():(j=O.range()[1],k=e.axes.scale.range()[1],m=O.invert(1.5*-k),g=O.invert(j+1.5*k),h=[m,g],0===t.indexOf("y")&&(h=h.reverse()),v=O.domain(),v=v[1]-v[0],v||(h[0]-=1,h[1]+=1),0===t.indexOf("y")&&(h=h.reverse())),e[t].scale.viz.domain(h)}}},{"../../../../../util/buckets.coffee":207,"../../../../../util/closest.coffee":209}],320:[function(e,t,n){var r,o,a,i,l;e("../../../../../util/copy.coffee"),r=e("../../../../../client/pointer.coffee"),o=e("../../../../../core/fetch/color.coffee"),a=e("../../../../../core/fetch/value.coffee"),i=e("../../../../../color/legible.coffee"),l=e("../../../../../color/text.coffee"),t.exports=function(e,t){var n,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M;return n=d3.event.type===r.click&&(t.tooltip.value.long||t.tooltip.html.value),u=[r.over,r.move].indexOf(d3.event.type)>=0,z=e.d3po.x,M=e.d3po.y,m=e.d3po.r||0,b=t.types[t.type.value].scale||1,m*=b,c=t.axes,g=t.axes.margin.viz,k=t.draw.timing?t.timing.mouseevents:0,!n&&u?(s=i(o(t,e)),f=["x","y","x2","y2"].filter(function(n){var r;return(r=a(t,e,t[n].value))&&!(r instanceof Array)&&n!==t.axes.stacked&&t[n].mouse.value})):f=[],d=function(e){return e.attr("x1",function(e){return 0===e.indexOf("x")?z:z-m}).attr("y1",function(e){return 0===e.indexOf("y")?M:M+m}).attr("x2",function(e){return 0===e.indexOf("x")?z:z-m}).attr("y2",function(e){return 0===e.indexOf("y")?M:M+m}).attr("opacity",0)},p=function(e){return e.style("stroke",function(e){return"area"===t.shape.value?"white":s}).attr("stroke-dasharray",function(e){return t[e].mouse.dasharray.value}).attr("shape-rendering",function(e){return t[e].mouse.rendering.value}).style("stroke-width",function(e){return t[e].mouse.width})},h=function(n){return n.attr("x1",function(e){return 0===e.indexOf("x")?z:z-m}).attr("y1",function(e){return 0===e.indexOf("y")?M:M+m}).attr("x2",function(n){return 0===n.indexOf("x")?z:e.d3po.x0?e.d3po.x0:"y"===n?g.left-t[n].ticks.size:g.left+c.width+t[n].ticks.size}).attr("y2",function(n){return 0===n.indexOf("y")?M:e.d3po.y0?e.d3po.y0:"x"===n?c.height+g.top+t[n].ticks.size:g.top-t[n].ticks.size}).style("opacity",1)},v=t.g.labels.selectAll("line.d3po_mouse_axis_label").data(f),k?(v.enter().append("line").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(d).call(p),v.transition().duration(k).call(h).call(p),v.exit().transition().duration(k).call(d).remove()):(v.call(h).call(p),v.enter().append("line").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(d).call(p),v.exit().remove()),w=function(n){return n.attr("font-size",function(e){return t[e].ticks.font.size+"px"}).attr("font-family",function(e){return t[e].ticks.font.family.value}).attr("font-weight",function(e){return t[e].ticks.font.weight}).attr("x",function(e){return 0===e.indexOf("x")?z:"y"===e?g.left-5-t[e].ticks.size:g.left+c.width+5+t[e].ticks.size}).attr("y",function(n){return 0===n.indexOf("y")?M:e.d3po.y0?e.d3po.y+(e.d3po.y0-e.d3po.y)/2+g.top-6:"x"===n?c.height+g.top+5+t[n].ticks.size:g.top-5-t[n].ticks.size-1.35*t[n].ticks.font.size}).attr("fill","area"===t.shape.value?"white":l(s))},_=t.g.labels.selectAll("text.d3po_mouse_axis_label").data(f),_.enter().append("text").attr("class","d3po_mouse_axis_label").attr("id",function(e){return e+"_d3pomouseaxislabel"}).attr("dy",function(e){return 0===e.indexOf("y")?.35*t[e].ticks.font.size:t[e].ticks.font.size}).style("text-anchor",function(e){return"y"===e?"end":"y2"===e?"start":"middle"}).attr("opacity",0).attr("pointer-events","none").call(w),_.text(function(n){var r,o;return r=t.axes.stacked||n,o=a(t,e,t[r].value),t.format.value(o,{key:t[r].value,vars:t,labels:t[r].affixes.value})}),k?(_.transition().duration(k).delay(k).attr("opacity",1).call(w),_.exit().transition().duration(k).attr("opacity",0).remove()):(_.attr("opacity",1).call(w),_.exit().remove()),y=function(n){var r;return r=function(e){var t;return t=d3.select("text#"+e+"_d3pomouseaxislabel"),t.size()?t.node().getBBox():{width:0,height:0}},n.attr("x",function(e){var n;return n=r(e).width,0===e.indexOf("x")?z-n/2-5:"y"===e?g.left-t[e].ticks.size-n-10:g.left+c.width+t[e].ticks.size}).attr("y",function(n){var o;return o=r(n).height,0===n.indexOf("y")?M-(o/2+5):e.d3po.y0?e.d3po.y+(e.d3po.y0-e.d3po.y)/2+g.top-(o/2+5):"x"===n?c.height+g.top+t[n].ticks.size:g.top-t[n].ticks.size-o-10}).attr("width",function(e){return r(e).width+10}).attr("height",function(e){return r(e).height+10}).style("stroke","area"===t.shape.value?"transparent":s).attr("fill",s).attr("shape-rendering",function(e){return t[e].mouse.rendering.value}).style("stroke-width",function(e){return t[e].mouse.width})},x=t.g.labels.selectAll("rect.d3po_mouse_axis_label").data(f),k?(x.enter().insert("rect","text.d3po_mouse_axis_label").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").attr("opacity",0).call(y),x.transition().duration(k).delay(k).attr("opacity",1).call(y),x.exit().transition().duration(k).attr("opacity",0).remove()):(x.attr("opacity",1).call(y),x.enter().insert("rect","text.d3po_mouse_axis_label").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(y),x.exit().remove())}},{"../../../../../client/pointer.coffee":40,"../../../../../color/legible.coffee":46,"../../../../../color/text.coffee":52,"../../../../../core/fetch/color.coffee":65,"../../../../../core/fetch/value.coffee":69,"../../../../../util/copy.coffee":210}],321:[function(e,t,n){var r,o,a,i,l,s,u,c,f,d;r=e("../../../../../util/buckets.coffee"),o=e("./buffer.coffee"),i=e("../../../../../core/fetch/value.coffee"),l=e("../../../../../font/sizes.coffee"),f=e("../../../../../textwrap/textwrap.coffee"),d=e("../../../../../core/data/time.coffee"),e("../../../../../util/uniques.coffee"),t.exports=function(e,t){var n,r,l,s,c,f,p,h,v,g,m,y,x,b,w,_,k,z,M,A;for(e.axes.margin.viz={top:e.axes.margin.top,right:e.axes.margin.right,bottom:e.axes.margin.bottom,left:e.axes.margin.left},e.axes.height=e.height.viz,e.axes.width=e.width.viz,n=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"],c=0,h=n.length;c<h;c++)if(r=n[c],e[r].value){if(!1===e[r].ticks.values)if(e[r].value===e.time.value){for(z=e.time.solo.value,z=z.length?z.map(function(e){return e.constructor!==Date&&(e+="",4===e.length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),e}):e.data.time.values,s=d3.extent(z),w=e.data.time.stepType,z=[s[0]],k=s[0];k<s[1];)m=new Date(k),k=new Date(m["set"+w](m["get"+w]()+1)),z.push(k);e[r].ticks.values=z}else 1===r.indexOf("2")?(x=e[r.slice(0,1)].scale.viz,b=e[r].scale.viz,z=e[r.slice(0,1)].scale.ticks,e[r].ticks.values=x.ticks(z).map(function(e){return parseFloat(d3.format(".5f")(b.invert(x(e))))})):e[r].ticks.values=e[r].scale.viz.ticks(e[r].scale.ticks);e[r].ticks.values.length||(A=i(e,e.data.viz,e[r].value),A instanceof Array||(A=[A]),e[r].ticks.values=A),y=0===r.indexOf("x")?"y":"x",(1===e[r].ticks.values.length||t.buffer&&t.buffer!==y&&r===e.axes.discrete&&!0===e[r].reset)&&o(e,r,t.buffer),e[r].reset=!1,e[r].value===e.time.value?(l={"font-family":e[r].ticks.font.family.value,"font-weight":e[r].ticks.font.weight,"font-size":e[r].ticks.font.size+"px","text-transform":e[r].ticks.font.transform.value,"letter-spacing":e[r].ticks.font.spacing+"px"},M=d(e,{values:e[r].ticks.values,limit:e.width.viz,style:l}),e[r].ticks.value?e[r].ticks.visible=e[r].ticks.value.map(Number):e[r].ticks.labels.value.constructor===Array?e[r].ticks.visible=e[r].ticks.labels.value.map(Number):e[r].ticks.visible=M.values.map(Number),e[r].ticks.format=M.format):e[r].ticks.value?(e[r].ticks.values=e[r].ticks.value,e[r].ticks.labels.value.constructor===Array?e[r].ticks.visible=e[r].ticks.labels.value:e[r].ticks.visible=e[r].ticks.value):e[r].ticks.labels.value.constructor===Array?e[r].ticks.visible=e[r].ticks.labels.value:"log"===e[r].scale.value?(z=e[r].ticks.values,_=z.filter(function(e){return"1"===Math.abs(e).toString().charAt(0)}),_.length<3?e[r].ticks.visible=z:e[r].ticks.visible=_):e[r].ticks.visible=e[r].ticks.values,e[r].value===e.time.value&&(e[r].ticks.visible=e[r].ticks.visible.map(function(e){return e.constructor===Number&&(""+e).length>4?e:(e+="",4===e.length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime())}))}if(e.small)for(e.axes.width-=e.axes.margin.viz.left+e.axes.margin.viz.right,e.axes.height-=e.axes.margin.viz.top+e.axes.margin.viz.bottom,f=0,v=n.length;f<v;f++)r=n[f],e[r].label.height=0;else e.small||u(e);for(p=0,g=n.length;p<g;p++)r=n[p],e[r].axis.svg=a(e,r)},u=function(e){var t,n,o,a,i,u,c,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C;for(b=e.x.scale.viz.domain(),O=e.y.scale.viz.domain(),e.x2.value&&(g=e.x2.scale.viz.domain()),e.y2.value&&(j=e.y2.scale.viz.domain()),d=["y","y2"],n=0,i=d.length;n<i;n++)t=d[n],e[t].value&&(c="y"===t?"left":"right",E={"font-size":e[t].ticks.font.size+"px","font-family":e[t].ticks.font.family.value,"font-weight":e[t].ticks.font.weight,"text-transform":e[t].ticks.font.transform.value,"letter-spacing":e[t].ticks.font.spacing+"px"},C=e[t].ticks.visible,"log"===e[t].scale.value?T=C.map(function(e){return s(e)}):"share"===e[t].scale.value?T=C.map(function(n){return e.format.value(100*n,{key:"share",vars:e,output:t})}):e[t].value===e.time.value?T=C.map(function(n,r){return e[t].ticks.format(new Date(n))}):("string"==typeof C[0]&&(C=e[t].scale.viz.domain().filter(function(e){return 0!==e.indexOf("d3po_buffer_")})),T=C.map(function(n){return e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t})})),e[t].ticks.labels.value?(e[t].ticks.hidden=!1,(S=d3.max(l(T,E),function(e){return e.width}))&&(S=Math.ceil(S+e.labels.padding),e.axes.margin.viz[c]+=S)):e[t].ticks.hidden=!0,N=e[t].label.fetch(e),N?(F={"font-family":e[t].label.font.family.value,"font-weight":e[t].label.font.weight,"font-size":e[t].label.font.size+"px","text-transform":e[t].label.font.transform.value,"letter-spacing":e[t].label.font.spacing+"px"},e[t].label.height=l([N],F)[0].height):e[t].label.height=0,e[t].label.value&&(e.axes.margin.viz[c]+=e[t].label.height,e.axes.margin.viz[c]+=2*e[t].label.padding));for(e.axes.width-=e.axes.margin.viz.left+e.axes.margin.viz.right,e.x.scale.viz.range(r([0,e.axes.width],b.length)),g&&e.x2.scale.viz.range(r([0,e.axes.width],g.length)),p=["x","x2"],o=0,u=p.length;o<u;o++)t=p[o],e[t].value&&(c="x"===t?"bottom":"top",e[t].ticks.labels.value?(e[t].ticks.hidden=!1,m={"font-size":e[t].ticks.font.size+"px","font-family":e[t].ticks.font.family.value,"font-weight":e[t].ticks.font.weight,"text-transform":e[t].ticks.font.transform.value,"letter-spacing":e[t].ticks.font.spacing+"px"},A=e[t].ticks.visible,"log"===e[t].scale.value?M=A.map(function(e){return s(e)}):"share"===e[t].scale.value?M=A.map(function(n){return e.format.value(100*n,{key:"share",vars:e,output:t})}):e[t].value===e.time.value?M=A.map(function(n,r){return e[t].ticks.format(new Date(n))}):("string"==typeof A[0]&&(A=e[t].scale.viz.domain().filter(function(e){return 0!==e.indexOf("d3po_buffer_")})),M=A.map(function(n){return e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t})})),z=l(M,m),x=d3.max(z,function(e){return e.width}),y=d3.max(z,function(e){return e.height}),1===A.length?k=e.axes.width:(k=e[t].scale.viz(A[1])-e[t].scale.viz(A[0]),k=Math.abs(k)),x>k&&M.join("").indexOf(" ")>0?(e[t].ticks.wrap=!0,z=l(M,m,{mod:function(t){return f().container(d3.select(t)).height(e.axes.height/2).width(k).draw()}}),x=d3.max(z,function(e){return e.width}),y=d3.max(z,function(e){return e.height})):e[t].ticks.wrap=!1,e[t].ticks.baseline="auto",x<=k?e[t].ticks.rotate=0:x<e.axes.height/2?(z=l(M,m,{mod:function(t){return f().container(d3.select(t)).width(e.axes.height/2).height(k).draw()}}),y=d3.max(z,function(e){return e.width}),x=d3.max(z,function(e){return e.height}),e[t].ticks.rotate=-90):(x=0,y=0),x&&y||(e[t].ticks.hidden=!0,e[t].ticks.rotate=0),x=Math.ceil(x),y=Math.ceil(y),e[t].ticks.maxHeight=y,e[t].ticks.maxWidth=x,y&&(e.axes.margin.viz[c]+=y+e.labels.padding),a=e[t].ticks.visible[e[t].ticks.visible.length-1],h=e[t].scale.viz(a),(h+=x/2+e.axes.margin.viz.left)>e.width.value&&(v=h-e.width.value+e.axes.margin.viz.right,e.axes.width-=v,e.axes.margin.viz.right+=v)):e[t].ticks.hidden=!0,w=e[t].label.fetch(e),w?(_={"font-family":e[t].label.font.family.value,"font-weight":e[t].label.font.weight,"font-size":e[t].label.font.size+"px","text-transform":e[t].label.font.transform.value,"letter-spacing":e[t].label.font.spacing+"px"},e[t].label.height=l([w],_)[0].height):e[t].label.height=0,e[t].label.value&&(e.axes.margin.viz[c]+=e[t].label.height,e.axes.margin.viz[c]+=2*e[t].label.padding));if(e.axes.height-=e.axes.margin.viz.top+e.axes.margin.viz.bottom,e.x.scale.viz.range(r([0,e.axes.width],b.length)),g&&e.x2.scale.viz.range(r([0,e.axes.width],g.length)),e.y.scale.viz.range(r([0,e.axes.height],O.length)),j)return e.y2.scale.viz.range(r([0,e.axes.height],j.length))},a=function(e,t){return d3.svg.axis().tickSize(e[t].ticks.size).tickPadding(5).orient(e[t].orient.value).scale(e[t].scale.viz).tickValues(e[t].ticks.values).tickFormat(function(n,r){var o,a;return e[t].ticks.hidden?null:(a=e[t].scale.value,o=n.constructor===Date?+n:n,e[t].ticks.visible.indexOf(o)>=0?"share"===a?e.format.value(100*n,{key:"share",vars:e,labels:e[t].affixes.value,output:t}):n.constructor===Date?e[t].ticks.format(n):"log"===a?s(n):e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t}):null)})},c="",s=function(e){var t,n,r;return n=Math.round(Math.log(Math.abs(e))/Math.LN10),r=Math.abs(e).toString().charAt(0),t="10 "+(n+"").split("").map(function(e){return c[e]}).join(""),"1"!==r&&(t=r+" x "+t),e<0?"-"+t:t}},{"../../../../../core/data/time.coffee":64,"../../../../../core/fetch/value.coffee":69,"../../../../../font/sizes.coffee":104,"../../../../../textwrap/textwrap.coffee":203,"../../../../../util/buckets.coffee":207,"../../../../../util/uniques.coffee":213,"./buffer.coffee":319}],322:[function(e,t,n){var r,o,a;r=e("../../../../../color/mix.coffee"),o=e("../../../../../textwrap/textwrap.coffee"),a=e("../../../../../object/validate.coffee"),t.exports=function(e){var t,n,i,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re,oe,ae,ie,le,se,ue;if(h=e.x.domain.viz.concat(e.y.domain.viz),h.indexOf(void 0)>=0)return null;for(f={width:e.axes.width,height:e.axes.height,fill:e.axes.background.color,stroke:e.axes.background.stroke.color,"stroke-width":e.axes.background.stroke.width,"shape-rendering":e.axes.background.rendering.value},n={left:"start",center:"middle",right:"end"},l=e.small?[]:[0],ae=function(t,n){return t.attr("x1",function(t){return 0===n.indexOf("x")?e.x.scale.viz(t):0}).attr("x2",function(t){return 0===n.indexOf("x")?e.x.scale.viz(t):e.axes.width}).attr("y1",function(t){return 0===n.indexOf("y")?e.y.scale.viz(t):0}).attr("y2",function(t){return 0===n.indexOf("y")?e.y.scale.viz(t):e.axes.height})},ie=function(t,n,o){var a,i,l;return a=o?e[n].grid.color:e[n].ticks.color,i="log"===e[n].scale.value,l=e[n].ticks.visible||[],t.attr("stroke",function(t){var s;return 0===t?e[n].axis.color:(t.constructor===Date&&(t=+t),s=l.indexOf(t)>=0,!s||i&&"1"!==Math.abs(t).toString().charAt(0)?o&&"transparent"!==e.axes.background.color?r(a,e.axes.background.color,.4,1):"transparent"!==e.background.value?r(a,e.background.value,.4,1):r(a,"white",.4,1):a)}).attr("stroke-width",e[n].ticks.width).attr("shape-rendering",e[n].ticks.rendering.value)},v=function(t,n,r){var o;return o=0===n?"axis":"ticks",n=e[t][o].font[r],n&&(n.length||"number"==typeof n)?n:e[t].ticks.font[r]},oe=function(t,n){var o;return o="log"===e[n].scale.value,t.attr("font-size",function(e){return v(n,e,"size")+"px"}).attr("stroke","none").attr("fill",function(t){var a;return a=v(n,t,"color"),o&&"1"!==Math.abs(t).toString().charAt(0)?r(a,e.background.value,.4,1):a}).attr("font-family",function(e){return v(n,e,"family").value}).attr("font-weight",function(e){return v(n,e,"weight")}).style("text-transform",function(e){return v(n,e,"transform").value}).style("letter-spacing",function(e){return v(n,e,"spacing")+"px"})},q=function(t,n){var r,o;return r=0===n.indexOf("x")?"height":"width",o=0===n.indexOf("x")?"y":"x",t.attr(o+"1",0).attr(o+"2",e.axes[r]).attr(n+"1",function(e){return e.coords.line}).attr(n+"2",function(e){return e.coords.line}).attr("stroke",function(t){return t.color||e[n].lines.color}).attr("stroke-width",e[n].lines.width).attr("shape-rendering",e[n].lines.rendering.value).attr("stroke-dasharray",e[n].lines.dasharray.value)},F=function(t,r){var o;return o=0===r.indexOf("x")?"y":"x",t.attr(o,function(e){return e.coords.text[o]+"px"}).attr(r,function(e){return e.coords.text[r]+"px"}).attr("dy",e[r].lines.font.position.value).attr("text-anchor",n[e[r].lines.font.align.value]).attr("transform",function(e){return e.transform}).attr("font-size",e[r].lines.font.size+"px").attr("fill",function(t){return t.color||e[r].lines.color}).attr("font-family",e[r].lines.font.family.value).attr("font-weight",e[r].lines.font.weight)},U="translate("+e.axes.margin.viz.left+","+e.axes.margin.viz.top+")",V=e.group.selectAll("g#d3po_graph_plane").data([0]),V.transition().duration(e.draw.timing).attr("transform",U),V.enter().append("g").attr("id","d3po_graph_plane").attr("transform",U),c=V.selectAll("rect#d3po_graph_background").data([0]),c.transition().duration(e.draw.timing).attr(f),c.enter().append("rect").attr("id","d3po_graph_background").attr("x",0).attr("y",0).attr(f),R=V.selectAll("path#d3po_graph_mirror").data([0]),R.enter().append("path").attr("id","d3po_graph_mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0),R.transition().duration(e.draw.timing).attr("opacity",function(){return e.axes.mirror.value?1:0}).attr("d",function(){var e,t;return t=f.width,e=f.height,"M "+t+" "+e+" L 0 "+e+" L "+t+" 0 Z"}),K=0!==e.x.ticks.rotate,se=function(t,n){var r,a;return a="x"===n?e.axes.height:0,r=t.attr("transform","translate(0,"+a+")").call(e[n].axis.svg.scale(e[n].scale.viz)).selectAll("g.tick"),r.selectAll("line").attr("y2",function(t){var r;return t.constructor===Date&&(t=+t),r=d3.select(this).attr("y2"),e[n].ticks.visible.indexOf(t)>=0?r:r/2}),r.select("text").style("text-anchor",K&&"x"===n?"end":K?"start":"middle").call(oe,n).each(function(t){if(d3.select(this).attr("dy","0px").attr("font-size",function(e){return v(n,e,"size")+"px"}),t.constructor===Date&&(t=+t),!e[n].ticks.hidden&&e[n].ticks.visible.indexOf(t)>=0)return o().container(d3.select(this)).rotate(e[n].ticks.rotate).align(K?"end":"center").valign(K?"middle":"x"===n?"top":"bottom").width(e[n].ticks.maxWidth+2).height(e[n].ticks.maxHeight).padding(0).x(-e[n].ticks.maxWidth/2).y("x2"===n?-(e[n].ticks.maxHeight+2*e.labels.padding):0).draw()})},ue=function(t,n){var r,o;return o="y2"===n?e.axes.width:0,r=t.attr("transform","translate("+o+", 0)").call(e[n].axis.svg.scale(e[n].scale.viz)).selectAll("g.tick"),r.selectAll("line").attr("y2",function(t){var n;return t.constructor===Date&&(t=+t),n=d3.select(this).attr("y2"),e.x.ticks.visible.indexOf(t)>=0?n:n/2}),r.select("text").call(oe,n)},Z=["x","x2","y","y2"],x=0,M=Z.length;x<M;x++)i=Z[x],ee=0===i.indexOf("x")?se:ue,H=l.length&&e[i].value?[0]:[],s=V.selectAll("g#d3po_graph_"+i+"ticks").data(H),s.transition().duration(e.draw.timing).call(ee,i),s.selectAll("line").transition().duration(e.draw.timing).call(ie,i),y=s.enter().append("g").attr("id","d3po_graph_"+i+"ticks").call(ee,i),y.selectAll("path").attr("fill","none").attr("stroke","none"),y.selectAll("line").call(ie,i),s.exit().transition().duration(e.data.timing).attr("opacity",0).remove();for(z=function(t,n){return t.attr("x",0===n.indexOf("x")?e.width.viz/2:-(e.axes.height/2+e.axes.margin.viz.top)).attr("y","x"===n?e.height.viz-e[n].label.height/2-e[n].label.padding:"y2"===n?e.width.viz-e[n].label.height/2-e[n].label.padding:e[n].label.height/2+e[n].label.padding).attr("transform",0===n.indexOf("y")?"rotate(-90)":null).attr("font-family",e[n].label.font.family.value).attr("font-weight",e[n].label.font.weight).attr("font-size",e[n].label.font.size+"px").attr("fill",e[n].label.font.color).style("text-anchor","middle").attr("dominant-baseline","central").style("text-transform",e[n].label.font.transform.value).style("letter-spacing",e[n].label.font.spacing+"px")},W=["x","y"],b=0,A=W.length;b<A;b++)i=W[b],e[i].grid.value?m=e[i].ticks.value?e[i].ticks.value:e[i].ticks.values:(m=[],L="x"===i?"y":"x",e[i].ticks.values.indexOf(0)>=0&&e[L].axis.value&&(m=[0])),e[i].value===e.time.value&&(m=m.map(function(e){return e+="",4===e.length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime()})),g=V.selectAll("g#d3po_graph_"+i+"grid").data([0]),g.enter().append("g").attr("id","d3po_graph_"+i+"grid"),P=g.selectAll("line").data(m,function(e,t){return e.constructor===Date?e.getTime():e}),P.transition().duration(e.draw.timing).call(ae,i).call(ie,i,!0),P.enter().append("line").style("opacity",0).call(ae,i).call(ie,i,!0).transition().duration(e.draw.timing).delay(e.draw.timing/2).style("opacity",1),P.exit().transition().duration(e.draw.timing/2).style("opacity",0).remove();for(J=["x","x2","y","y2"],w=0,j=J.length;w<j;w++)i=J[w],e[i].value?(u=e[i].label.fetch(e),k=l&&u&&!e.small?[0]:[],t=e.format.affixes.value[e[i].value],u&&!e[i].affixes.value&&t&&($=e[i].affixes.separator.value,!0===$?$=["[","]"]:!1===$&&($=["",""]),u+=" "+$[0]+t[0]+" "+t[1]+$[1])):(u="",k=[]),_=e.group.selectAll("text#d3po_graph_"+i+"label").data(k),_.text(u).transition().duration(e.draw.timing).call(z,i),_.enter().append("text").attr("stroke","none").attr("id","d3po_graph_"+i+"label").text(u).call(z,i),_.exit().transition().duration(e.data.timing).attr("opacity",0).remove();for(Q=["x","y","x2","y2"],D=0,E=Q.length;D<E;D++)if(i=Q[D],e[i].value){for(T=V.selectAll("g#d3po_graph_"+i+"_userlines").data([0]),T.enter().append("g").attr("id","d3po_graph_"+i+"_userlines"),p=e[i].scale.viz.domain(),0===i.indexOf("y")&&(p=p.slice().reverse()),te=[],N=[],le=e[i].lines.value||[],I=0,S=le.length;I<S;I++)O=le[I],d=a(O)?O.position:O,(i===e.axes.discrete?p.indexOf(d)>=0:d>=p[0]&&d<=p[1])&&(d=a(O)?O:{position:d},d.coords={line:e[i].scale.viz(d.position)},N.push(d),d.text&&(d.axis=i,d.padding=.5*e[i].lines.font.padding.value,d.align=e[i].lines.font.align.value,Y=e[i].lines.font.position.text,ne="middle"===Y?0:2*d.padding,"top"===Y&&(ne=-ne),0===i.indexOf("x")?(re="left"===d.align?e.axes.height:"center"===d.align?e.axes.height/2:0,"left"===d.align&&(re-=2*d.padding),"right"===d.align&&(re+=2*d.padding)):(re="left"===d.align?0:"center"===d.align?e.axes.width/2:e.axes.width,"right"===d.align&&(re-=2*d.padding),"left"===d.align&&(re+=2*d.padding)),d.coords.text={},d.coords.text[0===i.indexOf("x")?"y":"x"]=re,d.coords.text[i]=e[i].scale.viz(d.position)+ne,d.transform=0===i.indexOf("x")?"rotate(-90,"+d.coords.text.x+","+d.coords.text.y+")":null,te.push(d)));P=T.selectAll("line.d3po_graph_"+i+"line").data(N,function(e){return e.position}),P.enter().append("line").attr("class","d3po_graph_"+i+"line").attr("opacity",0).call(q,i),P.transition().duration(e.draw.timing).attr("opacity",1).call(q,i),P.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),B=T.selectAll("text.d3po_graph_"+i+"line_text").data(te,function(e){return e.position}),B.enter().append("text").attr("class","d3po_graph_"+i+"line_text").attr("id",function(e){var t;return t=e.position+"",t=t.replace("-","neg"),t=t.replace(".","p"),"d3po_graph_"+i+"line_text_"+t}).attr("opacity",0).call(F,i),B.text(function(e){return e.text}).transition().duration(e.draw.timing).attr("opacity",1).call(F,i),B.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),G=function(t){var n;return n=function(e){var t;return t=e.position+"",t=t.replace("-","neg"),t=t.replace(".","p"),V.select("text#d3po_graph_"+e.axis+"line_text_"+t).node().getBBox()},t.attr("x",function(e){return n(e).x-e.padding}).attr("y",function(e){return n(e).y-e.padding}).attr("transform",function(e){return e.transform}).attr("width",function(e){return n(e).width+2*e.padding}).attr("height",function(e){return n(e).height+2*e.padding}).attr("fill","transparent"!==e.axes.background.color?e.axes.background.color:"white")},X=e[i].lines.font.background.value?te:[],C=T.selectAll("rect.d3po_graph_"+i+"line_rect").data(X,function(e){return e.position}),C.enter().insert("rect","text.d3po_graph_"+i+"line_text").attr("class","d3po_graph_"+i+"line_rect").attr("pointer-events","none").attr("opacity",0).call(G),C.transition().delay(e.draw.timing).each("end",function(t){return d3.select(this).transition().duration(e.draw.timing).attr("opacity",1).call(G)}),C.exit().transition().duration(e.draw.timing).attr("opacity",0).remove()}}},{"../../../../../color/mix.coffee":48,"../../../../../object/validate.coffee":175,"../../../../../textwrap/textwrap.coffee":203}],323:[function(e,t,n){var r,o,a;r=e("../../../../core/fetch/value.coffee"),o=e("../../../../string/strip.js"),a=e("../../../../util/uniques.coffee"),t.exports=function(e,t,n){var i,l,s,u,c,f,d;return void 0===n?n=e.id.nesting.slice(0,e.depth.value+1):n.constructor!==Array&&(n=[n]),void 0===l&&(l=[]),t||(t=e.data.viz),i=e[e.axes.discrete],u=e[e.axes.opposite],d=i.value===e.time.value,d?(f=e.data.time.ticks,s=e.time.solo.value.length?"solo":"mute",e.time[s].value.length&&(c=e.time[s].value.slice().map(function(e){return e.constructor!==Date&&(e+="",4===e.length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),+e}),f=f.filter(function(e){return"solo"===s?c.indexOf(+e)>=0:c.indexOf(+e)<0}))):f=i.ticks.values?i.ticks.values:a(t,i.value,r,e),d3.nest().key(function(t){var a,i,l,s,u;for(s="nesting",i=0,l=n.length;i<l;i++)a=n[i],u=r(e,t,a),u instanceof Array&&(u=u.join("_")),s+="_"+o(u);return s}).rollup(function(t){var n,o,l,c,p,h,v,g,m,y,x,b;if(n=a(t,i.value,r,e),b=n.length&&n[0].constructor===Date,b&&(n=n.map(Number)),i.zerofill.value)for(o="log"===i.scale.value?u.scale.viz.domain().every(function(e){return e<0})?-1:1:0,l=c=0,h=f.length;c<h;l=++c)if(x=f[l],y=d?+x:x,n.indexOf(y)<0){for(g={d3po:{}},m=e.id.nesting,p=0,v=m.length;p<v;p++)(s=m[p])in t[0]&&(g[s]=t[0][s]);g[i.value]=x,g[u.value]=0,g[u.value]=o,t.splice(l,0,g)}return"string"==typeof t[0][i.value]?t:t.sort(function(t,n){var o,a,l,s,c;return o=r(e,t,i.value),l=r(e,n,i.value),(c=o-l)?c:(a=r(e,t,u.value),s=r(e,n,u.value),a-s)})}).entries(t)}},{"../../../../core/fetch/value.coffee":69,"../../../../string/strip.js":178,"../../../../util/uniques.coffee":213}],324:[function(e,t,n){var r;r=e("../../../../core/fetch/value.coffee"),t.exports=function(e,t){var n,o,a,i,l,s,u,c,f,d,p,h,v,g,m,y;for(m=e.axes.stacked||e.axes.opposite,o=e[m].scale.viz(0),v=e[m].scale.value,p="x"===m?"y":"x",u="y"===m?e.axes.margin.viz.top:e.axes.margin.viz.left,d="share"===v?"expand":"zero",g=d3.layout.stack().values(function(e){return e.values||[e]}).offset(d).x(function(e){return e.d3po[p]}).y(function(t){return o-e[m].scale.viz(r(e,t,e[m].value))}).out(function(t,n,a){var i;return i=r(e,t,e[m].value),i<0,"share"===v?(t.d3po[m+"0"]=(1-n)*o,t.d3po[m]=t.d3po[m+"0"]-a*o):(t.d3po[m+"0"]=o,e.axes.stacked&&(t.d3po[m+"0"]-=n),t.d3po[m]=t.d3po[m+"0"]-a),t.d3po[m]+=u,t.d3po[m+"0"]+=u}),h=[],f=[],a=0,l=t.length;a<l;a++)if(n=t[a],(y=r(e,n,e[m].value))instanceof Array){for(c=!0,i=0,s=y.length;i<s;i++)if(y[i]>=0){c=!1;break}c?f.push(n):h.push(n)}else y>=0&&h.push(n),y<0&&f.push(n);return 0===h.length||0===f.length?g(t):(h.length&&(h=g(h)),
f.length&&(f=g(f)),h.concat(f))}},{"../../../../core/fetch/value.coffee":69}],325:[function(e,t,n){var r,o,a,i,l,s;r=e("../../core/fetch/value.coffee"),o=e("./helpers/graph/draw.coffee"),i=e("./helpers/graph/nest.coffee"),l=e("../../array/sort.coffee"),s=e("./helpers/graph/stack.coffee"),a=function(e){var t,n,a,i,u,c,f,d,p,h,v;if(o(e,{buffer:e.axes.opposite,mouse:!0}),a=e.x.domain.viz.concat(e.y.domain.viz),a.indexOf(void 0)>=0)return[];for(n=l(e.data.viz,null,null,null,e),i=0,c=n.length;i<c;i++)for(d=n[i],p=d.values,u=0,f=p.length;u<f;u++)t=p[u],h=r(e,t,e.x.value),null!==h?(t.d3po.x2=!1,t.d3po.x=e.x.scale.viz(h)):(t.d3po.x2=!0,t.d3po.x=e.x2.scale.viz(r(e,t,e.x2.value))),t.d3po.x+=e.axes.margin.viz.left,v=r(e,t,e.y.value),null!==v?(t.d3po.y2=!1,t.d3po.y=e.y.scale.viz(v)):(t.d3po.y2=!0,t.d3po.y=e.y2.scale.viz(r(e,t,e.y2.value))),t.d3po.y+=e.axes.margin.viz.top;return e.axes.stacked?s(e,n):n},a.filter=function(e,t){return i(e,t)},a.requirements=["data","x","y"],a.setup=function(e){var t;e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"}))},a.shapes=["line"],a.tooltip="static",t.exports=a},{"../../array/sort.coffee":36,"../../core/fetch/value.coffee":69,"./helpers/graph/draw.coffee":317,"./helpers/graph/nest.coffee":323,"./helpers/graph/stack.coffee":324}],326:[function(e,t,n){var r=e("../../network/smallestGap.coffee"),o=e("../../core/fetch/value.coffee"),a=function(e){var t=e.nodes.restricted||e.nodes.value,n=e.edges.restricted||e.edges.value,a=d3.extent(t,function(e){return e.x}),i=d3.extent(t,function(e){return e.y}),l=[1,1];if("number"==typeof e.size.value?l=[e.size.value,e.size.value]:e.size.value&&(l=d3.extent(t,function(t){var n=o(e,t,e.size.value);return 0===n?null:n})),void 0===l[0]&&(l=[1,1]),"number"==typeof e.size.value)var s=e.size.value,u=e.size.value;else{var s=r(t,{accessor:function(e){return[e.x,e.y]}}),c=s/2;if(s*=e.size.value?e.nodes.overlap:.4,e.edges.arrows.value&&(s*=.5),l[0]===l[1]){var u=c;s=c}else{var f=a[1]+1.1*s-(a[0]-1.1*s),d=i[1]+1.1*s-(i[0]-1.1*s),p=f/d;if(e.width.viz/e.height.viz>p)var h=e.height.viz/d;else var h=e.width.viz/f;var u=.25*s;u*h<2&&(u=2/h)}}var v=e.size.scale.value.domain(l).range([u,s]);e.zoom.bounds=[[a[0]-1.1*s,i[0]-1.1*s],[a[1]+1.1*s,i[1]+1.1*s]];var g=[],m={};return t.forEach(function(t){var n=e.data.viz.filter(function(n){return n[e.id.value]==t[e.id.value]})[0],r=n||{};r[e.id.value]=t[e.id.value],r.d3po={},r.d3po.x=t.x,r.d3po.y=t.y;var a=o(e,r,e.size.value);r.d3po.r=a?v(a):v.range()[0],m[r[e.id.value]]={x:r.d3po.x,y:r.d3po.y,r:r.d3po.r},g.push(r)}),g.sort(function(e,t){return t.d3po.r-e.d3po.r}),n.forEach(function(t,n){t.d3po&&delete t.d3po.spline,t[e.edges.source].d3po={};var r=m[t[e.edges.source][e.id.value]];void 0!==r?(t[e.edges.source].d3po.r=r.r,t[e.edges.source].d3po.x=r.x,t[e.edges.source].d3po.y=r.y):delete t[e.edges.source].d3po,t[e.edges.target].d3po={};var o=m[t[e.edges.target][e.id.value]];void 0!==o?(t[e.edges.target].d3po.r=o.r,t[e.edges.target].d3po.x=o.x,t[e.edges.target].d3po.y=o.y):delete t[e.edges.target].d3po}),{nodes:g,edges:n}};a.nesting=!1,a.requirements=["nodes","edges"],a.scale=1.05,a.shapes=["circle","square","donut"],a.tooltip="static",a.zoom=!0,t.exports=a},{"../../core/fetch/value.coffee":69,"../../network/smallestGap.coffee":171}],327:[function(e,t,n){var r,o,a,i,l=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=e("../../network/shortestPath.coffee"),r=e("../../core/fetch/value.coffee"),a=e("../../util/uniques.coffee"),i=function(e){var t,n,o,a,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re,oe,ae,ie,le,se,ue,ce,fe,de;for(h=[],H={},H[e.focus.value[0]]=0,H[e.focus.value[1]]=0,X={all:[[e.focus.value[0]],[e.focus.value[1]]]},J=i.paths,Y=m=0,k=J.length;m<k;Y=++m)for(U=J[Y],h=h.concat(U.edges),_=e.focus.value[0],X[Y]=[_],Q=U.edges,p=y=0,z=Q.length;y<z;p=++y)d=Q[p],d[e.edges.source]=e.data.viz.filter(function(t){return d[e.edges.source][e.id.value]===t[e.id.value]})[0],d[e.edges.target]=e.data.viz.filter(function(t){return d[e.edges.target][e.id.value]===t[e.id.value]})[0],B=d[e.edges.source][e.id.value]===_?"target":"source",D=d[e.edges[B]][e.id.value],void 0===H[D]&&(H[D]=Y),X[Y].push(D),_=D;ae=0;for(Y in X)if(U=X[Y],"all"!==Y){for(q=0,v=x=0,M=U.length;x<M;v=++x)if(g=U[v],0!==v&&v!==U.length-1&&H[g]===parseFloat(Y)){for(q=1,G=U[v-1],P=U[v+1],Z=null,R=null,K=X.all,u=N=0,A=K.length;N<A;u=++N)s=K[u],l.call(s,G)>=0&&(Z=u),l.call(s,P)>=0&&(R=u);null!==Z&&null===R?Z+1===X.all.length-1?X.all.splice(Z+1,0,[g]):X.all[Z+1].push(g):R-Z==1?X.all.splice(R,0,[g]):R-Z>1&&X.all[R-1].push(g)}ae+=q}for(oe=Math.floor(e.height.viz/ae),de=[],v=0;v<ae;)v%2==0?de.push(v):de.unshift(v),v++;for(b=e.size.value&&!e.small?30:0,fe=d3.scale.ordinal().domain(de).range(d3.range(oe/2-b,e.height.viz+oe/2-b,(e.height.viz-oe)/(ae-1))),f=X.all.length,c=Math.floor(e.width.viz/f),ue=d3.scale.linear().domain([0,f-1]).rangeRound([c/2,e.width.viz-c/2]),T=5,F=.4*d3.min([c,oe-b]),le=d3.extent(e.data.viz,function(t){return r(e,t,e.size.value)||0}),ie=e.size.scale.value.domain(le).rangeRound([T,F]),$=e.data.viz,C=0,j=$.length;C<j;C++){for(I=$[C],null==I.d3po&&(I.d3po={}),ee=X.all,u=L=0,E=ee.length;L<E;u=++L)s=ee[u],te=I[e.id.value],l.call(s,te)>=0&&(I.d3po.x=ue(u));I.d3po.y=fe(H[I[e.id.value]]),e.size.value?(se=r(e,I,e.size.value),I.d3po.r=se?ie(se):T):I.d3po.r=F,I.d3po.r<.1*c&&!e.small?I.d3po.label={x:0,y:I.d3po.r+2*e.labels.padding,w:.6*c,h:b+F-I.d3po.r,resize:!1}:delete I.d3po.label}for(ne=i.paths,Y=V=0,S=ne.length;V<S;Y=++V)for(U=ne[Y],_=e.focus.value[0],re=U.edges,p=W=0,O=re.length;W<O;p=++W)d=re[p],B=d[e.edges.source][e.id.value]===_?"target":"source",w="target"===B?"source":"target",D=d[e.edges[B]][e.id.value],H[_]!==H[D]?(d.d3po={spline:!0},null==(t=d[e.edges.source]).d3po&&(t.d3po={}),null==(n=d[e.edges.source].d3po).edges&&(n.edges={}),null==(o=d[e.edges.target]).d3po&&(o.d3po={}),null==(a=d[e.edges.target].d3po).edges&&(a.edges={}),ce=d[B].d3po.x-d[w].d3po.x,d[w].d3po.edges[d[B][e.id.value]]={angle:Math.PI,radius:c/2},d[B].d3po.edges[d[w][e.id.value]]={angle:0,radius:c/2,offset:ce-c}):delete d.d3po,_=D;return{nodes:e.data.viz,edges:h}},i.filter=function(e,t){var n,l,s,u,c,f,d,p,h,v,g,m,y,x,b,w,_,k,z;for(u=e.edges.filtered||e.edges.value,i.paths=o(u,e.focus.value[0],{target:e.focus.value[1],distance:e.edges.size.value||void 0,nodeid:e.id.value,startpoint:e.edges.source,endpoint:e.edges.target,K:e.edges.limit.value||5}),i.nodes=[],n=[],b=i.paths,d=0,v=b.length;d<v;d++)for(x=b[d],w=x.edges,p=0,g=w.length;p<g;p++)s=w[p],k=s[e.edges.source],z=s[e.edges.target],n.indexOf(k[e.id.value])<0&&(i.nodes.push(k),n.push(k[e.id.value])),n.indexOf(z[e.id.value])<0&&(i.nodes.push(z),n.push(z[e.id.value]));for(f=a(i.nodes,e.id.value,r,e),_=[],h=0,m=f.length;h<m;h++)c=f[h],l=t.filter(function(t){return t[e.id.value]===c}),l[0]?_.push(l[0]):(y={d3po:{}},y[e.id.value]=c,_.push(y));return _},i.nesting=!1,i.requirements=[function(e){return{status:2===e.focus.value.length,text:e.format.locale.value.method.focus+" x 2"}},"edges"],i.scale=1,i.shapes=["circle","square","donut"],i.tooltip="static",t.exports=i},{"../../core/fetch/value.coffee":69,"../../network/shortestPath.coffee":170,"../../util/uniques.coffee":213}],328:[function(e,t,n){var r,o,a,i;r=e("../../array/comparator.coffee"),o=e("../../core/data/threshold.js"),a=e("../../core/data/group.coffee"),i=function(e){var t,n,o,i,l,s,u,c,f;for(u=d3.layout.pie().value(function(e){return e.value}).sort(function(t,n){return e.order.value?r(t.d3po,n.d3po,[e.order.value],e.order.sort.value,[],e):e.id.nesting.length>1?r(t.d3po,n.d3po,e.id.nesting.concat([e.size.value]),void 0,[],e):r(t.d3po,n.d3po,[e.size.value],"desc",[],e)}),n=a(e,e.data.viz,[]),s=u(n),f=[],c=d3.min([e.width.viz,e.height.viz])/2-2*e.labels.padding,o=0,l=s.length;o<l;o++)t=s[o],i=t.data.d3po,i.d3po.startAngle=t.startAngle,i.d3po.endAngle=t.endAngle,i.d3po.r=c,i.d3po.x=e.width.viz/2,i.d3po.y=e.height.viz/2,i.d3po.share=(t.endAngle-t.startAngle)/(2*Math.PI),f.push(i);return f},i.filter=o,i.requirements=["data","size"],i.shapes=["arc"],i.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=i},{"../../array/comparator.coffee":34,"../../core/data/group.coffee":59,"../../core/data/threshold.js":63}],329:[function(e,t,n){var r,o,a,i,l,s,u,c;e("../../array/comparator.coffee"),e("../../array/sort.coffee"),e("../../core/data/threshold.js"),o=e("../../core/fetch/text.js"),a=e("../../core/fetch/value.coffee"),i=e("../../font/sizes.coffee"),l=e("../../geom/offset.coffee"),u=e("../../textwrap/textwrap.coffee"),r=e("../../util/buckets.coffee"),c=e("../../util/uniques.coffee"),s=function(e){var t,n,s,f,d,p,h,v,g,m,y,x,b,w,_,k,z,M,A,j,E,S,O,N,F,T,C,q,P,B,D,R,I,L,V,U,Y,H,X,G,Z,W,J,Q,K,$,ee,te,ne,re,oe,ae,ie,le;for(m=e.data.viz,U=e.depth.value+1,Y=e.id.nesting[U],v=function(){var e,t,n;for(n=[],e=0,t=m.length;e<t;e++)g=m[e],n.push(g[Y]);return n}(),ae=function(){var t,n,r;for(r=[],t=0,n=m.length;t<n;t++)g=m[t],r.push(c(m,Y,a,e,U));return r}(),ae=c(d3.merge(ae)).length,f=2*Math.PI/ae,L=d3.min([e.width.viz,e.height.viz])/2,O=0,T=0,C=function(){var t,n,r;for(r=[],t=0,n=v.length;t<n;t++)p=v[t],r.push(o(e,p,U)[0]);return r}(),C=c(d3.merge(C)),e.labels.value&&(y=l(Math.PI/2,L),ee=l(f+Math.PI/2,L),O=y.x-ee.x-2*e.labels.padding,re={fill:e.x.ticks.font.color,"font-family":e.x.ticks.font.family.value,"font-weight":e.x.ticks.font.weight,"font-size":e.x.ticks.font.size+"px"},te=i(C,re,{mod:function(t){return u().container(d3.select(t)).width(e.height.viz/8).height(O).draw()}}),T=d3.max(te,function(e){return e.width}),L-=T,L-=2*e.labels.padding),I=function(){var t,n,r;for(r=[],t=0,n=v.length;t<n;t++)p=v[t],r.push(function(){var t,n,r;for(r=[],t=0,n=p.length;t<n;t++)g=p[t],r.push(a(e,g,e.size.value));return r}());return r}(),I=d3.max(d3.merge(I)),G=d3.scale.linear().domain([0,I]).range([0,L]),k=function(){var t,n,r;for(r=[],t=0,n=v.length;t<n;t++)p=v[t],r.push(a(e,p,Y));return r}(),k=c(d3.merge(k)),_=d3.scale.ordinal().domain(k).range(d3.range(0,k.length)),M=0,q=m.length;M<q;M++)for(g=m[M],g.d3po.x=e.width.viz/2+e.margin.top,g.d3po.y=e.height.viz/2+e.margin.left,Z=g[Y],w=A=0,P=Z.length;A<P;w=++A)t=Z[w],t.d3po||(t.d3po={}),t.d3po.r=G(a(e,t,e.size.value)),t.d3po.a=_(a(e,t,Y))*f;for(z=1,W=[10,5,4,2],R=0,B=W.length;R<B;R++)if(w=W[R],L/w>=20){z=w;break}for(Q=r([L/z,L],z-1).reverse(),Q.length===z&&Q.shift(),$=e.group.selectAll(".d3po_radar_rings").data(Q,function(e,t){return t}),K=function(t){return t.attr("fill",function(t,n){return 0===n?e.axes.background.color:"transparent"}).attr("cx",e.width.viz/2+e.margin.top).attr("cy",e.height.viz/2+e.margin.left).attr("stroke",e.x.grid.value?e.x.grid.color:"transparent")},$.enter().append("circle").attr("class","d3po_radar_rings").call(K).attr("r",0),$.transition().duration(e.draw.timing).call(K).attr("r",function(e){return e}),$.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),N=d3.scale.ordinal().domain(C).range(d3.range(0,C.length)),E=[],V=0,D=C.length;V<D;V++)j=C[V],n=f*N(j)-Math.PI/2,t=n*(180/Math.PI),t<-90||t>90?(t-=180,d=-(L+2*e.labels.padding+T),s="end"):(d=L+2*e.labels.padding,s="start"),oe=n<0||n>Math.PI,J=n<Math.PI/2,X=L,e.labels.value&&(X+=e.labels.padding),H=l(n,X),ie=H.x,le=H.y,J||(ie-=T),oe&&(le-=O),h=[0,Math.PI].indexOf(f*N(j))>=0,h&&(ie-=T/2),E.push({text:j,angle:t,x:d,anchor:s,offset:H});return S=e.group.selectAll("g.d3po_radar_label_group").data([0]),S.enter().append("g").attr("class","d3po_radar_label_group").attr("transform","translate("+e.width.viz/2+","+e.height.viz/2+")"),S.transition().duration(e.draw.timing).attr("transform","translate("+e.width.viz/2+","+e.height.viz/2+")"),ne=S.selectAll(".d3po_radar_labels").data(e.labels.value?E:[],function(e,t){return t}),F=function(e){return e.attr(re).each(function(e,t){return u().container(d3.select(this)).height(O).width(T).align(e.anchor).text(e.text).padding(0).valign("middle").x(e.x).y(-O/2).draw()}).attr("transform",function(e){var t;return t=d3.select(this).attr("transform")||"",t.length&&(t=t.split(")").slice(-3).join(")")),"rotate("+e.angle+")"+t})},ne.call(F),ne.enter().append("text").attr("class","d3po_radar_labels").attr("opacity",0).call(F).transition().duration(e.draw.timing).attr("opacity",1),ne.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),x=e.group.selectAll(".d3po_radar_lines").data(E,function(e,t){return t}),b=function(t){return t.attr("stroke",e.x.grid.color).attr("x1",e.width.viz/2+e.margin.left).attr("y1",e.height.viz/2+e.margin.top)},x.enter().append("line").attr("class","d3po_radar_lines").call(b).attr("x2",e.width.viz/2+e.margin.left).attr("y2",e.height.viz/2+e.margin.top),x.transition().duration(e.draw.timing).call(b).attr("x2",function(t){return e.width.viz/2+e.margin.left+t.offset.x}).attr("y2",function(t){return e.height.viz/2+e.margin.top+t.offset.y}),x.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.mouse.viz={click:!1},m},s.requirements=["data","size"],s.shapes=["radial"],t.exports=s},{"../../array/comparator.coffee":34,"../../array/sort.coffee":36,"../../core/data/threshold.js":63,"../../core/fetch/text.js":68,"../../core/fetch/value.coffee":69,"../../font/sizes.coffee":104,"../../geom/offset.coffee":163,"../../textwrap/textwrap.coffee":203,"../../util/buckets.coffee":207,"../../util/uniques.coffee":213}],330:[function(e,t,n){var r=e("../../array/sort.coffee"),o=e("../../client/pointer.coffee"),i=e("../../core/fetch/value.coffee"),l=e("../../core/fetch/color.coffee"),s=e("../../color/legible.coffee"),u=e("../../tooltip/remove.coffee"),c=e("../../network/smallestGap.coffee"),f=e("../../color/text.coffee"),d=e("../../util/uniques.coffee"),p=function(e){var t=d3.min([e.height.viz,e.width.viz])/2,n=e.small||!e.labels.value?(t-2*e.labels.padding)/2:t/3,p=e.small||!e.labels.value?1.4*n:n,h=2*n,v=[],g=[],m=e.data.viz.filter(function(t){return t[e.id.value]===e.focus.value[0]})[0];m||(m={d3po:{}},m[e.id.value]=e.focus.value[0]),m.d3po.x=e.width.viz/2,m.d3po.y=e.height.viz/2,m.d3po.r=.65*p;var y=[],x=[e.focus.value[0]];e.edges.connections(e.focus.value[0],e.id.value).forEach(function(t){var n=t[e.edges.source][e.id.value]==e.focus.value[0]?t[e.edges.target]:t[e.edges.source],r=e.data.viz.filter(function(t){return t[e.id.value]===n[e.id.value]})[0];r||(r={d3po:{}},r[e.id.value]=n[e.id.value]),r.d3po.edges=e.edges.connections(r[e.id.value],e.id.value).filter(function(t){return t[e.edges.source][e.id.value]!=e.focus.value[0]&&t[e.edges.target][e.id.value]!=e.focus.value[0]}),r.d3po.edge=t,x.push(r[e.id.value]),y.push(r)});var b=e.order.value||e.color.value||e.size.value||e.id.value;y.sort(function(t,n){var o=t.d3po.edges.length-n.d3po.edges.length;return o||r([t,n],b,e.order.sort.value,e.color.value||[],e)}),"number"==typeof e.edges.limit.value?y=y.slice(0,e.edges.limit.value):"function"==typeof e.edges.limit.value&&(y=e.edges.limit.value(y));var w=[],_=0;y.forEach(function(t){var n=t[e.id.value];t.d3po.edges=t.d3po.edges.filter(function(t){var r=t[e.edges.source][e.id.value],o=t[e.edges.target][e.id.value];return x.indexOf(r)<0&&o==n||x.indexOf(o)<0&&r==n}),_+=t.d3po.edges.length||1,t.d3po.edges.forEach(function(t){var r=t[e.edges.source],o=t[e.edges.target],a=o[e.id.value]==n?r:o;x.push(a[e.id.value])})}),r(y,b,e.order.sort.value,e.color.value||[],e);var k=0,z=2*Math.PI,M=0;y.forEach(function(t,n){var o=t.d3po.edges.length||1,i=z/_*o;0==n&&(M=l,k-=i/2);var l=k+i/2;l-=z/4,t.d3po.radians=l,t.d3po.x=e.width.viz/2+p*Math.cos(l),t.d3po.y=e.height.viz/2+p*Math.sin(l),k+=i,t.d3po.edges.sort(function(n,o){var n=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],o=o[e.edges.source][e.id.value]==t[e.id.value]?o[e.edges.target]:o[e.edges.source];return r([n,o],b,e.order.sort.value,e.color.value||[],e)}),t.d3po.edges.forEach(function(n,r){var i=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],s=z/_,u=e.data.viz.filter(function(t){return t[e.id.value]===i[e.id.value]})[0];u||(u={d3po:{}},u[e.id.value]=i[e.id.value]),a=l-s*o/2+s/2+s*r,u.d3po.radians=a,u.d3po.x=e.width.viz/2+h*Math.cos(a),u.d3po.y=e.height.viz/2+h*Math.sin(a),w.push(u)})});var A=c(y,{accessor:function(e){return[e.d3po.x,e.d3po.y]}}),j=c(w,{accessor:function(e){return[e.d3po.x,e.d3po.y]}});if(A||(A=n/2),j||(j=n/4),A/2-4<8)var E=d3.min([A/2,8]);else var E=A/2-4;if(j/2-4<4)var S=d3.min([j/2,4]);else var S=j/2-4;S>n/10&&(S=n/10),S>E&&S>10&&(S=.75*E),E>1.5*S&&(E=1.5*S),E=Math.floor(E),S=Math.floor(S);var O=d(y,e.id.value,i,e);O=O.concat(d(w,e.id.value,i,e)),O.push(e.focus.value[0]);var N=e.data.viz.filter(function(t){return O.indexOf(t[e.id.value])>=0});if(e.size.value){var F=d3.extent(N,function(t){return i(e,t,e.size.value)});F[0]==F[1]&&(F[0]=0);var t=d3.scale.linear().domain(F).rangeRound([3,d3.min([E,S])]),T=i(e,m,e.size.value);m.d3po.r=t(T)}else{var t=d3.scale.linear().domain([1,2]).rangeRound([E,S]);e.edges.label&&(m.d3po.r=1.5*t(1))}w.forEach(function(n){n.d3po.ring=2;var r=e.size.value?i(e,n,e.size.value):2;n.d3po.r=t(r)}),y.forEach(function(n){n.d3po.ring=1;var r=e.size.value?i(e,n,e.size.value):1;n.d3po.r=t(r)}),g=[m].concat(y).concat(w),y.forEach(function(t,r){var o=[e.edges.source,e.edges.target],a=t.d3po.edge;o.forEach(function(t){a[t]=g.filter(function(n){return n[e.id.value]==a[t][e.id.value]})[0]}),delete a.d3po,v.push(a),e.edges.connections(t[e.id.value],e.id.value).forEach(function(r){var o=r[e.edges.source][e.id.value]==t[e.id.value]?r[e.edges.target]:r[e.edges.source];if(o[e.id.value]!=m[e.id.value]){var a=w.filter(function(t){return t[e.id.value]==o[e.id.value]})[0];if(a);else{a=y.filter(function(t){return t[e.id.value]==o[e.id.value]})[0]}if(a){r.d3po={spline:!0,translate:{x:e.width.viz/2,y:e.height.viz/2}};[e.edges.source,e.edges.target].forEach(function(o,i){r[o]=g.filter(function(t){return t[e.id.value]==r[o][e.id.value]})[0],void 0===r[o].d3po.edges&&(r[o].d3po.edges={});var l=0===i?r[e.edges.target][e.id.value]:r[e.edges.source][e.id.value];r[o][e.id.value]==t[e.id.value]?r[o].d3po.edges[l]={angle:t.d3po.radians+Math.PI,radius:n/2}:r[o].d3po.edges[l]={angle:a.d3po.radians,radius:n/2}}),v.push(r)}}})});var C=!1;return e.background.value&&["transparent","none"].indexOf(e.background.value)<0&&d3.hsl(e.background.value).l<.5&&(C=f(e.background.value)),g.forEach(function(t){if(!e.small&&e.labels.value)if(t[e.id.value]!=e.focus.value[0]){t.d3po.rotate=t.d3po.radians*(180/Math.PI);var r=t.d3po.rotate,o=n-3*e.labels.padding-t.d3po.r;if(r<-90||r>90){r-=180;var a=-(t.d3po.r+o/2+e.labels.padding),i="end"}else var a=t.d3po.r+o/2+e.labels.padding,i="start";var u=y.indexOf(t)>=0,c=1==t.d3po.ring?A:j;t.d3po.label={x:a,y:0,w:o,h:c,angle:r,anchor:i,valign:"center",color:C||s(l(e,t)),resize:[8,e.labels.font.size],background:u,mouse:!0}}else if(e.size.value||e.edges.label){var c=p-2*t.d3po.r-2*e.labels.padding;t.d3po.label={x:0,y:t.d3po.r+c/2,w:p,h:c,color:C||s(l(e,t)),resize:[10,40],background:!0,mouse:!0}}else delete t.d3po.rotate,delete t.d3po.label;else delete t.d3po.rotate,delete t.d3po.label}),e.mouse.viz={},e.mouse.viz[o.click]=function(t){if(t[e.id.value]!=e.focus.value[0]){u(e.type.value);var n=e.focus.value[0];e.history.states.push(function(){e.self.focus(n).draw()}),e.self.focus(t[e.id.value]).draw()}},{edges:v,nodes:g,data:N}};p.filter=function(e,t){var n=e.edges.connections(e.focus.value[0],e.id.value,!0),r=[];n.forEach(function(t){r=r.concat(e.edges.connections(t[e.id.value],e.id.value,!0))});var o=n.concat(r),a=d(o,e.id.value,i,e),l=[];return a.forEach(function(n){var r=t.filter(function(t){return t[e.id.value]==n})[0];if(r)l.push(r);else{var o={d3po:{}};o[e.id.value]=n,l.push(o)}}),l},p.nesting=!1,p.scale=1,p.shapes=["circle","square","donut"],p.requirements=["edges","focus"],p.tooltip="static",t.exports=p},{"../../array/sort.coffee":36,"../../client/pointer.coffee":40,"../../color/legible.coffee":46,"../../color/text.coffee":52,"../../core/fetch/color.coffee":65,"../../core/fetch/value.coffee":69,"../../network/smallestGap.coffee":171,"../../tooltip/remove.coffee":206,"../../util/uniques.coffee":213}],331:[function(e,t,n){var r,o,a,i;r=e("./sankey.js"),o=e("../../client/pointer.coffee"),a=e("../../tooltip/remove.coffee"),e("../../util/uniques.coffee"),i=function(e){var t,n,i,l,s,u,c,f,d,p,h,v,g,m,y;for(l=e.focus.value[0],v=2*e.data.stroke.width,y=e.size.value.constructor===Number?e.size.value:20,i=e.edges.connections(l,e.id.value).filter(function(t){return t[e.edges.source][e.id.value]!==l||t[e.edges.target][e.id.value]!==l}),h=[],g=[],i=i.map(function(t){var n,r;return t[e.edges.target][e.id.value]===l?(n={id:"left_"+t[e.edges.source][e.id.value],dupe:"left",data:t[e.edges.source],value:t[e.edges.strength.value]},r=t[e.edges.target]):(n=t[e.edges.source],r={id:"right_"+t[e.edges.target][e.id.value],dupe:"right",data:t[e.edges.target],value:t[e.edges.strength.value]}),g.indexOf(n.id)<0&&h.push(n),g.indexOf(r.id)<0&&h.push(r),g.push(n.id),g.push(r.id),{source:n,target:r,value:t[e.edges.strength.value]||1}}),c=r().nodeWidth(y).nodePadding(e.data.padding.value).size([e.width.viz-2*v,e.height.viz-2*v]).nodes(h).links(i).layout(2),m=[],s=0,f=h.length;s<f;s++)p=h[s],t=p.data||p,t={id:t[e.id.value]},t.d3po={x:p.x+p.dx/2+v,y:p.y+p.dy/2+v,width:p.dx,height:p.dy,suffix:p.dupe},t.id!==l&&(t[e.edges.strength.value]=p.value),m.push(t);for(e.edges.path=c.link(),u=0,d=i.length;u<d;u++)n=i[u],n.d3po={x:v,y:v};return e.mouse.viz={},e.mouse.viz[o.click]=function(t){var n;if(t[e.id.value]!==e.focus.value[0])return a(e.type.value),n=e.focus.value[0],e.history.states.push(function(){return e.self.focus(n).draw()}),e.self.focus(t[e.id.value]).draw()},{nodes:m,edges:i}},i.requirements=["edges","focus","nodes"],i.shapes=["square"],t.exports=i},{"../../client/pointer.coffee":40,"../../tooltip/remove.coffee":206,"../../util/uniques.coffee":213,"./sankey.js":332}],332:[function(e,t,n){t.exports=function(){function e(){p.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),h.forEach(function(e){var t=e.source,n=e.target;"number"==typeof t&&(t=e.source=p[e.source]),"number"==typeof n&&(n=e.target=p[e.target]),t.sourceLinks.push(e),n.targetLinks.push(e)})}function t(){p.forEach(function(e){e.value=Math.max(d3.sum(e.sourceLinks,s),d3.sum(e.targetLinks,s))})}function n(){for(var e,t=p,n=0;t.length;)e=[],t.forEach(function(t){t.x=n,t.dx=c,t.sourceLinks.forEach(function(t){e.indexOf(t.target)<0&&e.push(t.target)})}),t=e,++n;r(n),o((d[0]-c)/(n-1))}function r(e){p.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})}function o(e){p.forEach(function(t){t.x*=e})}function a(e){function t(){r.forEach(function(e){var t,r,o,a=0,i=e.length;for(e.sort(n),o=0;o<i;++o)t=e[o],r=a-t.y,r>0&&(t.y+=r),a=t.y+t.dy+f;if((r=a-f-d[1])>0)for(a=t.y-=r,o=i-2;o>=0;--o)t=e[o],r=t.y+t.dy+f-a,r>0&&(t.y-=r),a=t.y})}function n(e,t){return e.y-t.y}var r=d3.nest().key(function(e){return e.x}).sortKeys(d3.ascending).entries(p).map(function(e){return e.values});!function(){var e=d3.min(r,function(e){return(d[1]-(e.length-1)*f)/d3.sum(e,s)});r.forEach(function(t){t.forEach(function(t,n){t.y=n,t.dy=t.value*e})}),h.forEach(function(t){t.dy=t.value*e})}(),t();for(var o=1;e>0;--e)!function(e){function t(e){return l(e.target)*e.value}r.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var r=d3.sum(n.sourceLinks,t)/d3.sum(n.sourceLinks,s);n.y+=(r-l(n))*e}})})}(o*=.99),t(),function(e){function t(e){return l(e.source)*e.value}r.forEach(function(n,r){n.forEach(function(n){if(n.targetLinks.length){var r=d3.sum(n.targetLinks,t)/d3.sum(n.targetLinks,s);n.y+=(r-l(n))*e}})})}(o),t()}function i(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}p.forEach(function(n){n.sourceLinks.sort(t),n.targetLinks.sort(e)}),p.forEach(function(e){var t=0,n=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=n,n+=e.dy})})}function l(e){return e.y+e.dy/2}function s(e){return e.value}var u={},c=24,f=8,d=[1,1],p=[],h=[];return u.nodeWidth=function(e){return arguments.length?(c=+e,u):c},u.nodePadding=function(e){return arguments.length?(f=+e,u):f},u.nodes=function(e){return arguments.length?(p=e,u):p},u.links=function(e){return arguments.length?(h=e,u):h},u.size=function(e){return arguments.length?(d=e,u):d},u.layout=function(r){return e(),t(),n(),a(r),i(),u},u.relayout=function(){return i(),u},u.link=function(){function e(e){var n=e.source.x+e.source.dx,r=e.target.x,o=d3.interpolateNumber(n,r),a=o(t),i=o(1-t),l=e.source.y+e.sy+e.dy/2,s=e.target.y+e.ty+e.dy/2;return"M"+n+","+l+"C"+a+","+l+" "+i+","+s+" "+r+","+s}var t=.5;return e.curvature=function(n){return arguments.length?(t=+n,e):t},e},u}},{}],333:[function(e,t,n){var r,o,a,i,l;r=e("../../core/fetch/value.coffee"),o=e("./helpers/graph/draw.coffee"),e("../../core/console/print.coffee"),i=e("../../array/sort.coffee"),l=e("./helpers/graph/dataTicks.coffee"),a=function(e){var t,n,a,s,u;if(o(e,{buffer:"size",mouse:!0}),n=e.x.domain.viz.concat(e.y.domain.viz),n.indexOf(void 0)>=0)return[];for(u=e.data.viz,a=0,s=u.length;a<s;a++)t=u[a],t.d3po.x=e.x.scale.viz(r(e,t,e.x.value)),t.d3po.x+=e.axes.margin.viz.left,t.d3po.y=e.y.scale.viz(r(e,t,e.y.value)),t.d3po.y+=e.axes.margin.viz.top,"number"!=typeof e.size.value&&e.size.value?t.d3po.r=e.axes.scale(r(e,t,e.size.value)):t.d3po.r=e.axes.scale(0);return l(e),i(e.data.viz,e.order.value||e.size.value||e.id.value,"desc"===e.order.sort.value?"asc":"desc",e.color.value||[],e)},a.fill=!0,a.requirements=["data","x","y"],a.scale=1.1,a.setup=function(e){if(e.time.value&&!e.axes.discrete&&(e.time.value===e.x.value&&e.self.x({scale:"discrete"}),e.time.value===e.y.value))return e.self.y({scale:"discrete"})},a.shapes=["circle","square","donut"],a.tooltip="static",t.exports=a},{"../../array/sort.coffee":36,"../../core/console/print.coffee":54,"../../core/fetch/value.coffee":69,"./helpers/graph/dataTicks.coffee":316,"./helpers/graph/draw.coffee":317}],334:[function(e,t,n){var r=e("../../core/fetch/value.coffee"),o=e("../../util/uniques.coffee"),a=e("../../util/copy.coffee"),i=e("../../color/random.coffee"),l=function(e){var t=o(e.data.viz,e.id.value,r,e),n=o(e.cols.value);n.indexOf("label")<0&&e.cols.index.value&&n.unshift("label");var l=e.height.viz/(t.length+1),s=e.width.viz/n.length;e.group.selectAll("rect").data([0]).enter().append("rect").attr("class","background").attr("height",e.height.viz).attr("width",e.width.viz).style("fill",e.color.missing);var u=e.group.selectAll("line.horiz").data(e.data.viz);u.enter().append("line").attr("class","horiz"),u.attr("x1",0).attr("y1",function(e,t){return l*t+l}).attr("x2",e.width.viz).attr("y2",function(e,t){return l*t+l}).style("fill","#fff").style("stroke","#fff"),u.exit().remove();var c=e.group.selectAll("line.vert").data(n);c.enter().append("line").attr("class","vert"),c.attr("x1",function(e,t){return s*t+s}).attr("y1",0).attr("x2",function(e,t){return s*t+s}).attr("y2",e.height.viz).style("fill","#fff").style("stroke","#fff"),c.exit().remove();var f=[],d={};return n.forEach(function(t,n){var r={d3po:{x:s*n+s/2,y:l/2,width:s,height:l,id:"d3p_header_"+t.toString().replace(/ /g,"_"),shape:"square",color:"#fff",text:e.format.value(t)}};if(t==e.id.value&&(r.d3po.color="#fff"),"label"==t&&(r.d3po.label=!1,r.d3po.color="#fff",r.d3po.stroke="#fff"),f.push(r),"number"==e.data.keys[t]){var o=d3.extent(e.data.viz,function(e){return e[t]});o[0]==o[1]&&(o=[o[0]-1,o[1]]),d[t]=d3.scale.linear().domain(o).range([e.color.missing,i(t)])}else"boolean"==e.data.keys[t]&&(d[t]=function(n){return n?i(t):e.color.missing})}),e.data.viz.forEach(function(t,r){r+=1,n.forEach(function(n,o){var i=a(t);i.d3po.id="d3p_"+i[e.id.value].toString().replace(/ /g,"_")+"_"+n,i.d3po.x=s*o+s/2,i.d3po.y=l*r+l/2,i.d3po.width=s,i.d3po.height=l,"label"==n&&(i.d3po.shape="square",i.d3po.color="#fff",f.push(i)),d3.keys(t).indexOf(n)>=0&&n in t&&(d[n]&&(i.d3po.color=d[n](i[n])),i.d3po.text=e.format.value(i[n]),"boolean"==e.data.keys[n]?i.d3po.label=!1:"string"==e.data.keys[n]&&(i.d3po.color=e.color.missing,i.d3po.stroke="#fff",i.d3po.shape="square"),f.push(i))})}),f};l.shapes=["check","cross","diamond","square","triangle","triangle_up","triangle_down"],l.requirements=["data","cols"],t.exports=l},{"../../color/random.coffee":49,"../../core/fetch/value.coffee":69,"../../util/copy.coffee":210,"../../util/uniques.coffee":213}],335:[function(e,t,n){var r,o,a,i;r=e("../../core/data/threshold.js"),o=e("../../core/data/group.coffee"),a=e("../../object/merge.coffee"),i=function(e){var t,n,r,i,l,s,u;if(r=o(e,e.data.viz),n=d3.layout.treemap().mode(e.type.mode.value).round(!0).size([e.width.viz,e.height.viz]).children(function(e){return e.values}).padding(e.data.padding.value).sort(function(e,t){var n;return n=e.value-t.value,0===n?e.id<t.id:n}).nodes({name:"root",values:r}).filter(function(e){return!e.values&&e.area}),n.length){for(u=n[0];u.parent;)u=u.parent;for(s=[],i=0,l=n.length;i<l;i++)t=n[i],t.d3po.d3po=a(t.d3po.d3po,{x:t.x+t.dx/2,y:t.y+t.dy/2,width:t.dx,height:t.dy,share:t.value/u.value}),s.push(t.d3po)}return s},i.filter=r,i.modes=["squarify","slice","dice","slice-dice"],i.requirements=["data","size"],i.shapes=["square"],i.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=i},{"../../core/data/group.coffee":59,"../../core/data/threshold.js":63,"../../object/merge.coffee":174}],336:[function(e,t,n){var r,o,a,i,l,s;r=e("../core/methods/attach.coffee"),o=e("./methods/helpers/axis.coffee"),i=e("./helpers/ui/message.js"),l=e("./helpers/drawSteps.js"),s=e("../core/console/print.coffee"),a=e("./helpers/container.coffee"),e("../object/validate.coffee"),t.exports=function(){var t;return t={g:{apps:{}},types:{area:e("./types/area.coffee"),bar:e("./types/bar.coffee"),bubbles:e("./types/bubbles.coffee"),box:e("./types/box.coffee"),chart:e("./types/deprecated/chart.coffee"),geo_map:e("./types/geo_map.coffee"),line:e("./types/line.coffee"),network:e("./types/network.js"),paths:e("./types/paths.coffee"),pie:e("./types/pie.coffee"),radar:e("./types/radar.coffee"),rings:e("./types/rings.js"),sankey:e("./types/sankey.coffee"),scatter:e("./types/scatter.coffee"),stacked:e("./types/area.coffee"),table:e("./types/table.js"),tree_map:e("./types/tree_map.coffee")}},t.self=function(e){return e.each(function(){var e,n,r,o,u,c,f;t.draw.frozen=!0,t.error.internal=null,"timing"in t.draw||(t.draw.timing=t.timing.transitions),t.error.value&&(t.draw.timing=0),a(t),c=t.width.value<=t.width.small,u=t.height.value<=t.height.small,t.small=c||u,t.width.viz=t.width.value,t.height.viz=t.height.value,e=!1,n=function(){f.length?o():t.dev.value&&(s.groupEnd(),s.timeEnd("total draw time"),s.log("\n"))},r=function(e,r){r=r||"function",e[r]instanceof Array?e[r].forEach(function(e){e(t,n)}):"function"==typeof e[r]&&e[r](t,n),e.wait||n()},o=function(){var o,a,l,u;u=f.shift(),l=t.g.message&&e===u.message,a=!("check"in u)||u.check,"function"==typeof a&&(a=a(t)),a?l?r(u):(t.dev.value&&(!1!==e&&s.groupEnd(),s.group(u.message)),"string"==typeof t.messages.value?(e=t.messages.value,o=t.messages.value):(e=u.message,o=t.format.value(u.message)),t.draw.update?(i(t,o),t.error.value?r(u):setTimeout(function(){return r(u)},10)):r(u)):"otherwise"in u?t.error.value?r(u,"otherwise"):setTimeout(function(){return r(u,"otherwise")},10):n()},t.messages.style.backup=t.group&&"1"===t.group.attr("opacity")?"small":"large",f=l(t),o()}),t.self},r(t,{active:e("./methods/active.coffee"),aggs:e("./methods/aggs.coffee"),attrs:e("./methods/attrs.coffee"),axes:e("./methods/axes.coffee"),background:e("./methods/background.coffee"),class:e("./methods/class.coffee"),color:e("./methods/color.coffee"),cols:e("./methods/cols.js"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),coords:e("./methods/coords.coffee"),csv:e("./methods/csv.coffee"),data:e("./methods/data.coffee"),depth:e("./methods/depth.coffee"),
descs:e("./methods/descs.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.js"),edges:e("./methods/edges.js"),error:e("./methods/error.coffee"),focus:e("./methods/focus.coffee"),font:e("./methods/font.coffee"),footer:e("./methods/footer.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),history:e("./methods/history.coffee"),icon:e("./methods/icon.coffee"),id:e("./methods/id.coffee"),labels:e("./methods/labels.coffee"),legend:e("./methods/legend.coffee"),links:e("./methods/links.coffee"),margin:e("./methods/margin.coffee"),messages:e("./methods/messages.coffee"),mouse:e("./methods/mouse.coffee"),nodes:e("./methods/nodes.coffee"),order:e("./methods/order.coffee"),resize:e("./methods/resize.coffee"),shape:e("./methods/shape.coffee"),size:e("./methods/size.coffee"),style:e("./methods/style.coffee"),temp:e("./methods/temp.coffee"),text:e("./methods/text.coffee"),time:e("./methods/time.coffee"),timeline:e("./methods/timeline.coffee"),timing:e("./methods/timing.coffee"),title:e("./methods/title.coffee"),tooltip:e("./methods/tooltip.coffee"),total:e("./methods/total.coffee"),type:e("./methods/type.coffee"),ui:e("./methods/ui.coffee"),width:e("./methods/width.coffee"),x:o("x"),x2:o("x2"),y:o("y"),y2:o("y2"),zoom:e("./methods/zoom.js")}),t.self}},{"../core/console/print.coffee":54,"../core/methods/attach.coffee":82,"../object/validate.coffee":175,"./helpers/container.coffee":214,"./helpers/drawSteps.js":215,"./helpers/ui/message.js":249,"./methods/active.coffee":258,"./methods/aggs.coffee":259,"./methods/attrs.coffee":260,"./methods/axes.coffee":261,"./methods/background.coffee":262,"./methods/class.coffee":263,"./methods/color.coffee":264,"./methods/cols.js":265,"./methods/config.coffee":266,"./methods/container.coffee":267,"./methods/coords.coffee":268,"./methods/csv.coffee":269,"./methods/data.coffee":270,"./methods/depth.coffee":271,"./methods/descs.coffee":272,"./methods/dev.coffee":273,"./methods/draw.js":274,"./methods/edges.js":275,"./methods/error.coffee":276,"./methods/focus.coffee":277,"./methods/font.coffee":278,"./methods/footer.coffee":279,"./methods/format.coffee":280,"./methods/height.coffee":281,"./methods/helpers/axis.coffee":282,"./methods/history.coffee":283,"./methods/icon.coffee":284,"./methods/id.coffee":285,"./methods/labels.coffee":286,"./methods/legend.coffee":287,"./methods/links.coffee":288,"./methods/margin.coffee":289,"./methods/messages.coffee":290,"./methods/mouse.coffee":291,"./methods/nodes.coffee":292,"./methods/order.coffee":293,"./methods/resize.coffee":294,"./methods/shape.coffee":295,"./methods/size.coffee":296,"./methods/style.coffee":297,"./methods/temp.coffee":298,"./methods/text.coffee":299,"./methods/time.coffee":300,"./methods/timeline.coffee":301,"./methods/timing.coffee":302,"./methods/title.coffee":303,"./methods/tooltip.coffee":304,"./methods/total.coffee":305,"./methods/type.coffee":306,"./methods/ui.coffee":307,"./methods/width.coffee":308,"./methods/zoom.js":309,"./types/area.coffee":310,"./types/bar.coffee":311,"./types/box.coffee":312,"./types/bubbles.coffee":313,"./types/deprecated/chart.coffee":314,"./types/geo_map.coffee":315,"./types/line.coffee":325,"./types/network.js":326,"./types/paths.coffee":327,"./types/pie.coffee":328,"./types/radar.coffee":329,"./types/rings.js":330,"./types/sankey.coffee":331,"./types/scatter.coffee":333,"./types/table.js":334,"./types/tree_map.coffee":335}]},{},[166,165]);